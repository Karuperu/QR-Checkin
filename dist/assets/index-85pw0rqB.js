function jf(h,i){for(var o=0;o<i.length;o++){const f=i[o];if(typeof f!="string"&&!Array.isArray(f)){for(const x in f)if(x!=="default"&&!(x in h)){const m=Object.getOwnPropertyDescriptor(f,x);m&&Object.defineProperty(h,x,m.get?m:{enumerable:!0,get:()=>f[x]})}}}return Object.freeze(Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))f(x);new MutationObserver(x=>{for(const m of x)if(m.type==="childList")for(const w of m.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&f(w)}).observe(document,{childList:!0,subtree:!0});function o(x){const m={};return x.integrity&&(m.integrity=x.integrity),x.referrerPolicy&&(m.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?m.credentials="include":x.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function f(x){if(x.ep)return;x.ep=!0;const m=o(x);fetch(x.href,m)}})();var ql=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uc(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}function $g(h){if(Object.prototype.hasOwnProperty.call(h,"__esModule"))return h;var i=h.default;if(typeof i=="function"){var o=function f(){var x=!1;try{x=this instanceof f}catch{}return x?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};o.prototype=i.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(h).forEach(function(f){var x=Object.getOwnPropertyDescriptor(h,f);Object.defineProperty(o,f,x.get?x:{enumerable:!0,get:function(){return h[f]}})}),o}var Fu={exports:{}},Eo={},Uu={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _h;function Xg(){if(_h)return It;_h=1;var h=Symbol.for("react.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),w=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),A=Symbol.iterator;function O(B){return B===null||typeof B!="object"?null:(B=A&&B[A]||B["@@iterator"],typeof B=="function"?B:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,F={};function U(B,te,fe){this.props=B,this.context=te,this.refs=F,this.updater=fe||D}U.prototype.isReactComponent={},U.prototype.setState=function(B,te){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,te,"setState")},U.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function ie(){}ie.prototype=U.prototype;function re(B,te,fe){this.props=B,this.context=te,this.refs=F,this.updater=fe||D}var L=re.prototype=new ie;L.constructor=re,z(L,U.prototype),L.isPureReactComponent=!0;var Y=Array.isArray,ne=Object.prototype.hasOwnProperty,ce={current:null},q={key:!0,ref:!0,__self:!0,__source:!0};function Ne(B,te,fe){var Be,nt={},Ae=null,mt=null;if(te!=null)for(Be in te.ref!==void 0&&(mt=te.ref),te.key!==void 0&&(Ae=""+te.key),te)ne.call(te,Be)&&!q.hasOwnProperty(Be)&&(nt[Be]=te[Be]);var Ye=arguments.length-2;if(Ye===1)nt.children=fe;else if(1<Ye){for(var Ue=Array(Ye),ct=0;ct<Ye;ct++)Ue[ct]=arguments[ct+2];nt.children=Ue}if(B&&B.defaultProps)for(Be in Ye=B.defaultProps,Ye)nt[Be]===void 0&&(nt[Be]=Ye[Be]);return{$$typeof:h,type:B,key:Ae,ref:mt,props:nt,_owner:ce.current}}function Z(B,te){return{$$typeof:h,type:B.type,key:te,ref:B.ref,props:B.props,_owner:B._owner}}function Ke(B){return typeof B=="object"&&B!==null&&B.$$typeof===h}function ge(B){var te={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(fe){return te[fe]})}var xe=/\/+/g;function Ve(B,te){return typeof B=="object"&&B!==null&&B.key!=null?ge(""+B.key):te.toString(36)}function Fe(B,te,fe,Be,nt){var Ae=typeof B;(Ae==="undefined"||Ae==="boolean")&&(B=null);var mt=!1;if(B===null)mt=!0;else switch(Ae){case"string":case"number":mt=!0;break;case"object":switch(B.$$typeof){case h:case i:mt=!0}}if(mt)return mt=B,nt=nt(mt),B=Be===""?"."+Ve(mt,0):Be,Y(nt)?(fe="",B!=null&&(fe=B.replace(xe,"$&/")+"/"),Fe(nt,te,fe,"",function(ct){return ct})):nt!=null&&(Ke(nt)&&(nt=Z(nt,fe+(!nt.key||mt&&mt.key===nt.key?"":(""+nt.key).replace(xe,"$&/")+"/")+B)),te.push(nt)),1;if(mt=0,Be=Be===""?".":Be+":",Y(B))for(var Ye=0;Ye<B.length;Ye++){Ae=B[Ye];var Ue=Be+Ve(Ae,Ye);mt+=Fe(Ae,te,fe,Ue,nt)}else if(Ue=O(B),typeof Ue=="function")for(B=Ue.call(B),Ye=0;!(Ae=B.next()).done;)Ae=Ae.value,Ue=Be+Ve(Ae,Ye++),mt+=Fe(Ae,te,fe,Ue,nt);else if(Ae==="object")throw te=String(B),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.");return mt}function X(B,te,fe){if(B==null)return B;var Be=[],nt=0;return Fe(B,Be,"","",function(Ae){return te.call(fe,Ae,nt++)}),Be}function Ge(B){if(B._status===-1){var te=B._result;te=te(),te.then(function(fe){(B._status===0||B._status===-1)&&(B._status=1,B._result=fe)},function(fe){(B._status===0||B._status===-1)&&(B._status=2,B._result=fe)}),B._status===-1&&(B._status=0,B._result=te)}if(B._status===1)return B._result.default;throw B._result}var Ce={current:null},he={transition:null},je={ReactCurrentDispatcher:Ce,ReactCurrentBatchConfig:he,ReactCurrentOwner:ce};function ye(){throw Error("act(...) is not supported in production builds of React.")}return It.Children={map:X,forEach:function(B,te,fe){X(B,function(){te.apply(this,arguments)},fe)},count:function(B){var te=0;return X(B,function(){te++}),te},toArray:function(B){return X(B,function(te){return te})||[]},only:function(B){if(!Ke(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},It.Component=U,It.Fragment=o,It.Profiler=x,It.PureComponent=re,It.StrictMode=f,It.Suspense=N,It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=je,It.act=ye,It.cloneElement=function(B,te,fe){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var Be=z({},B.props),nt=B.key,Ae=B.ref,mt=B._owner;if(te!=null){if(te.ref!==void 0&&(Ae=te.ref,mt=ce.current),te.key!==void 0&&(nt=""+te.key),B.type&&B.type.defaultProps)var Ye=B.type.defaultProps;for(Ue in te)ne.call(te,Ue)&&!q.hasOwnProperty(Ue)&&(Be[Ue]=te[Ue]===void 0&&Ye!==void 0?Ye[Ue]:te[Ue])}var Ue=arguments.length-2;if(Ue===1)Be.children=fe;else if(1<Ue){Ye=Array(Ue);for(var ct=0;ct<Ue;ct++)Ye[ct]=arguments[ct+2];Be.children=Ye}return{$$typeof:h,type:B.type,key:nt,ref:Ae,props:Be,_owner:mt}},It.createContext=function(B){return B={$$typeof:w,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:m,_context:B},B.Consumer=B},It.createElement=Ne,It.createFactory=function(B){var te=Ne.bind(null,B);return te.type=B,te},It.createRef=function(){return{current:null}},It.forwardRef=function(B){return{$$typeof:S,render:B}},It.isValidElement=Ke,It.lazy=function(B){return{$$typeof:E,_payload:{_status:-1,_result:B},_init:Ge}},It.memo=function(B,te){return{$$typeof:b,type:B,compare:te===void 0?null:te}},It.startTransition=function(B){var te=he.transition;he.transition={};try{B()}finally{he.transition=te}},It.unstable_act=ye,It.useCallback=function(B,te){return Ce.current.useCallback(B,te)},It.useContext=function(B){return Ce.current.useContext(B)},It.useDebugValue=function(){},It.useDeferredValue=function(B){return Ce.current.useDeferredValue(B)},It.useEffect=function(B,te){return Ce.current.useEffect(B,te)},It.useId=function(){return Ce.current.useId()},It.useImperativeHandle=function(B,te,fe){return Ce.current.useImperativeHandle(B,te,fe)},It.useInsertionEffect=function(B,te){return Ce.current.useInsertionEffect(B,te)},It.useLayoutEffect=function(B,te){return Ce.current.useLayoutEffect(B,te)},It.useMemo=function(B,te){return Ce.current.useMemo(B,te)},It.useReducer=function(B,te,fe){return Ce.current.useReducer(B,te,fe)},It.useRef=function(B){return Ce.current.useRef(B)},It.useState=function(B){return Ce.current.useState(B)},It.useSyncExternalStore=function(B,te,fe){return Ce.current.useSyncExternalStore(B,te,fe)},It.useTransition=function(){return Ce.current.useTransition()},It.version="18.3.1",It}var Nh;function gd(){return Nh||(Nh=1,Uu.exports=Xg()),Uu.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eh;function qg(){if(Eh)return Eo;Eh=1;var h=gd(),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),f=Object.prototype.hasOwnProperty,x=h.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m={key:!0,ref:!0,__self:!0,__source:!0};function w(S,N,b){var E,A={},O=null,D=null;b!==void 0&&(O=""+b),N.key!==void 0&&(O=""+N.key),N.ref!==void 0&&(D=N.ref);for(E in N)f.call(N,E)&&!m.hasOwnProperty(E)&&(A[E]=N[E]);if(S&&S.defaultProps)for(E in N=S.defaultProps,N)A[E]===void 0&&(A[E]=N[E]);return{$$typeof:i,type:S,key:O,ref:D,props:A,_owner:x.current}}return Eo.Fragment=o,Eo.jsx=w,Eo.jsxs=w,Eo}var Ch;function Kg(){return Ch||(Ch=1,Fu.exports=qg()),Fu.exports}var l=Kg(),V=gd();const vr=uc(V),Yg=jf({__proto__:null,default:vr},[V]);var Kl={},Wu={exports:{}},En={},zu={exports:{}},Vu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sh;function Zg(){return Sh||(Sh=1,function(h){function i(he,je){var ye=he.length;he.push(je);e:for(;0<ye;){var B=ye-1>>>1,te=he[B];if(0<x(te,je))he[B]=je,he[ye]=te,ye=B;else break e}}function o(he){return he.length===0?null:he[0]}function f(he){if(he.length===0)return null;var je=he[0],ye=he.pop();if(ye!==je){he[0]=ye;e:for(var B=0,te=he.length,fe=te>>>1;B<fe;){var Be=2*(B+1)-1,nt=he[Be],Ae=Be+1,mt=he[Ae];if(0>x(nt,ye))Ae<te&&0>x(mt,nt)?(he[B]=mt,he[Ae]=ye,B=Ae):(he[B]=nt,he[Be]=ye,B=Be);else if(Ae<te&&0>x(mt,ye))he[B]=mt,he[Ae]=ye,B=Ae;else break e}}return je}function x(he,je){var ye=he.sortIndex-je.sortIndex;return ye!==0?ye:he.id-je.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;h.unstable_now=function(){return m.now()}}else{var w=Date,S=w.now();h.unstable_now=function(){return w.now()-S}}var N=[],b=[],E=1,A=null,O=3,D=!1,z=!1,F=!1,U=typeof setTimeout=="function"?setTimeout:null,ie=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(he){for(var je=o(b);je!==null;){if(je.callback===null)f(b);else if(je.startTime<=he)f(b),je.sortIndex=je.expirationTime,i(N,je);else break;je=o(b)}}function Y(he){if(F=!1,L(he),!z)if(o(N)!==null)z=!0,Ge(ne);else{var je=o(b);je!==null&&Ce(Y,je.startTime-he)}}function ne(he,je){z=!1,F&&(F=!1,ie(Ne),Ne=-1),D=!0;var ye=O;try{for(L(je),A=o(N);A!==null&&(!(A.expirationTime>je)||he&&!ge());){var B=A.callback;if(typeof B=="function"){A.callback=null,O=A.priorityLevel;var te=B(A.expirationTime<=je);je=h.unstable_now(),typeof te=="function"?A.callback=te:A===o(N)&&f(N),L(je)}else f(N);A=o(N)}if(A!==null)var fe=!0;else{var Be=o(b);Be!==null&&Ce(Y,Be.startTime-je),fe=!1}return fe}finally{A=null,O=ye,D=!1}}var ce=!1,q=null,Ne=-1,Z=5,Ke=-1;function ge(){return!(h.unstable_now()-Ke<Z)}function xe(){if(q!==null){var he=h.unstable_now();Ke=he;var je=!0;try{je=q(!0,he)}finally{je?Ve():(ce=!1,q=null)}}else ce=!1}var Ve;if(typeof re=="function")Ve=function(){re(xe)};else if(typeof MessageChannel<"u"){var Fe=new MessageChannel,X=Fe.port2;Fe.port1.onmessage=xe,Ve=function(){X.postMessage(null)}}else Ve=function(){U(xe,0)};function Ge(he){q=he,ce||(ce=!0,Ve())}function Ce(he,je){Ne=U(function(){he(h.unstable_now())},je)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(he){he.callback=null},h.unstable_continueExecution=function(){z||D||(z=!0,Ge(ne))},h.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<he?Math.floor(1e3/he):5},h.unstable_getCurrentPriorityLevel=function(){return O},h.unstable_getFirstCallbackNode=function(){return o(N)},h.unstable_next=function(he){switch(O){case 1:case 2:case 3:var je=3;break;default:je=O}var ye=O;O=je;try{return he()}finally{O=ye}},h.unstable_pauseExecution=function(){},h.unstable_requestPaint=function(){},h.unstable_runWithPriority=function(he,je){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var ye=O;O=he;try{return je()}finally{O=ye}},h.unstable_scheduleCallback=function(he,je,ye){var B=h.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?B+ye:B):ye=B,he){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=ye+te,he={id:E++,callback:je,priorityLevel:he,startTime:ye,expirationTime:te,sortIndex:-1},ye>B?(he.sortIndex=ye,i(b,he),o(N)===null&&he===o(b)&&(F?(ie(Ne),Ne=-1):F=!0,Ce(Y,ye-B))):(he.sortIndex=te,i(N,he),z||D||(z=!0,Ge(ne))),he},h.unstable_shouldYield=ge,h.unstable_wrapCallback=function(he){var je=O;return function(){var ye=O;O=je;try{return he.apply(this,arguments)}finally{O=ye}}}}(Vu)),Vu}var Ah;function Qg(){return Ah||(Ah=1,zu.exports=Zg()),zu.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kh;function Jg(){if(kh)return En;kh=1;var h=gd(),i=Qg();function o(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,d=1;d<arguments.length;d++)s+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f=new Set,x={};function m(t,s){w(t,s),w(t+"Capture",s)}function w(t,s){for(x[t]=s,t=0;t<s.length;t++)f.add(s[t])}var S=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),N=Object.prototype.hasOwnProperty,b=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,E={},A={};function O(t){return N.call(A,t)?!0:N.call(E,t)?!1:b.test(t)?A[t]=!0:(E[t]=!0,!1)}function D(t,s,d,p){if(d!==null&&d.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return p?!1:d!==null?!d.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function z(t,s,d,p){if(s===null||typeof s>"u"||D(t,s,d,p))return!0;if(p)return!1;if(d!==null)switch(d.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function F(t,s,d,p,_,C,j){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=d,this.propertyName=t,this.type=s,this.sanitizeURL=C,this.removeEmptyString=j}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){U[t]=new F(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];U[s]=new F(s,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){U[t]=new F(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){U[t]=new F(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){U[t]=new F(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){U[t]=new F(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){U[t]=new F(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){U[t]=new F(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){U[t]=new F(t,5,!1,t.toLowerCase(),null,!1,!1)});var ie=/[\-:]([a-z])/g;function re(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(ie,re);U[s]=new F(s,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(ie,re);U[s]=new F(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(ie,re);U[s]=new F(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){U[t]=new F(t,1,!1,t.toLowerCase(),null,!1,!1)}),U.xlinkHref=new F("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){U[t]=new F(t,1,!1,t.toLowerCase(),null,!0,!0)});function L(t,s,d,p){var _=U.hasOwnProperty(s)?U[s]:null;(_!==null?_.type!==0:p||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(z(s,d,_,p)&&(d=null),p||_===null?O(s)&&(d===null?t.removeAttribute(s):t.setAttribute(s,""+d)):_.mustUseProperty?t[_.propertyName]=d===null?_.type===3?!1:"":d:(s=_.attributeName,p=_.attributeNamespace,d===null?t.removeAttribute(s):(_=_.type,d=_===3||_===4&&d===!0?"":""+d,p?t.setAttributeNS(p,s,d):t.setAttribute(s,d))))}var Y=h.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ne=Symbol.for("react.element"),ce=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),Ne=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),Ke=Symbol.for("react.provider"),ge=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),Ve=Symbol.for("react.suspense"),Fe=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),Ge=Symbol.for("react.lazy"),Ce=Symbol.for("react.offscreen"),he=Symbol.iterator;function je(t){return t===null||typeof t!="object"?null:(t=he&&t[he]||t["@@iterator"],typeof t=="function"?t:null)}var ye=Object.assign,B;function te(t){if(B===void 0)try{throw Error()}catch(d){var s=d.stack.trim().match(/\n( *(at )?)/);B=s&&s[1]||""}return`
`+B+t}var fe=!1;function Be(t,s){if(!t||fe)return"";fe=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(le){var p=le}Reflect.construct(t,[],s)}else{try{s.call()}catch(le){p=le}t.call(s.prototype)}else{try{throw Error()}catch(le){p=le}t()}}catch(le){if(le&&p&&typeof le.stack=="string"){for(var _=le.stack.split(`
`),C=p.stack.split(`
`),j=_.length-1,W=C.length-1;1<=j&&0<=W&&_[j]!==C[W];)W--;for(;1<=j&&0<=W;j--,W--)if(_[j]!==C[W]){if(j!==1||W!==1)do if(j--,W--,0>W||_[j]!==C[W]){var G=`
`+_[j].replace(" at new "," at ");return t.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",t.displayName)),G}while(1<=j&&0<=W);break}}}finally{fe=!1,Error.prepareStackTrace=d}return(t=t?t.displayName||t.name:"")?te(t):""}function nt(t){switch(t.tag){case 5:return te(t.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return t=Be(t.type,!1),t;case 11:return t=Be(t.type.render,!1),t;case 1:return t=Be(t.type,!0),t;default:return""}}function Ae(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case q:return"Fragment";case ce:return"Portal";case Z:return"Profiler";case Ne:return"StrictMode";case Ve:return"Suspense";case Fe:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ge:return(t.displayName||"Context")+".Consumer";case Ke:return(t._context.displayName||"Context")+".Provider";case xe:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case X:return s=t.displayName||null,s!==null?s:Ae(t.type)||"Memo";case Ge:s=t._payload,t=t._init;try{return Ae(t(s))}catch{}}return null}function mt(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ae(s);case 8:return s===Ne?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Ye(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ue(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ct(t){var s=Ue(t)?"checked":"value",d=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),p=""+t[s];if(!t.hasOwnProperty(s)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,C=d.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return _.call(this)},set:function(j){p=""+j,C.call(this,j)}}),Object.defineProperty(t,s,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(j){p=""+j},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function de(t){t._valueTracker||(t._valueTracker=ct(t))}function Oe(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var d=s.getValue(),p="";return t&&(p=Ue(t)?t.checked?"true":"false":t.value),t=p,t!==d?(s.setValue(t),!0):!1}function Xe(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Nt(t,s){var d=s.checked;return ye({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??t._wrapperState.initialChecked})}function nr(t,s){var d=s.defaultValue==null?"":s.defaultValue,p=s.checked!=null?s.checked:s.defaultChecked;d=Ye(s.value!=null?s.value:d),t._wrapperState={initialChecked:p,initialValue:d,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ke(t,s){s=s.checked,s!=null&&L(t,"checked",s,!1)}function ze(t,s){ke(t,s);var d=Ye(s.value),p=s.type;if(d!=null)p==="number"?(d===0&&t.value===""||t.value!=d)&&(t.value=""+d):t.value!==""+d&&(t.value=""+d);else if(p==="submit"||p==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?$e(t,s.type,d):s.hasOwnProperty("defaultValue")&&$e(t,s.type,Ye(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function We(t,s,d){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var p=s.type;if(!(p!=="submit"&&p!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,d||s===t.value||(t.value=s),t.defaultValue=s}d=t.name,d!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,d!==""&&(t.name=d)}function $e(t,s,d){(s!=="number"||Xe(t.ownerDocument)!==t)&&(d==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+d&&(t.defaultValue=""+d))}var bt=Array.isArray;function Ee(t,s,d,p){if(t=t.options,s){s={};for(var _=0;_<d.length;_++)s["$"+d[_]]=!0;for(d=0;d<t.length;d++)_=s.hasOwnProperty("$"+t[d].value),t[d].selected!==_&&(t[d].selected=_),_&&p&&(t[d].defaultSelected=!0)}else{for(d=""+Ye(d),s=null,_=0;_<t.length;_++){if(t[_].value===d){t[_].selected=!0,p&&(t[_].defaultSelected=!0);return}s!==null||t[_].disabled||(s=t[_])}s!==null&&(s.selected=!0)}}function _t(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(o(91));return ye({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sr(t,s){var d=s.value;if(d==null){if(d=s.children,s=s.defaultValue,d!=null){if(s!=null)throw Error(o(92));if(bt(d)){if(1<d.length)throw Error(o(93));d=d[0]}s=d}s==null&&(s=""),d=s}t._wrapperState={initialValue:Ye(d)}}function Dt(t,s){var d=Ye(s.value),p=Ye(s.defaultValue);d!=null&&(d=""+d,d!==t.value&&(t.value=d),s.defaultValue==null&&t.defaultValue!==d&&(t.defaultValue=d)),p!=null&&(t.defaultValue=""+p)}function Er(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function me(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mt(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?me(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var or,Cr=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,d,p,_){MSApp.execUnsafeLocalFunction(function(){return t(s,d,p,_)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(or=or||document.createElement("div"),or.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=or.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function ls(t,s){if(s){var d=t.firstChild;if(d&&d===t.lastChild&&d.nodeType===3){d.nodeValue=s;return}}t.textContent=s}var Bn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wa=["Webkit","ms","Moz","O"];Object.keys(Bn).forEach(function(t){Wa.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),Bn[s]=Bn[t]})});function hr(t,s,d){return s==null||typeof s=="boolean"||s===""?"":d||typeof s!="number"||s===0||Bn.hasOwnProperty(t)&&Bn[t]?(""+s).trim():s+"px"}function Pe(t,s){t=t.style;for(var d in s)if(s.hasOwnProperty(d)){var p=d.indexOf("--")===0,_=hr(d,s[d],p);d==="float"&&(d="cssFloat"),p?t.setProperty(d,_):t[d]=_}}var mr=ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ut(t,s){if(s){if(mr[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(o(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(o(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(o(61))}if(s.style!=null&&typeof s.style!="object")throw Error(o(62))}}function Zt(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qn=null;function ys(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kn=null,Et=null,on=null;function ue(t){if(t=lo(t)){if(typeof Kn!="function")throw Error(o(280));var s=t.stateNode;s&&(s=cl(s),Kn(t.stateNode,t.type,s))}}function Se(t){Et?on?on.push(t):on=[t]:Et=t}function Le(){if(Et){var t=Et,s=on;if(on=Et=null,ue(t),s)for(t=0;t<s.length;t++)ue(s[t])}}function Me(t,s){return t(s)}function kt(){}var pt=!1;function St(t,s,d){if(pt)return t(s,d);pt=!0;try{return Me(t,s,d)}finally{pt=!1,(Et!==null||on!==null)&&(kt(),Le())}}function Ct(t,s){var d=t.stateNode;if(d===null)return null;var p=cl(d);if(p===null)return null;d=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(t=t.type,p=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!p;break e;default:t=!1}if(t)return null;if(d&&typeof d!="function")throw Error(o(231,s,typeof d));return d}var Qt=!1;if(S)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){Qt=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch{Qt=!1}function gt(t,s,d,p,_,C,j,W,G){var le=Array.prototype.slice.call(arguments,3);try{s.apply(d,le)}catch(_e){this.onError(_e)}}var ut=!1,Pt=null,Wt=!1,we=null,pr={onError:function(t){ut=!0,Pt=t}};function en(t,s,d,p,_,C,j,W,G){ut=!1,Pt=null,gt.apply(pr,arguments)}function zt(t,s,d,p,_,C,j,W,G){if(en.apply(this,arguments),ut){if(ut){var le=Pt;ut=!1,Pt=null}else throw Error(o(198));Wt||(Wt=!0,we=le)}}function Gt(t){var s=t,d=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,(s.flags&4098)!==0&&(d=s.return),t=s.return;while(t)}return s.tag===3?d:null}function $r(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function Xr(t){if(Gt(t)!==t)throw Error(o(188))}function Jt(t){var s=t.alternate;if(!s){if(s=Gt(t),s===null)throw Error(o(188));return s!==t?null:t}for(var d=t,p=s;;){var _=d.return;if(_===null)break;var C=_.alternate;if(C===null){if(p=_.return,p!==null){d=p;continue}break}if(_.child===C.child){for(C=_.child;C;){if(C===d)return Xr(_),t;if(C===p)return Xr(_),s;C=C.sibling}throw Error(o(188))}if(d.return!==p.return)d=_,p=C;else{for(var j=!1,W=_.child;W;){if(W===d){j=!0,d=_,p=C;break}if(W===p){j=!0,p=_,d=C;break}W=W.sibling}if(!j){for(W=C.child;W;){if(W===d){j=!0,d=C,p=_;break}if(W===p){j=!0,p=C,d=_;break}W=W.sibling}if(!j)throw Error(o(189))}}if(d.alternate!==p)throw Error(o(190))}if(d.tag!==3)throw Error(o(188));return d.stateNode.current===d?t:s}function Sr(t){return t=Jt(t),t!==null?gi(t):null}function gi(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=gi(t);if(s!==null)return s;t=t.sibling}return null}var Lr=i.unstable_scheduleCallback,tr=i.unstable_cancelCallback,$t=i.unstable_shouldYield,Ho=i.unstable_requestPaint,Kt=i.unstable_now,za=i.unstable_getCurrentPriorityLevel,pe=i.unstable_ImmediatePriority,Go=i.unstable_UserBlockingPriority,ir=i.unstable_NormalPriority,Ls=i.unstable_LowPriority,$o=i.unstable_IdlePriority,Bt=null,yt=null;function Tt(t){if(yt&&typeof yt.onCommitFiberRoot=="function")try{yt.onCommitFiberRoot(Bt,t,void 0,(t.current.flags&128)===128)}catch{}}var gn=Math.clz32?Math.clz32:Rr,Va=Math.log,Ha=Math.LN2;function Rr(t){return t>>>=0,t===0?32:31-(Va(t)/Ha|0)|0}var An=64,qi=4194304;function ar(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kn(t,s){var d=t.pendingLanes;if(d===0)return 0;var p=0,_=t.suspendedLanes,C=t.pingedLanes,j=d&268435455;if(j!==0){var W=j&~_;W!==0?p=ar(W):(C&=j,C!==0&&(p=ar(C)))}else j=d&~_,j!==0?p=ar(j):C!==0&&(p=ar(C));if(p===0)return 0;if(s!==0&&s!==p&&(s&_)===0&&(_=p&-p,C=s&-s,_>=C||_===16&&(C&4194240)!==0))return s;if((p&4)!==0&&(p|=d&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=p;0<s;)d=31-gn(s),_=1<<d,p|=t[d],s&=~_;return p}function wc(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bs(t,s){for(var d=t.suspendedLanes,p=t.pingedLanes,_=t.expirationTimes,C=t.pendingLanes;0<C;){var j=31-gn(C),W=1<<j,G=_[j];G===-1?((W&d)===0||(W&p)!==0)&&(_[j]=wc(W,s)):G<=s&&(t.expiredLanes|=W),C&=~W}}function Yt(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Br(){var t=An;return An<<=1,(An&4194240)===0&&(An=64),t}function J(t){for(var s=[],d=0;31>d;d++)s.push(t);return s}function M(t,s,d){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-gn(s),t[s]=d}function rt(t,s){var d=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var p=t.eventTimes;for(t=t.expirationTimes;0<d;){var _=31-gn(d),C=1<<_;s[_]=0,p[_]=-1,t[_]=-1,d&=~C}}function Ar(t,s){var d=t.entangledLanes|=s;for(t=t.entanglements;d;){var p=31-gn(d),_=1<<p;_&s|t[p]&s&&(t[p]|=s),d&=~_}}var wt=0;function Xo(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Ki,ln,st,lr,Ga,$a=!1,Fs=[],In=null,Fn=null,cs=null,yr=new Map,Yn=new Map,tn=[],lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qo(t,s){switch(t){case"focusin":case"focusout":In=null;break;case"dragenter":case"dragleave":Fn=null;break;case"mouseover":case"mouseout":cs=null;break;case"pointerover":case"pointerout":yr.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yn.delete(s.pointerId)}}function ht(t,s,d,p,_,C){return t===null||t.nativeEvent!==C?(t={blockedOn:s,domEventName:d,eventSystemFlags:p,nativeEvent:C,targetContainers:[_]},s!==null&&(s=lo(s),s!==null&&ln(s)),t):(t.eventSystemFlags|=p,s=t.targetContainers,_!==null&&s.indexOf(_)===-1&&s.push(_),t)}function Fr(t,s,d,p,_){switch(s){case"focusin":return In=ht(In,t,s,d,p,_),!0;case"dragenter":return Fn=ht(Fn,t,s,d,p,_),!0;case"mouseover":return cs=ht(cs,t,s,d,p,_),!0;case"pointerover":var C=_.pointerId;return yr.set(C,ht(yr.get(C)||null,t,s,d,p,_)),!0;case"gotpointercapture":return C=_.pointerId,Yn.set(C,ht(Yn.get(C)||null,t,s,d,p,_)),!0}return!1}function Ko(t){var s=Ei(t.target);if(s!==null){var d=Gt(s);if(d!==null){if(s=d.tag,s===13){if(s=$r(d),s!==null){t.blockedOn=s,Ga(t.priority,function(){st(d)});return}}else if(s===3&&d.stateNode.current.memoizedState.isDehydrated){t.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Us(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var d=Yi(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(d===null){d=t.nativeEvent;var p=new d.constructor(d.type,d);qn=p,d.target.dispatchEvent(p),qn=null}else return s=lo(d),s!==null&&ln(s),t.blockedOn=d,!1;s.shift()}return!0}function Xa(t,s,d){Us(t)&&d.delete(s)}function ws(){$a=!1,In!==null&&Us(In)&&(In=null),Fn!==null&&Us(Fn)&&(Fn=null),cs!==null&&Us(cs)&&(cs=null),yr.forEach(Xa),Yn.forEach(Xa)}function xi(t,s){t.blockedOn===s&&(t.blockedOn=null,$a||($a=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,ws)))}function Zn(t){function s(_){return xi(_,t)}if(0<Fs.length){xi(Fs[0],t);for(var d=1;d<Fs.length;d++){var p=Fs[d];p.blockedOn===t&&(p.blockedOn=null)}}for(In!==null&&xi(In,t),Fn!==null&&xi(Fn,t),cs!==null&&xi(cs,t),yr.forEach(s),Yn.forEach(s),d=0;d<tn.length;d++)p=tn[d],p.blockedOn===t&&(p.blockedOn=null);for(;0<tn.length&&(d=tn[0],d.blockedOn===null);)Ko(d),d.blockedOn===null&&tn.shift()}var Un=Y.ReactCurrentBatchConfig,us=!0;function Yo(t,s,d,p){var _=wt,C=Un.transition;Un.transition=null;try{wt=1,vs(t,s,d,p)}finally{wt=_,Un.transition=C}}function mi(t,s,d,p){var _=wt,C=Un.transition;Un.transition=null;try{wt=4,vs(t,s,d,p)}finally{wt=_,Un.transition=C}}function vs(t,s,d,p){if(us){var _=Yi(t,s,d,p);if(_===null)Ic(t,s,p,Ur,d),qo(t,p);else if(Fr(_,t,s,d,p))p.stopPropagation();else if(qo(t,p),s&4&&-1<lt.indexOf(t)){for(;_!==null;){var C=lo(_);if(C!==null&&Ki(C),C=Yi(t,s,d,p),C===null&&Ic(t,s,p,Ur,d),C===_)break;_=C}_!==null&&p.stopPropagation()}else Ic(t,s,p,null,d)}}var Ur=null;function Yi(t,s,d,p){if(Ur=null,t=ys(p),t=Ei(t),t!==null)if(s=Gt(t),s===null)t=null;else if(d=s.tag,d===13){if(t=$r(s),t!==null)return t;t=null}else if(d===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return Ur=t,null}function qa(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(za()){case pe:return 1;case Go:return 4;case ir:case Ls:return 16;case $o:return 536870912;default:return 16}default:return 16}}var Qn=null,Ka=null,Zi=null;function Zo(){if(Zi)return Zi;var t,s=Ka,d=s.length,p,_="value"in Qn?Qn.value:Qn.textContent,C=_.length;for(t=0;t<d&&s[t]===_[t];t++);var j=d-t;for(p=1;p<=j&&s[d-p]===_[C-p];p++);return Zi=_.slice(t,1<p?1-p:void 0)}function Vt(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function pi(){return!0}function yi(){return!1}function kr(t){function s(d,p,_,C,j){this._reactName=d,this._targetInst=_,this.type=p,this.nativeEvent=C,this.target=j,this.currentTarget=null;for(var W in t)t.hasOwnProperty(W)&&(d=t[W],this[W]=d?d(C):C[W]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?pi:yi,this.isPropagationStopped=yi,this}return ye(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=pi)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=pi)},persist:function(){},isPersistent:pi}),s}var Ws={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oe=kr(Ws),xt=ye({},Ws,{view:0,detail:0}),Wr=kr(xt),zs,Qi,wi,Ji=ye({},xt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vi,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wi&&(wi&&t.type==="mousemove"?(zs=t.screenX-wi.screenX,Qi=t.screenY-wi.screenY):Qi=zs=0,wi=t),zs)},movementY:function(t){return"movementY"in t?t.movementY:Qi}}),Qo=kr(Ji),Ya=ye({},Ji,{dataTransfer:0}),Or=kr(Ya),Za=ye({},xt,{relatedTarget:0}),cr=kr(Za),ea=ye({},Ws,{animationName:0,elapsedTime:0,pseudoElement:0}),bs=kr(ea),er=ye({},Ws,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),it=kr(er),vc=ye({},Ws,{data:0}),rr=kr(vc),_s={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wn(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=bc[t])?!!s[t]:!1}function vi(){return Wn}var Jo=ye({},xt,{key:function(t){if(t.key){var s=_s[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=Vt(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Vs[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vi,charCode:function(t){return t.type==="keypress"?Vt(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vt(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Qa=kr(Jo),el=ye({},Ji,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ja=kr(el),_c=ye({},xt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vi}),Hs=kr(_c),eo=ye({},Ws,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nc=kr(eo),bi=ye({},Ji,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ec=kr(bi),ds=[9,13,27,32],Gs=S&&"CompositionEvent"in window,qr=null;S&&"documentMode"in document&&(qr=document.documentMode);var tl=S&&"TextEvent"in window&&!qr,Tn=S&&(!Gs||qr&&8<qr&&11>=qr),rl=" ",ta=!1;function nl(t,s){switch(t){case"keyup":return ds.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function to(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var rn=!1;function Cc(t,s){switch(t){case"compositionend":return to(s);case"keypress":return s.which!==32?null:(ta=!0,rl);case"textInput":return t=s.data,t===rl&&ta?null:t;default:return null}}function ro(t,s){if(rn)return t==="compositionend"||!Gs&&nl(t,s)?(t=Zo(),Zi=Ka=Qn=null,rn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Tn&&s.locale!=="ko"?null:s.data;default:return null}}var _i={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lt(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!_i[t.type]:s==="textarea"}function Ni(t,s,d,p){Se(p),s=al(s,"onChange"),0<s.length&&(d=new oe("onChange","change",null,d,p),t.push({event:d,listeners:s}))}var I=null,e=null;function r(t){Bd(t,0)}function n(t){var s=sa(t);if(Oe(s))return t}function a(t,s){if(t==="change")return s}var c=!1;if(S){var u;if(S){var g="oninput"in document;if(!g){var y=document.createElement("div");y.setAttribute("oninput","return;"),g=typeof y.oninput=="function"}u=g}else u=!1;c=u&&(!document.documentMode||9<document.documentMode)}function v(){I&&(I.detachEvent("onpropertychange",k),e=I=null)}function k(t){if(t.propertyName==="value"&&n(e)){var s=[];Ni(s,e,t,ys(t)),St(r,s)}}function T(t,s,d){t==="focusin"?(v(),I=s,e=d,I.attachEvent("onpropertychange",k)):t==="focusout"&&v()}function R(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return n(e)}function P(t,s){if(t==="click")return n(s)}function H(t,s){if(t==="input"||t==="change")return n(s)}function $(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Q=typeof Object.is=="function"?Object.is:$;function ae(t,s){if(Q(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var d=Object.keys(t),p=Object.keys(s);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var _=d[p];if(!N.call(s,_)||!Q(t[_],s[_]))return!1}return!0}function Te(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Re(t,s){var d=Te(t);t=0;for(var p;d;){if(d.nodeType===3){if(p=t+d.textContent.length,t<=s&&p>=s)return{node:d,offset:s-t};t=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Te(d)}}function be(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?be(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function At(){for(var t=window,s=Xe();s instanceof t.HTMLIFrameElement;){try{var d=typeof s.contentWindow.location.href=="string"}catch{d=!1}if(d)t=s.contentWindow;else break;s=Xe(t.document)}return s}function ft(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function cn(t){var s=At(),d=t.focusedElem,p=t.selectionRange;if(s!==d&&d&&d.ownerDocument&&be(d.ownerDocument.documentElement,d)){if(p!==null&&ft(d)){if(s=p.start,t=p.end,t===void 0&&(t=s),"selectionStart"in d)d.selectionStart=s,d.selectionEnd=Math.min(t,d.value.length);else if(t=(s=d.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var _=d.textContent.length,C=Math.min(p.start,_);p=p.end===void 0?C:Math.min(p.end,_),!t.extend&&C>p&&(_=p,p=C,C=_),_=Re(d,C);var j=Re(d,p);_&&j&&(t.rangeCount!==1||t.anchorNode!==_.node||t.anchorOffset!==_.offset||t.focusNode!==j.node||t.focusOffset!==j.offset)&&(s=s.createRange(),s.setStart(_.node,_.offset),t.removeAllRanges(),C>p?(t.addRange(s),t.extend(j.node,j.offset)):(s.setEnd(j.node,j.offset),t.addRange(s)))}}for(s=[],t=d;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<s.length;d++)t=s[d],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var jn=S&&"documentMode"in document&&11>=document.documentMode,Dr=null,qt=null,br=null,nn=!1;function Ns(t,s,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;nn||Dr==null||Dr!==Xe(p)||(p=Dr,"selectionStart"in p&&ft(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),br&&ae(br,p)||(br=p,p=al(qt,"onSelect"),0<p.length&&(s=new oe("onSelect","select",null,s,d),t.push({event:s,listeners:p}),s.target=Dr)))}function Jn(t,s){var d={};return d[t.toLowerCase()]=s.toLowerCase(),d["Webkit"+t]="webkit"+s,d["Moz"+t]="moz"+s,d}var $s={animationend:Jn("Animation","AnimationEnd"),animationiteration:Jn("Animation","AnimationIteration"),animationstart:Jn("Animation","AnimationStart"),transitionend:Jn("Transition","TransitionEnd")},no={},Td={};S&&(Td=document.createElement("div").style,"AnimationEvent"in window||(delete $s.animationend.animation,delete $s.animationiteration.animation,delete $s.animationstart.animation),"TransitionEvent"in window||delete $s.transitionend.transition);function sl(t){if(no[t])return no[t];if(!$s[t])return t;var s=$s[t],d;for(d in s)if(s.hasOwnProperty(d)&&d in Td)return no[t]=s[d];return t}var jd=sl("animationend"),Rd=sl("animationiteration"),Od=sl("animationstart"),Dd=sl("transitionend"),Md=new Map,Pd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xs(t,s){Md.set(t,s),m(s,[t])}for(var Sc=0;Sc<Pd.length;Sc++){var Ac=Pd[Sc],tg=Ac.toLowerCase(),rg=Ac[0].toUpperCase()+Ac.slice(1);Xs(tg,"on"+rg)}Xs(jd,"onAnimationEnd"),Xs(Rd,"onAnimationIteration"),Xs(Od,"onAnimationStart"),Xs("dblclick","onDoubleClick"),Xs("focusin","onFocus"),Xs("focusout","onBlur"),Xs(Dd,"onTransitionEnd"),w("onMouseEnter",["mouseout","mouseover"]),w("onMouseLeave",["mouseout","mouseover"]),w("onPointerEnter",["pointerout","pointerover"]),w("onPointerLeave",["pointerout","pointerover"]),m("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),m("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),m("onBeforeInput",["compositionend","keypress","textInput","paste"]),m("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var so="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ng=new Set("cancel close invalid load scroll toggle".split(" ").concat(so));function Ld(t,s,d){var p=t.type||"unknown-event";t.currentTarget=d,zt(p,s,void 0,t),t.currentTarget=null}function Bd(t,s){s=(s&4)!==0;for(var d=0;d<t.length;d++){var p=t[d],_=p.event;p=p.listeners;e:{var C=void 0;if(s)for(var j=p.length-1;0<=j;j--){var W=p[j],G=W.instance,le=W.currentTarget;if(W=W.listener,G!==C&&_.isPropagationStopped())break e;Ld(_,W,le),C=G}else for(j=0;j<p.length;j++){if(W=p[j],G=W.instance,le=W.currentTarget,W=W.listener,G!==C&&_.isPropagationStopped())break e;Ld(_,W,le),C=G}}}if(Wt)throw t=we,Wt=!1,we=null,t}function fr(t,s){var d=s[Mc];d===void 0&&(d=s[Mc]=new Set);var p=t+"__bubble";d.has(p)||(Fd(s,t,2,!1),d.add(p))}function kc(t,s,d){var p=0;s&&(p|=4),Fd(d,t,p,s)}var il="_reactListening"+Math.random().toString(36).slice(2);function io(t){if(!t[il]){t[il]=!0,f.forEach(function(d){d!=="selectionchange"&&(ng.has(d)||kc(d,!1,t),kc(d,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[il]||(s[il]=!0,kc("selectionchange",!1,s))}}function Fd(t,s,d,p){switch(qa(s)){case 1:var _=Yo;break;case 4:_=mi;break;default:_=vs}d=_.bind(null,s,d,t),_=void 0,!Qt||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(_=!0),p?_!==void 0?t.addEventListener(s,d,{capture:!0,passive:_}):t.addEventListener(s,d,!0):_!==void 0?t.addEventListener(s,d,{passive:_}):t.addEventListener(s,d,!1)}function Ic(t,s,d,p,_){var C=p;if((s&1)===0&&(s&2)===0&&p!==null)e:for(;;){if(p===null)return;var j=p.tag;if(j===3||j===4){var W=p.stateNode.containerInfo;if(W===_||W.nodeType===8&&W.parentNode===_)break;if(j===4)for(j=p.return;j!==null;){var G=j.tag;if((G===3||G===4)&&(G=j.stateNode.containerInfo,G===_||G.nodeType===8&&G.parentNode===_))return;j=j.return}for(;W!==null;){if(j=Ei(W),j===null)return;if(G=j.tag,G===5||G===6){p=C=j;continue e}W=W.parentNode}}p=p.return}St(function(){var le=C,_e=ys(d),Ie=[];e:{var ve=Md.get(t);if(ve!==void 0){var qe=oe,Je=t;switch(t){case"keypress":if(Vt(d)===0)break e;case"keydown":case"keyup":qe=Qa;break;case"focusin":Je="focus",qe=cr;break;case"focusout":Je="blur",qe=cr;break;case"beforeblur":case"afterblur":qe=cr;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=Qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=Or;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=Hs;break;case jd:case Rd:case Od:qe=bs;break;case Dd:qe=Nc;break;case"scroll":qe=Wr;break;case"wheel":qe=Ec;break;case"copy":case"cut":case"paste":qe=it;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=Ja}var et=(s&4)!==0,Mr=!et&&t==="scroll",ee=et?ve!==null?ve+"Capture":null:ve;et=[];for(var K=le,se;K!==null;){se=K;var De=se.stateNode;if(se.tag===5&&De!==null&&(se=De,ee!==null&&(De=Ct(K,ee),De!=null&&et.push(ao(K,De,se)))),Mr)break;K=K.return}0<et.length&&(ve=new qe(ve,Je,null,d,_e),Ie.push({event:ve,listeners:et}))}}if((s&7)===0){e:{if(ve=t==="mouseover"||t==="pointerover",qe=t==="mouseout"||t==="pointerout",ve&&d!==qn&&(Je=d.relatedTarget||d.fromElement)&&(Ei(Je)||Je[Es]))break e;if((qe||ve)&&(ve=_e.window===_e?_e:(ve=_e.ownerDocument)?ve.defaultView||ve.parentWindow:window,qe?(Je=d.relatedTarget||d.toElement,qe=le,Je=Je?Ei(Je):null,Je!==null&&(Mr=Gt(Je),Je!==Mr||Je.tag!==5&&Je.tag!==6)&&(Je=null)):(qe=null,Je=le),qe!==Je)){if(et=Qo,De="onMouseLeave",ee="onMouseEnter",K="mouse",(t==="pointerout"||t==="pointerover")&&(et=Ja,De="onPointerLeave",ee="onPointerEnter",K="pointer"),Mr=qe==null?ve:sa(qe),se=Je==null?ve:sa(Je),ve=new et(De,K+"leave",qe,d,_e),ve.target=Mr,ve.relatedTarget=se,De=null,Ei(_e)===le&&(et=new et(ee,K+"enter",Je,d,_e),et.target=se,et.relatedTarget=Mr,De=et),Mr=De,qe&&Je)t:{for(et=qe,ee=Je,K=0,se=et;se;se=ra(se))K++;for(se=0,De=ee;De;De=ra(De))se++;for(;0<K-se;)et=ra(et),K--;for(;0<se-K;)ee=ra(ee),se--;for(;K--;){if(et===ee||ee!==null&&et===ee.alternate)break t;et=ra(et),ee=ra(ee)}et=null}else et=null;qe!==null&&Ud(Ie,ve,qe,et,!1),Je!==null&&Mr!==null&&Ud(Ie,Mr,Je,et,!0)}}e:{if(ve=le?sa(le):window,qe=ve.nodeName&&ve.nodeName.toLowerCase(),qe==="select"||qe==="input"&&ve.type==="file")var tt=a;else if(Lt(ve))if(c)tt=H;else{tt=R;var at=T}else(qe=ve.nodeName)&&qe.toLowerCase()==="input"&&(ve.type==="checkbox"||ve.type==="radio")&&(tt=P);if(tt&&(tt=tt(t,le))){Ni(Ie,tt,d,_e);break e}at&&at(t,ve,le),t==="focusout"&&(at=ve._wrapperState)&&at.controlled&&ve.type==="number"&&$e(ve,"number",ve.value)}switch(at=le?sa(le):window,t){case"focusin":(Lt(at)||at.contentEditable==="true")&&(Dr=at,qt=le,br=null);break;case"focusout":br=qt=Dr=null;break;case"mousedown":nn=!0;break;case"contextmenu":case"mouseup":case"dragend":nn=!1,Ns(Ie,d,_e);break;case"selectionchange":if(jn)break;case"keydown":case"keyup":Ns(Ie,d,_e)}var ot;if(Gs)e:{switch(t){case"compositionstart":var dt="onCompositionStart";break e;case"compositionend":dt="onCompositionEnd";break e;case"compositionupdate":dt="onCompositionUpdate";break e}dt=void 0}else rn?nl(t,d)&&(dt="onCompositionEnd"):t==="keydown"&&d.keyCode===229&&(dt="onCompositionStart");dt&&(Tn&&d.locale!=="ko"&&(rn||dt!=="onCompositionStart"?dt==="onCompositionEnd"&&rn&&(ot=Zo()):(Qn=_e,Ka="value"in Qn?Qn.value:Qn.textContent,rn=!0)),at=al(le,dt),0<at.length&&(dt=new rr(dt,t,null,d,_e),Ie.push({event:dt,listeners:at}),ot?dt.data=ot:(ot=to(d),ot!==null&&(dt.data=ot)))),(ot=tl?Cc(t,d):ro(t,d))&&(le=al(le,"onBeforeInput"),0<le.length&&(_e=new rr("onBeforeInput","beforeinput",null,d,_e),Ie.push({event:_e,listeners:le}),_e.data=ot))}Bd(Ie,s)})}function ao(t,s,d){return{instance:t,listener:s,currentTarget:d}}function al(t,s){for(var d=s+"Capture",p=[];t!==null;){var _=t,C=_.stateNode;_.tag===5&&C!==null&&(_=C,C=Ct(t,d),C!=null&&p.unshift(ao(t,C,_)),C=Ct(t,s),C!=null&&p.push(ao(t,C,_))),t=t.return}return p}function ra(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ud(t,s,d,p,_){for(var C=s._reactName,j=[];d!==null&&d!==p;){var W=d,G=W.alternate,le=W.stateNode;if(G!==null&&G===p)break;W.tag===5&&le!==null&&(W=le,_?(G=Ct(d,C),G!=null&&j.unshift(ao(d,G,W))):_||(G=Ct(d,C),G!=null&&j.push(ao(d,G,W)))),d=d.return}j.length!==0&&t.push({event:s,listeners:j})}var sg=/\r\n?/g,ig=/\u0000|\uFFFD/g;function Wd(t){return(typeof t=="string"?t:""+t).replace(sg,`
`).replace(ig,"")}function ol(t,s,d){if(s=Wd(s),Wd(t)!==s&&d)throw Error(o(425))}function ll(){}var Tc=null,jc=null;function Rc(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Oc=typeof setTimeout=="function"?setTimeout:void 0,ag=typeof clearTimeout=="function"?clearTimeout:void 0,zd=typeof Promise=="function"?Promise:void 0,og=typeof queueMicrotask=="function"?queueMicrotask:typeof zd<"u"?function(t){return zd.resolve(null).then(t).catch(lg)}:Oc;function lg(t){setTimeout(function(){throw t})}function Dc(t,s){var d=s,p=0;do{var _=d.nextSibling;if(t.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"){if(p===0){t.removeChild(_),Zn(s);return}p--}else d!=="$"&&d!=="$?"&&d!=="$!"||p++;d=_}while(d);Zn(s)}function qs(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function Vd(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var d=t.data;if(d==="$"||d==="$!"||d==="$?"){if(s===0)return t;s--}else d==="/$"&&s++}t=t.previousSibling}return null}var na=Math.random().toString(36).slice(2),hs="__reactFiber$"+na,oo="__reactProps$"+na,Es="__reactContainer$"+na,Mc="__reactEvents$"+na,cg="__reactListeners$"+na,ug="__reactHandles$"+na;function Ei(t){var s=t[hs];if(s)return s;for(var d=t.parentNode;d;){if(s=d[Es]||d[hs]){if(d=s.alternate,s.child!==null||d!==null&&d.child!==null)for(t=Vd(t);t!==null;){if(d=t[hs])return d;t=Vd(t)}return s}t=d,d=t.parentNode}return null}function lo(t){return t=t[hs]||t[Es],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function sa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(o(33))}function cl(t){return t[oo]||null}var Pc=[],ia=-1;function Ks(t){return{current:t}}function gr(t){0>ia||(t.current=Pc[ia],Pc[ia]=null,ia--)}function ur(t,s){ia++,Pc[ia]=t.current,t.current=s}var Ys={},un=Ks(Ys),wn=Ks(!1),Ci=Ys;function aa(t,s){var d=t.type.contextTypes;if(!d)return Ys;var p=t.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===s)return p.__reactInternalMemoizedMaskedChildContext;var _={},C;for(C in d)_[C]=s[C];return p&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=_),_}function vn(t){return t=t.childContextTypes,t!=null}function ul(){gr(wn),gr(un)}function Hd(t,s,d){if(un.current!==Ys)throw Error(o(168));ur(un,s),ur(wn,d)}function Gd(t,s,d){var p=t.stateNode;if(s=s.childContextTypes,typeof p.getChildContext!="function")return d;p=p.getChildContext();for(var _ in p)if(!(_ in s))throw Error(o(108,mt(t)||"Unknown",_));return ye({},d,p)}function dl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ys,Ci=un.current,ur(un,t),ur(wn,wn.current),!0}function $d(t,s,d){var p=t.stateNode;if(!p)throw Error(o(169));d?(t=Gd(t,s,Ci),p.__reactInternalMemoizedMergedChildContext=t,gr(wn),gr(un),ur(un,t)):gr(wn),ur(wn,d)}var Cs=null,hl=!1,Lc=!1;function Xd(t){Cs===null?Cs=[t]:Cs.push(t)}function dg(t){hl=!0,Xd(t)}function Zs(){if(!Lc&&Cs!==null){Lc=!0;var t=0,s=wt;try{var d=Cs;for(wt=1;t<d.length;t++){var p=d[t];do p=p(!0);while(p!==null)}Cs=null,hl=!1}catch(_){throw Cs!==null&&(Cs=Cs.slice(t+1)),Lr(pe,Zs),_}finally{wt=s,Lc=!1}}return null}var oa=[],la=0,fl=null,gl=0,zn=[],Vn=0,Si=null,Ss=1,As="";function Ai(t,s){oa[la++]=gl,oa[la++]=fl,fl=t,gl=s}function qd(t,s,d){zn[Vn++]=Ss,zn[Vn++]=As,zn[Vn++]=Si,Si=t;var p=Ss;t=As;var _=32-gn(p)-1;p&=~(1<<_),d+=1;var C=32-gn(s)+_;if(30<C){var j=_-_%5;C=(p&(1<<j)-1).toString(32),p>>=j,_-=j,Ss=1<<32-gn(s)+_|d<<_|p,As=C+t}else Ss=1<<C|d<<_|p,As=t}function Bc(t){t.return!==null&&(Ai(t,1),qd(t,1,0))}function Fc(t){for(;t===fl;)fl=oa[--la],oa[la]=null,gl=oa[--la],oa[la]=null;for(;t===Si;)Si=zn[--Vn],zn[Vn]=null,As=zn[--Vn],zn[Vn]=null,Ss=zn[--Vn],zn[Vn]=null}var Rn=null,On=null,wr=!1,es=null;function Kd(t,s){var d=Xn(5,null,null,0);d.elementType="DELETED",d.stateNode=s,d.return=t,s=t.deletions,s===null?(t.deletions=[d],t.flags|=16):s.push(d)}function Yd(t,s){switch(t.tag){case 5:var d=t.type;return s=s.nodeType!==1||d.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,Rn=t,On=qs(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,Rn=t,On=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(d=Si!==null?{id:Ss,overflow:As}:null,t.memoizedState={dehydrated:s,treeContext:d,retryLane:1073741824},d=Xn(18,null,null,0),d.stateNode=s,d.return=t,t.child=d,Rn=t,On=null,!0):!1;default:return!1}}function Uc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Wc(t){if(wr){var s=On;if(s){var d=s;if(!Yd(t,s)){if(Uc(t))throw Error(o(418));s=qs(d.nextSibling);var p=Rn;s&&Yd(t,s)?Kd(p,d):(t.flags=t.flags&-4097|2,wr=!1,Rn=t)}}else{if(Uc(t))throw Error(o(418));t.flags=t.flags&-4097|2,wr=!1,Rn=t}}}function Zd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Rn=t}function xl(t){if(t!==Rn)return!1;if(!wr)return Zd(t),wr=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!Rc(t.type,t.memoizedProps)),s&&(s=On)){if(Uc(t))throw Qd(),Error(o(418));for(;s;)Kd(t,s),s=qs(s.nextSibling)}if(Zd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var d=t.data;if(d==="/$"){if(s===0){On=qs(t.nextSibling);break e}s--}else d!=="$"&&d!=="$!"&&d!=="$?"||s++}t=t.nextSibling}On=null}}else On=Rn?qs(t.stateNode.nextSibling):null;return!0}function Qd(){for(var t=On;t;)t=qs(t.nextSibling)}function ca(){On=Rn=null,wr=!1}function zc(t){es===null?es=[t]:es.push(t)}var hg=Y.ReactCurrentBatchConfig;function co(t,s,d){if(t=d.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(o(309));var p=d.stateNode}if(!p)throw Error(o(147,t));var _=p,C=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===C?s.ref:(s=function(j){var W=_.refs;j===null?delete W[C]:W[C]=j},s._stringRef=C,s)}if(typeof t!="string")throw Error(o(284));if(!d._owner)throw Error(o(290,t))}return t}function ml(t,s){throw t=Object.prototype.toString.call(s),Error(o(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function Jd(t){var s=t._init;return s(t._payload)}function e0(t){function s(ee,K){if(t){var se=ee.deletions;se===null?(ee.deletions=[K],ee.flags|=16):se.push(K)}}function d(ee,K){if(!t)return null;for(;K!==null;)s(ee,K),K=K.sibling;return null}function p(ee,K){for(ee=new Map;K!==null;)K.key!==null?ee.set(K.key,K):ee.set(K.index,K),K=K.sibling;return ee}function _(ee,K){return ee=ii(ee,K),ee.index=0,ee.sibling=null,ee}function C(ee,K,se){return ee.index=se,t?(se=ee.alternate,se!==null?(se=se.index,se<K?(ee.flags|=2,K):se):(ee.flags|=2,K)):(ee.flags|=1048576,K)}function j(ee){return t&&ee.alternate===null&&(ee.flags|=2),ee}function W(ee,K,se,De){return K===null||K.tag!==6?(K=Ou(se,ee.mode,De),K.return=ee,K):(K=_(K,se),K.return=ee,K)}function G(ee,K,se,De){var tt=se.type;return tt===q?_e(ee,K,se.props.children,De,se.key):K!==null&&(K.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===Ge&&Jd(tt)===K.type)?(De=_(K,se.props),De.ref=co(ee,K,se),De.return=ee,De):(De=Ul(se.type,se.key,se.props,null,ee.mode,De),De.ref=co(ee,K,se),De.return=ee,De)}function le(ee,K,se,De){return K===null||K.tag!==4||K.stateNode.containerInfo!==se.containerInfo||K.stateNode.implementation!==se.implementation?(K=Du(se,ee.mode,De),K.return=ee,K):(K=_(K,se.children||[]),K.return=ee,K)}function _e(ee,K,se,De,tt){return K===null||K.tag!==7?(K=Mi(se,ee.mode,De,tt),K.return=ee,K):(K=_(K,se),K.return=ee,K)}function Ie(ee,K,se){if(typeof K=="string"&&K!==""||typeof K=="number")return K=Ou(""+K,ee.mode,se),K.return=ee,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case ne:return se=Ul(K.type,K.key,K.props,null,ee.mode,se),se.ref=co(ee,null,K),se.return=ee,se;case ce:return K=Du(K,ee.mode,se),K.return=ee,K;case Ge:var De=K._init;return Ie(ee,De(K._payload),se)}if(bt(K)||je(K))return K=Mi(K,ee.mode,se,null),K.return=ee,K;ml(ee,K)}return null}function ve(ee,K,se,De){var tt=K!==null?K.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return tt!==null?null:W(ee,K,""+se,De);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case ne:return se.key===tt?G(ee,K,se,De):null;case ce:return se.key===tt?le(ee,K,se,De):null;case Ge:return tt=se._init,ve(ee,K,tt(se._payload),De)}if(bt(se)||je(se))return tt!==null?null:_e(ee,K,se,De,null);ml(ee,se)}return null}function qe(ee,K,se,De,tt){if(typeof De=="string"&&De!==""||typeof De=="number")return ee=ee.get(se)||null,W(K,ee,""+De,tt);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case ne:return ee=ee.get(De.key===null?se:De.key)||null,G(K,ee,De,tt);case ce:return ee=ee.get(De.key===null?se:De.key)||null,le(K,ee,De,tt);case Ge:var at=De._init;return qe(ee,K,se,at(De._payload),tt)}if(bt(De)||je(De))return ee=ee.get(se)||null,_e(K,ee,De,tt,null);ml(K,De)}return null}function Je(ee,K,se,De){for(var tt=null,at=null,ot=K,dt=K=0,Zr=null;ot!==null&&dt<se.length;dt++){ot.index>dt?(Zr=ot,ot=null):Zr=ot.sibling;var Xt=ve(ee,ot,se[dt],De);if(Xt===null){ot===null&&(ot=Zr);break}t&&ot&&Xt.alternate===null&&s(ee,ot),K=C(Xt,K,dt),at===null?tt=Xt:at.sibling=Xt,at=Xt,ot=Zr}if(dt===se.length)return d(ee,ot),wr&&Ai(ee,dt),tt;if(ot===null){for(;dt<se.length;dt++)ot=Ie(ee,se[dt],De),ot!==null&&(K=C(ot,K,dt),at===null?tt=ot:at.sibling=ot,at=ot);return wr&&Ai(ee,dt),tt}for(ot=p(ee,ot);dt<se.length;dt++)Zr=qe(ot,ee,dt,se[dt],De),Zr!==null&&(t&&Zr.alternate!==null&&ot.delete(Zr.key===null?dt:Zr.key),K=C(Zr,K,dt),at===null?tt=Zr:at.sibling=Zr,at=Zr);return t&&ot.forEach(function(ai){return s(ee,ai)}),wr&&Ai(ee,dt),tt}function et(ee,K,se,De){var tt=je(se);if(typeof tt!="function")throw Error(o(150));if(se=tt.call(se),se==null)throw Error(o(151));for(var at=tt=null,ot=K,dt=K=0,Zr=null,Xt=se.next();ot!==null&&!Xt.done;dt++,Xt=se.next()){ot.index>dt?(Zr=ot,ot=null):Zr=ot.sibling;var ai=ve(ee,ot,Xt.value,De);if(ai===null){ot===null&&(ot=Zr);break}t&&ot&&ai.alternate===null&&s(ee,ot),K=C(ai,K,dt),at===null?tt=ai:at.sibling=ai,at=ai,ot=Zr}if(Xt.done)return d(ee,ot),wr&&Ai(ee,dt),tt;if(ot===null){for(;!Xt.done;dt++,Xt=se.next())Xt=Ie(ee,Xt.value,De),Xt!==null&&(K=C(Xt,K,dt),at===null?tt=Xt:at.sibling=Xt,at=Xt);return wr&&Ai(ee,dt),tt}for(ot=p(ee,ot);!Xt.done;dt++,Xt=se.next())Xt=qe(ot,ee,dt,Xt.value,De),Xt!==null&&(t&&Xt.alternate!==null&&ot.delete(Xt.key===null?dt:Xt.key),K=C(Xt,K,dt),at===null?tt=Xt:at.sibling=Xt,at=Xt);return t&&ot.forEach(function(Gg){return s(ee,Gg)}),wr&&Ai(ee,dt),tt}function Mr(ee,K,se,De){if(typeof se=="object"&&se!==null&&se.type===q&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case ne:e:{for(var tt=se.key,at=K;at!==null;){if(at.key===tt){if(tt=se.type,tt===q){if(at.tag===7){d(ee,at.sibling),K=_(at,se.props.children),K.return=ee,ee=K;break e}}else if(at.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===Ge&&Jd(tt)===at.type){d(ee,at.sibling),K=_(at,se.props),K.ref=co(ee,at,se),K.return=ee,ee=K;break e}d(ee,at);break}else s(ee,at);at=at.sibling}se.type===q?(K=Mi(se.props.children,ee.mode,De,se.key),K.return=ee,ee=K):(De=Ul(se.type,se.key,se.props,null,ee.mode,De),De.ref=co(ee,K,se),De.return=ee,ee=De)}return j(ee);case ce:e:{for(at=se.key;K!==null;){if(K.key===at)if(K.tag===4&&K.stateNode.containerInfo===se.containerInfo&&K.stateNode.implementation===se.implementation){d(ee,K.sibling),K=_(K,se.children||[]),K.return=ee,ee=K;break e}else{d(ee,K);break}else s(ee,K);K=K.sibling}K=Du(se,ee.mode,De),K.return=ee,ee=K}return j(ee);case Ge:return at=se._init,Mr(ee,K,at(se._payload),De)}if(bt(se))return Je(ee,K,se,De);if(je(se))return et(ee,K,se,De);ml(ee,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,K!==null&&K.tag===6?(d(ee,K.sibling),K=_(K,se),K.return=ee,ee=K):(d(ee,K),K=Ou(se,ee.mode,De),K.return=ee,ee=K),j(ee)):d(ee,K)}return Mr}var ua=e0(!0),t0=e0(!1),pl=Ks(null),yl=null,da=null,Vc=null;function Hc(){Vc=da=yl=null}function Gc(t){var s=pl.current;gr(pl),t._currentValue=s}function $c(t,s,d){for(;t!==null;){var p=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),t===d)break;t=t.return}}function ha(t,s){yl=t,Vc=da=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&s)!==0&&(bn=!0),t.firstContext=null)}function Hn(t){var s=t._currentValue;if(Vc!==t)if(t={context:t,memoizedValue:s,next:null},da===null){if(yl===null)throw Error(o(308));da=t,yl.dependencies={lanes:0,firstContext:t}}else da=da.next=t;return s}var ki=null;function Xc(t){ki===null?ki=[t]:ki.push(t)}function r0(t,s,d,p){var _=s.interleaved;return _===null?(d.next=d,Xc(s)):(d.next=_.next,_.next=d),s.interleaved=d,ks(t,p)}function ks(t,s){t.lanes|=s;var d=t.alternate;for(d!==null&&(d.lanes|=s),d=t,t=t.return;t!==null;)t.childLanes|=s,d=t.alternate,d!==null&&(d.childLanes|=s),d=t,t=t.return;return d.tag===3?d.stateNode:null}var Qs=!1;function qc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function n0(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Is(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function Js(t,s,d){var p=t.updateQueue;if(p===null)return null;if(p=p.shared,(Ht&2)!==0){var _=p.pending;return _===null?s.next=s:(s.next=_.next,_.next=s),p.pending=s,ks(t,d)}return _=p.interleaved,_===null?(s.next=s,Xc(p)):(s.next=_.next,_.next=s),p.interleaved=s,ks(t,d)}function wl(t,s,d){if(s=s.updateQueue,s!==null&&(s=s.shared,(d&4194240)!==0)){var p=s.lanes;p&=t.pendingLanes,d|=p,s.lanes=d,Ar(t,d)}}function s0(t,s){var d=t.updateQueue,p=t.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var _=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var j={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};C===null?_=C=j:C=C.next=j,d=d.next}while(d!==null);C===null?_=C=s:C=C.next=s}else _=C=s;d={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:C,shared:p.shared,effects:p.effects},t.updateQueue=d;return}t=d.lastBaseUpdate,t===null?d.firstBaseUpdate=s:t.next=s,d.lastBaseUpdate=s}function vl(t,s,d,p){var _=t.updateQueue;Qs=!1;var C=_.firstBaseUpdate,j=_.lastBaseUpdate,W=_.shared.pending;if(W!==null){_.shared.pending=null;var G=W,le=G.next;G.next=null,j===null?C=le:j.next=le,j=G;var _e=t.alternate;_e!==null&&(_e=_e.updateQueue,W=_e.lastBaseUpdate,W!==j&&(W===null?_e.firstBaseUpdate=le:W.next=le,_e.lastBaseUpdate=G))}if(C!==null){var Ie=_.baseState;j=0,_e=le=G=null,W=C;do{var ve=W.lane,qe=W.eventTime;if((p&ve)===ve){_e!==null&&(_e=_e.next={eventTime:qe,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var Je=t,et=W;switch(ve=s,qe=d,et.tag){case 1:if(Je=et.payload,typeof Je=="function"){Ie=Je.call(qe,Ie,ve);break e}Ie=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=et.payload,ve=typeof Je=="function"?Je.call(qe,Ie,ve):Je,ve==null)break e;Ie=ye({},Ie,ve);break e;case 2:Qs=!0}}W.callback!==null&&W.lane!==0&&(t.flags|=64,ve=_.effects,ve===null?_.effects=[W]:ve.push(W))}else qe={eventTime:qe,lane:ve,tag:W.tag,payload:W.payload,callback:W.callback,next:null},_e===null?(le=_e=qe,G=Ie):_e=_e.next=qe,j|=ve;if(W=W.next,W===null){if(W=_.shared.pending,W===null)break;ve=W,W=ve.next,ve.next=null,_.lastBaseUpdate=ve,_.shared.pending=null}}while(!0);if(_e===null&&(G=Ie),_.baseState=G,_.firstBaseUpdate=le,_.lastBaseUpdate=_e,s=_.shared.interleaved,s!==null){_=s;do j|=_.lane,_=_.next;while(_!==s)}else C===null&&(_.shared.lanes=0);ji|=j,t.lanes=j,t.memoizedState=Ie}}function i0(t,s,d){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var p=t[s],_=p.callback;if(_!==null){if(p.callback=null,p=d,typeof _!="function")throw Error(o(191,_));_.call(p)}}}var uo={},fs=Ks(uo),ho=Ks(uo),fo=Ks(uo);function Ii(t){if(t===uo)throw Error(o(174));return t}function Kc(t,s){switch(ur(fo,s),ur(ho,t),ur(fs,uo),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Mt(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=Mt(s,t)}gr(fs),ur(fs,s)}function fa(){gr(fs),gr(ho),gr(fo)}function a0(t){Ii(fo.current);var s=Ii(fs.current),d=Mt(s,t.type);s!==d&&(ur(ho,t),ur(fs,d))}function Yc(t){ho.current===t&&(gr(fs),gr(ho))}var _r=Ks(0);function bl(t){for(var s=t;s!==null;){if(s.tag===13){var d=s.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Zc=[];function Qc(){for(var t=0;t<Zc.length;t++)Zc[t]._workInProgressVersionPrimary=null;Zc.length=0}var _l=Y.ReactCurrentDispatcher,Jc=Y.ReactCurrentBatchConfig,Ti=0,Nr=null,zr=null,Kr=null,Nl=!1,go=!1,xo=0,fg=0;function dn(){throw Error(o(321))}function eu(t,s){if(s===null)return!1;for(var d=0;d<s.length&&d<t.length;d++)if(!Q(t[d],s[d]))return!1;return!0}function tu(t,s,d,p,_,C){if(Ti=C,Nr=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,_l.current=t===null||t.memoizedState===null?pg:yg,t=d(p,_),go){C=0;do{if(go=!1,xo=0,25<=C)throw Error(o(301));C+=1,Kr=zr=null,s.updateQueue=null,_l.current=wg,t=d(p,_)}while(go)}if(_l.current=Sl,s=zr!==null&&zr.next!==null,Ti=0,Kr=zr=Nr=null,Nl=!1,s)throw Error(o(300));return t}function ru(){var t=xo!==0;return xo=0,t}function gs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?Nr.memoizedState=Kr=t:Kr=Kr.next=t,Kr}function Gn(){if(zr===null){var t=Nr.alternate;t=t!==null?t.memoizedState:null}else t=zr.next;var s=Kr===null?Nr.memoizedState:Kr.next;if(s!==null)Kr=s,zr=t;else{if(t===null)throw Error(o(310));zr=t,t={memoizedState:zr.memoizedState,baseState:zr.baseState,baseQueue:zr.baseQueue,queue:zr.queue,next:null},Kr===null?Nr.memoizedState=Kr=t:Kr=Kr.next=t}return Kr}function mo(t,s){return typeof s=="function"?s(t):s}function nu(t){var s=Gn(),d=s.queue;if(d===null)throw Error(o(311));d.lastRenderedReducer=t;var p=zr,_=p.baseQueue,C=d.pending;if(C!==null){if(_!==null){var j=_.next;_.next=C.next,C.next=j}p.baseQueue=_=C,d.pending=null}if(_!==null){C=_.next,p=p.baseState;var W=j=null,G=null,le=C;do{var _e=le.lane;if((Ti&_e)===_e)G!==null&&(G=G.next={lane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),p=le.hasEagerState?le.eagerState:t(p,le.action);else{var Ie={lane:_e,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null};G===null?(W=G=Ie,j=p):G=G.next=Ie,Nr.lanes|=_e,ji|=_e}le=le.next}while(le!==null&&le!==C);G===null?j=p:G.next=W,Q(p,s.memoizedState)||(bn=!0),s.memoizedState=p,s.baseState=j,s.baseQueue=G,d.lastRenderedState=p}if(t=d.interleaved,t!==null){_=t;do C=_.lane,Nr.lanes|=C,ji|=C,_=_.next;while(_!==t)}else _===null&&(d.lanes=0);return[s.memoizedState,d.dispatch]}function su(t){var s=Gn(),d=s.queue;if(d===null)throw Error(o(311));d.lastRenderedReducer=t;var p=d.dispatch,_=d.pending,C=s.memoizedState;if(_!==null){d.pending=null;var j=_=_.next;do C=t(C,j.action),j=j.next;while(j!==_);Q(C,s.memoizedState)||(bn=!0),s.memoizedState=C,s.baseQueue===null&&(s.baseState=C),d.lastRenderedState=C}return[C,p]}function o0(){}function l0(t,s){var d=Nr,p=Gn(),_=s(),C=!Q(p.memoizedState,_);if(C&&(p.memoizedState=_,bn=!0),p=p.queue,iu(d0.bind(null,d,p,t),[t]),p.getSnapshot!==s||C||Kr!==null&&Kr.memoizedState.tag&1){if(d.flags|=2048,po(9,u0.bind(null,d,p,_,s),void 0,null),Yr===null)throw Error(o(349));(Ti&30)!==0||c0(d,s,_)}return _}function c0(t,s,d){t.flags|=16384,t={getSnapshot:s,value:d},s=Nr.updateQueue,s===null?(s={lastEffect:null,stores:null},Nr.updateQueue=s,s.stores=[t]):(d=s.stores,d===null?s.stores=[t]:d.push(t))}function u0(t,s,d,p){s.value=d,s.getSnapshot=p,h0(s)&&f0(t)}function d0(t,s,d){return d(function(){h0(s)&&f0(t)})}function h0(t){var s=t.getSnapshot;t=t.value;try{var d=s();return!Q(t,d)}catch{return!0}}function f0(t){var s=ks(t,1);s!==null&&ss(s,t,1,-1)}function g0(t){var s=gs();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:t},s.queue=t,t=t.dispatch=mg.bind(null,Nr,t),[s.memoizedState,t]}function po(t,s,d,p){return t={tag:t,create:s,destroy:d,deps:p,next:null},s=Nr.updateQueue,s===null?(s={lastEffect:null,stores:null},Nr.updateQueue=s,s.lastEffect=t.next=t):(d=s.lastEffect,d===null?s.lastEffect=t.next=t:(p=d.next,d.next=t,t.next=p,s.lastEffect=t)),t}function x0(){return Gn().memoizedState}function El(t,s,d,p){var _=gs();Nr.flags|=t,_.memoizedState=po(1|s,d,void 0,p===void 0?null:p)}function Cl(t,s,d,p){var _=Gn();p=p===void 0?null:p;var C=void 0;if(zr!==null){var j=zr.memoizedState;if(C=j.destroy,p!==null&&eu(p,j.deps)){_.memoizedState=po(s,d,C,p);return}}Nr.flags|=t,_.memoizedState=po(1|s,d,C,p)}function m0(t,s){return El(8390656,8,t,s)}function iu(t,s){return Cl(2048,8,t,s)}function p0(t,s){return Cl(4,2,t,s)}function y0(t,s){return Cl(4,4,t,s)}function w0(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function v0(t,s,d){return d=d!=null?d.concat([t]):null,Cl(4,4,w0.bind(null,s,t),d)}function au(){}function b0(t,s){var d=Gn();s=s===void 0?null:s;var p=d.memoizedState;return p!==null&&s!==null&&eu(s,p[1])?p[0]:(d.memoizedState=[t,s],t)}function _0(t,s){var d=Gn();s=s===void 0?null:s;var p=d.memoizedState;return p!==null&&s!==null&&eu(s,p[1])?p[0]:(t=t(),d.memoizedState=[t,s],t)}function N0(t,s,d){return(Ti&21)===0?(t.baseState&&(t.baseState=!1,bn=!0),t.memoizedState=d):(Q(d,s)||(d=Br(),Nr.lanes|=d,ji|=d,t.baseState=!0),s)}function gg(t,s){var d=wt;wt=d!==0&&4>d?d:4,t(!0);var p=Jc.transition;Jc.transition={};try{t(!1),s()}finally{wt=d,Jc.transition=p}}function E0(){return Gn().memoizedState}function xg(t,s,d){var p=ni(t);if(d={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null},C0(t))S0(s,d);else if(d=r0(t,s,d,p),d!==null){var _=mn();ss(d,t,p,_),A0(d,s,p)}}function mg(t,s,d){var p=ni(t),_={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null};if(C0(t))S0(s,_);else{var C=t.alternate;if(t.lanes===0&&(C===null||C.lanes===0)&&(C=s.lastRenderedReducer,C!==null))try{var j=s.lastRenderedState,W=C(j,d);if(_.hasEagerState=!0,_.eagerState=W,Q(W,j)){var G=s.interleaved;G===null?(_.next=_,Xc(s)):(_.next=G.next,G.next=_),s.interleaved=_;return}}catch{}finally{}d=r0(t,s,_,p),d!==null&&(_=mn(),ss(d,t,p,_),A0(d,s,p))}}function C0(t){var s=t.alternate;return t===Nr||s!==null&&s===Nr}function S0(t,s){go=Nl=!0;var d=t.pending;d===null?s.next=s:(s.next=d.next,d.next=s),t.pending=s}function A0(t,s,d){if((d&4194240)!==0){var p=s.lanes;p&=t.pendingLanes,d|=p,s.lanes=d,Ar(t,d)}}var Sl={readContext:Hn,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useInsertionEffect:dn,useLayoutEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useMutableSource:dn,useSyncExternalStore:dn,useId:dn,unstable_isNewReconciler:!1},pg={readContext:Hn,useCallback:function(t,s){return gs().memoizedState=[t,s===void 0?null:s],t},useContext:Hn,useEffect:m0,useImperativeHandle:function(t,s,d){return d=d!=null?d.concat([t]):null,El(4194308,4,w0.bind(null,s,t),d)},useLayoutEffect:function(t,s){return El(4194308,4,t,s)},useInsertionEffect:function(t,s){return El(4,2,t,s)},useMemo:function(t,s){var d=gs();return s=s===void 0?null:s,t=t(),d.memoizedState=[t,s],t},useReducer:function(t,s,d){var p=gs();return s=d!==void 0?d(s):s,p.memoizedState=p.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},p.queue=t,t=t.dispatch=xg.bind(null,Nr,t),[p.memoizedState,t]},useRef:function(t){var s=gs();return t={current:t},s.memoizedState=t},useState:g0,useDebugValue:au,useDeferredValue:function(t){return gs().memoizedState=t},useTransition:function(){var t=g0(!1),s=t[0];return t=gg.bind(null,t[1]),gs().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,d){var p=Nr,_=gs();if(wr){if(d===void 0)throw Error(o(407));d=d()}else{if(d=s(),Yr===null)throw Error(o(349));(Ti&30)!==0||c0(p,s,d)}_.memoizedState=d;var C={value:d,getSnapshot:s};return _.queue=C,m0(d0.bind(null,p,C,t),[t]),p.flags|=2048,po(9,u0.bind(null,p,C,d,s),void 0,null),d},useId:function(){var t=gs(),s=Yr.identifierPrefix;if(wr){var d=As,p=Ss;d=(p&~(1<<32-gn(p)-1)).toString(32)+d,s=":"+s+"R"+d,d=xo++,0<d&&(s+="H"+d.toString(32)),s+=":"}else d=fg++,s=":"+s+"r"+d.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},yg={readContext:Hn,useCallback:b0,useContext:Hn,useEffect:iu,useImperativeHandle:v0,useInsertionEffect:p0,useLayoutEffect:y0,useMemo:_0,useReducer:nu,useRef:x0,useState:function(){return nu(mo)},useDebugValue:au,useDeferredValue:function(t){var s=Gn();return N0(s,zr.memoizedState,t)},useTransition:function(){var t=nu(mo)[0],s=Gn().memoizedState;return[t,s]},useMutableSource:o0,useSyncExternalStore:l0,useId:E0,unstable_isNewReconciler:!1},wg={readContext:Hn,useCallback:b0,useContext:Hn,useEffect:iu,useImperativeHandle:v0,useInsertionEffect:p0,useLayoutEffect:y0,useMemo:_0,useReducer:su,useRef:x0,useState:function(){return su(mo)},useDebugValue:au,useDeferredValue:function(t){var s=Gn();return zr===null?s.memoizedState=t:N0(s,zr.memoizedState,t)},useTransition:function(){var t=su(mo)[0],s=Gn().memoizedState;return[t,s]},useMutableSource:o0,useSyncExternalStore:l0,useId:E0,unstable_isNewReconciler:!1};function ts(t,s){if(t&&t.defaultProps){s=ye({},s),t=t.defaultProps;for(var d in t)s[d]===void 0&&(s[d]=t[d]);return s}return s}function ou(t,s,d,p){s=t.memoizedState,d=d(p,s),d=d==null?s:ye({},s,d),t.memoizedState=d,t.lanes===0&&(t.updateQueue.baseState=d)}var Al={isMounted:function(t){return(t=t._reactInternals)?Gt(t)===t:!1},enqueueSetState:function(t,s,d){t=t._reactInternals;var p=mn(),_=ni(t),C=Is(p,_);C.payload=s,d!=null&&(C.callback=d),s=Js(t,C,_),s!==null&&(ss(s,t,_,p),wl(s,t,_))},enqueueReplaceState:function(t,s,d){t=t._reactInternals;var p=mn(),_=ni(t),C=Is(p,_);C.tag=1,C.payload=s,d!=null&&(C.callback=d),s=Js(t,C,_),s!==null&&(ss(s,t,_,p),wl(s,t,_))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var d=mn(),p=ni(t),_=Is(d,p);_.tag=2,s!=null&&(_.callback=s),s=Js(t,_,p),s!==null&&(ss(s,t,p,d),wl(s,t,p))}};function k0(t,s,d,p,_,C,j){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(p,C,j):s.prototype&&s.prototype.isPureReactComponent?!ae(d,p)||!ae(_,C):!0}function I0(t,s,d){var p=!1,_=Ys,C=s.contextType;return typeof C=="object"&&C!==null?C=Hn(C):(_=vn(s)?Ci:un.current,p=s.contextTypes,C=(p=p!=null)?aa(t,_):Ys),s=new s(d,C),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Al,t.stateNode=s,s._reactInternals=t,p&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=_,t.__reactInternalMemoizedMaskedChildContext=C),s}function T0(t,s,d,p){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(d,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(d,p),s.state!==t&&Al.enqueueReplaceState(s,s.state,null)}function lu(t,s,d,p){var _=t.stateNode;_.props=d,_.state=t.memoizedState,_.refs={},qc(t);var C=s.contextType;typeof C=="object"&&C!==null?_.context=Hn(C):(C=vn(s)?Ci:un.current,_.context=aa(t,C)),_.state=t.memoizedState,C=s.getDerivedStateFromProps,typeof C=="function"&&(ou(t,s,C,d),_.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(s=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),s!==_.state&&Al.enqueueReplaceState(_,_.state,null),vl(t,d,_,p),_.state=t.memoizedState),typeof _.componentDidMount=="function"&&(t.flags|=4194308)}function ga(t,s){try{var d="",p=s;do d+=nt(p),p=p.return;while(p);var _=d}catch(C){_=`
Error generating stack: `+C.message+`
`+C.stack}return{value:t,source:s,stack:_,digest:null}}function cu(t,s,d){return{value:t,source:null,stack:d??null,digest:s??null}}function uu(t,s){try{console.error(s.value)}catch(d){setTimeout(function(){throw d})}}var vg=typeof WeakMap=="function"?WeakMap:Map;function j0(t,s,d){d=Is(-1,d),d.tag=3,d.payload={element:null};var p=s.value;return d.callback=function(){Dl||(Dl=!0,Cu=p),uu(t,s)},d}function R0(t,s,d){d=Is(-1,d),d.tag=3;var p=t.type.getDerivedStateFromError;if(typeof p=="function"){var _=s.value;d.payload=function(){return p(_)},d.callback=function(){uu(t,s)}}var C=t.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(d.callback=function(){uu(t,s),typeof p!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var j=s.stack;this.componentDidCatch(s.value,{componentStack:j!==null?j:""})}),d}function O0(t,s,d){var p=t.pingCache;if(p===null){p=t.pingCache=new vg;var _=new Set;p.set(s,_)}else _=p.get(s),_===void 0&&(_=new Set,p.set(s,_));_.has(d)||(_.add(d),t=Dg.bind(null,t,s,d),s.then(t,t))}function D0(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function M0(t,s,d,p,_){return(t.mode&1)===0?(t===s?t.flags|=65536:(t.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(s=Is(-1,1),s.tag=2,Js(d,s,1))),d.lanes|=1),t):(t.flags|=65536,t.lanes=_,t)}var bg=Y.ReactCurrentOwner,bn=!1;function xn(t,s,d,p){s.child=t===null?t0(s,null,d,p):ua(s,t.child,d,p)}function P0(t,s,d,p,_){d=d.render;var C=s.ref;return ha(s,_),p=tu(t,s,d,p,C,_),d=ru(),t!==null&&!bn?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~_,Ts(t,s,_)):(wr&&d&&Bc(s),s.flags|=1,xn(t,s,p,_),s.child)}function L0(t,s,d,p,_){if(t===null){var C=d.type;return typeof C=="function"&&!Ru(C)&&C.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(s.tag=15,s.type=C,B0(t,s,C,p,_)):(t=Ul(d.type,null,p,s,s.mode,_),t.ref=s.ref,t.return=s,s.child=t)}if(C=t.child,(t.lanes&_)===0){var j=C.memoizedProps;if(d=d.compare,d=d!==null?d:ae,d(j,p)&&t.ref===s.ref)return Ts(t,s,_)}return s.flags|=1,t=ii(C,p),t.ref=s.ref,t.return=s,s.child=t}function B0(t,s,d,p,_){if(t!==null){var C=t.memoizedProps;if(ae(C,p)&&t.ref===s.ref)if(bn=!1,s.pendingProps=p=C,(t.lanes&_)!==0)(t.flags&131072)!==0&&(bn=!0);else return s.lanes=t.lanes,Ts(t,s,_)}return du(t,s,d,p,_)}function F0(t,s,d){var p=s.pendingProps,_=p.children,C=t!==null?t.memoizedState:null;if(p.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},ur(ma,Dn),Dn|=d;else{if((d&1073741824)===0)return t=C!==null?C.baseLanes|d:d,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,ur(ma,Dn),Dn|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=C!==null?C.baseLanes:d,ur(ma,Dn),Dn|=p}else C!==null?(p=C.baseLanes|d,s.memoizedState=null):p=d,ur(ma,Dn),Dn|=p;return xn(t,s,_,d),s.child}function U0(t,s){var d=s.ref;(t===null&&d!==null||t!==null&&t.ref!==d)&&(s.flags|=512,s.flags|=2097152)}function du(t,s,d,p,_){var C=vn(d)?Ci:un.current;return C=aa(s,C),ha(s,_),d=tu(t,s,d,p,C,_),p=ru(),t!==null&&!bn?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~_,Ts(t,s,_)):(wr&&p&&Bc(s),s.flags|=1,xn(t,s,d,_),s.child)}function W0(t,s,d,p,_){if(vn(d)){var C=!0;dl(s)}else C=!1;if(ha(s,_),s.stateNode===null)Il(t,s),I0(s,d,p),lu(s,d,p,_),p=!0;else if(t===null){var j=s.stateNode,W=s.memoizedProps;j.props=W;var G=j.context,le=d.contextType;typeof le=="object"&&le!==null?le=Hn(le):(le=vn(d)?Ci:un.current,le=aa(s,le));var _e=d.getDerivedStateFromProps,Ie=typeof _e=="function"||typeof j.getSnapshotBeforeUpdate=="function";Ie||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(W!==p||G!==le)&&T0(s,j,p,le),Qs=!1;var ve=s.memoizedState;j.state=ve,vl(s,p,j,_),G=s.memoizedState,W!==p||ve!==G||wn.current||Qs?(typeof _e=="function"&&(ou(s,d,_e,p),G=s.memoizedState),(W=Qs||k0(s,d,W,p,ve,G,le))?(Ie||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(s.flags|=4194308)):(typeof j.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=G),j.props=p,j.state=G,j.context=le,p=W):(typeof j.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{j=s.stateNode,n0(t,s),W=s.memoizedProps,le=s.type===s.elementType?W:ts(s.type,W),j.props=le,Ie=s.pendingProps,ve=j.context,G=d.contextType,typeof G=="object"&&G!==null?G=Hn(G):(G=vn(d)?Ci:un.current,G=aa(s,G));var qe=d.getDerivedStateFromProps;(_e=typeof qe=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(W!==Ie||ve!==G)&&T0(s,j,p,G),Qs=!1,ve=s.memoizedState,j.state=ve,vl(s,p,j,_);var Je=s.memoizedState;W!==Ie||ve!==Je||wn.current||Qs?(typeof qe=="function"&&(ou(s,d,qe,p),Je=s.memoizedState),(le=Qs||k0(s,d,le,p,ve,Je,G)||!1)?(_e||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(p,Je,G),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(p,Je,G)),typeof j.componentDidUpdate=="function"&&(s.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof j.componentDidUpdate!="function"||W===t.memoizedProps&&ve===t.memoizedState||(s.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||W===t.memoizedProps&&ve===t.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=Je),j.props=p,j.state=Je,j.context=G,p=le):(typeof j.componentDidUpdate!="function"||W===t.memoizedProps&&ve===t.memoizedState||(s.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||W===t.memoizedProps&&ve===t.memoizedState||(s.flags|=1024),p=!1)}return hu(t,s,d,p,C,_)}function hu(t,s,d,p,_,C){U0(t,s);var j=(s.flags&128)!==0;if(!p&&!j)return _&&$d(s,d,!1),Ts(t,s,C);p=s.stateNode,bg.current=s;var W=j&&typeof d.getDerivedStateFromError!="function"?null:p.render();return s.flags|=1,t!==null&&j?(s.child=ua(s,t.child,null,C),s.child=ua(s,null,W,C)):xn(t,s,W,C),s.memoizedState=p.state,_&&$d(s,d,!0),s.child}function z0(t){var s=t.stateNode;s.pendingContext?Hd(t,s.pendingContext,s.pendingContext!==s.context):s.context&&Hd(t,s.context,!1),Kc(t,s.containerInfo)}function V0(t,s,d,p,_){return ca(),zc(_),s.flags|=256,xn(t,s,d,p),s.child}var fu={dehydrated:null,treeContext:null,retryLane:0};function gu(t){return{baseLanes:t,cachePool:null,transitions:null}}function H0(t,s,d){var p=s.pendingProps,_=_r.current,C=!1,j=(s.flags&128)!==0,W;if((W=j)||(W=t!==null&&t.memoizedState===null?!1:(_&2)!==0),W?(C=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(_|=1),ur(_r,_&1),t===null)return Wc(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((s.mode&1)===0?s.lanes=1:t.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(j=p.children,t=p.fallback,C?(p=s.mode,C=s.child,j={mode:"hidden",children:j},(p&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=j):C=Wl(j,p,0,null),t=Mi(t,p,d,null),C.return=s,t.return=s,C.sibling=t,s.child=C,s.child.memoizedState=gu(d),s.memoizedState=fu,t):xu(s,j));if(_=t.memoizedState,_!==null&&(W=_.dehydrated,W!==null))return _g(t,s,j,p,W,_,d);if(C){C=p.fallback,j=s.mode,_=t.child,W=_.sibling;var G={mode:"hidden",children:p.children};return(j&1)===0&&s.child!==_?(p=s.child,p.childLanes=0,p.pendingProps=G,s.deletions=null):(p=ii(_,G),p.subtreeFlags=_.subtreeFlags&14680064),W!==null?C=ii(W,C):(C=Mi(C,j,d,null),C.flags|=2),C.return=s,p.return=s,p.sibling=C,s.child=p,p=C,C=s.child,j=t.child.memoizedState,j=j===null?gu(d):{baseLanes:j.baseLanes|d,cachePool:null,transitions:j.transitions},C.memoizedState=j,C.childLanes=t.childLanes&~d,s.memoizedState=fu,p}return C=t.child,t=C.sibling,p=ii(C,{mode:"visible",children:p.children}),(s.mode&1)===0&&(p.lanes=d),p.return=s,p.sibling=null,t!==null&&(d=s.deletions,d===null?(s.deletions=[t],s.flags|=16):d.push(t)),s.child=p,s.memoizedState=null,p}function xu(t,s){return s=Wl({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function kl(t,s,d,p){return p!==null&&zc(p),ua(s,t.child,null,d),t=xu(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function _g(t,s,d,p,_,C,j){if(d)return s.flags&256?(s.flags&=-257,p=cu(Error(o(422))),kl(t,s,j,p)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(C=p.fallback,_=s.mode,p=Wl({mode:"visible",children:p.children},_,0,null),C=Mi(C,_,j,null),C.flags|=2,p.return=s,C.return=s,p.sibling=C,s.child=p,(s.mode&1)!==0&&ua(s,t.child,null,j),s.child.memoizedState=gu(j),s.memoizedState=fu,C);if((s.mode&1)===0)return kl(t,s,j,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var W=p.dgst;return p=W,C=Error(o(419)),p=cu(C,p,void 0),kl(t,s,j,p)}if(W=(j&t.childLanes)!==0,bn||W){if(p=Yr,p!==null){switch(j&-j){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(p.suspendedLanes|j))!==0?0:_,_!==0&&_!==C.retryLane&&(C.retryLane=_,ks(t,_),ss(p,t,_,-1))}return ju(),p=cu(Error(o(421))),kl(t,s,j,p)}return _.data==="$?"?(s.flags|=128,s.child=t.child,s=Mg.bind(null,t),_._reactRetry=s,null):(t=C.treeContext,On=qs(_.nextSibling),Rn=s,wr=!0,es=null,t!==null&&(zn[Vn++]=Ss,zn[Vn++]=As,zn[Vn++]=Si,Ss=t.id,As=t.overflow,Si=s),s=xu(s,p.children),s.flags|=4096,s)}function G0(t,s,d){t.lanes|=s;var p=t.alternate;p!==null&&(p.lanes|=s),$c(t.return,s,d)}function mu(t,s,d,p,_){var C=t.memoizedState;C===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:_}:(C.isBackwards=s,C.rendering=null,C.renderingStartTime=0,C.last=p,C.tail=d,C.tailMode=_)}function $0(t,s,d){var p=s.pendingProps,_=p.revealOrder,C=p.tail;if(xn(t,s,p.children,d),p=_r.current,(p&2)!==0)p=p&1|2,s.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&G0(t,d,s);else if(t.tag===19)G0(t,d,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}p&=1}if(ur(_r,p),(s.mode&1)===0)s.memoizedState=null;else switch(_){case"forwards":for(d=s.child,_=null;d!==null;)t=d.alternate,t!==null&&bl(t)===null&&(_=d),d=d.sibling;d=_,d===null?(_=s.child,s.child=null):(_=d.sibling,d.sibling=null),mu(s,!1,_,d,C);break;case"backwards":for(d=null,_=s.child,s.child=null;_!==null;){if(t=_.alternate,t!==null&&bl(t)===null){s.child=_;break}t=_.sibling,_.sibling=d,d=_,_=t}mu(s,!0,d,null,C);break;case"together":mu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Il(t,s){(s.mode&1)===0&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function Ts(t,s,d){if(t!==null&&(s.dependencies=t.dependencies),ji|=s.lanes,(d&s.childLanes)===0)return null;if(t!==null&&s.child!==t.child)throw Error(o(153));if(s.child!==null){for(t=s.child,d=ii(t,t.pendingProps),s.child=d,d.return=s;t.sibling!==null;)t=t.sibling,d=d.sibling=ii(t,t.pendingProps),d.return=s;d.sibling=null}return s.child}function Ng(t,s,d){switch(s.tag){case 3:z0(s),ca();break;case 5:a0(s);break;case 1:vn(s.type)&&dl(s);break;case 4:Kc(s,s.stateNode.containerInfo);break;case 10:var p=s.type._context,_=s.memoizedProps.value;ur(pl,p._currentValue),p._currentValue=_;break;case 13:if(p=s.memoizedState,p!==null)return p.dehydrated!==null?(ur(_r,_r.current&1),s.flags|=128,null):(d&s.child.childLanes)!==0?H0(t,s,d):(ur(_r,_r.current&1),t=Ts(t,s,d),t!==null?t.sibling:null);ur(_r,_r.current&1);break;case 19:if(p=(d&s.childLanes)!==0,(t.flags&128)!==0){if(p)return $0(t,s,d);s.flags|=128}if(_=s.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),ur(_r,_r.current),p)break;return null;case 22:case 23:return s.lanes=0,F0(t,s,d)}return Ts(t,s,d)}var X0,pu,q0,K0;X0=function(t,s){for(var d=s.child;d!==null;){if(d.tag===5||d.tag===6)t.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===s)break;for(;d.sibling===null;){if(d.return===null||d.return===s)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},pu=function(){},q0=function(t,s,d,p){var _=t.memoizedProps;if(_!==p){t=s.stateNode,Ii(fs.current);var C=null;switch(d){case"input":_=Nt(t,_),p=Nt(t,p),C=[];break;case"select":_=ye({},_,{value:void 0}),p=ye({},p,{value:void 0}),C=[];break;case"textarea":_=_t(t,_),p=_t(t,p),C=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(t.onclick=ll)}Ut(d,p);var j;d=null;for(le in _)if(!p.hasOwnProperty(le)&&_.hasOwnProperty(le)&&_[le]!=null)if(le==="style"){var W=_[le];for(j in W)W.hasOwnProperty(j)&&(d||(d={}),d[j]="")}else le!=="dangerouslySetInnerHTML"&&le!=="children"&&le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&le!=="autoFocus"&&(x.hasOwnProperty(le)?C||(C=[]):(C=C||[]).push(le,null));for(le in p){var G=p[le];if(W=_?.[le],p.hasOwnProperty(le)&&G!==W&&(G!=null||W!=null))if(le==="style")if(W){for(j in W)!W.hasOwnProperty(j)||G&&G.hasOwnProperty(j)||(d||(d={}),d[j]="");for(j in G)G.hasOwnProperty(j)&&W[j]!==G[j]&&(d||(d={}),d[j]=G[j])}else d||(C||(C=[]),C.push(le,d)),d=G;else le==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,W=W?W.__html:void 0,G!=null&&W!==G&&(C=C||[]).push(le,G)):le==="children"?typeof G!="string"&&typeof G!="number"||(C=C||[]).push(le,""+G):le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&(x.hasOwnProperty(le)?(G!=null&&le==="onScroll"&&fr("scroll",t),C||W===G||(C=[])):(C=C||[]).push(le,G))}d&&(C=C||[]).push("style",d);var le=C;(s.updateQueue=le)&&(s.flags|=4)}},K0=function(t,s,d,p){d!==p&&(s.flags|=4)};function yo(t,s){if(!wr)switch(t.tailMode){case"hidden":s=t.tail;for(var d=null;s!==null;)s.alternate!==null&&(d=s),s=s.sibling;d===null?t.tail=null:d.sibling=null;break;case"collapsed":d=t.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:p.sibling=null}}function hn(t){var s=t.alternate!==null&&t.alternate.child===t.child,d=0,p=0;if(s)for(var _=t.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=t,_=_.sibling;else for(_=t.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=t,_=_.sibling;return t.subtreeFlags|=p,t.childLanes=d,s}function Eg(t,s,d){var p=s.pendingProps;switch(Fc(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(s),null;case 1:return vn(s.type)&&ul(),hn(s),null;case 3:return p=s.stateNode,fa(),gr(wn),gr(un),Qc(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(t===null||t.child===null)&&(xl(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,es!==null&&(ku(es),es=null))),pu(t,s),hn(s),null;case 5:Yc(s);var _=Ii(fo.current);if(d=s.type,t!==null&&s.stateNode!=null)q0(t,s,d,p,_),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!p){if(s.stateNode===null)throw Error(o(166));return hn(s),null}if(t=Ii(fs.current),xl(s)){p=s.stateNode,d=s.type;var C=s.memoizedProps;switch(p[hs]=s,p[oo]=C,t=(s.mode&1)!==0,d){case"dialog":fr("cancel",p),fr("close",p);break;case"iframe":case"object":case"embed":fr("load",p);break;case"video":case"audio":for(_=0;_<so.length;_++)fr(so[_],p);break;case"source":fr("error",p);break;case"img":case"image":case"link":fr("error",p),fr("load",p);break;case"details":fr("toggle",p);break;case"input":nr(p,C),fr("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!C.multiple},fr("invalid",p);break;case"textarea":sr(p,C),fr("invalid",p)}Ut(d,C),_=null;for(var j in C)if(C.hasOwnProperty(j)){var W=C[j];j==="children"?typeof W=="string"?p.textContent!==W&&(C.suppressHydrationWarning!==!0&&ol(p.textContent,W,t),_=["children",W]):typeof W=="number"&&p.textContent!==""+W&&(C.suppressHydrationWarning!==!0&&ol(p.textContent,W,t),_=["children",""+W]):x.hasOwnProperty(j)&&W!=null&&j==="onScroll"&&fr("scroll",p)}switch(d){case"input":de(p),We(p,C,!0);break;case"textarea":de(p),Er(p);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(p.onclick=ll)}p=_,s.updateQueue=p,p!==null&&(s.flags|=4)}else{j=_.nodeType===9?_:_.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=me(d)),t==="http://www.w3.org/1999/xhtml"?d==="script"?(t=j.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof p.is=="string"?t=j.createElement(d,{is:p.is}):(t=j.createElement(d),d==="select"&&(j=t,p.multiple?j.multiple=!0:p.size&&(j.size=p.size))):t=j.createElementNS(t,d),t[hs]=s,t[oo]=p,X0(t,s,!1,!1),s.stateNode=t;e:{switch(j=Zt(d,p),d){case"dialog":fr("cancel",t),fr("close",t),_=p;break;case"iframe":case"object":case"embed":fr("load",t),_=p;break;case"video":case"audio":for(_=0;_<so.length;_++)fr(so[_],t);_=p;break;case"source":fr("error",t),_=p;break;case"img":case"image":case"link":fr("error",t),fr("load",t),_=p;break;case"details":fr("toggle",t),_=p;break;case"input":nr(t,p),_=Nt(t,p),fr("invalid",t);break;case"option":_=p;break;case"select":t._wrapperState={wasMultiple:!!p.multiple},_=ye({},p,{value:void 0}),fr("invalid",t);break;case"textarea":sr(t,p),_=_t(t,p),fr("invalid",t);break;default:_=p}Ut(d,_),W=_;for(C in W)if(W.hasOwnProperty(C)){var G=W[C];C==="style"?Pe(t,G):C==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,G!=null&&Cr(t,G)):C==="children"?typeof G=="string"?(d!=="textarea"||G!=="")&&ls(t,G):typeof G=="number"&&ls(t,""+G):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(x.hasOwnProperty(C)?G!=null&&C==="onScroll"&&fr("scroll",t):G!=null&&L(t,C,G,j))}switch(d){case"input":de(t),We(t,p,!1);break;case"textarea":de(t),Er(t);break;case"option":p.value!=null&&t.setAttribute("value",""+Ye(p.value));break;case"select":t.multiple=!!p.multiple,C=p.value,C!=null?Ee(t,!!p.multiple,C,!1):p.defaultValue!=null&&Ee(t,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(t.onclick=ll)}switch(d){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return hn(s),null;case 6:if(t&&s.stateNode!=null)K0(t,s,t.memoizedProps,p);else{if(typeof p!="string"&&s.stateNode===null)throw Error(o(166));if(d=Ii(fo.current),Ii(fs.current),xl(s)){if(p=s.stateNode,d=s.memoizedProps,p[hs]=s,(C=p.nodeValue!==d)&&(t=Rn,t!==null))switch(t.tag){case 3:ol(p.nodeValue,d,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ol(p.nodeValue,d,(t.mode&1)!==0)}C&&(s.flags|=4)}else p=(d.nodeType===9?d:d.ownerDocument).createTextNode(p),p[hs]=s,s.stateNode=p}return hn(s),null;case 13:if(gr(_r),p=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(wr&&On!==null&&(s.mode&1)!==0&&(s.flags&128)===0)Qd(),ca(),s.flags|=98560,C=!1;else if(C=xl(s),p!==null&&p.dehydrated!==null){if(t===null){if(!C)throw Error(o(318));if(C=s.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(o(317));C[hs]=s}else ca(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;hn(s),C=!1}else es!==null&&(ku(es),es=null),C=!0;if(!C)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=d,s):(p=p!==null,p!==(t!==null&&t.memoizedState!==null)&&p&&(s.child.flags|=8192,(s.mode&1)!==0&&(t===null||(_r.current&1)!==0?Vr===0&&(Vr=3):ju())),s.updateQueue!==null&&(s.flags|=4),hn(s),null);case 4:return fa(),pu(t,s),t===null&&io(s.stateNode.containerInfo),hn(s),null;case 10:return Gc(s.type._context),hn(s),null;case 17:return vn(s.type)&&ul(),hn(s),null;case 19:if(gr(_r),C=s.memoizedState,C===null)return hn(s),null;if(p=(s.flags&128)!==0,j=C.rendering,j===null)if(p)yo(C,!1);else{if(Vr!==0||t!==null&&(t.flags&128)!==0)for(t=s.child;t!==null;){if(j=bl(t),j!==null){for(s.flags|=128,yo(C,!1),p=j.updateQueue,p!==null&&(s.updateQueue=p,s.flags|=4),s.subtreeFlags=0,p=d,d=s.child;d!==null;)C=d,t=p,C.flags&=14680066,j=C.alternate,j===null?(C.childLanes=0,C.lanes=t,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=j.childLanes,C.lanes=j.lanes,C.child=j.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=j.memoizedProps,C.memoizedState=j.memoizedState,C.updateQueue=j.updateQueue,C.type=j.type,t=j.dependencies,C.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),d=d.sibling;return ur(_r,_r.current&1|2),s.child}t=t.sibling}C.tail!==null&&Kt()>pa&&(s.flags|=128,p=!0,yo(C,!1),s.lanes=4194304)}else{if(!p)if(t=bl(j),t!==null){if(s.flags|=128,p=!0,d=t.updateQueue,d!==null&&(s.updateQueue=d,s.flags|=4),yo(C,!0),C.tail===null&&C.tailMode==="hidden"&&!j.alternate&&!wr)return hn(s),null}else 2*Kt()-C.renderingStartTime>pa&&d!==1073741824&&(s.flags|=128,p=!0,yo(C,!1),s.lanes=4194304);C.isBackwards?(j.sibling=s.child,s.child=j):(d=C.last,d!==null?d.sibling=j:s.child=j,C.last=j)}return C.tail!==null?(s=C.tail,C.rendering=s,C.tail=s.sibling,C.renderingStartTime=Kt(),s.sibling=null,d=_r.current,ur(_r,p?d&1|2:d&1),s):(hn(s),null);case 22:case 23:return Tu(),p=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==p&&(s.flags|=8192),p&&(s.mode&1)!==0?(Dn&1073741824)!==0&&(hn(s),s.subtreeFlags&6&&(s.flags|=8192)):hn(s),null;case 24:return null;case 25:return null}throw Error(o(156,s.tag))}function Cg(t,s){switch(Fc(s),s.tag){case 1:return vn(s.type)&&ul(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return fa(),gr(wn),gr(un),Qc(),t=s.flags,(t&65536)!==0&&(t&128)===0?(s.flags=t&-65537|128,s):null;case 5:return Yc(s),null;case 13:if(gr(_r),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(o(340));ca()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return gr(_r),null;case 4:return fa(),null;case 10:return Gc(s.type._context),null;case 22:case 23:return Tu(),null;case 24:return null;default:return null}}var Tl=!1,fn=!1,Sg=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function xa(t,s){var d=t.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(p){Ir(t,s,p)}else d.current=null}function yu(t,s,d){try{d()}catch(p){Ir(t,s,p)}}var Y0=!1;function Ag(t,s){if(Tc=us,t=At(),ft(t)){if("selectionStart"in t)var d={start:t.selectionStart,end:t.selectionEnd};else e:{d=(d=t.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var _=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var j=0,W=-1,G=-1,le=0,_e=0,Ie=t,ve=null;t:for(;;){for(var qe;Ie!==d||_!==0&&Ie.nodeType!==3||(W=j+_),Ie!==C||p!==0&&Ie.nodeType!==3||(G=j+p),Ie.nodeType===3&&(j+=Ie.nodeValue.length),(qe=Ie.firstChild)!==null;)ve=Ie,Ie=qe;for(;;){if(Ie===t)break t;if(ve===d&&++le===_&&(W=j),ve===C&&++_e===p&&(G=j),(qe=Ie.nextSibling)!==null)break;Ie=ve,ve=Ie.parentNode}Ie=qe}d=W===-1||G===-1?null:{start:W,end:G}}else d=null}d=d||{start:0,end:0}}else d=null;for(jc={focusedElem:t,selectionRange:d},us=!1,Qe=s;Qe!==null;)if(s=Qe,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,Qe=t;else for(;Qe!==null;){s=Qe;try{var Je=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(Je!==null){var et=Je.memoizedProps,Mr=Je.memoizedState,ee=s.stateNode,K=ee.getSnapshotBeforeUpdate(s.elementType===s.type?et:ts(s.type,et),Mr);ee.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var se=s.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(De){Ir(s,s.return,De)}if(t=s.sibling,t!==null){t.return=s.return,Qe=t;break}Qe=s.return}return Je=Y0,Y0=!1,Je}function wo(t,s,d){var p=s.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&t)===t){var C=_.destroy;_.destroy=void 0,C!==void 0&&yu(s,d,C)}_=_.next}while(_!==p)}}function jl(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var d=s=s.next;do{if((d.tag&t)===t){var p=d.create;d.destroy=p()}d=d.next}while(d!==s)}}function wu(t){var s=t.ref;if(s!==null){var d=t.stateNode;switch(t.tag){case 5:t=d;break;default:t=d}typeof s=="function"?s(t):s.current=t}}function Z0(t){var s=t.alternate;s!==null&&(t.alternate=null,Z0(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[hs],delete s[oo],delete s[Mc],delete s[cg],delete s[ug])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Q0(t){return t.tag===5||t.tag===3||t.tag===4}function J0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Q0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vu(t,s,d){var p=t.tag;if(p===5||p===6)t=t.stateNode,s?d.nodeType===8?d.parentNode.insertBefore(t,s):d.insertBefore(t,s):(d.nodeType===8?(s=d.parentNode,s.insertBefore(t,d)):(s=d,s.appendChild(t)),d=d._reactRootContainer,d!=null||s.onclick!==null||(s.onclick=ll));else if(p!==4&&(t=t.child,t!==null))for(vu(t,s,d),t=t.sibling;t!==null;)vu(t,s,d),t=t.sibling}function bu(t,s,d){var p=t.tag;if(p===5||p===6)t=t.stateNode,s?d.insertBefore(t,s):d.appendChild(t);else if(p!==4&&(t=t.child,t!==null))for(bu(t,s,d),t=t.sibling;t!==null;)bu(t,s,d),t=t.sibling}var sn=null,rs=!1;function ei(t,s,d){for(d=d.child;d!==null;)eh(t,s,d),d=d.sibling}function eh(t,s,d){if(yt&&typeof yt.onCommitFiberUnmount=="function")try{yt.onCommitFiberUnmount(Bt,d)}catch{}switch(d.tag){case 5:fn||xa(d,s);case 6:var p=sn,_=rs;sn=null,ei(t,s,d),sn=p,rs=_,sn!==null&&(rs?(t=sn,d=d.stateNode,t.nodeType===8?t.parentNode.removeChild(d):t.removeChild(d)):sn.removeChild(d.stateNode));break;case 18:sn!==null&&(rs?(t=sn,d=d.stateNode,t.nodeType===8?Dc(t.parentNode,d):t.nodeType===1&&Dc(t,d),Zn(t)):Dc(sn,d.stateNode));break;case 4:p=sn,_=rs,sn=d.stateNode.containerInfo,rs=!0,ei(t,s,d),sn=p,rs=_;break;case 0:case 11:case 14:case 15:if(!fn&&(p=d.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var C=_,j=C.destroy;C=C.tag,j!==void 0&&((C&2)!==0||(C&4)!==0)&&yu(d,s,j),_=_.next}while(_!==p)}ei(t,s,d);break;case 1:if(!fn&&(xa(d,s),p=d.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=d.memoizedProps,p.state=d.memoizedState,p.componentWillUnmount()}catch(W){Ir(d,s,W)}ei(t,s,d);break;case 21:ei(t,s,d);break;case 22:d.mode&1?(fn=(p=fn)||d.memoizedState!==null,ei(t,s,d),fn=p):ei(t,s,d);break;default:ei(t,s,d)}}function th(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var d=t.stateNode;d===null&&(d=t.stateNode=new Sg),s.forEach(function(p){var _=Pg.bind(null,t,p);d.has(p)||(d.add(p),p.then(_,_))})}}function ns(t,s){var d=s.deletions;if(d!==null)for(var p=0;p<d.length;p++){var _=d[p];try{var C=t,j=s,W=j;e:for(;W!==null;){switch(W.tag){case 5:sn=W.stateNode,rs=!1;break e;case 3:sn=W.stateNode.containerInfo,rs=!0;break e;case 4:sn=W.stateNode.containerInfo,rs=!0;break e}W=W.return}if(sn===null)throw Error(o(160));eh(C,j,_),sn=null,rs=!1;var G=_.alternate;G!==null&&(G.return=null),_.return=null}catch(le){Ir(_,s,le)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)rh(s,t),s=s.sibling}function rh(t,s){var d=t.alternate,p=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ns(s,t),xs(t),p&4){try{wo(3,t,t.return),jl(3,t)}catch(et){Ir(t,t.return,et)}try{wo(5,t,t.return)}catch(et){Ir(t,t.return,et)}}break;case 1:ns(s,t),xs(t),p&512&&d!==null&&xa(d,d.return);break;case 5:if(ns(s,t),xs(t),p&512&&d!==null&&xa(d,d.return),t.flags&32){var _=t.stateNode;try{ls(_,"")}catch(et){Ir(t,t.return,et)}}if(p&4&&(_=t.stateNode,_!=null)){var C=t.memoizedProps,j=d!==null?d.memoizedProps:C,W=t.type,G=t.updateQueue;if(t.updateQueue=null,G!==null)try{W==="input"&&C.type==="radio"&&C.name!=null&&ke(_,C),Zt(W,j);var le=Zt(W,C);for(j=0;j<G.length;j+=2){var _e=G[j],Ie=G[j+1];_e==="style"?Pe(_,Ie):_e==="dangerouslySetInnerHTML"?Cr(_,Ie):_e==="children"?ls(_,Ie):L(_,_e,Ie,le)}switch(W){case"input":ze(_,C);break;case"textarea":Dt(_,C);break;case"select":var ve=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!C.multiple;var qe=C.value;qe!=null?Ee(_,!!C.multiple,qe,!1):ve!==!!C.multiple&&(C.defaultValue!=null?Ee(_,!!C.multiple,C.defaultValue,!0):Ee(_,!!C.multiple,C.multiple?[]:"",!1))}_[oo]=C}catch(et){Ir(t,t.return,et)}}break;case 6:if(ns(s,t),xs(t),p&4){if(t.stateNode===null)throw Error(o(162));_=t.stateNode,C=t.memoizedProps;try{_.nodeValue=C}catch(et){Ir(t,t.return,et)}}break;case 3:if(ns(s,t),xs(t),p&4&&d!==null&&d.memoizedState.isDehydrated)try{Zn(s.containerInfo)}catch(et){Ir(t,t.return,et)}break;case 4:ns(s,t),xs(t);break;case 13:ns(s,t),xs(t),_=t.child,_.flags&8192&&(C=_.memoizedState!==null,_.stateNode.isHidden=C,!C||_.alternate!==null&&_.alternate.memoizedState!==null||(Eu=Kt())),p&4&&th(t);break;case 22:if(_e=d!==null&&d.memoizedState!==null,t.mode&1?(fn=(le=fn)||_e,ns(s,t),fn=le):ns(s,t),xs(t),p&8192){if(le=t.memoizedState!==null,(t.stateNode.isHidden=le)&&!_e&&(t.mode&1)!==0)for(Qe=t,_e=t.child;_e!==null;){for(Ie=Qe=_e;Qe!==null;){switch(ve=Qe,qe=ve.child,ve.tag){case 0:case 11:case 14:case 15:wo(4,ve,ve.return);break;case 1:xa(ve,ve.return);var Je=ve.stateNode;if(typeof Je.componentWillUnmount=="function"){p=ve,d=ve.return;try{s=p,Je.props=s.memoizedProps,Je.state=s.memoizedState,Je.componentWillUnmount()}catch(et){Ir(p,d,et)}}break;case 5:xa(ve,ve.return);break;case 22:if(ve.memoizedState!==null){ih(Ie);continue}}qe!==null?(qe.return=ve,Qe=qe):ih(Ie)}_e=_e.sibling}e:for(_e=null,Ie=t;;){if(Ie.tag===5){if(_e===null){_e=Ie;try{_=Ie.stateNode,le?(C=_.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(W=Ie.stateNode,G=Ie.memoizedProps.style,j=G!=null&&G.hasOwnProperty("display")?G.display:null,W.style.display=hr("display",j))}catch(et){Ir(t,t.return,et)}}}else if(Ie.tag===6){if(_e===null)try{Ie.stateNode.nodeValue=le?"":Ie.memoizedProps}catch(et){Ir(t,t.return,et)}}else if((Ie.tag!==22&&Ie.tag!==23||Ie.memoizedState===null||Ie===t)&&Ie.child!==null){Ie.child.return=Ie,Ie=Ie.child;continue}if(Ie===t)break e;for(;Ie.sibling===null;){if(Ie.return===null||Ie.return===t)break e;_e===Ie&&(_e=null),Ie=Ie.return}_e===Ie&&(_e=null),Ie.sibling.return=Ie.return,Ie=Ie.sibling}}break;case 19:ns(s,t),xs(t),p&4&&th(t);break;case 21:break;default:ns(s,t),xs(t)}}function xs(t){var s=t.flags;if(s&2){try{e:{for(var d=t.return;d!==null;){if(Q0(d)){var p=d;break e}d=d.return}throw Error(o(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(ls(_,""),p.flags&=-33);var C=J0(t);bu(t,C,_);break;case 3:case 4:var j=p.stateNode.containerInfo,W=J0(t);vu(t,W,j);break;default:throw Error(o(161))}}catch(G){Ir(t,t.return,G)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function kg(t,s,d){Qe=t,nh(t)}function nh(t,s,d){for(var p=(t.mode&1)!==0;Qe!==null;){var _=Qe,C=_.child;if(_.tag===22&&p){var j=_.memoizedState!==null||Tl;if(!j){var W=_.alternate,G=W!==null&&W.memoizedState!==null||fn;W=Tl;var le=fn;if(Tl=j,(fn=G)&&!le)for(Qe=_;Qe!==null;)j=Qe,G=j.child,j.tag===22&&j.memoizedState!==null?ah(_):G!==null?(G.return=j,Qe=G):ah(_);for(;C!==null;)Qe=C,nh(C),C=C.sibling;Qe=_,Tl=W,fn=le}sh(t)}else(_.subtreeFlags&8772)!==0&&C!==null?(C.return=_,Qe=C):sh(t)}}function sh(t){for(;Qe!==null;){var s=Qe;if((s.flags&8772)!==0){var d=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:fn||jl(5,s);break;case 1:var p=s.stateNode;if(s.flags&4&&!fn)if(d===null)p.componentDidMount();else{var _=s.elementType===s.type?d.memoizedProps:ts(s.type,d.memoizedProps);p.componentDidUpdate(_,d.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var C=s.updateQueue;C!==null&&i0(s,C,p);break;case 3:var j=s.updateQueue;if(j!==null){if(d=null,s.child!==null)switch(s.child.tag){case 5:d=s.child.stateNode;break;case 1:d=s.child.stateNode}i0(s,j,d)}break;case 5:var W=s.stateNode;if(d===null&&s.flags&4){d=W;var G=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":G.autoFocus&&d.focus();break;case"img":G.src&&(d.src=G.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var le=s.alternate;if(le!==null){var _e=le.memoizedState;if(_e!==null){var Ie=_e.dehydrated;Ie!==null&&Zn(Ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}fn||s.flags&512&&wu(s)}catch(ve){Ir(s,s.return,ve)}}if(s===t){Qe=null;break}if(d=s.sibling,d!==null){d.return=s.return,Qe=d;break}Qe=s.return}}function ih(t){for(;Qe!==null;){var s=Qe;if(s===t){Qe=null;break}var d=s.sibling;if(d!==null){d.return=s.return,Qe=d;break}Qe=s.return}}function ah(t){for(;Qe!==null;){var s=Qe;try{switch(s.tag){case 0:case 11:case 15:var d=s.return;try{jl(4,s)}catch(G){Ir(s,d,G)}break;case 1:var p=s.stateNode;if(typeof p.componentDidMount=="function"){var _=s.return;try{p.componentDidMount()}catch(G){Ir(s,_,G)}}var C=s.return;try{wu(s)}catch(G){Ir(s,C,G)}break;case 5:var j=s.return;try{wu(s)}catch(G){Ir(s,j,G)}}}catch(G){Ir(s,s.return,G)}if(s===t){Qe=null;break}var W=s.sibling;if(W!==null){W.return=s.return,Qe=W;break}Qe=s.return}}var Ig=Math.ceil,Rl=Y.ReactCurrentDispatcher,_u=Y.ReactCurrentOwner,$n=Y.ReactCurrentBatchConfig,Ht=0,Yr=null,Pr=null,an=0,Dn=0,ma=Ks(0),Vr=0,vo=null,ji=0,Ol=0,Nu=0,bo=null,_n=null,Eu=0,pa=1/0,js=null,Dl=!1,Cu=null,ti=null,Ml=!1,ri=null,Pl=0,_o=0,Su=null,Ll=-1,Bl=0;function mn(){return(Ht&6)!==0?Kt():Ll!==-1?Ll:Ll=Kt()}function ni(t){return(t.mode&1)===0?1:(Ht&2)!==0&&an!==0?an&-an:hg.transition!==null?(Bl===0&&(Bl=Br()),Bl):(t=wt,t!==0||(t=window.event,t=t===void 0?16:qa(t.type)),t)}function ss(t,s,d,p){if(50<_o)throw _o=0,Su=null,Error(o(185));M(t,d,p),((Ht&2)===0||t!==Yr)&&(t===Yr&&((Ht&2)===0&&(Ol|=d),Vr===4&&si(t,an)),Nn(t,p),d===1&&Ht===0&&(s.mode&1)===0&&(pa=Kt()+500,hl&&Zs()))}function Nn(t,s){var d=t.callbackNode;Bs(t,s);var p=kn(t,t===Yr?an:0);if(p===0)d!==null&&tr(d),t.callbackNode=null,t.callbackPriority=0;else if(s=p&-p,t.callbackPriority!==s){if(d!=null&&tr(d),s===1)t.tag===0?dg(lh.bind(null,t)):Xd(lh.bind(null,t)),og(function(){(Ht&6)===0&&Zs()}),d=null;else{switch(Xo(p)){case 1:d=pe;break;case 4:d=Go;break;case 16:d=ir;break;case 536870912:d=$o;break;default:d=ir}d=mh(d,oh.bind(null,t))}t.callbackPriority=s,t.callbackNode=d}}function oh(t,s){if(Ll=-1,Bl=0,(Ht&6)!==0)throw Error(o(327));var d=t.callbackNode;if(ya()&&t.callbackNode!==d)return null;var p=kn(t,t===Yr?an:0);if(p===0)return null;if((p&30)!==0||(p&t.expiredLanes)!==0||s)s=Fl(t,p);else{s=p;var _=Ht;Ht|=2;var C=uh();(Yr!==t||an!==s)&&(js=null,pa=Kt()+500,Oi(t,s));do try{Rg();break}catch(W){ch(t,W)}while(!0);Hc(),Rl.current=C,Ht=_,Pr!==null?s=0:(Yr=null,an=0,s=Vr)}if(s!==0){if(s===2&&(_=Yt(t),_!==0&&(p=_,s=Au(t,_))),s===1)throw d=vo,Oi(t,0),si(t,p),Nn(t,Kt()),d;if(s===6)si(t,p);else{if(_=t.current.alternate,(p&30)===0&&!Tg(_)&&(s=Fl(t,p),s===2&&(C=Yt(t),C!==0&&(p=C,s=Au(t,C))),s===1))throw d=vo,Oi(t,0),si(t,p),Nn(t,Kt()),d;switch(t.finishedWork=_,t.finishedLanes=p,s){case 0:case 1:throw Error(o(345));case 2:Di(t,_n,js);break;case 3:if(si(t,p),(p&130023424)===p&&(s=Eu+500-Kt(),10<s)){if(kn(t,0)!==0)break;if(_=t.suspendedLanes,(_&p)!==p){mn(),t.pingedLanes|=t.suspendedLanes&_;break}t.timeoutHandle=Oc(Di.bind(null,t,_n,js),s);break}Di(t,_n,js);break;case 4:if(si(t,p),(p&4194240)===p)break;for(s=t.eventTimes,_=-1;0<p;){var j=31-gn(p);C=1<<j,j=s[j],j>_&&(_=j),p&=~C}if(p=_,p=Kt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*Ig(p/1960))-p,10<p){t.timeoutHandle=Oc(Di.bind(null,t,_n,js),p);break}Di(t,_n,js);break;case 5:Di(t,_n,js);break;default:throw Error(o(329))}}}return Nn(t,Kt()),t.callbackNode===d?oh.bind(null,t):null}function Au(t,s){var d=bo;return t.current.memoizedState.isDehydrated&&(Oi(t,s).flags|=256),t=Fl(t,s),t!==2&&(s=_n,_n=d,s!==null&&ku(s)),t}function ku(t){_n===null?_n=t:_n.push.apply(_n,t)}function Tg(t){for(var s=t;;){if(s.flags&16384){var d=s.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var p=0;p<d.length;p++){var _=d[p],C=_.getSnapshot;_=_.value;try{if(!Q(C(),_))return!1}catch{return!1}}}if(d=s.child,s.subtreeFlags&16384&&d!==null)d.return=s,s=d;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function si(t,s){for(s&=~Nu,s&=~Ol,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var d=31-gn(s),p=1<<d;t[d]=-1,s&=~p}}function lh(t){if((Ht&6)!==0)throw Error(o(327));ya();var s=kn(t,0);if((s&1)===0)return Nn(t,Kt()),null;var d=Fl(t,s);if(t.tag!==0&&d===2){var p=Yt(t);p!==0&&(s=p,d=Au(t,p))}if(d===1)throw d=vo,Oi(t,0),si(t,s),Nn(t,Kt()),d;if(d===6)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,Di(t,_n,js),Nn(t,Kt()),null}function Iu(t,s){var d=Ht;Ht|=1;try{return t(s)}finally{Ht=d,Ht===0&&(pa=Kt()+500,hl&&Zs())}}function Ri(t){ri!==null&&ri.tag===0&&(Ht&6)===0&&ya();var s=Ht;Ht|=1;var d=$n.transition,p=wt;try{if($n.transition=null,wt=1,t)return t()}finally{wt=p,$n.transition=d,Ht=s,(Ht&6)===0&&Zs()}}function Tu(){Dn=ma.current,gr(ma)}function Oi(t,s){t.finishedWork=null,t.finishedLanes=0;var d=t.timeoutHandle;if(d!==-1&&(t.timeoutHandle=-1,ag(d)),Pr!==null)for(d=Pr.return;d!==null;){var p=d;switch(Fc(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&ul();break;case 3:fa(),gr(wn),gr(un),Qc();break;case 5:Yc(p);break;case 4:fa();break;case 13:gr(_r);break;case 19:gr(_r);break;case 10:Gc(p.type._context);break;case 22:case 23:Tu()}d=d.return}if(Yr=t,Pr=t=ii(t.current,null),an=Dn=s,Vr=0,vo=null,Nu=Ol=ji=0,_n=bo=null,ki!==null){for(s=0;s<ki.length;s++)if(d=ki[s],p=d.interleaved,p!==null){d.interleaved=null;var _=p.next,C=d.pending;if(C!==null){var j=C.next;C.next=_,p.next=j}d.pending=p}ki=null}return t}function ch(t,s){do{var d=Pr;try{if(Hc(),_l.current=Sl,Nl){for(var p=Nr.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}Nl=!1}if(Ti=0,Kr=zr=Nr=null,go=!1,xo=0,_u.current=null,d===null||d.return===null){Vr=1,vo=s,Pr=null;break}e:{var C=t,j=d.return,W=d,G=s;if(s=an,W.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var le=G,_e=W,Ie=_e.tag;if((_e.mode&1)===0&&(Ie===0||Ie===11||Ie===15)){var ve=_e.alternate;ve?(_e.updateQueue=ve.updateQueue,_e.memoizedState=ve.memoizedState,_e.lanes=ve.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var qe=D0(j);if(qe!==null){qe.flags&=-257,M0(qe,j,W,C,s),qe.mode&1&&O0(C,le,s),s=qe,G=le;var Je=s.updateQueue;if(Je===null){var et=new Set;et.add(G),s.updateQueue=et}else Je.add(G);break e}else{if((s&1)===0){O0(C,le,s),ju();break e}G=Error(o(426))}}else if(wr&&W.mode&1){var Mr=D0(j);if(Mr!==null){(Mr.flags&65536)===0&&(Mr.flags|=256),M0(Mr,j,W,C,s),zc(ga(G,W));break e}}C=G=ga(G,W),Vr!==4&&(Vr=2),bo===null?bo=[C]:bo.push(C),C=j;do{switch(C.tag){case 3:C.flags|=65536,s&=-s,C.lanes|=s;var ee=j0(C,G,s);s0(C,ee);break e;case 1:W=G;var K=C.type,se=C.stateNode;if((C.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(ti===null||!ti.has(se)))){C.flags|=65536,s&=-s,C.lanes|=s;var De=R0(C,W,s);s0(C,De);break e}}C=C.return}while(C!==null)}hh(d)}catch(tt){s=tt,Pr===d&&d!==null&&(Pr=d=d.return);continue}break}while(!0)}function uh(){var t=Rl.current;return Rl.current=Sl,t===null?Sl:t}function ju(){(Vr===0||Vr===3||Vr===2)&&(Vr=4),Yr===null||(ji&268435455)===0&&(Ol&268435455)===0||si(Yr,an)}function Fl(t,s){var d=Ht;Ht|=2;var p=uh();(Yr!==t||an!==s)&&(js=null,Oi(t,s));do try{jg();break}catch(_){ch(t,_)}while(!0);if(Hc(),Ht=d,Rl.current=p,Pr!==null)throw Error(o(261));return Yr=null,an=0,Vr}function jg(){for(;Pr!==null;)dh(Pr)}function Rg(){for(;Pr!==null&&!$t();)dh(Pr)}function dh(t){var s=xh(t.alternate,t,Dn);t.memoizedProps=t.pendingProps,s===null?hh(t):Pr=s,_u.current=null}function hh(t){var s=t;do{var d=s.alternate;if(t=s.return,(s.flags&32768)===0){if(d=Eg(d,s,Dn),d!==null){Pr=d;return}}else{if(d=Cg(d,s),d!==null){d.flags&=32767,Pr=d;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Vr=6,Pr=null;return}}if(s=s.sibling,s!==null){Pr=s;return}Pr=s=t}while(s!==null);Vr===0&&(Vr=5)}function Di(t,s,d){var p=wt,_=$n.transition;try{$n.transition=null,wt=1,Og(t,s,d,p)}finally{$n.transition=_,wt=p}return null}function Og(t,s,d,p){do ya();while(ri!==null);if((Ht&6)!==0)throw Error(o(327));d=t.finishedWork;var _=t.finishedLanes;if(d===null)return null;if(t.finishedWork=null,t.finishedLanes=0,d===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var C=d.lanes|d.childLanes;if(rt(t,C),t===Yr&&(Pr=Yr=null,an=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Ml||(Ml=!0,mh(ir,function(){return ya(),null})),C=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||C){C=$n.transition,$n.transition=null;var j=wt;wt=1;var W=Ht;Ht|=4,_u.current=null,Ag(t,d),rh(d,t),cn(jc),us=!!Tc,jc=Tc=null,t.current=d,kg(d),Ho(),Ht=W,wt=j,$n.transition=C}else t.current=d;if(Ml&&(Ml=!1,ri=t,Pl=_),C=t.pendingLanes,C===0&&(ti=null),Tt(d.stateNode),Nn(t,Kt()),s!==null)for(p=t.onRecoverableError,d=0;d<s.length;d++)_=s[d],p(_.value,{componentStack:_.stack,digest:_.digest});if(Dl)throw Dl=!1,t=Cu,Cu=null,t;return(Pl&1)!==0&&t.tag!==0&&ya(),C=t.pendingLanes,(C&1)!==0?t===Su?_o++:(_o=0,Su=t):_o=0,Zs(),null}function ya(){if(ri!==null){var t=Xo(Pl),s=$n.transition,d=wt;try{if($n.transition=null,wt=16>t?16:t,ri===null)var p=!1;else{if(t=ri,ri=null,Pl=0,(Ht&6)!==0)throw Error(o(331));var _=Ht;for(Ht|=4,Qe=t.current;Qe!==null;){var C=Qe,j=C.child;if((Qe.flags&16)!==0){var W=C.deletions;if(W!==null){for(var G=0;G<W.length;G++){var le=W[G];for(Qe=le;Qe!==null;){var _e=Qe;switch(_e.tag){case 0:case 11:case 15:wo(8,_e,C)}var Ie=_e.child;if(Ie!==null)Ie.return=_e,Qe=Ie;else for(;Qe!==null;){_e=Qe;var ve=_e.sibling,qe=_e.return;if(Z0(_e),_e===le){Qe=null;break}if(ve!==null){ve.return=qe,Qe=ve;break}Qe=qe}}}var Je=C.alternate;if(Je!==null){var et=Je.child;if(et!==null){Je.child=null;do{var Mr=et.sibling;et.sibling=null,et=Mr}while(et!==null)}}Qe=C}}if((C.subtreeFlags&2064)!==0&&j!==null)j.return=C,Qe=j;else e:for(;Qe!==null;){if(C=Qe,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:wo(9,C,C.return)}var ee=C.sibling;if(ee!==null){ee.return=C.return,Qe=ee;break e}Qe=C.return}}var K=t.current;for(Qe=K;Qe!==null;){j=Qe;var se=j.child;if((j.subtreeFlags&2064)!==0&&se!==null)se.return=j,Qe=se;else e:for(j=K;Qe!==null;){if(W=Qe,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:jl(9,W)}}catch(tt){Ir(W,W.return,tt)}if(W===j){Qe=null;break e}var De=W.sibling;if(De!==null){De.return=W.return,Qe=De;break e}Qe=W.return}}if(Ht=_,Zs(),yt&&typeof yt.onPostCommitFiberRoot=="function")try{yt.onPostCommitFiberRoot(Bt,t)}catch{}p=!0}return p}finally{wt=d,$n.transition=s}}return!1}function fh(t,s,d){s=ga(d,s),s=j0(t,s,1),t=Js(t,s,1),s=mn(),t!==null&&(M(t,1,s),Nn(t,s))}function Ir(t,s,d){if(t.tag===3)fh(t,t,d);else for(;s!==null;){if(s.tag===3){fh(s,t,d);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(ti===null||!ti.has(p))){t=ga(d,t),t=R0(s,t,1),s=Js(s,t,1),t=mn(),s!==null&&(M(s,1,t),Nn(s,t));break}}s=s.return}}function Dg(t,s,d){var p=t.pingCache;p!==null&&p.delete(s),s=mn(),t.pingedLanes|=t.suspendedLanes&d,Yr===t&&(an&d)===d&&(Vr===4||Vr===3&&(an&130023424)===an&&500>Kt()-Eu?Oi(t,0):Nu|=d),Nn(t,s)}function gh(t,s){s===0&&((t.mode&1)===0?s=1:(s=qi,qi<<=1,(qi&130023424)===0&&(qi=4194304)));var d=mn();t=ks(t,s),t!==null&&(M(t,s,d),Nn(t,d))}function Mg(t){var s=t.memoizedState,d=0;s!==null&&(d=s.retryLane),gh(t,d)}function Pg(t,s){var d=0;switch(t.tag){case 13:var p=t.stateNode,_=t.memoizedState;_!==null&&(d=_.retryLane);break;case 19:p=t.stateNode;break;default:throw Error(o(314))}p!==null&&p.delete(s),gh(t,d)}var xh;xh=function(t,s,d){if(t!==null)if(t.memoizedProps!==s.pendingProps||wn.current)bn=!0;else{if((t.lanes&d)===0&&(s.flags&128)===0)return bn=!1,Ng(t,s,d);bn=(t.flags&131072)!==0}else bn=!1,wr&&(s.flags&1048576)!==0&&qd(s,gl,s.index);switch(s.lanes=0,s.tag){case 2:var p=s.type;Il(t,s),t=s.pendingProps;var _=aa(s,un.current);ha(s,d),_=tu(null,s,p,t,_,d);var C=ru();return s.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,vn(p)?(C=!0,dl(s)):C=!1,s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,qc(s),_.updater=Al,s.stateNode=_,_._reactInternals=s,lu(s,p,t,d),s=hu(null,s,p,!0,C,d)):(s.tag=0,wr&&C&&Bc(s),xn(null,s,_,d),s=s.child),s;case 16:p=s.elementType;e:{switch(Il(t,s),t=s.pendingProps,_=p._init,p=_(p._payload),s.type=p,_=s.tag=Bg(p),t=ts(p,t),_){case 0:s=du(null,s,p,t,d);break e;case 1:s=W0(null,s,p,t,d);break e;case 11:s=P0(null,s,p,t,d);break e;case 14:s=L0(null,s,p,ts(p.type,t),d);break e}throw Error(o(306,p,""))}return s;case 0:return p=s.type,_=s.pendingProps,_=s.elementType===p?_:ts(p,_),du(t,s,p,_,d);case 1:return p=s.type,_=s.pendingProps,_=s.elementType===p?_:ts(p,_),W0(t,s,p,_,d);case 3:e:{if(z0(s),t===null)throw Error(o(387));p=s.pendingProps,C=s.memoizedState,_=C.element,n0(t,s),vl(s,p,null,d);var j=s.memoizedState;if(p=j.element,C.isDehydrated)if(C={element:p,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},s.updateQueue.baseState=C,s.memoizedState=C,s.flags&256){_=ga(Error(o(423)),s),s=V0(t,s,p,d,_);break e}else if(p!==_){_=ga(Error(o(424)),s),s=V0(t,s,p,d,_);break e}else for(On=qs(s.stateNode.containerInfo.firstChild),Rn=s,wr=!0,es=null,d=t0(s,null,p,d),s.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(ca(),p===_){s=Ts(t,s,d);break e}xn(t,s,p,d)}s=s.child}return s;case 5:return a0(s),t===null&&Wc(s),p=s.type,_=s.pendingProps,C=t!==null?t.memoizedProps:null,j=_.children,Rc(p,_)?j=null:C!==null&&Rc(p,C)&&(s.flags|=32),U0(t,s),xn(t,s,j,d),s.child;case 6:return t===null&&Wc(s),null;case 13:return H0(t,s,d);case 4:return Kc(s,s.stateNode.containerInfo),p=s.pendingProps,t===null?s.child=ua(s,null,p,d):xn(t,s,p,d),s.child;case 11:return p=s.type,_=s.pendingProps,_=s.elementType===p?_:ts(p,_),P0(t,s,p,_,d);case 7:return xn(t,s,s.pendingProps,d),s.child;case 8:return xn(t,s,s.pendingProps.children,d),s.child;case 12:return xn(t,s,s.pendingProps.children,d),s.child;case 10:e:{if(p=s.type._context,_=s.pendingProps,C=s.memoizedProps,j=_.value,ur(pl,p._currentValue),p._currentValue=j,C!==null)if(Q(C.value,j)){if(C.children===_.children&&!wn.current){s=Ts(t,s,d);break e}}else for(C=s.child,C!==null&&(C.return=s);C!==null;){var W=C.dependencies;if(W!==null){j=C.child;for(var G=W.firstContext;G!==null;){if(G.context===p){if(C.tag===1){G=Is(-1,d&-d),G.tag=2;var le=C.updateQueue;if(le!==null){le=le.shared;var _e=le.pending;_e===null?G.next=G:(G.next=_e.next,_e.next=G),le.pending=G}}C.lanes|=d,G=C.alternate,G!==null&&(G.lanes|=d),$c(C.return,d,s),W.lanes|=d;break}G=G.next}}else if(C.tag===10)j=C.type===s.type?null:C.child;else if(C.tag===18){if(j=C.return,j===null)throw Error(o(341));j.lanes|=d,W=j.alternate,W!==null&&(W.lanes|=d),$c(j,d,s),j=C.sibling}else j=C.child;if(j!==null)j.return=C;else for(j=C;j!==null;){if(j===s){j=null;break}if(C=j.sibling,C!==null){C.return=j.return,j=C;break}j=j.return}C=j}xn(t,s,_.children,d),s=s.child}return s;case 9:return _=s.type,p=s.pendingProps.children,ha(s,d),_=Hn(_),p=p(_),s.flags|=1,xn(t,s,p,d),s.child;case 14:return p=s.type,_=ts(p,s.pendingProps),_=ts(p.type,_),L0(t,s,p,_,d);case 15:return B0(t,s,s.type,s.pendingProps,d);case 17:return p=s.type,_=s.pendingProps,_=s.elementType===p?_:ts(p,_),Il(t,s),s.tag=1,vn(p)?(t=!0,dl(s)):t=!1,ha(s,d),I0(s,p,_),lu(s,p,_,d),hu(null,s,p,!0,t,d);case 19:return $0(t,s,d);case 22:return F0(t,s,d)}throw Error(o(156,s.tag))};function mh(t,s){return Lr(t,s)}function Lg(t,s,d,p){this.tag=t,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xn(t,s,d,p){return new Lg(t,s,d,p)}function Ru(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Bg(t){if(typeof t=="function")return Ru(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xe)return 11;if(t===X)return 14}return 2}function ii(t,s){var d=t.alternate;return d===null?(d=Xn(t.tag,s,t.key,t.mode),d.elementType=t.elementType,d.type=t.type,d.stateNode=t.stateNode,d.alternate=t,t.alternate=d):(d.pendingProps=s,d.type=t.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=t.flags&14680064,d.childLanes=t.childLanes,d.lanes=t.lanes,d.child=t.child,d.memoizedProps=t.memoizedProps,d.memoizedState=t.memoizedState,d.updateQueue=t.updateQueue,s=t.dependencies,d.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},d.sibling=t.sibling,d.index=t.index,d.ref=t.ref,d}function Ul(t,s,d,p,_,C){var j=2;if(p=t,typeof t=="function")Ru(t)&&(j=1);else if(typeof t=="string")j=5;else e:switch(t){case q:return Mi(d.children,_,C,s);case Ne:j=8,_|=8;break;case Z:return t=Xn(12,d,s,_|2),t.elementType=Z,t.lanes=C,t;case Ve:return t=Xn(13,d,s,_),t.elementType=Ve,t.lanes=C,t;case Fe:return t=Xn(19,d,s,_),t.elementType=Fe,t.lanes=C,t;case Ce:return Wl(d,_,C,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ke:j=10;break e;case ge:j=9;break e;case xe:j=11;break e;case X:j=14;break e;case Ge:j=16,p=null;break e}throw Error(o(130,t==null?t:typeof t,""))}return s=Xn(j,d,s,_),s.elementType=t,s.type=p,s.lanes=C,s}function Mi(t,s,d,p){return t=Xn(7,t,p,s),t.lanes=d,t}function Wl(t,s,d,p){return t=Xn(22,t,p,s),t.elementType=Ce,t.lanes=d,t.stateNode={isHidden:!1},t}function Ou(t,s,d){return t=Xn(6,t,null,s),t.lanes=d,t}function Du(t,s,d){return s=Xn(4,t.children!==null?t.children:[],t.key,s),s.lanes=d,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function Fg(t,s,d,p,_){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=J(0),this.expirationTimes=J(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=J(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Mu(t,s,d,p,_,C,j,W,G){return t=new Fg(t,s,d,W,G),s===1?(s=1,C===!0&&(s|=8)):s=0,C=Xn(3,null,null,s),t.current=C,C.stateNode=t,C.memoizedState={element:p,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},qc(C),t}function Ug(t,s,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ce,key:p==null?null:""+p,children:t,containerInfo:s,implementation:d}}function ph(t){if(!t)return Ys;t=t._reactInternals;e:{if(Gt(t)!==t||t.tag!==1)throw Error(o(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(vn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(o(171))}if(t.tag===1){var d=t.type;if(vn(d))return Gd(t,d,s)}return s}function yh(t,s,d,p,_,C,j,W,G){return t=Mu(d,p,!0,t,_,C,j,W,G),t.context=ph(null),d=t.current,p=mn(),_=ni(d),C=Is(p,_),C.callback=s??null,Js(d,C,_),t.current.lanes=_,M(t,_,p),Nn(t,p),t}function zl(t,s,d,p){var _=s.current,C=mn(),j=ni(_);return d=ph(d),s.context===null?s.context=d:s.pendingContext=d,s=Is(C,j),s.payload={element:t},p=p===void 0?null:p,p!==null&&(s.callback=p),t=Js(_,s,j),t!==null&&(ss(t,_,j,C),wl(t,_,j)),j}function Vl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wh(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var d=t.retryLane;t.retryLane=d!==0&&d<s?d:s}}function Pu(t,s){wh(t,s),(t=t.alternate)&&wh(t,s)}function Wg(){return null}var vh=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lu(t){this._internalRoot=t}Hl.prototype.render=Lu.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(o(409));zl(t,s,null,null)},Hl.prototype.unmount=Lu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;Ri(function(){zl(null,t,null,null)}),s[Es]=null}};function Hl(t){this._internalRoot=t}Hl.prototype.unstable_scheduleHydration=function(t){if(t){var s=lr();t={blockedOn:null,target:t,priority:s};for(var d=0;d<tn.length&&s!==0&&s<tn[d].priority;d++);tn.splice(d,0,t),d===0&&Ko(t)}};function Bu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Gl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bh(){}function zg(t,s,d,p,_){if(_){if(typeof p=="function"){var C=p;p=function(){var le=Vl(j);C.call(le)}}var j=yh(s,p,t,0,null,!1,!1,"",bh);return t._reactRootContainer=j,t[Es]=j.current,io(t.nodeType===8?t.parentNode:t),Ri(),j}for(;_=t.lastChild;)t.removeChild(_);if(typeof p=="function"){var W=p;p=function(){var le=Vl(G);W.call(le)}}var G=Mu(t,0,!1,null,null,!1,!1,"",bh);return t._reactRootContainer=G,t[Es]=G.current,io(t.nodeType===8?t.parentNode:t),Ri(function(){zl(s,G,d,p)}),G}function $l(t,s,d,p,_){var C=d._reactRootContainer;if(C){var j=C;if(typeof _=="function"){var W=_;_=function(){var G=Vl(j);W.call(G)}}zl(s,j,t,_)}else j=zg(d,s,t,_,p);return Vl(j)}Ki=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var d=ar(s.pendingLanes);d!==0&&(Ar(s,d|1),Nn(s,Kt()),(Ht&6)===0&&(pa=Kt()+500,Zs()))}break;case 13:Ri(function(){var p=ks(t,1);if(p!==null){var _=mn();ss(p,t,1,_)}}),Pu(t,1)}},ln=function(t){if(t.tag===13){var s=ks(t,134217728);if(s!==null){var d=mn();ss(s,t,134217728,d)}Pu(t,134217728)}},st=function(t){if(t.tag===13){var s=ni(t),d=ks(t,s);if(d!==null){var p=mn();ss(d,t,s,p)}Pu(t,s)}},lr=function(){return wt},Ga=function(t,s){var d=wt;try{return wt=t,s()}finally{wt=d}},Kn=function(t,s,d){switch(s){case"input":if(ze(t,d),s=d.name,d.type==="radio"&&s!=null){for(d=t;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<d.length;s++){var p=d[s];if(p!==t&&p.form===t.form){var _=cl(p);if(!_)throw Error(o(90));Oe(p),ze(p,_)}}}break;case"textarea":Dt(t,d);break;case"select":s=d.value,s!=null&&Ee(t,!!d.multiple,s,!1)}},Me=Iu,kt=Ri;var Vg={usingClientEntryPoint:!1,Events:[lo,sa,cl,Se,Le,Iu]},No={findFiberByHostInstance:Ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Hg={bundleType:No.bundleType,version:No.version,rendererPackageName:No.rendererPackageName,rendererConfig:No.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Y.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Sr(t),t===null?null:t.stateNode},findFiberByHostInstance:No.findFiberByHostInstance||Wg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xl.isDisabled&&Xl.supportsFiber)try{Bt=Xl.inject(Hg),yt=Xl}catch{}}return En.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vg,En.createPortal=function(t,s){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bu(s))throw Error(o(200));return Ug(t,s,null,d)},En.createRoot=function(t,s){if(!Bu(t))throw Error(o(299));var d=!1,p="",_=vh;return s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),s=Mu(t,1,!1,null,null,d,!1,p,_),t[Es]=s.current,io(t.nodeType===8?t.parentNode:t),new Lu(s)},En.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(o(188)):(t=Object.keys(t).join(","),Error(o(268,t)));return t=Sr(s),t=t===null?null:t.stateNode,t},En.flushSync=function(t){return Ri(t)},En.hydrate=function(t,s,d){if(!Gl(s))throw Error(o(200));return $l(null,t,s,!0,d)},En.hydrateRoot=function(t,s,d){if(!Bu(t))throw Error(o(405));var p=d!=null&&d.hydratedSources||null,_=!1,C="",j=vh;if(d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(C=d.identifierPrefix),d.onRecoverableError!==void 0&&(j=d.onRecoverableError)),s=yh(s,null,t,1,d??null,_,!1,C,j),t[Es]=s.current,io(t),p)for(t=0;t<p.length;t++)d=p[t],_=d._getVersion,_=_(d._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[d,_]:s.mutableSourceEagerHydrationData.push(d,_);return new Hl(s)},En.render=function(t,s,d){if(!Gl(s))throw Error(o(200));return $l(null,t,s,!1,d)},En.unmountComponentAtNode=function(t){if(!Gl(t))throw Error(o(40));return t._reactRootContainer?(Ri(function(){$l(null,null,t,!1,function(){t._reactRootContainer=null,t[Es]=null})}),!0):!1},En.unstable_batchedUpdates=Iu,En.unstable_renderSubtreeIntoContainer=function(t,s,d,p){if(!Gl(d))throw Error(o(200));if(t==null||t._reactInternals===void 0)throw Error(o(38));return $l(t,s,d,!1,p)},En.version="18.3.1-next-f1338f8080-20240426",En}var Ih;function Rf(){if(Ih)return Wu.exports;Ih=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(i){console.error(i)}}return h(),Wu.exports=Jg(),Wu.exports}var Th;function ex(){if(Th)return Kl;Th=1;var h=Rf();return Kl.createRoot=h.createRoot,Kl.hydrateRoot=h.hydrateRoot,Kl}var tx=ex();const rx=uc(tx);Rf();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oo(){return Oo=Object.assign?Object.assign.bind():function(h){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(h[f]=o[f])}return h},Oo.apply(this,arguments)}var ui;(function(h){h.Pop="POP",h.Push="PUSH",h.Replace="REPLACE"})(ui||(ui={}));const jh="popstate";function nx(h){h===void 0&&(h={});function i(f,x){let{pathname:m,search:w,hash:S}=f.location;return Qu("",{pathname:m,search:w,hash:S},x.state&&x.state.usr||null,x.state&&x.state.key||"default")}function o(f,x){return typeof x=="string"?x:Df(x)}return ix(i,o,null,h)}function Gr(h,i){if(h===!1||h===null||typeof h>"u")throw new Error(i)}function Of(h,i){if(!h){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function sx(){return Math.random().toString(36).substr(2,8)}function Rh(h,i){return{usr:h.state,key:h.key,idx:i}}function Qu(h,i,o,f){return o===void 0&&(o=null),Oo({pathname:typeof h=="string"?h:h.pathname,search:"",hash:""},typeof i=="string"?La(i):i,{state:o,key:i&&i.key||f||sx()})}function Df(h){let{pathname:i="/",search:o="",hash:f=""}=h;return o&&o!=="?"&&(i+=o.charAt(0)==="?"?o:"?"+o),f&&f!=="#"&&(i+=f.charAt(0)==="#"?f:"#"+f),i}function La(h){let i={};if(h){let o=h.indexOf("#");o>=0&&(i.hash=h.substr(o),h=h.substr(0,o));let f=h.indexOf("?");f>=0&&(i.search=h.substr(f),h=h.substr(0,f)),h&&(i.pathname=h)}return i}function ix(h,i,o,f){f===void 0&&(f={});let{window:x=document.defaultView,v5Compat:m=!1}=f,w=x.history,S=ui.Pop,N=null,b=E();b==null&&(b=0,w.replaceState(Oo({},w.state,{idx:b}),""));function E(){return(w.state||{idx:null}).idx}function A(){S=ui.Pop;let U=E(),ie=U==null?null:U-b;b=U,N&&N({action:S,location:F.location,delta:ie})}function O(U,ie){S=ui.Push;let re=Qu(F.location,U,ie);b=E()+1;let L=Rh(re,b),Y=F.createHref(re);try{w.pushState(L,"",Y)}catch(ne){if(ne instanceof DOMException&&ne.name==="DataCloneError")throw ne;x.location.assign(Y)}m&&N&&N({action:S,location:F.location,delta:1})}function D(U,ie){S=ui.Replace;let re=Qu(F.location,U,ie);b=E();let L=Rh(re,b),Y=F.createHref(re);w.replaceState(L,"",Y),m&&N&&N({action:S,location:F.location,delta:0})}function z(U){let ie=x.location.origin!=="null"?x.location.origin:x.location.href,re=typeof U=="string"?U:Df(U);return re=re.replace(/ $/,"%20"),Gr(ie,"No window.location.(origin|href) available to create URL for href: "+re),new URL(re,ie)}let F={get action(){return S},get location(){return h(x,w)},listen(U){if(N)throw new Error("A history only accepts one active listener");return x.addEventListener(jh,A),N=U,()=>{x.removeEventListener(jh,A),N=null}},createHref(U){return i(x,U)},createURL:z,encodeLocation(U){let ie=z(U);return{pathname:ie.pathname,search:ie.search,hash:ie.hash}},push:O,replace:D,go(U){return w.go(U)}};return F}var Oh;(function(h){h.data="data",h.deferred="deferred",h.redirect="redirect",h.error="error"})(Oh||(Oh={}));function ax(h,i,o){return o===void 0&&(o="/"),ox(h,i,o)}function ox(h,i,o,f){let x=typeof i=="string"?La(i):i,m=Lf(x.pathname||"/",o);if(m==null)return null;let w=Mf(h);lx(w);let S=null;for(let N=0;S==null&&N<w.length;++N){let b=vx(m);S=px(w[N],b)}return S}function Mf(h,i,o,f){i===void 0&&(i=[]),o===void 0&&(o=[]),f===void 0&&(f="");let x=(m,w,S)=>{let N={relativePath:S===void 0?m.path||"":S,caseSensitive:m.caseSensitive===!0,childrenIndex:w,route:m};N.relativePath.startsWith("/")&&(Gr(N.relativePath.startsWith(f),'Absolute route path "'+N.relativePath+'" nested under path '+('"'+f+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),N.relativePath=N.relativePath.slice(f.length));let b=Ui([f,N.relativePath]),E=o.concat(N);m.children&&m.children.length>0&&(Gr(m.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),Mf(m.children,i,E,b)),!(m.path==null&&!m.index)&&i.push({path:b,score:xx(b,m.index),routesMeta:E})};return h.forEach((m,w)=>{var S;if(m.path===""||!((S=m.path)!=null&&S.includes("?")))x(m,w);else for(let N of Pf(m.path))x(m,w,N)}),i}function Pf(h){let i=h.split("/");if(i.length===0)return[];let[o,...f]=i,x=o.endsWith("?"),m=o.replace(/\?$/,"");if(f.length===0)return x?[m,""]:[m];let w=Pf(f.join("/")),S=[];return S.push(...w.map(N=>N===""?m:[m,N].join("/"))),x&&S.push(...w),S.map(N=>h.startsWith("/")&&N===""?"/":N)}function lx(h){h.sort((i,o)=>i.score!==o.score?o.score-i.score:mx(i.routesMeta.map(f=>f.childrenIndex),o.routesMeta.map(f=>f.childrenIndex)))}const cx=/^:[\w-]+$/,ux=3,dx=2,hx=1,fx=10,gx=-2,Dh=h=>h==="*";function xx(h,i){let o=h.split("/"),f=o.length;return o.some(Dh)&&(f+=gx),i&&(f+=dx),o.filter(x=>!Dh(x)).reduce((x,m)=>x+(cx.test(m)?ux:m===""?hx:fx),f)}function mx(h,i){return h.length===i.length&&h.slice(0,-1).every((f,x)=>f===i[x])?h[h.length-1]-i[i.length-1]:0}function px(h,i,o){let{routesMeta:f}=h,x={},m="/",w=[];for(let S=0;S<f.length;++S){let N=f[S],b=S===f.length-1,E=m==="/"?i:i.slice(m.length)||"/",A=yx({path:N.relativePath,caseSensitive:N.caseSensitive,end:b},E),O=N.route;if(!A)return null;Object.assign(x,A.params),w.push({params:x,pathname:Ui([m,A.pathname]),pathnameBase:Sx(Ui([m,A.pathnameBase])),route:O}),A.pathnameBase!=="/"&&(m=Ui([m,A.pathnameBase]))}return w}function yx(h,i){typeof h=="string"&&(h={path:h,caseSensitive:!1,end:!0});let[o,f]=wx(h.path,h.caseSensitive,h.end),x=i.match(o);if(!x)return null;let m=x[0],w=m.replace(/(.)\/+$/,"$1"),S=x.slice(1);return{params:f.reduce((b,E,A)=>{let{paramName:O,isOptional:D}=E;if(O==="*"){let F=S[A]||"";w=m.slice(0,m.length-F.length).replace(/(.)\/+$/,"$1")}const z=S[A];return D&&!z?b[O]=void 0:b[O]=(z||"").replace(/%2F/g,"/"),b},{}),pathname:m,pathnameBase:w,pattern:h}}function wx(h,i,o){i===void 0&&(i=!1),o===void 0&&(o=!0),Of(h==="*"||!h.endsWith("*")||h.endsWith("/*"),'Route path "'+h+'" will be treated as if it were '+('"'+h.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+h.replace(/\*$/,"/*")+'".'));let f=[],x="^"+h.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(w,S,N)=>(f.push({paramName:S,isOptional:N!=null}),N?"/?([^\\/]+)?":"/([^\\/]+)"));return h.endsWith("*")?(f.push({paramName:"*"}),x+=h==="*"||h==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?x+="\\/*$":h!==""&&h!=="/"&&(x+="(?:(?=\\/|$))"),[new RegExp(x,i?void 0:"i"),f]}function vx(h){try{return h.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return Of(!1,'The URL path "'+h+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),h}}function Lf(h,i){if(i==="/")return h;if(!h.toLowerCase().startsWith(i.toLowerCase()))return null;let o=i.endsWith("/")?i.length-1:i.length,f=h.charAt(o);return f&&f!=="/"?null:h.slice(o)||"/"}function bx(h,i){i===void 0&&(i="/");let{pathname:o,search:f="",hash:x=""}=typeof h=="string"?La(h):h;return{pathname:o?o.startsWith("/")?o:_x(o,i):i,search:Ax(f),hash:kx(x)}}function _x(h,i){let o=i.replace(/\/+$/,"").split("/");return h.split("/").forEach(x=>{x===".."?o.length>1&&o.pop():x!=="."&&o.push(x)}),o.length>1?o.join("/"):"/"}function Hu(h,i,o,f){return"Cannot include a '"+h+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(f)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Nx(h){return h.filter((i,o)=>o===0||i.route.path&&i.route.path.length>0)}function Ex(h,i){let o=Nx(h);return i?o.map((f,x)=>x===o.length-1?f.pathname:f.pathnameBase):o.map(f=>f.pathnameBase)}function Cx(h,i,o,f){f===void 0&&(f=!1);let x;typeof h=="string"?x=La(h):(x=Oo({},h),Gr(!x.pathname||!x.pathname.includes("?"),Hu("?","pathname","search",x)),Gr(!x.pathname||!x.pathname.includes("#"),Hu("#","pathname","hash",x)),Gr(!x.search||!x.search.includes("#"),Hu("#","search","hash",x)));let m=h===""||x.pathname==="",w=m?"/":x.pathname,S;if(w==null)S=o;else{let A=i.length-1;if(!f&&w.startsWith("..")){let O=w.split("/");for(;O[0]==="..";)O.shift(),A-=1;x.pathname=O.join("/")}S=A>=0?i[A]:"/"}let N=bx(x,S),b=w&&w!=="/"&&w.endsWith("/"),E=(m||w===".")&&o.endsWith("/");return!N.pathname.endsWith("/")&&(b||E)&&(N.pathname+="/"),N}const Ui=h=>h.join("/").replace(/\/\/+/g,"/"),Sx=h=>h.replace(/\/+$/,"").replace(/^\/*/,"/"),Ax=h=>!h||h==="?"?"":h.startsWith("?")?h:"?"+h,kx=h=>!h||h==="#"?"":h.startsWith("#")?h:"#"+h;function Ix(h){return h!=null&&typeof h.status=="number"&&typeof h.statusText=="string"&&typeof h.internal=="boolean"&&"data"in h}const Bf=["post","put","patch","delete"];new Set(Bf);const Tx=["get",...Bf];new Set(Tx);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Do(){return Do=Object.assign?Object.assign.bind():function(h){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(h[f]=o[f])}return h},Do.apply(this,arguments)}const xd=V.createContext(null),jx=V.createContext(null),dc=V.createContext(null),hc=V.createContext(null),$i=V.createContext({outlet:null,matches:[],isDataRoute:!1}),Ff=V.createContext(null);function fc(){return V.useContext(hc)!=null}function Uf(){return fc()||Gr(!1),V.useContext(hc).location}function Wf(h){V.useContext(dc).static||V.useLayoutEffect(h)}function ms(){let{isDataRoute:h}=V.useContext($i);return h?Gx():Rx()}function Rx(){fc()||Gr(!1);let h=V.useContext(xd),{basename:i,future:o,navigator:f}=V.useContext(dc),{matches:x}=V.useContext($i),{pathname:m}=Uf(),w=JSON.stringify(Ex(x,o.v7_relativeSplatPath)),S=V.useRef(!1);return Wf(()=>{S.current=!0}),V.useCallback(function(b,E){if(E===void 0&&(E={}),!S.current)return;if(typeof b=="number"){f.go(b);return}let A=Cx(b,JSON.parse(w),m,E.relative==="path");h==null&&i!=="/"&&(A.pathname=A.pathname==="/"?i:Ui([i,A.pathname])),(E.replace?f.replace:f.push)(A,E.state,E)},[i,f,w,m,h])}function Ox(){let{matches:h}=V.useContext($i),i=h[h.length-1];return i?i.params:{}}function Dx(h,i){return Mx(h,i)}function Mx(h,i,o,f){fc()||Gr(!1);let{navigator:x}=V.useContext(dc),{matches:m}=V.useContext($i),w=m[m.length-1],S=w?w.params:{};w&&w.pathname;let N=w?w.pathnameBase:"/";w&&w.route;let b=Uf(),E;if(i){var A;let U=typeof i=="string"?La(i):i;N==="/"||(A=U.pathname)!=null&&A.startsWith(N)||Gr(!1),E=U}else E=b;let O=E.pathname||"/",D=O;if(N!=="/"){let U=N.replace(/^\//,"").split("/");D="/"+O.replace(/^\//,"").split("/").slice(U.length).join("/")}let z=ax(h,{pathname:D}),F=Ux(z&&z.map(U=>Object.assign({},U,{params:Object.assign({},S,U.params),pathname:Ui([N,x.encodeLocation?x.encodeLocation(U.pathname).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?N:Ui([N,x.encodeLocation?x.encodeLocation(U.pathnameBase).pathname:U.pathnameBase])})),m,o,f);return i&&F?V.createElement(hc.Provider,{value:{location:Do({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:ui.Pop}},F):F}function Px(){let h=Hx(),i=Ix(h)?h.status+" "+h.statusText:h instanceof Error?h.message:JSON.stringify(h),o=h instanceof Error?h.stack:null,x={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},i),o?V.createElement("pre",{style:x},o):null,null)}const Lx=V.createElement(Px,null);class Bx extends V.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,o){return o.location!==i.location||o.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:o.error,location:o.location,revalidation:i.revalidation||o.revalidation}}componentDidCatch(i,o){console.error("React Router caught the following error during render",i,o)}render(){return this.state.error!==void 0?V.createElement($i.Provider,{value:this.props.routeContext},V.createElement(Ff.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Fx(h){let{routeContext:i,match:o,children:f}=h,x=V.useContext(xd);return x&&x.static&&x.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(x.staticContext._deepestRenderedBoundaryId=o.route.id),V.createElement($i.Provider,{value:i},f)}function Ux(h,i,o,f){var x;if(i===void 0&&(i=[]),o===void 0&&(o=null),f===void 0&&(f=null),h==null){var m;if(!o)return null;if(o.errors)h=o.matches;else if((m=f)!=null&&m.v7_partialHydration&&i.length===0&&!o.initialized&&o.matches.length>0)h=o.matches;else return null}let w=h,S=(x=o)==null?void 0:x.errors;if(S!=null){let E=w.findIndex(A=>A.route.id&&S?.[A.route.id]!==void 0);E>=0||Gr(!1),w=w.slice(0,Math.min(w.length,E+1))}let N=!1,b=-1;if(o&&f&&f.v7_partialHydration)for(let E=0;E<w.length;E++){let A=w[E];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(b=E),A.route.id){let{loaderData:O,errors:D}=o,z=A.route.loader&&O[A.route.id]===void 0&&(!D||D[A.route.id]===void 0);if(A.route.lazy||z){N=!0,b>=0?w=w.slice(0,b+1):w=[w[0]];break}}}return w.reduceRight((E,A,O)=>{let D,z=!1,F=null,U=null;o&&(D=S&&A.route.id?S[A.route.id]:void 0,F=A.route.errorElement||Lx,N&&(b<0&&O===0?($x("route-fallback"),z=!0,U=null):b===O&&(z=!0,U=A.route.hydrateFallbackElement||null)));let ie=i.concat(w.slice(0,O+1)),re=()=>{let L;return D?L=F:z?L=U:A.route.Component?L=V.createElement(A.route.Component,null):A.route.element?L=A.route.element:L=E,V.createElement(Fx,{match:A,routeContext:{outlet:E,matches:ie,isDataRoute:o!=null},children:L})};return o&&(A.route.ErrorBoundary||A.route.errorElement||O===0)?V.createElement(Bx,{location:o.location,revalidation:o.revalidation,component:F,error:D,children:re(),routeContext:{outlet:null,matches:ie,isDataRoute:!0}}):re()},null)}var zf=function(h){return h.UseBlocker="useBlocker",h.UseRevalidator="useRevalidator",h.UseNavigateStable="useNavigate",h}(zf||{}),Vf=function(h){return h.UseBlocker="useBlocker",h.UseLoaderData="useLoaderData",h.UseActionData="useActionData",h.UseRouteError="useRouteError",h.UseNavigation="useNavigation",h.UseRouteLoaderData="useRouteLoaderData",h.UseMatches="useMatches",h.UseRevalidator="useRevalidator",h.UseNavigateStable="useNavigate",h.UseRouteId="useRouteId",h}(Vf||{});function Wx(h){let i=V.useContext(xd);return i||Gr(!1),i}function zx(h){let i=V.useContext(jx);return i||Gr(!1),i}function Vx(h){let i=V.useContext($i);return i||Gr(!1),i}function Hf(h){let i=Vx(),o=i.matches[i.matches.length-1];return o.route.id||Gr(!1),o.route.id}function Hx(){var h;let i=V.useContext(Ff),o=zx(),f=Hf();return i!==void 0?i:(h=o.errors)==null?void 0:h[f]}function Gx(){let{router:h}=Wx(zf.UseNavigateStable),i=Hf(Vf.UseNavigateStable),o=V.useRef(!1);return Wf(()=>{o.current=!0}),V.useCallback(function(x,m){m===void 0&&(m={}),o.current&&(typeof x=="number"?h.navigate(x):h.navigate(x,Do({fromRouteId:i},m)))},[h,i])}const Mh={};function $x(h,i,o){Mh[h]||(Mh[h]=!0)}function Xx(h,i){h?.v7_startTransition,h?.v7_relativeSplatPath}function pn(h){Gr(!1)}function qx(h){let{basename:i="/",children:o=null,location:f,navigationType:x=ui.Pop,navigator:m,static:w=!1,future:S}=h;fc()&&Gr(!1);let N=i.replace(/^\/*/,"/"),b=V.useMemo(()=>({basename:N,navigator:m,static:w,future:Do({v7_relativeSplatPath:!1},S)}),[N,S,m,w]);typeof f=="string"&&(f=La(f));let{pathname:E="/",search:A="",hash:O="",state:D=null,key:z="default"}=f,F=V.useMemo(()=>{let U=Lf(E,N);return U==null?null:{location:{pathname:U,search:A,hash:O,state:D,key:z},navigationType:x}},[N,E,A,O,D,z,x]);return F==null?null:V.createElement(dc.Provider,{value:b},V.createElement(hc.Provider,{children:o,value:F}))}function Kx(h){let{children:i,location:o}=h;return Dx(Ju(i),o)}new Promise(()=>{});function Ju(h,i){i===void 0&&(i=[]);let o=[];return V.Children.forEach(h,(f,x)=>{if(!V.isValidElement(f))return;let m=[...i,x];if(f.type===V.Fragment){o.push.apply(o,Ju(f.props.children,m));return}f.type!==pn&&Gr(!1),!f.props.index||!f.props.children||Gr(!1);let w={id:f.props.id||m.join("-"),caseSensitive:f.props.caseSensitive,element:f.props.element,Component:f.props.Component,index:f.props.index,path:f.props.path,loader:f.props.loader,action:f.props.action,errorElement:f.props.errorElement,ErrorBoundary:f.props.ErrorBoundary,hasErrorBoundary:f.props.ErrorBoundary!=null||f.props.errorElement!=null,shouldRevalidate:f.props.shouldRevalidate,handle:f.props.handle,lazy:f.props.lazy};f.props.children&&(w.children=Ju(f.props.children,m)),o.push(w)}),o}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Yx="6";try{window.__reactRouterVersion=Yx}catch{}const Zx="startTransition",Ph=Yg[Zx];function Qx(h){let{basename:i,children:o,future:f,window:x}=h,m=V.useRef();m.current==null&&(m.current=nx({window:x,v5Compat:!0}));let w=m.current,[S,N]=V.useState({action:w.action,location:w.location}),{v7_startTransition:b}=f||{},E=V.useCallback(A=>{b&&Ph?Ph(()=>N(A)):N(A)},[N,b]);return V.useLayoutEffect(()=>w.listen(E),[w,E]),V.useEffect(()=>Xx(f),[f]),V.createElement(qx,{basename:i,children:o,location:S.location,navigationType:S.action,navigator:w,future:f})}var Lh;(function(h){h.UseScrollRestoration="useScrollRestoration",h.UseSubmit="useSubmit",h.UseSubmitFetcher="useSubmitFetcher",h.UseFetcher="useFetcher",h.useViewTransitionState="useViewTransitionState"})(Lh||(Lh={}));var Bh;(function(h){h.UseFetcher="useFetcher",h.UseFetchers="useFetchers",h.UseScrollRestoration="useScrollRestoration"})(Bh||(Bh={}));const Jx="modulepreload",em=function(h){return"/"+h},Fh={},Ba=function(i,o,f){let x=Promise.resolve();if(o&&o.length>0){let b=function(E){return Promise.all(E.map(A=>Promise.resolve(A).then(O=>({status:"fulfilled",value:O}),O=>({status:"rejected",reason:O}))))};var w=b;document.getElementsByTagName("link");const S=document.querySelector("meta[property=csp-nonce]"),N=S?.nonce||S?.getAttribute("nonce");x=b(o.map(E=>{if(E=em(E),E in Fh)return;Fh[E]=!0;const A=E.endsWith(".css"),O=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${E}"]${O}`))return;const D=document.createElement("link");if(D.rel=A?"stylesheet":Jx,A||(D.as="script"),D.crossOrigin="",D.href=E,N&&D.setAttribute("nonce",N),document.head.appendChild(D),A)return new Promise((z,F)=>{D.addEventListener("load",z),D.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${E}`)))})}))}function m(S){const N=new Event("vite:preloadError",{cancelable:!0});if(N.payload=S,window.dispatchEvent(N),!N.defaultPrevented)throw S}return x.then(S=>{for(const N of S||[])N.status==="rejected"&&m(N.reason);return i().catch(m)})},tm=h=>{let i;return h?i=h:typeof fetch>"u"?i=(...o)=>Ba(async()=>{const{default:f}=await Promise.resolve().then(()=>Fa);return{default:f}},void 0).then(({default:f})=>f(...o)):i=fetch,(...o)=>i(...o)};class md extends Error{constructor(i,o="FunctionsError",f){super(i),this.name=o,this.context=f}}class rm extends md{constructor(i){super("Failed to send a request to the Edge Function","FunctionsFetchError",i)}}class Uh extends md{constructor(i){super("Relay Error invoking the Edge Function","FunctionsRelayError",i)}}class Wh extends md{constructor(i){super("Edge Function returned a non-2xx status code","FunctionsHttpError",i)}}var ed;(function(h){h.Any="any",h.ApNortheast1="ap-northeast-1",h.ApNortheast2="ap-northeast-2",h.ApSouth1="ap-south-1",h.ApSoutheast1="ap-southeast-1",h.ApSoutheast2="ap-southeast-2",h.CaCentral1="ca-central-1",h.EuCentral1="eu-central-1",h.EuWest1="eu-west-1",h.EuWest2="eu-west-2",h.EuWest3="eu-west-3",h.SaEast1="sa-east-1",h.UsEast1="us-east-1",h.UsWest1="us-west-1",h.UsWest2="us-west-2"})(ed||(ed={}));var nm=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};class sm{constructor(i,{headers:o={},customFetch:f,region:x=ed.Any}={}){this.url=i,this.headers=o,this.region=x,this.fetch=tm(f)}setAuth(i){this.headers.Authorization=`Bearer ${i}`}invoke(i,o={}){var f;return nm(this,void 0,void 0,function*(){try{const{headers:x,method:m,body:w}=o;let S={},{region:N}=o;N||(N=this.region);const b=new URL(`${this.url}/${i}`);N&&N!=="any"&&(S["x-region"]=N,b.searchParams.set("forceFunctionRegion",N));let E;w&&(x&&!Object.prototype.hasOwnProperty.call(x,"Content-Type")||!x)&&(typeof Blob<"u"&&w instanceof Blob||w instanceof ArrayBuffer?(S["Content-Type"]="application/octet-stream",E=w):typeof w=="string"?(S["Content-Type"]="text/plain",E=w):typeof FormData<"u"&&w instanceof FormData?E=w:(S["Content-Type"]="application/json",E=JSON.stringify(w)));const A=yield this.fetch(b.toString(),{method:m||"POST",headers:Object.assign(Object.assign(Object.assign({},S),this.headers),x),body:E}).catch(F=>{throw new rm(F)}),O=A.headers.get("x-relay-error");if(O&&O==="true")throw new Uh(A);if(!A.ok)throw new Wh(A);let D=((f=A.headers.get("Content-Type"))!==null&&f!==void 0?f:"text/plain").split(";")[0].trim(),z;return D==="application/json"?z=yield A.json():D==="application/octet-stream"?z=yield A.blob():D==="text/event-stream"?z=A:D==="multipart/form-data"?z=yield A.formData():z=yield A.text(),{data:z,error:null,response:A}}catch(x){return{data:null,error:x,response:x instanceof Wh||x instanceof Uh?x.context:void 0}}})}}var Qr={},wa={},va={},ba={},_a={},Na={},im=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Pa=im();const am=Pa.fetch,Gf=Pa.fetch.bind(Pa),$f=Pa.Headers,om=Pa.Request,lm=Pa.Response,Fa=Object.freeze(Object.defineProperty({__proto__:null,Headers:$f,Request:om,Response:lm,default:Gf,fetch:am},Symbol.toStringTag,{value:"Module"})),cm=$g(Fa);var Yl={},zh;function Xf(){if(zh)return Yl;zh=1,Object.defineProperty(Yl,"__esModule",{value:!0});class h extends Error{constructor(o){super(o.message),this.name="PostgrestError",this.details=o.details,this.hint=o.hint,this.code=o.code}}return Yl.default=h,Yl}var Vh;function qf(){if(Vh)return Na;Vh=1;var h=Na&&Na.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(Na,"__esModule",{value:!0});const i=h(cm),o=h(Xf());class f{constructor(m){this.shouldThrowOnError=!1,this.method=m.method,this.url=m.url,this.headers=m.headers,this.schema=m.schema,this.body=m.body,this.shouldThrowOnError=m.shouldThrowOnError,this.signal=m.signal,this.isMaybeSingle=m.isMaybeSingle,m.fetch?this.fetch=m.fetch:typeof fetch>"u"?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(m,w){return this.headers=Object.assign({},this.headers),this.headers[m]=w,this}then(m,w){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const S=this.fetch;let N=S(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async b=>{var E,A,O;let D=null,z=null,F=null,U=b.status,ie=b.statusText;if(b.ok){if(this.method!=="HEAD"){const ne=await b.text();ne===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?z=ne:z=JSON.parse(ne))}const L=(E=this.headers.Prefer)===null||E===void 0?void 0:E.match(/count=(exact|planned|estimated)/),Y=(A=b.headers.get("content-range"))===null||A===void 0?void 0:A.split("/");L&&Y&&Y.length>1&&(F=parseInt(Y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(z)&&(z.length>1?(D={code:"PGRST116",details:`Results contain ${z.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},z=null,F=null,U=406,ie="Not Acceptable"):z.length===1?z=z[0]:z=null)}else{const L=await b.text();try{D=JSON.parse(L),Array.isArray(D)&&b.status===404&&(z=[],D=null,U=200,ie="OK")}catch{b.status===404&&L===""?(U=204,ie="No Content"):D={message:L}}if(D&&this.isMaybeSingle&&(!((O=D?.details)===null||O===void 0)&&O.includes("0 rows"))&&(D=null,U=200,ie="OK"),D&&this.shouldThrowOnError)throw new o.default(D)}return{error:D,data:z,count:F,status:U,statusText:ie}});return this.shouldThrowOnError||(N=N.catch(b=>{var E,A,O;return{error:{message:`${(E=b?.name)!==null&&E!==void 0?E:"FetchError"}: ${b?.message}`,details:`${(A=b?.stack)!==null&&A!==void 0?A:""}`,hint:"",code:`${(O=b?.code)!==null&&O!==void 0?O:""}`},data:null,count:null,status:0,statusText:""}})),N.then(m,w)}returns(){return this}overrideTypes(){return this}}return Na.default=f,Na}var Hh;function Kf(){if(Hh)return _a;Hh=1;var h=_a&&_a.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(_a,"__esModule",{value:!0});const i=h(qf());class o extends i.default{select(x){let m=!1;const w=(x??"*").split("").map(S=>/\s/.test(S)&&!m?"":(S==='"'&&(m=!m),S)).join("");return this.url.searchParams.set("select",w),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(x,{ascending:m=!0,nullsFirst:w,foreignTable:S,referencedTable:N=S}={}){const b=N?`${N}.order`:"order",E=this.url.searchParams.get(b);return this.url.searchParams.set(b,`${E?`${E},`:""}${x}.${m?"asc":"desc"}${w===void 0?"":w?".nullsfirst":".nullslast"}`),this}limit(x,{foreignTable:m,referencedTable:w=m}={}){const S=typeof w>"u"?"limit":`${w}.limit`;return this.url.searchParams.set(S,`${x}`),this}range(x,m,{foreignTable:w,referencedTable:S=w}={}){const N=typeof S>"u"?"offset":`${S}.offset`,b=typeof S>"u"?"limit":`${S}.limit`;return this.url.searchParams.set(N,`${x}`),this.url.searchParams.set(b,`${m-x+1}`),this}abortSignal(x){return this.signal=x,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:x=!1,verbose:m=!1,settings:w=!1,buffers:S=!1,wal:N=!1,format:b="text"}={}){var E;const A=[x?"analyze":null,m?"verbose":null,w?"settings":null,S?"buffers":null,N?"wal":null].filter(Boolean).join("|"),O=(E=this.headers.Accept)!==null&&E!==void 0?E:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${b}; for="${O}"; options=${A};`,b==="json"?this:this}rollback(){var x;return((x=this.headers.Prefer)!==null&&x!==void 0?x:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return _a.default=o,_a}var Gh;function pd(){if(Gh)return ba;Gh=1;var h=ba&&ba.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(ba,"__esModule",{value:!0});const i=h(Kf());class o extends i.default{eq(x,m){return this.url.searchParams.append(x,`eq.${m}`),this}neq(x,m){return this.url.searchParams.append(x,`neq.${m}`),this}gt(x,m){return this.url.searchParams.append(x,`gt.${m}`),this}gte(x,m){return this.url.searchParams.append(x,`gte.${m}`),this}lt(x,m){return this.url.searchParams.append(x,`lt.${m}`),this}lte(x,m){return this.url.searchParams.append(x,`lte.${m}`),this}like(x,m){return this.url.searchParams.append(x,`like.${m}`),this}likeAllOf(x,m){return this.url.searchParams.append(x,`like(all).{${m.join(",")}}`),this}likeAnyOf(x,m){return this.url.searchParams.append(x,`like(any).{${m.join(",")}}`),this}ilike(x,m){return this.url.searchParams.append(x,`ilike.${m}`),this}ilikeAllOf(x,m){return this.url.searchParams.append(x,`ilike(all).{${m.join(",")}}`),this}ilikeAnyOf(x,m){return this.url.searchParams.append(x,`ilike(any).{${m.join(",")}}`),this}is(x,m){return this.url.searchParams.append(x,`is.${m}`),this}in(x,m){const w=Array.from(new Set(m)).map(S=>typeof S=="string"&&new RegExp("[,()]").test(S)?`"${S}"`:`${S}`).join(",");return this.url.searchParams.append(x,`in.(${w})`),this}contains(x,m){return typeof m=="string"?this.url.searchParams.append(x,`cs.${m}`):Array.isArray(m)?this.url.searchParams.append(x,`cs.{${m.join(",")}}`):this.url.searchParams.append(x,`cs.${JSON.stringify(m)}`),this}containedBy(x,m){return typeof m=="string"?this.url.searchParams.append(x,`cd.${m}`):Array.isArray(m)?this.url.searchParams.append(x,`cd.{${m.join(",")}}`):this.url.searchParams.append(x,`cd.${JSON.stringify(m)}`),this}rangeGt(x,m){return this.url.searchParams.append(x,`sr.${m}`),this}rangeGte(x,m){return this.url.searchParams.append(x,`nxl.${m}`),this}rangeLt(x,m){return this.url.searchParams.append(x,`sl.${m}`),this}rangeLte(x,m){return this.url.searchParams.append(x,`nxr.${m}`),this}rangeAdjacent(x,m){return this.url.searchParams.append(x,`adj.${m}`),this}overlaps(x,m){return typeof m=="string"?this.url.searchParams.append(x,`ov.${m}`):this.url.searchParams.append(x,`ov.{${m.join(",")}}`),this}textSearch(x,m,{config:w,type:S}={}){let N="";S==="plain"?N="pl":S==="phrase"?N="ph":S==="websearch"&&(N="w");const b=w===void 0?"":`(${w})`;return this.url.searchParams.append(x,`${N}fts${b}.${m}`),this}match(x){return Object.entries(x).forEach(([m,w])=>{this.url.searchParams.append(m,`eq.${w}`)}),this}not(x,m,w){return this.url.searchParams.append(x,`not.${m}.${w}`),this}or(x,{foreignTable:m,referencedTable:w=m}={}){const S=w?`${w}.or`:"or";return this.url.searchParams.append(S,`(${x})`),this}filter(x,m,w){return this.url.searchParams.append(x,`${m}.${w}`),this}}return ba.default=o,ba}var $h;function Yf(){if($h)return va;$h=1;var h=va&&va.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(va,"__esModule",{value:!0});const i=h(pd());class o{constructor(x,{headers:m={},schema:w,fetch:S}){this.url=x,this.headers=m,this.schema=w,this.fetch=S}select(x,{head:m=!1,count:w}={}){const S=m?"HEAD":"GET";let N=!1;const b=(x??"*").split("").map(E=>/\s/.test(E)&&!N?"":(E==='"'&&(N=!N),E)).join("");return this.url.searchParams.set("select",b),w&&(this.headers.Prefer=`count=${w}`),new i.default({method:S,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(x,{count:m,defaultToNull:w=!0}={}){const S="POST",N=[];if(this.headers.Prefer&&N.push(this.headers.Prefer),m&&N.push(`count=${m}`),w||N.push("missing=default"),this.headers.Prefer=N.join(","),Array.isArray(x)){const b=x.reduce((E,A)=>E.concat(Object.keys(A)),[]);if(b.length>0){const E=[...new Set(b)].map(A=>`"${A}"`);this.url.searchParams.set("columns",E.join(","))}}return new i.default({method:S,url:this.url,headers:this.headers,schema:this.schema,body:x,fetch:this.fetch,allowEmpty:!1})}upsert(x,{onConflict:m,ignoreDuplicates:w=!1,count:S,defaultToNull:N=!0}={}){const b="POST",E=[`resolution=${w?"ignore":"merge"}-duplicates`];if(m!==void 0&&this.url.searchParams.set("on_conflict",m),this.headers.Prefer&&E.push(this.headers.Prefer),S&&E.push(`count=${S}`),N||E.push("missing=default"),this.headers.Prefer=E.join(","),Array.isArray(x)){const A=x.reduce((O,D)=>O.concat(Object.keys(D)),[]);if(A.length>0){const O=[...new Set(A)].map(D=>`"${D}"`);this.url.searchParams.set("columns",O.join(","))}}return new i.default({method:b,url:this.url,headers:this.headers,schema:this.schema,body:x,fetch:this.fetch,allowEmpty:!1})}update(x,{count:m}={}){const w="PATCH",S=[];return this.headers.Prefer&&S.push(this.headers.Prefer),m&&S.push(`count=${m}`),this.headers.Prefer=S.join(","),new i.default({method:w,url:this.url,headers:this.headers,schema:this.schema,body:x,fetch:this.fetch,allowEmpty:!1})}delete({count:x}={}){const m="DELETE",w=[];return x&&w.push(`count=${x}`),this.headers.Prefer&&w.unshift(this.headers.Prefer),this.headers.Prefer=w.join(","),new i.default({method:m,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return va.default=o,va}var Co={},So={},Xh;function um(){return Xh||(Xh=1,Object.defineProperty(So,"__esModule",{value:!0}),So.version=void 0,So.version="0.0.0-automated"),So}var qh;function dm(){if(qh)return Co;qh=1,Object.defineProperty(Co,"__esModule",{value:!0}),Co.DEFAULT_HEADERS=void 0;const h=um();return Co.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${h.version}`},Co}var Kh;function hm(){if(Kh)return wa;Kh=1;var h=wa&&wa.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(wa,"__esModule",{value:!0});const i=h(Yf()),o=h(pd()),f=dm();class x{constructor(w,{headers:S={},schema:N,fetch:b}={}){this.url=w,this.headers=Object.assign(Object.assign({},f.DEFAULT_HEADERS),S),this.schemaName=N,this.fetch=b}from(w){const S=new URL(`${this.url}/${w}`);return new i.default(S,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(w){return new x(this.url,{headers:this.headers,schema:w,fetch:this.fetch})}rpc(w,S={},{head:N=!1,get:b=!1,count:E}={}){let A;const O=new URL(`${this.url}/rpc/${w}`);let D;N||b?(A=N?"HEAD":"GET",Object.entries(S).filter(([F,U])=>U!==void 0).map(([F,U])=>[F,Array.isArray(U)?`{${U.join(",")}}`:`${U}`]).forEach(([F,U])=>{O.searchParams.append(F,U)})):(A="POST",D=S);const z=Object.assign({},this.headers);return E&&(z.Prefer=`count=${E}`),new o.default({method:A,url:O,headers:z,schema:this.schemaName,body:D,fetch:this.fetch,allowEmpty:!1})}}return wa.default=x,wa}var Yh;function fm(){if(Yh)return Qr;Yh=1;var h=Qr&&Qr.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.PostgrestError=Qr.PostgrestBuilder=Qr.PostgrestTransformBuilder=Qr.PostgrestFilterBuilder=Qr.PostgrestQueryBuilder=Qr.PostgrestClient=void 0;const i=h(hm());Qr.PostgrestClient=i.default;const o=h(Yf());Qr.PostgrestQueryBuilder=o.default;const f=h(pd());Qr.PostgrestFilterBuilder=f.default;const x=h(Kf());Qr.PostgrestTransformBuilder=x.default;const m=h(qf());Qr.PostgrestBuilder=m.default;const w=h(Xf());return Qr.PostgrestError=w.default,Qr.default={PostgrestClient:i.default,PostgrestQueryBuilder:o.default,PostgrestFilterBuilder:f.default,PostgrestTransformBuilder:x.default,PostgrestBuilder:m.default,PostgrestError:w.default},Qr}var gm=fm();const xm=uc(gm),{PostgrestClient:mm,PostgrestQueryBuilder:hy,PostgrestFilterBuilder:fy,PostgrestTransformBuilder:gy,PostgrestBuilder:xy,PostgrestError:my}=xm;class pm{static dynamicRequire(i){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(i):null}catch{return null}}static detectEnvironment(){var i,o;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((i=navigator.userAgent)===null||i===void 0)&&i.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const f=parseInt(process.versions.node.split(".")[0]);if(f>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const x=this.dynamicRequire("undici");if(x&&x.WebSocket)return{type:"native",constructor:x.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${f} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const x=this.dynamicRequire("ws");if(x)return{type:"ws",constructor:(o=x.WebSocket)!==null&&o!==void 0?o:x};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${f} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const i=this.detectEnvironment();if(i.constructor)return i.constructor;let o=i.error||"WebSocket not supported in this environment.";throw i.workaround&&(o+=`

Suggested solution: ${i.workaround}`),new Error(o)}static createWebSocket(i,o){const f=this.getWebSocketConstructor();return new f(i,o)}static isWebSocketSupported(){try{const i=this.detectEnvironment();return i.type==="native"||i.type==="ws"}catch{return!1}}}const ym="2.15.0",wm=`realtime-js/${ym}`,vm="1.0.0",td=1e4,bm=1e3,_m=100;var To;(function(h){h[h.connecting=0]="connecting",h[h.open=1]="open",h[h.closing=2]="closing",h[h.closed=3]="closed"})(To||(To={}));var Hr;(function(h){h.closed="closed",h.errored="errored",h.joined="joined",h.joining="joining",h.leaving="leaving"})(Hr||(Hr={}));var as;(function(h){h.close="phx_close",h.error="phx_error",h.join="phx_join",h.reply="phx_reply",h.leave="phx_leave",h.access_token="access_token"})(as||(as={}));var rd;(function(h){h.websocket="websocket"})(rd||(rd={}));var Fi;(function(h){h.Connecting="connecting",h.Open="open",h.Closing="closing",h.Closed="closed"})(Fi||(Fi={}));class Nm{constructor(){this.HEADER_LENGTH=1}decode(i,o){return i.constructor===ArrayBuffer?o(this._binaryDecode(i)):o(typeof i=="string"?JSON.parse(i):{})}_binaryDecode(i){const o=new DataView(i),f=new TextDecoder;return this._decodeBroadcast(i,o,f)}_decodeBroadcast(i,o,f){const x=o.getUint8(1),m=o.getUint8(2);let w=this.HEADER_LENGTH+2;const S=f.decode(i.slice(w,w+x));w=w+x;const N=f.decode(i.slice(w,w+m));w=w+m;const b=JSON.parse(f.decode(i.slice(w,i.byteLength)));return{ref:null,topic:S,event:N,payload:b}}}class Zf{constructor(i,o){this.callback=i,this.timerCalc=o,this.timer=void 0,this.tries=0,this.callback=i,this.timerCalc=o}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var dr;(function(h){h.abstime="abstime",h.bool="bool",h.date="date",h.daterange="daterange",h.float4="float4",h.float8="float8",h.int2="int2",h.int4="int4",h.int4range="int4range",h.int8="int8",h.int8range="int8range",h.json="json",h.jsonb="jsonb",h.money="money",h.numeric="numeric",h.oid="oid",h.reltime="reltime",h.text="text",h.time="time",h.timestamp="timestamp",h.timestamptz="timestamptz",h.timetz="timetz",h.tsrange="tsrange",h.tstzrange="tstzrange"})(dr||(dr={}));const Zh=(h,i,o={})=>{var f;const x=(f=o.skipTypes)!==null&&f!==void 0?f:[];return Object.keys(i).reduce((m,w)=>(m[w]=Em(w,h,i,x),m),{})},Em=(h,i,o,f)=>{const x=i.find(S=>S.name===h),m=x?.type,w=o[h];return m&&!f.includes(m)?Qf(m,w):nd(w)},Qf=(h,i)=>{if(h.charAt(0)==="_"){const o=h.slice(1,h.length);return km(i,o)}switch(h){case dr.bool:return Cm(i);case dr.float4:case dr.float8:case dr.int2:case dr.int4:case dr.int8:case dr.numeric:case dr.oid:return Sm(i);case dr.json:case dr.jsonb:return Am(i);case dr.timestamp:return Im(i);case dr.abstime:case dr.date:case dr.daterange:case dr.int4range:case dr.int8range:case dr.money:case dr.reltime:case dr.text:case dr.time:case dr.timestamptz:case dr.timetz:case dr.tsrange:case dr.tstzrange:return nd(i);default:return nd(i)}},nd=h=>h,Cm=h=>{switch(h){case"t":return!0;case"f":return!1;default:return h}},Sm=h=>{if(typeof h=="string"){const i=parseFloat(h);if(!Number.isNaN(i))return i}return h},Am=h=>{if(typeof h=="string")try{return JSON.parse(h)}catch(i){return console.log(`JSON parse error: ${i}`),h}return h},km=(h,i)=>{if(typeof h!="string")return h;const o=h.length-1,f=h[o];if(h[0]==="{"&&f==="}"){let m;const w=h.slice(1,o);try{m=JSON.parse("["+w+"]")}catch{m=w?w.split(","):[]}return m.map(S=>Qf(i,S))}return h},Im=h=>typeof h=="string"?h.replace(" ","T"):h,Jf=h=>{let i=h;return i=i.replace(/^ws/i,"http"),i=i.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),i.replace(/\/+$/,"")+"/api/broadcast"};class Gu{constructor(i,o,f={},x=td){this.channel=i,this.event=o,this.payload=f,this.timeout=x,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(i){this.timeout=i,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(i){this.payload=Object.assign(Object.assign({},this.payload),i)}receive(i,o){var f;return this._hasReceived(i)&&o((f=this.receivedResp)===null||f===void 0?void 0:f.response),this.recHooks.push({status:i,callback:o}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const i=o=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=o,this._matchReceive(o)};this.channel._on(this.refEvent,{},i),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(i,o){this.refEvent&&this.channel._trigger(this.refEvent,{status:i,response:o})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:i,response:o}){this.recHooks.filter(f=>f.status===i).forEach(f=>f.callback(o))}_hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}}var Qh;(function(h){h.SYNC="sync",h.JOIN="join",h.LEAVE="leave"})(Qh||(Qh={}));class jo{constructor(i,o){this.channel=i,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const f=o?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(f.state,{},x=>{const{onJoin:m,onLeave:w,onSync:S}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jo.syncState(this.state,x,m,w),this.pendingDiffs.forEach(N=>{this.state=jo.syncDiff(this.state,N,m,w)}),this.pendingDiffs=[],S()}),this.channel._on(f.diff,{},x=>{const{onJoin:m,onLeave:w,onSync:S}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(x):(this.state=jo.syncDiff(this.state,x,m,w),S())}),this.onJoin((x,m,w)=>{this.channel._trigger("presence",{event:"join",key:x,currentPresences:m,newPresences:w})}),this.onLeave((x,m,w)=>{this.channel._trigger("presence",{event:"leave",key:x,currentPresences:m,leftPresences:w})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(i,o,f,x){const m=this.cloneDeep(i),w=this.transformState(o),S={},N={};return this.map(m,(b,E)=>{w[b]||(N[b]=E)}),this.map(w,(b,E)=>{const A=m[b];if(A){const O=E.map(U=>U.presence_ref),D=A.map(U=>U.presence_ref),z=E.filter(U=>D.indexOf(U.presence_ref)<0),F=A.filter(U=>O.indexOf(U.presence_ref)<0);z.length>0&&(S[b]=z),F.length>0&&(N[b]=F)}else S[b]=E}),this.syncDiff(m,{joins:S,leaves:N},f,x)}static syncDiff(i,o,f,x){const{joins:m,leaves:w}={joins:this.transformState(o.joins),leaves:this.transformState(o.leaves)};return f||(f=()=>{}),x||(x=()=>{}),this.map(m,(S,N)=>{var b;const E=(b=i[S])!==null&&b!==void 0?b:[];if(i[S]=this.cloneDeep(N),E.length>0){const A=i[S].map(D=>D.presence_ref),O=E.filter(D=>A.indexOf(D.presence_ref)<0);i[S].unshift(...O)}f(S,E,N)}),this.map(w,(S,N)=>{let b=i[S];if(!b)return;const E=N.map(A=>A.presence_ref);b=b.filter(A=>E.indexOf(A.presence_ref)<0),i[S]=b,x(S,b,N),b.length===0&&delete i[S]}),i}static map(i,o){return Object.getOwnPropertyNames(i).map(f=>o(f,i[f]))}static transformState(i){return i=this.cloneDeep(i),Object.getOwnPropertyNames(i).reduce((o,f)=>{const x=i[f];return"metas"in x?o[f]=x.metas.map(m=>(m.presence_ref=m.phx_ref,delete m.phx_ref,delete m.phx_ref_prev,m)):o[f]=x,o},{})}static cloneDeep(i){return JSON.parse(JSON.stringify(i))}onJoin(i){this.caller.onJoin=i}onLeave(i){this.caller.onLeave=i}onSync(i){this.caller.onSync=i}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jh;(function(h){h.ALL="*",h.INSERT="INSERT",h.UPDATE="UPDATE",h.DELETE="DELETE"})(Jh||(Jh={}));var Ro;(function(h){h.BROADCAST="broadcast",h.PRESENCE="presence",h.POSTGRES_CHANGES="postgres_changes",h.SYSTEM="system"})(Ro||(Ro={}));var Ds;(function(h){h.SUBSCRIBED="SUBSCRIBED",h.TIMED_OUT="TIMED_OUT",h.CLOSED="CLOSED",h.CHANNEL_ERROR="CHANNEL_ERROR"})(Ds||(Ds={}));class yd{constructor(i,o={config:{}},f){this.topic=i,this.params=o,this.socket=f,this.bindings={},this.state=Hr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=i.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},o.config),this.timeout=this.socket.timeout,this.joinPush=new Gu(this,as.join,this.params,this.timeout),this.rejoinTimer=new Zf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Hr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(x=>x.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Hr.closed,this.socket._remove(this)}),this._onError(x=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,x),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",x=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,x),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(as.reply,{},(x,m)=>{this._trigger(this._replyEventName(m),x)}),this.presence=new jo(this),this.broadcastEndpointURL=Jf(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(i,o=this.timeout){var f,x;if(this.socket.isConnected()||this.socket.connect(),this.state==Hr.closed){const{config:{broadcast:m,presence:w,private:S}}=this.params,N=(x=(f=this.bindings.postgres_changes)===null||f===void 0?void 0:f.map(O=>O.filter))!==null&&x!==void 0?x:[],b=!!this.bindings[Ro.PRESENCE]&&this.bindings[Ro.PRESENCE].length>0,E={},A={broadcast:m,presence:Object.assign(Object.assign({},w),{enabled:b}),postgres_changes:N,private:S};this.socket.accessTokenValue&&(E.access_token=this.socket.accessTokenValue),this._onError(O=>i?.(Ds.CHANNEL_ERROR,O)),this._onClose(()=>i?.(Ds.CLOSED)),this.updateJoinPayload(Object.assign({config:A},E)),this.joinedOnce=!0,this._rejoin(o),this.joinPush.receive("ok",async({postgres_changes:O})=>{var D;if(this.socket.setAuth(),O===void 0){i?.(Ds.SUBSCRIBED);return}else{const z=this.bindings.postgres_changes,F=(D=z?.length)!==null&&D!==void 0?D:0,U=[];for(let ie=0;ie<F;ie++){const re=z[ie],{filter:{event:L,schema:Y,table:ne,filter:ce}}=re,q=O&&O[ie];if(q&&q.event===L&&q.schema===Y&&q.table===ne&&q.filter===ce)U.push(Object.assign(Object.assign({},re),{id:q.id}));else{this.unsubscribe(),this.state=Hr.errored,i?.(Ds.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=U,i&&i(Ds.SUBSCRIBED);return}}).receive("error",O=>{this.state=Hr.errored,i?.(Ds.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(O).join(", ")||"error")))}).receive("timeout",()=>{i?.(Ds.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(i,o={}){return await this.send({type:"presence",event:"track",payload:i},o.timeout||this.timeout)}async untrack(i={}){return await this.send({type:"presence",event:"untrack"},i)}on(i,o,f){return this.state===Hr.joined&&i===Ro.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(i,o,f)}async send(i,o={}){var f,x;if(!this._canPush()&&i.type==="broadcast"){const{event:m,payload:w}=i,N={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:m,payload:w,private:this.private}]})};try{const b=await this._fetchWithTimeout(this.broadcastEndpointURL,N,(f=o.timeout)!==null&&f!==void 0?f:this.timeout);return await((x=b.body)===null||x===void 0?void 0:x.cancel()),b.ok?"ok":"error"}catch(b){return b.name==="AbortError"?"timed out":"error"}}else return new Promise(m=>{var w,S,N;const b=this._push(i.type,i,o.timeout||this.timeout);i.type==="broadcast"&&!(!((N=(S=(w=this.params)===null||w===void 0?void 0:w.config)===null||S===void 0?void 0:S.broadcast)===null||N===void 0)&&N.ack)&&m("ok"),b.receive("ok",()=>m("ok")),b.receive("error",()=>m("error")),b.receive("timeout",()=>m("timed out"))})}updateJoinPayload(i){this.joinPush.updatePayload(i)}unsubscribe(i=this.timeout){this.state=Hr.leaving;const o=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(as.close,"leave",this._joinRef())};this.joinPush.destroy();let f=null;return new Promise(x=>{f=new Gu(this,as.leave,{},i),f.receive("ok",()=>{o(),x("ok")}).receive("timeout",()=>{o(),x("timed out")}).receive("error",()=>{x("error")}),f.send(),this._canPush()||f.trigger("ok",{})}).finally(()=>{f?.destroy()})}teardown(){this.pushBuffer.forEach(i=>i.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Hr.closed,this.bindings={}}async _fetchWithTimeout(i,o,f){const x=new AbortController,m=setTimeout(()=>x.abort(),f),w=await this.socket.fetch(i,Object.assign(Object.assign({},o),{signal:x.signal}));return clearTimeout(m),w}_push(i,o,f=this.timeout){if(!this.joinedOnce)throw`tried to push '${i}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let x=new Gu(this,i,o,f);return this._canPush()?x.send():this._addToPushBuffer(x),x}_addToPushBuffer(i){if(i.startTimeout(),this.pushBuffer.push(i),this.pushBuffer.length>_m){const o=this.pushBuffer.shift();o&&(o.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${o.event}`,o.payload))}}_onMessage(i,o,f){return o}_isMember(i){return this.topic===i}_joinRef(){return this.joinPush.ref}_trigger(i,o,f){var x,m;const w=i.toLocaleLowerCase(),{close:S,error:N,leave:b,join:E}=as;if(f&&[S,N,b,E].indexOf(w)>=0&&f!==this._joinRef())return;let O=this._onMessage(w,o,f);if(o&&!O)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(w)?(x=this.bindings.postgres_changes)===null||x===void 0||x.filter(D=>{var z,F,U;return((z=D.filter)===null||z===void 0?void 0:z.event)==="*"||((U=(F=D.filter)===null||F===void 0?void 0:F.event)===null||U===void 0?void 0:U.toLocaleLowerCase())===w}).map(D=>D.callback(O,f)):(m=this.bindings[w])===null||m===void 0||m.filter(D=>{var z,F,U,ie,re,L;if(["broadcast","presence","postgres_changes"].includes(w))if("id"in D){const Y=D.id,ne=(z=D.filter)===null||z===void 0?void 0:z.event;return Y&&((F=o.ids)===null||F===void 0?void 0:F.includes(Y))&&(ne==="*"||ne?.toLocaleLowerCase()===((U=o.data)===null||U===void 0?void 0:U.type.toLocaleLowerCase()))}else{const Y=(re=(ie=D?.filter)===null||ie===void 0?void 0:ie.event)===null||re===void 0?void 0:re.toLocaleLowerCase();return Y==="*"||Y===((L=o?.event)===null||L===void 0?void 0:L.toLocaleLowerCase())}else return D.type.toLocaleLowerCase()===w}).map(D=>{if(typeof O=="object"&&"ids"in O){const z=O.data,{schema:F,table:U,commit_timestamp:ie,type:re,errors:L}=z;O=Object.assign(Object.assign({},{schema:F,table:U,commit_timestamp:ie,eventType:re,new:{},old:{},errors:L}),this._getPayloadRecords(z))}D.callback(O,f)})}_isClosed(){return this.state===Hr.closed}_isJoined(){return this.state===Hr.joined}_isJoining(){return this.state===Hr.joining}_isLeaving(){return this.state===Hr.leaving}_replyEventName(i){return`chan_reply_${i}`}_on(i,o,f){const x=i.toLocaleLowerCase(),m={type:x,filter:o,callback:f};return this.bindings[x]?this.bindings[x].push(m):this.bindings[x]=[m],this}_off(i,o){const f=i.toLocaleLowerCase();return this.bindings[f]&&(this.bindings[f]=this.bindings[f].filter(x=>{var m;return!(((m=x.type)===null||m===void 0?void 0:m.toLocaleLowerCase())===f&&yd.isEqual(x.filter,o))})),this}static isEqual(i,o){if(Object.keys(i).length!==Object.keys(o).length)return!1;for(const f in i)if(i[f]!==o[f])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(i){this._on(as.close,{},i)}_onError(i){this._on(as.error,{},o=>i(o))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(i=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Hr.joining,this.joinPush.resend(i))}_getPayloadRecords(i){const o={new:{},old:{}};return(i.type==="INSERT"||i.type==="UPDATE")&&(o.new=Zh(i.columns,i.record)),(i.type==="UPDATE"||i.type==="DELETE")&&(o.old=Zh(i.columns,i.old_record)),o}}const ef=()=>{},Zl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Tm=[1e3,2e3,5e3,1e4],jm=1e4,Rm=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Om{constructor(i,o){var f;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=td,this.transport=null,this.heartbeatIntervalMs=Zl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ef,this.ref=0,this.reconnectTimer=null,this.logger=ef,this.conn=null,this.sendBuffer=[],this.serializer=new Nm,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=x=>{let m;return x?m=x:typeof fetch>"u"?m=(...w)=>Ba(async()=>{const{default:S}=await Promise.resolve().then(()=>Fa);return{default:S}},void 0).then(({default:S})=>S(...w)).catch(S=>{throw new Error(`Failed to load @supabase/node-fetch: ${S.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):m=fetch,(...w)=>m(...w)},!(!((f=o?.params)===null||f===void 0)&&f.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=o.params.apikey,this.endPoint=`${i}/${rd.websocket}`,this.httpEndpoint=Jf(i),this._initializeOptions(o),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(o?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=pm.createWebSocket(this.endpointURL())}catch(i){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${i.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:vm}))}disconnect(i,o){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const f=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(f),this._setConnectionState("disconnected")},i?this.conn.close(i,o??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(i){const o=await i.unsubscribe();return this.channels.length===0&&this.disconnect(),o}async removeAllChannels(){const i=await Promise.all(this.channels.map(o=>o.unsubscribe()));return this.channels=[],this.disconnect(),i}log(i,o,f){this.logger(i,o,f)}connectionState(){switch(this.conn&&this.conn.readyState){case To.connecting:return Fi.Connecting;case To.open:return Fi.Open;case To.closing:return Fi.Closing;default:return Fi.Closed}}isConnected(){return this.connectionState()===Fi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(i,o={config:{}}){const f=`realtime:${i}`,x=this.getChannels().find(m=>m.topic===f);if(x)return x;{const m=new yd(`realtime:${i}`,o,this);return this.channels.push(m),m}}push(i){const{topic:o,event:f,payload:x,ref:m}=i,w=()=>{this.encode(i,S=>{var N;(N=this.conn)===null||N===void 0||N.send(S)})};this.log("push",`${o} ${f} (${m})`,x),this.isConnected()?w():this.sendBuffer.push(w)}async setAuth(i=null){this._authPromise=this._performAuth(i);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var i;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(i=this.conn)===null||i===void 0||i.close(bm,"heartbeat timeout"),setTimeout(()=>{var o;this.isConnected()||(o=this.reconnectTimer)===null||o===void 0||o.scheduleTimeout()},Zl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(i){this.heartbeatCallback=i}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}_makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}_leaveOpenTopic(i){let o=this.channels.find(f=>f.topic===i&&(f._isJoined()||f._isJoining()));o&&(this.log("transport",`leaving duplicate topic "${i}"`),o.unsubscribe())}_remove(i){this.channels=this.channels.filter(o=>o.topic!==i.topic)}_onConnMessage(i){this.decode(i.data,o=>{o.topic==="phoenix"&&o.event==="phx_reply"&&this.heartbeatCallback(o.payload.status==="ok"?"ok":"error"),o.ref&&o.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:f,event:x,payload:m,ref:w}=o,S=w?`(${w})`:"",N=m.status||"";this.log("receive",`${N} ${f} ${x} ${S}`.trim(),m),this.channels.filter(b=>b._isMember(f)).forEach(b=>b._trigger(x,m,w)),this._triggerStateCallbacks("message",o)})}_clearTimer(i){var o;i==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):i==="reconnect"&&((o=this.reconnectTimer)===null||o===void 0||o.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=i=>this._onConnError(i),this.conn.onmessage=i=>this._onConnMessage(i),this.conn.onclose=i=>this._onConnClose(i))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(i=>i.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const i=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(i),this.workerRef.onerror=o=>{this.log("worker","worker error",o.message),this.workerRef.terminate()},this.workerRef.onmessage=o=>{o.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(i){var o;this._setConnectionState("disconnected"),this.log("transport","close",i),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(o=this.reconnectTimer)===null||o===void 0||o.scheduleTimeout(),this._triggerStateCallbacks("close",i)}_onConnError(i){this._setConnectionState("disconnected"),this.log("transport",`${i}`),this._triggerChanError(),this._triggerStateCallbacks("error",i)}_triggerChanError(){this.channels.forEach(i=>i._trigger(as.error))}_appendParams(i,o){if(Object.keys(o).length===0)return i;const f=i.match(/\?/)?"&":"?",x=new URLSearchParams(o);return`${i}${f}${x}`}_workerObjectUrl(i){let o;if(i)o=i;else{const f=new Blob([Rm],{type:"application/javascript"});o=URL.createObjectURL(f)}return o}_setConnectionState(i,o=!1){this._connectionState=i,i==="connecting"?this._wasManualDisconnect=!1:i==="disconnecting"&&(this._wasManualDisconnect=o)}async _performAuth(i=null){let o;i?o=i:this.accessToken?o=await this.accessToken():o=this.accessTokenValue,this.accessTokenValue!=o&&(this.accessTokenValue=o,this.channels.forEach(f=>{const x={access_token:o,version:wm};o&&f.updateJoinPayload(x),f.joinedOnce&&f._isJoined()&&f._push(as.access_token,{access_token:o})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(i="general"){this.setAuth().catch(o=>{this.log("error",`error setting auth in ${i}`,o)})}_triggerStateCallbacks(i,o){try{this.stateChangeCallbacks[i].forEach(f=>{try{f(o)}catch(x){this.log("error",`error in ${i} callback`,x)}})}catch(f){this.log("error",`error triggering ${i} callbacks`,f)}}_setupReconnectionTimer(){this.reconnectTimer=new Zf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(i){var o,f,x,m,w,S,N,b;if(this.transport=(o=i?.transport)!==null&&o!==void 0?o:null,this.timeout=(f=i?.timeout)!==null&&f!==void 0?f:td,this.heartbeatIntervalMs=(x=i?.heartbeatIntervalMs)!==null&&x!==void 0?x:Zl.HEARTBEAT_INTERVAL,this.worker=(m=i?.worker)!==null&&m!==void 0?m:!1,this.accessToken=(w=i?.accessToken)!==null&&w!==void 0?w:null,i?.params&&(this.params=i.params),i?.logger&&(this.logger=i.logger),(i?.logLevel||i?.log_level)&&(this.logLevel=i.logLevel||i.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(S=i?.reconnectAfterMs)!==null&&S!==void 0?S:E=>Tm[E-1]||jm,this.encode=(N=i?.encode)!==null&&N!==void 0?N:(E,A)=>A(JSON.stringify(E)),this.decode=(b=i?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=i?.workerUrl}}}class wd extends Error{constructor(i){super(i),this.__isStorageError=!0,this.name="StorageError"}}function Jr(h){return typeof h=="object"&&h!==null&&"__isStorageError"in h}class Dm extends wd{constructor(i,o,f){super(i),this.name="StorageApiError",this.status=o,this.statusCode=f}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sd extends wd{constructor(i,o){super(i),this.name="StorageUnknownError",this.originalError=o}}var Mm=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};const e1=h=>{let i;return h?i=h:typeof fetch>"u"?i=(...o)=>Ba(async()=>{const{default:f}=await Promise.resolve().then(()=>Fa);return{default:f}},void 0).then(({default:f})=>f(...o)):i=fetch,(...o)=>i(...o)},Pm=()=>Mm(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ba(()=>Promise.resolve().then(()=>Fa),void 0)).Response:Response}),id=h=>{if(Array.isArray(h))return h.map(o=>id(o));if(typeof h=="function"||h!==Object(h))return h;const i={};return Object.entries(h).forEach(([o,f])=>{const x=o.replace(/([-_][a-z])/gi,m=>m.toUpperCase().replace(/[-_]/g,""));i[x]=id(f)}),i},Lm=h=>{if(typeof h!="object"||h===null)return!1;const i=Object.getPrototypeOf(h);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in h)&&!(Symbol.iterator in h)};var Xi=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};const $u=h=>h.msg||h.message||h.error_description||h.error||JSON.stringify(h),Bm=(h,i,o)=>Xi(void 0,void 0,void 0,function*(){const f=yield Pm();h instanceof f&&!o?.noResolveJson?h.json().then(x=>{const m=h.status||500,w=x?.statusCode||m+"";i(new Dm($u(x),m,w))}).catch(x=>{i(new sd($u(x),x))}):i(new sd($u(h),h))}),Fm=(h,i,o,f)=>{const x={method:h,headers:i?.headers||{}};return h==="GET"||!f?x:(Lm(f)?(x.headers=Object.assign({"Content-Type":"application/json"},i?.headers),x.body=JSON.stringify(f)):x.body=f,Object.assign(Object.assign({},x),o))};function zo(h,i,o,f,x,m){return Xi(this,void 0,void 0,function*(){return new Promise((w,S)=>{h(o,Fm(i,f,x,m)).then(N=>{if(!N.ok)throw N;return f?.noResolveJson?N:N.json()}).then(N=>w(N)).catch(N=>Bm(N,S,f))})})}function rc(h,i,o,f){return Xi(this,void 0,void 0,function*(){return zo(h,"GET",i,o,f)})}function Ms(h,i,o,f,x){return Xi(this,void 0,void 0,function*(){return zo(h,"POST",i,f,x,o)})}function ad(h,i,o,f,x){return Xi(this,void 0,void 0,function*(){return zo(h,"PUT",i,f,x,o)})}function Um(h,i,o,f){return Xi(this,void 0,void 0,function*(){return zo(h,"HEAD",i,Object.assign(Object.assign({},o),{noResolveJson:!0}),f)})}function t1(h,i,o,f,x){return Xi(this,void 0,void 0,function*(){return zo(h,"DELETE",i,f,x,o)})}var Cn=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};const Wm={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},tf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class zm{constructor(i,o={},f,x){this.url=i,this.headers=o,this.bucketId=f,this.fetch=e1(x)}uploadOrUpdate(i,o,f,x){return Cn(this,void 0,void 0,function*(){try{let m;const w=Object.assign(Object.assign({},tf),x);let S=Object.assign(Object.assign({},this.headers),i==="POST"&&{"x-upsert":String(w.upsert)});const N=w.metadata;typeof Blob<"u"&&f instanceof Blob?(m=new FormData,m.append("cacheControl",w.cacheControl),N&&m.append("metadata",this.encodeMetadata(N)),m.append("",f)):typeof FormData<"u"&&f instanceof FormData?(m=f,m.append("cacheControl",w.cacheControl),N&&m.append("metadata",this.encodeMetadata(N))):(m=f,S["cache-control"]=`max-age=${w.cacheControl}`,S["content-type"]=w.contentType,N&&(S["x-metadata"]=this.toBase64(this.encodeMetadata(N)))),x?.headers&&(S=Object.assign(Object.assign({},S),x.headers));const b=this._removeEmptyFolders(o),E=this._getFinalPath(b),A=yield(i=="PUT"?ad:Ms)(this.fetch,`${this.url}/object/${E}`,m,Object.assign({headers:S},w?.duplex?{duplex:w.duplex}:{}));return{data:{path:b,id:A.Id,fullPath:A.Key},error:null}}catch(m){if(Jr(m))return{data:null,error:m};throw m}})}upload(i,o,f){return Cn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",i,o,f)})}uploadToSignedUrl(i,o,f,x){return Cn(this,void 0,void 0,function*(){const m=this._removeEmptyFolders(i),w=this._getFinalPath(m),S=new URL(this.url+`/object/upload/sign/${w}`);S.searchParams.set("token",o);try{let N;const b=Object.assign({upsert:tf.upsert},x),E=Object.assign(Object.assign({},this.headers),{"x-upsert":String(b.upsert)});typeof Blob<"u"&&f instanceof Blob?(N=new FormData,N.append("cacheControl",b.cacheControl),N.append("",f)):typeof FormData<"u"&&f instanceof FormData?(N=f,N.append("cacheControl",b.cacheControl)):(N=f,E["cache-control"]=`max-age=${b.cacheControl}`,E["content-type"]=b.contentType);const A=yield ad(this.fetch,S.toString(),N,{headers:E});return{data:{path:m,fullPath:A.Key},error:null}}catch(N){if(Jr(N))return{data:null,error:N};throw N}})}createSignedUploadUrl(i,o){return Cn(this,void 0,void 0,function*(){try{let f=this._getFinalPath(i);const x=Object.assign({},this.headers);o?.upsert&&(x["x-upsert"]="true");const m=yield Ms(this.fetch,`${this.url}/object/upload/sign/${f}`,{},{headers:x}),w=new URL(this.url+m.url),S=w.searchParams.get("token");if(!S)throw new wd("No token returned by API");return{data:{signedUrl:w.toString(),path:i,token:S},error:null}}catch(f){if(Jr(f))return{data:null,error:f};throw f}})}update(i,o,f){return Cn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",i,o,f)})}move(i,o,f){return Cn(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:i,destinationKey:o,destinationBucket:f?.destinationBucket},{headers:this.headers}),error:null}}catch(x){if(Jr(x))return{data:null,error:x};throw x}})}copy(i,o,f){return Cn(this,void 0,void 0,function*(){try{return{data:{path:(yield Ms(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:i,destinationKey:o,destinationBucket:f?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(x){if(Jr(x))return{data:null,error:x};throw x}})}createSignedUrl(i,o,f){return Cn(this,void 0,void 0,function*(){try{let x=this._getFinalPath(i),m=yield Ms(this.fetch,`${this.url}/object/sign/${x}`,Object.assign({expiresIn:o},f?.transform?{transform:f.transform}:{}),{headers:this.headers});const w=f?.download?`&download=${f.download===!0?"":f.download}`:"";return m={signedUrl:encodeURI(`${this.url}${m.signedURL}${w}`)},{data:m,error:null}}catch(x){if(Jr(x))return{data:null,error:x};throw x}})}createSignedUrls(i,o,f){return Cn(this,void 0,void 0,function*(){try{const x=yield Ms(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:o,paths:i},{headers:this.headers}),m=f?.download?`&download=${f.download===!0?"":f.download}`:"";return{data:x.map(w=>Object.assign(Object.assign({},w),{signedUrl:w.signedURL?encodeURI(`${this.url}${w.signedURL}${m}`):null})),error:null}}catch(x){if(Jr(x))return{data:null,error:x};throw x}})}download(i,o){return Cn(this,void 0,void 0,function*(){const x=typeof o?.transform<"u"?"render/image/authenticated":"object",m=this.transformOptsToQueryString(o?.transform||{}),w=m?`?${m}`:"";try{const S=this._getFinalPath(i);return{data:yield(yield rc(this.fetch,`${this.url}/${x}/${S}${w}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(S){if(Jr(S))return{data:null,error:S};throw S}})}info(i){return Cn(this,void 0,void 0,function*(){const o=this._getFinalPath(i);try{const f=yield rc(this.fetch,`${this.url}/object/info/${o}`,{headers:this.headers});return{data:id(f),error:null}}catch(f){if(Jr(f))return{data:null,error:f};throw f}})}exists(i){return Cn(this,void 0,void 0,function*(){const o=this._getFinalPath(i);try{return yield Um(this.fetch,`${this.url}/object/${o}`,{headers:this.headers}),{data:!0,error:null}}catch(f){if(Jr(f)&&f instanceof sd){const x=f.originalError;if([400,404].includes(x?.status))return{data:!1,error:f}}throw f}})}getPublicUrl(i,o){const f=this._getFinalPath(i),x=[],m=o?.download?`download=${o.download===!0?"":o.download}`:"";m!==""&&x.push(m);const S=typeof o?.transform<"u"?"render/image":"object",N=this.transformOptsToQueryString(o?.transform||{});N!==""&&x.push(N);let b=x.join("&");return b!==""&&(b=`?${b}`),{data:{publicUrl:encodeURI(`${this.url}/${S}/public/${f}${b}`)}}}remove(i){return Cn(this,void 0,void 0,function*(){try{return{data:yield t1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:i},{headers:this.headers}),error:null}}catch(o){if(Jr(o))return{data:null,error:o};throw o}})}list(i,o,f){return Cn(this,void 0,void 0,function*(){try{const x=Object.assign(Object.assign(Object.assign({},Wm),o),{prefix:i||""});return{data:yield Ms(this.fetch,`${this.url}/object/list/${this.bucketId}`,x,{headers:this.headers},f),error:null}}catch(x){if(Jr(x))return{data:null,error:x};throw x}})}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i.replace(/^\/+/,"")}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const o=[];return i.width&&o.push(`width=${i.width}`),i.height&&o.push(`height=${i.height}`),i.resize&&o.push(`resize=${i.resize}`),i.format&&o.push(`format=${i.format}`),i.quality&&o.push(`quality=${i.quality}`),o.join("&")}}const Vm="2.10.4",Hm={"X-Client-Info":`storage-js/${Vm}`};var Ea=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};class Gm{constructor(i,o={},f,x){const m=new URL(i);x?.useNewHostname&&/supabase\.(co|in|red)$/.test(m.hostname)&&!m.hostname.includes("storage.supabase.")&&(m.hostname=m.hostname.replace("supabase.","storage.supabase.")),this.url=m.href,this.headers=Object.assign(Object.assign({},Hm),o),this.fetch=e1(f)}listBuckets(){return Ea(this,void 0,void 0,function*(){try{return{data:yield rc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(i){if(Jr(i))return{data:null,error:i};throw i}})}getBucket(i){return Ea(this,void 0,void 0,function*(){try{return{data:yield rc(this.fetch,`${this.url}/bucket/${i}`,{headers:this.headers}),error:null}}catch(o){if(Jr(o))return{data:null,error:o};throw o}})}createBucket(i,o={public:!1}){return Ea(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/bucket`,{id:i,name:i,type:o.type,public:o.public,file_size_limit:o.fileSizeLimit,allowed_mime_types:o.allowedMimeTypes},{headers:this.headers}),error:null}}catch(f){if(Jr(f))return{data:null,error:f};throw f}})}updateBucket(i,o){return Ea(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/bucket/${i}`,{id:i,name:i,public:o.public,file_size_limit:o.fileSizeLimit,allowed_mime_types:o.allowedMimeTypes},{headers:this.headers}),error:null}}catch(f){if(Jr(f))return{data:null,error:f};throw f}})}emptyBucket(i){return Ea(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/bucket/${i}/empty`,{},{headers:this.headers}),error:null}}catch(o){if(Jr(o))return{data:null,error:o};throw o}})}deleteBucket(i){return Ea(this,void 0,void 0,function*(){try{return{data:yield t1(this.fetch,`${this.url}/bucket/${i}`,{},{headers:this.headers}),error:null}}catch(o){if(Jr(o))return{data:null,error:o};throw o}})}}class $m extends Gm{constructor(i,o={},f,x){super(i,o,f,x)}from(i){return new zm(this.url,this.headers,i,this.fetch)}}const Xm="2.54.0";let Ao="";typeof Deno<"u"?Ao="deno":typeof document<"u"?Ao="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ao="react-native":Ao="node";const qm={"X-Client-Info":`supabase-js-${Ao}/${Xm}`},Km={headers:qm},Ym={schema:"public"},Zm={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Qm={};var Jm=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};const ep=h=>{let i;return h?i=h:typeof fetch>"u"?i=Gf:i=fetch,(...o)=>i(...o)},tp=()=>typeof Headers>"u"?$f:Headers,rp=(h,i,o)=>{const f=ep(o),x=tp();return(m,w)=>Jm(void 0,void 0,void 0,function*(){var S;const N=(S=yield i())!==null&&S!==void 0?S:h;let b=new x(w?.headers);return b.has("apikey")||b.set("apikey",h),b.has("Authorization")||b.set("Authorization",`Bearer ${N}`),f(m,Object.assign(Object.assign({},w),{headers:b}))})};var np=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};function sp(h){return h.endsWith("/")?h:h+"/"}function ip(h,i){var o,f;const{db:x,auth:m,realtime:w,global:S}=h,{db:N,auth:b,realtime:E,global:A}=i,O={db:Object.assign(Object.assign({},N),x),auth:Object.assign(Object.assign({},b),m),realtime:Object.assign(Object.assign({},E),w),storage:{},global:Object.assign(Object.assign(Object.assign({},A),S),{headers:Object.assign(Object.assign({},(o=A?.headers)!==null&&o!==void 0?o:{}),(f=S?.headers)!==null&&f!==void 0?f:{})}),accessToken:()=>np(this,void 0,void 0,function*(){return""})};return h.accessToken?O.accessToken=h.accessToken:delete O.accessToken,O}const r1="2.71.1",Ia=30*1e3,od=3,Xu=od*Ia,ap="http://localhost:9999",op="supabase.auth.token",lp={"X-Client-Info":`gotrue-js/${r1}`},ld="X-Supabase-Api-Version",n1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},cp=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,up=10*60*1e3;class vd extends Error{constructor(i,o,f){super(i),this.__isAuthError=!0,this.name="AuthError",this.status=o,this.code=f}}function vt(h){return typeof h=="object"&&h!==null&&"__isAuthError"in h}class dp extends vd{constructor(i,o,f){super(i,o,f),this.name="AuthApiError",this.status=o,this.code=f}}function hp(h){return vt(h)&&h.name==="AuthApiError"}class s1 extends vd{constructor(i,o){super(i),this.name="AuthUnknownError",this.originalError=o}}class fi extends vd{constructor(i,o,f,x){super(i,f,x),this.name=o,this.status=f}}class li extends fi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function fp(h){return vt(h)&&h.name==="AuthSessionMissingError"}class Ql extends fi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jl extends fi{constructor(i){super(i,"AuthInvalidCredentialsError",400,void 0)}}class ec extends fi{constructor(i,o=null){super(i,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=o}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function gp(h){return vt(h)&&h.name==="AuthImplicitGrantRedirectError"}class rf extends fi{constructor(i,o=null){super(i,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=o}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cd extends fi{constructor(i,o){super(i,"AuthRetryableFetchError",o,void 0)}}function qu(h){return vt(h)&&h.name==="AuthRetryableFetchError"}class nf extends fi{constructor(i,o,f){super(i,"AuthWeakPasswordError",o,"weak_password"),this.reasons=f}}class ud extends fi{constructor(i){super(i,"AuthInvalidJwtError",400,"invalid_jwt")}}const nc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sf=` 	
\r=`.split(""),xp=(()=>{const h=new Array(128);for(let i=0;i<h.length;i+=1)h[i]=-1;for(let i=0;i<sf.length;i+=1)h[sf[i].charCodeAt(0)]=-2;for(let i=0;i<nc.length;i+=1)h[nc[i].charCodeAt(0)]=i;return h})();function af(h,i,o){if(h!==null)for(i.queue=i.queue<<8|h,i.queuedBits+=8;i.queuedBits>=6;){const f=i.queue>>i.queuedBits-6&63;o(nc[f]),i.queuedBits-=6}else if(i.queuedBits>0)for(i.queue=i.queue<<6-i.queuedBits,i.queuedBits=6;i.queuedBits>=6;){const f=i.queue>>i.queuedBits-6&63;o(nc[f]),i.queuedBits-=6}}function i1(h,i,o){const f=xp[h];if(f>-1)for(i.queue=i.queue<<6|f,i.queuedBits+=6;i.queuedBits>=8;)o(i.queue>>i.queuedBits-8&255),i.queuedBits-=8;else{if(f===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(h)}"`)}}function of(h){const i=[],o=w=>{i.push(String.fromCodePoint(w))},f={utf8seq:0,codepoint:0},x={queue:0,queuedBits:0},m=w=>{yp(w,f,o)};for(let w=0;w<h.length;w+=1)i1(h.charCodeAt(w),x,m);return i.join("")}function mp(h,i){if(h<=127){i(h);return}else if(h<=2047){i(192|h>>6),i(128|h&63);return}else if(h<=65535){i(224|h>>12),i(128|h>>6&63),i(128|h&63);return}else if(h<=1114111){i(240|h>>18),i(128|h>>12&63),i(128|h>>6&63),i(128|h&63);return}throw new Error(`Unrecognized Unicode codepoint: ${h.toString(16)}`)}function pp(h,i){for(let o=0;o<h.length;o+=1){let f=h.charCodeAt(o);if(f>55295&&f<=56319){const x=(f-55296)*1024&65535;f=(h.charCodeAt(o+1)-56320&65535|x)+65536,o+=1}mp(f,i)}}function yp(h,i,o){if(i.utf8seq===0){if(h<=127){o(h);return}for(let f=1;f<6;f+=1)if((h>>7-f&1)===0){i.utf8seq=f;break}if(i.utf8seq===2)i.codepoint=h&31;else if(i.utf8seq===3)i.codepoint=h&15;else if(i.utf8seq===4)i.codepoint=h&7;else throw new Error("Invalid UTF-8 sequence");i.utf8seq-=1}else if(i.utf8seq>0){if(h<=127)throw new Error("Invalid UTF-8 sequence");i.codepoint=i.codepoint<<6|h&63,i.utf8seq-=1,i.utf8seq===0&&o(i.codepoint)}}function wp(h){const i=[],o={queue:0,queuedBits:0},f=x=>{i.push(x)};for(let x=0;x<h.length;x+=1)i1(h.charCodeAt(x),o,f);return new Uint8Array(i)}function vp(h){const i=[];return pp(h,o=>i.push(o)),new Uint8Array(i)}function bp(h){const i=[],o={queue:0,queuedBits:0},f=x=>{i.push(x)};return h.forEach(x=>af(x,o,f)),af(null,o,f),i.join("")}function _p(h){return Math.round(Date.now()/1e3)+h}function Np(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){const i=Math.random()*16|0;return(h=="x"?i:i&3|8).toString(16)})}const is=()=>typeof window<"u"&&typeof document<"u",Pi={tested:!1,writable:!1},a1=()=>{if(!is())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Pi.tested)return Pi.writable;const h=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(h,h),globalThis.localStorage.removeItem(h),Pi.tested=!0,Pi.writable=!0}catch{Pi.tested=!0,Pi.writable=!1}return Pi.writable};function Ep(h){const i={},o=new URL(h);if(o.hash&&o.hash[0]==="#")try{new URLSearchParams(o.hash.substring(1)).forEach((x,m)=>{i[m]=x})}catch{}return o.searchParams.forEach((f,x)=>{i[x]=f}),i}const o1=h=>{let i;return h?i=h:typeof fetch>"u"?i=(...o)=>Ba(async()=>{const{default:f}=await Promise.resolve().then(()=>Fa);return{default:f}},void 0).then(({default:f})=>f(...o)):i=fetch,(...o)=>i(...o)},Cp=h=>typeof h=="object"&&h!==null&&"status"in h&&"ok"in h&&"json"in h&&typeof h.json=="function",Ta=async(h,i,o)=>{await h.setItem(i,JSON.stringify(o))},Li=async(h,i)=>{const o=await h.getItem(i);if(!o)return null;try{return JSON.parse(o)}catch{return o}},oi=async(h,i)=>{await h.removeItem(i)};class gc{constructor(){this.promise=new gc.promiseConstructor((i,o)=>{this.resolve=i,this.reject=o})}}gc.promiseConstructor=Promise;function Ku(h){const i=h.split(".");if(i.length!==3)throw new ud("Invalid JWT structure");for(let f=0;f<i.length;f++)if(!cp.test(i[f]))throw new ud("JWT not in base64url format");return{header:JSON.parse(of(i[0])),payload:JSON.parse(of(i[1])),signature:wp(i[2]),raw:{header:i[0],payload:i[1]}}}async function Sp(h){return await new Promise(i=>{setTimeout(()=>i(null),h)})}function Ap(h,i){return new Promise((f,x)=>{(async()=>{for(let m=0;m<1/0;m++)try{const w=await h(m);if(!i(m,null,w)){f(w);return}}catch(w){if(!i(m,w)){x(w);return}}})()})}function kp(h){return("0"+h.toString(16)).substr(-2)}function Ip(){const i=new Uint32Array(56);if(typeof crypto>"u"){const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",f=o.length;let x="";for(let m=0;m<56;m++)x+=o.charAt(Math.floor(Math.random()*f));return x}return crypto.getRandomValues(i),Array.from(i,kp).join("")}async function Tp(h){const o=new TextEncoder().encode(h),f=await crypto.subtle.digest("SHA-256",o),x=new Uint8Array(f);return Array.from(x).map(m=>String.fromCharCode(m)).join("")}async function jp(h){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),h;const o=await Tp(h);return btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ca(h,i,o=!1){const f=Ip();let x=f;o&&(x+="/PASSWORD_RECOVERY"),await Ta(h,`${i}-code-verifier`,x);const m=await jp(f);return[m,f===m?"plain":"s256"]}const Rp=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Op(h){const i=h.headers.get(ld);if(!i||!i.match(Rp))return null;try{return new Date(`${i}T00:00:00.0Z`)}catch{return null}}function Dp(h){if(!h)throw new Error("Missing exp claim");const i=Math.floor(Date.now()/1e3);if(h<=i)throw new Error("JWT has expired")}function Mp(h){switch(h){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Pp=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Sa(h){if(!Pp.test(h))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Yu(){const h={};return new Proxy(h,{get:(i,o)=>{if(o==="__isUserNotAvailableProxy")return!0;if(typeof o=="symbol"){const f=o.toString();if(f==="Symbol(Symbol.toPrimitive)"||f==="Symbol(Symbol.toStringTag)"||f==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${o}" property of the session object is not supported. Please use getUser() instead.`)},set:(i,o)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${o}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(i,o)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${o}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function lf(h){return JSON.parse(JSON.stringify(h))}var Lp=function(h,i){var o={};for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&i.indexOf(f)<0&&(o[f]=h[f]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var x=0,f=Object.getOwnPropertySymbols(h);x<f.length;x++)i.indexOf(f[x])<0&&Object.prototype.propertyIsEnumerable.call(h,f[x])&&(o[f[x]]=h[f[x]]);return o};const Bi=h=>h.msg||h.message||h.error_description||h.error||JSON.stringify(h),Bp=[502,503,504];async function cf(h){var i;if(!Cp(h))throw new cd(Bi(h),0);if(Bp.includes(h.status))throw new cd(Bi(h),h.status);let o;try{o=await h.json()}catch(m){throw new s1(Bi(m),m)}let f;const x=Op(h);if(x&&x.getTime()>=n1["2024-01-01"].timestamp&&typeof o=="object"&&o&&typeof o.code=="string"?f=o.code:typeof o=="object"&&o&&typeof o.error_code=="string"&&(f=o.error_code),f){if(f==="weak_password")throw new nf(Bi(o),h.status,((i=o.weak_password)===null||i===void 0?void 0:i.reasons)||[]);if(f==="session_not_found")throw new li}else if(typeof o=="object"&&o&&typeof o.weak_password=="object"&&o.weak_password&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.reasons.reduce((m,w)=>m&&typeof w=="string",!0))throw new nf(Bi(o),h.status,o.weak_password.reasons);throw new dp(Bi(o),h.status||500,f)}const Fp=(h,i,o,f)=>{const x={method:h,headers:i?.headers||{}};return h==="GET"?x:(x.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},i?.headers),x.body=JSON.stringify(f),Object.assign(Object.assign({},x),o))};async function Rt(h,i,o,f){var x;const m=Object.assign({},f?.headers);m[ld]||(m[ld]=n1["2024-01-01"].name),f?.jwt&&(m.Authorization=`Bearer ${f.jwt}`);const w=(x=f?.query)!==null&&x!==void 0?x:{};f?.redirectTo&&(w.redirect_to=f.redirectTo);const S=Object.keys(w).length?"?"+new URLSearchParams(w).toString():"",N=await Up(h,i,o+S,{headers:m,noResolveJson:f?.noResolveJson},{},f?.body);return f?.xform?f?.xform(N):{data:Object.assign({},N),error:null}}async function Up(h,i,o,f,x,m){const w=Fp(i,f,x,m);let S;try{S=await h(o,Object.assign({},w))}catch(N){throw console.error(N),new cd(Bi(N),0)}if(S.ok||await cf(S),f?.noResolveJson)return S;try{return await S.json()}catch(N){await cf(N)}}function Rs(h){var i;let o=null;Hp(h)&&(o=Object.assign({},h),h.expires_at||(o.expires_at=_p(h.expires_in)));const f=(i=h.user)!==null&&i!==void 0?i:h;return{data:{session:o,user:f},error:null}}function uf(h){const i=Rs(h);return!i.error&&h.weak_password&&typeof h.weak_password=="object"&&Array.isArray(h.weak_password.reasons)&&h.weak_password.reasons.length&&h.weak_password.message&&typeof h.weak_password.message=="string"&&h.weak_password.reasons.reduce((o,f)=>o&&typeof f=="string",!0)&&(i.data.weak_password=h.weak_password),i}function ci(h){var i;return{data:{user:(i=h.user)!==null&&i!==void 0?i:h},error:null}}function Wp(h){return{data:h,error:null}}function zp(h){const{action_link:i,email_otp:o,hashed_token:f,redirect_to:x,verification_type:m}=h,w=Lp(h,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),S={action_link:i,email_otp:o,hashed_token:f,redirect_to:x,verification_type:m},N=Object.assign({},w);return{data:{properties:S,user:N},error:null}}function Vp(h){return h}function Hp(h){return h.access_token&&h.refresh_token&&h.expires_in}const Zu=["global","local","others"];var Gp=function(h,i){var o={};for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&i.indexOf(f)<0&&(o[f]=h[f]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var x=0,f=Object.getOwnPropertySymbols(h);x<f.length;x++)i.indexOf(f[x])<0&&Object.prototype.propertyIsEnumerable.call(h,f[x])&&(o[f[x]]=h[f[x]]);return o};class $p{constructor({url:i="",headers:o={},fetch:f}){this.url=i,this.headers=o,this.fetch=o1(f),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(i,o=Zu[0]){if(Zu.indexOf(o)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zu.join(", ")}`);try{return await Rt(this.fetch,"POST",`${this.url}/logout?scope=${o}`,{headers:this.headers,jwt:i,noResolveJson:!0}),{data:null,error:null}}catch(f){if(vt(f))return{data:null,error:f};throw f}}async inviteUserByEmail(i,o={}){try{return await Rt(this.fetch,"POST",`${this.url}/invite`,{body:{email:i,data:o.data},headers:this.headers,redirectTo:o.redirectTo,xform:ci})}catch(f){if(vt(f))return{data:{user:null},error:f};throw f}}async generateLink(i){try{const{options:o}=i,f=Gp(i,["options"]),x=Object.assign(Object.assign({},f),o);return"newEmail"in f&&(x.new_email=f?.newEmail,delete x.newEmail),await Rt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:x,headers:this.headers,xform:zp,redirectTo:o?.redirectTo})}catch(o){if(vt(o))return{data:{properties:null,user:null},error:o};throw o}}async createUser(i){try{return await Rt(this.fetch,"POST",`${this.url}/admin/users`,{body:i,headers:this.headers,xform:ci})}catch(o){if(vt(o))return{data:{user:null},error:o};throw o}}async listUsers(i){var o,f,x,m,w,S,N;try{const b={nextPage:null,lastPage:0,total:0},E=await Rt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(f=(o=i?.page)===null||o===void 0?void 0:o.toString())!==null&&f!==void 0?f:"",per_page:(m=(x=i?.perPage)===null||x===void 0?void 0:x.toString())!==null&&m!==void 0?m:""},xform:Vp});if(E.error)throw E.error;const A=await E.json(),O=(w=E.headers.get("x-total-count"))!==null&&w!==void 0?w:0,D=(N=(S=E.headers.get("link"))===null||S===void 0?void 0:S.split(","))!==null&&N!==void 0?N:[];return D.length>0&&(D.forEach(z=>{const F=parseInt(z.split(";")[0].split("=")[1].substring(0,1)),U=JSON.parse(z.split(";")[1].split("=")[1]);b[`${U}Page`]=F}),b.total=parseInt(O)),{data:Object.assign(Object.assign({},A),b),error:null}}catch(b){if(vt(b))return{data:{users:[]},error:b};throw b}}async getUserById(i){Sa(i);try{return await Rt(this.fetch,"GET",`${this.url}/admin/users/${i}`,{headers:this.headers,xform:ci})}catch(o){if(vt(o))return{data:{user:null},error:o};throw o}}async updateUserById(i,o){Sa(i);try{return await Rt(this.fetch,"PUT",`${this.url}/admin/users/${i}`,{body:o,headers:this.headers,xform:ci})}catch(f){if(vt(f))return{data:{user:null},error:f};throw f}}async deleteUser(i,o=!1){Sa(i);try{return await Rt(this.fetch,"DELETE",`${this.url}/admin/users/${i}`,{headers:this.headers,body:{should_soft_delete:o},xform:ci})}catch(f){if(vt(f))return{data:{user:null},error:f};throw f}}async _listFactors(i){Sa(i.userId);try{const{data:o,error:f}=await Rt(this.fetch,"GET",`${this.url}/admin/users/${i.userId}/factors`,{headers:this.headers,xform:x=>({data:{factors:x},error:null})});return{data:o,error:f}}catch(o){if(vt(o))return{data:null,error:o};throw o}}async _deleteFactor(i){Sa(i.userId),Sa(i.id);try{return{data:await Rt(this.fetch,"DELETE",`${this.url}/admin/users/${i.userId}/factors/${i.id}`,{headers:this.headers}),error:null}}catch(o){if(vt(o))return{data:null,error:o};throw o}}}function df(h={}){return{getItem:i=>h[i]||null,setItem:(i,o)=>{h[i]=o},removeItem:i=>{delete h[i]}}}function Xp(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Aa={debug:!!(globalThis&&a1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class l1 extends Error{constructor(i){super(i),this.isAcquireTimeout=!0}}class qp extends l1{}async function Kp(h,i,o){Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",h,i);const f=new globalThis.AbortController;return i>0&&setTimeout(()=>{f.abort(),Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",h)},i),await Promise.resolve().then(()=>globalThis.navigator.locks.request(h,i===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:f.signal},async x=>{if(x){Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",h,x.name);try{return await o()}finally{Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",h,x.name)}}else{if(i===0)throw Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",h),new qp(`Acquiring an exclusive Navigator LockManager lock "${h}" immediately failed`);if(Aa.debug)try{const m=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(m,null,"  "))}catch(m){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",m)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await o()}}))}Xp();const Yp={url:ap,storageKey:op,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:lp,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hf(h,i,o){return await o()}const ka={};class Mo{constructor(i){var o,f;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Mo.nextInstanceID,Mo.nextInstanceID+=1,this.instanceID>0&&is()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const x=Object.assign(Object.assign({},Yp),i);if(this.logDebugMessages=!!x.debug,typeof x.debug=="function"&&(this.logger=x.debug),this.persistSession=x.persistSession,this.storageKey=x.storageKey,this.autoRefreshToken=x.autoRefreshToken,this.admin=new $p({url:x.url,headers:x.headers,fetch:x.fetch}),this.url=x.url,this.headers=x.headers,this.fetch=o1(x.fetch),this.lock=x.lock||hf,this.detectSessionInUrl=x.detectSessionInUrl,this.flowType=x.flowType,this.hasCustomAuthorizationHeader=x.hasCustomAuthorizationHeader,x.lock?this.lock=x.lock:is()&&(!((o=globalThis?.navigator)===null||o===void 0)&&o.locks)?this.lock=Kp:this.lock=hf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(x.storage?this.storage=x.storage:a1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=df(this.memoryStorage)),x.userStorage&&(this.userStorage=x.userStorage)):(this.memoryStorage={},this.storage=df(this.memoryStorage)),is()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(m){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",m)}(f=this.broadcastChannel)===null||f===void 0||f.addEventListener("message",async m=>{this._debug("received broadcast notification from other tab or client",m),await this._notifyAllSubscribers(m.data.event,m.data.session,!1)})}this.initialize()}get jwks(){var i,o;return(o=(i=ka[this.storageKey])===null||i===void 0?void 0:i.jwks)!==null&&o!==void 0?o:{keys:[]}}set jwks(i){ka[this.storageKey]=Object.assign(Object.assign({},ka[this.storageKey]),{jwks:i})}get jwks_cached_at(){var i,o;return(o=(i=ka[this.storageKey])===null||i===void 0?void 0:i.cachedAt)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER}set jwks_cached_at(i){ka[this.storageKey]=Object.assign(Object.assign({},ka[this.storageKey]),{cachedAt:i})}_debug(...i){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${r1}) ${new Date().toISOString()}`,...i),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var i;try{const o=Ep(window.location.href);let f="none";if(this._isImplicitGrantCallback(o)?f="implicit":await this._isPKCECallback(o)&&(f="pkce"),is()&&this.detectSessionInUrl&&f!=="none"){const{data:x,error:m}=await this._getSessionFromURL(o,f);if(m){if(this._debug("#_initialize()","error detecting session from URL",m),gp(m)){const N=(i=m.details)===null||i===void 0?void 0:i.code;if(N==="identity_already_exists"||N==="identity_not_found"||N==="single_identity_not_deletable")return{error:m}}return await this._removeSession(),{error:m}}const{session:w,redirectType:S}=x;return this._debug("#_initialize()","detected session in URL",w,"redirect type",S),await this._saveSession(w),setTimeout(async()=>{S==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",w):await this._notifyAllSubscribers("SIGNED_IN",w)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(o){return vt(o)?{error:o}:{error:new s1("Unexpected error during initialization",o)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(i){var o,f,x;try{const m=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(f=(o=i?.options)===null||o===void 0?void 0:o.data)!==null&&f!==void 0?f:{},gotrue_meta_security:{captcha_token:(x=i?.options)===null||x===void 0?void 0:x.captchaToken}},xform:Rs}),{data:w,error:S}=m;if(S||!w)return{data:{user:null,session:null},error:S};const N=w.session,b=w.user;return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",N)),{data:{user:b,session:N},error:null}}catch(m){if(vt(m))return{data:{user:null,session:null},error:m};throw m}}async signUp(i){var o,f,x;try{let m;if("email"in i){const{email:E,password:A,options:O}=i;let D=null,z=null;this.flowType==="pkce"&&([D,z]=await Ca(this.storage,this.storageKey)),m=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:O?.emailRedirectTo,body:{email:E,password:A,data:(o=O?.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:O?.captchaToken},code_challenge:D,code_challenge_method:z},xform:Rs})}else if("phone"in i){const{phone:E,password:A,options:O}=i;m=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:E,password:A,data:(f=O?.data)!==null&&f!==void 0?f:{},channel:(x=O?.channel)!==null&&x!==void 0?x:"sms",gotrue_meta_security:{captcha_token:O?.captchaToken}},xform:Rs})}else throw new Jl("You must provide either an email or phone number and a password");const{data:w,error:S}=m;if(S||!w)return{data:{user:null,session:null},error:S};const N=w.session,b=w.user;return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",N)),{data:{user:b,session:N},error:null}}catch(m){if(vt(m))return{data:{user:null,session:null},error:m};throw m}}async signInWithPassword(i){try{let o;if("email"in i){const{email:m,password:w,options:S}=i;o=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:m,password:w,gotrue_meta_security:{captcha_token:S?.captchaToken}},xform:uf})}else if("phone"in i){const{phone:m,password:w,options:S}=i;o=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:m,password:w,gotrue_meta_security:{captcha_token:S?.captchaToken}},xform:uf})}else throw new Jl("You must provide either an email or phone number and a password");const{data:f,error:x}=o;return x?{data:{user:null,session:null},error:x}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new Ql}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:Object.assign({user:f.user,session:f.session},f.weak_password?{weakPassword:f.weak_password}:null),error:x})}catch(o){if(vt(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithOAuth(i){var o,f,x,m;return await this._handleProviderSignIn(i.provider,{redirectTo:(o=i.options)===null||o===void 0?void 0:o.redirectTo,scopes:(f=i.options)===null||f===void 0?void 0:f.scopes,queryParams:(x=i.options)===null||x===void 0?void 0:x.queryParams,skipBrowserRedirect:(m=i.options)===null||m===void 0?void 0:m.skipBrowserRedirect})}async exchangeCodeForSession(i){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(i))}async signInWithWeb3(i){const{chain:o}=i;if(o==="solana")return await this.signInWithSolana(i);throw new Error(`@supabase/auth-js: Unsupported chain "${o}"`)}async signInWithSolana(i){var o,f,x,m,w,S,N,b,E,A,O,D;let z,F;if("message"in i)z=i.message,F=i.signature;else{const{chain:U,wallet:ie,statement:re,options:L}=i;let Y;if(is())if(typeof ie=="object")Y=ie;else{const ce=window;if("solana"in ce&&typeof ce.solana=="object"&&("signIn"in ce.solana&&typeof ce.solana.signIn=="function"||"signMessage"in ce.solana&&typeof ce.solana.signMessage=="function"))Y=ce.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof ie!="object"||!L?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Y=ie}const ne=new URL((o=L?.url)!==null&&o!==void 0?o:window.location.href);if("signIn"in Y&&Y.signIn){const ce=await Y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},L?.signInWithSolana),{version:"1",domain:ne.host,uri:ne.href}),re?{statement:re}:null));let q;if(Array.isArray(ce)&&ce[0]&&typeof ce[0]=="object")q=ce[0];else if(ce&&typeof ce=="object"&&"signedMessage"in ce&&"signature"in ce)q=ce;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in q&&"signature"in q&&(typeof q.signedMessage=="string"||q.signedMessage instanceof Uint8Array)&&q.signature instanceof Uint8Array)z=typeof q.signedMessage=="string"?q.signedMessage:new TextDecoder().decode(q.signedMessage),F=q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in Y)||typeof Y.signMessage!="function"||!("publicKey"in Y)||typeof Y!="object"||!Y.publicKey||!("toBase58"in Y.publicKey)||typeof Y.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");z=[`${ne.host} wants you to sign in with your Solana account:`,Y.publicKey.toBase58(),...re?["",re,""]:[""],"Version: 1",`URI: ${ne.href}`,`Issued At: ${(x=(f=L?.signInWithSolana)===null||f===void 0?void 0:f.issuedAt)!==null&&x!==void 0?x:new Date().toISOString()}`,...!((m=L?.signInWithSolana)===null||m===void 0)&&m.notBefore?[`Not Before: ${L.signInWithSolana.notBefore}`]:[],...!((w=L?.signInWithSolana)===null||w===void 0)&&w.expirationTime?[`Expiration Time: ${L.signInWithSolana.expirationTime}`]:[],...!((S=L?.signInWithSolana)===null||S===void 0)&&S.chainId?[`Chain ID: ${L.signInWithSolana.chainId}`]:[],...!((N=L?.signInWithSolana)===null||N===void 0)&&N.nonce?[`Nonce: ${L.signInWithSolana.nonce}`]:[],...!((b=L?.signInWithSolana)===null||b===void 0)&&b.requestId?[`Request ID: ${L.signInWithSolana.requestId}`]:[],...!((A=(E=L?.signInWithSolana)===null||E===void 0?void 0:E.resources)===null||A===void 0)&&A.length?["Resources",...L.signInWithSolana.resources.map(q=>`- ${q}`)]:[]].join(`
`);const ce=await Y.signMessage(new TextEncoder().encode(z),"utf8");if(!ce||!(ce instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");F=ce}}try{const{data:U,error:ie}=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:z,signature:bp(F)},!((O=i.options)===null||O===void 0)&&O.captchaToken?{gotrue_meta_security:{captcha_token:(D=i.options)===null||D===void 0?void 0:D.captchaToken}}:null),xform:Rs});if(ie)throw ie;return!U||!U.session||!U.user?{data:{user:null,session:null},error:new Ql}:(U.session&&(await this._saveSession(U.session),await this._notifyAllSubscribers("SIGNED_IN",U.session)),{data:Object.assign({},U),error:ie})}catch(U){if(vt(U))return{data:{user:null,session:null},error:U};throw U}}async _exchangeCodeForSession(i){const o=await Li(this.storage,`${this.storageKey}-code-verifier`),[f,x]=(o??"").split("/");try{const{data:m,error:w}=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:i,code_verifier:f},xform:Rs});if(await oi(this.storage,`${this.storageKey}-code-verifier`),w)throw w;return!m||!m.session||!m.user?{data:{user:null,session:null,redirectType:null},error:new Ql}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign(Object.assign({},m),{redirectType:x??null}),error:w})}catch(m){if(vt(m))return{data:{user:null,session:null,redirectType:null},error:m};throw m}}async signInWithIdToken(i){try{const{options:o,provider:f,token:x,access_token:m,nonce:w}=i,S=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:f,id_token:x,access_token:m,nonce:w,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Rs}),{data:N,error:b}=S;return b?{data:{user:null,session:null},error:b}:!N||!N.session||!N.user?{data:{user:null,session:null},error:new Ql}:(N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),{data:N,error:b})}catch(o){if(vt(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithOtp(i){var o,f,x,m,w;try{if("email"in i){const{email:S,options:N}=i;let b=null,E=null;this.flowType==="pkce"&&([b,E]=await Ca(this.storage,this.storageKey));const{error:A}=await Rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:S,data:(o=N?.data)!==null&&o!==void 0?o:{},create_user:(f=N?.shouldCreateUser)!==null&&f!==void 0?f:!0,gotrue_meta_security:{captcha_token:N?.captchaToken},code_challenge:b,code_challenge_method:E},redirectTo:N?.emailRedirectTo});return{data:{user:null,session:null},error:A}}if("phone"in i){const{phone:S,options:N}=i,{data:b,error:E}=await Rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:S,data:(x=N?.data)!==null&&x!==void 0?x:{},create_user:(m=N?.shouldCreateUser)!==null&&m!==void 0?m:!0,gotrue_meta_security:{captcha_token:N?.captchaToken},channel:(w=N?.channel)!==null&&w!==void 0?w:"sms"}});return{data:{user:null,session:null,messageId:b?.message_id},error:E}}throw new Jl("You must provide either an email or phone number.")}catch(S){if(vt(S))return{data:{user:null,session:null},error:S};throw S}}async verifyOtp(i){var o,f;try{let x,m;"options"in i&&(x=(o=i.options)===null||o===void 0?void 0:o.redirectTo,m=(f=i.options)===null||f===void 0?void 0:f.captchaToken);const{data:w,error:S}=await Rt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},i),{gotrue_meta_security:{captcha_token:m}}),redirectTo:x,xform:Rs});if(S)throw S;if(!w)throw new Error("An error occurred on token verification.");const N=w.session,b=w.user;return N?.access_token&&(await this._saveSession(N),await this._notifyAllSubscribers(i.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",N)),{data:{user:b,session:N},error:null}}catch(x){if(vt(x))return{data:{user:null,session:null},error:x};throw x}}async signInWithSSO(i){var o,f,x;try{let m=null,w=null;return this.flowType==="pkce"&&([m,w]=await Ca(this.storage,this.storageKey)),await Rt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in i?{provider_id:i.providerId}:null),"domain"in i?{domain:i.domain}:null),{redirect_to:(f=(o=i.options)===null||o===void 0?void 0:o.redirectTo)!==null&&f!==void 0?f:void 0}),!((x=i?.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:i.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:m,code_challenge_method:w}),headers:this.headers,xform:Wp})}catch(m){if(vt(m))return{data:null,error:m};throw m}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async i=>{const{data:{session:o},error:f}=i;if(f)throw f;if(!o)throw new li;const{error:x}=await Rt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:o.access_token});return{data:{user:null,session:null},error:x}})}catch(i){if(vt(i))return{data:{user:null,session:null},error:i};throw i}}async resend(i){try{const o=`${this.url}/resend`;if("email"in i){const{email:f,type:x,options:m}=i,{error:w}=await Rt(this.fetch,"POST",o,{headers:this.headers,body:{email:f,type:x,gotrue_meta_security:{captcha_token:m?.captchaToken}},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:w}}else if("phone"in i){const{phone:f,type:x,options:m}=i,{data:w,error:S}=await Rt(this.fetch,"POST",o,{headers:this.headers,body:{phone:f,type:x,gotrue_meta_security:{captcha_token:m?.captchaToken}}});return{data:{user:null,session:null,messageId:w?.message_id},error:S}}throw new Jl("You must provide either an email or phone number and a type")}catch(o){if(vt(o))return{data:{user:null,session:null},error:o};throw o}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async o=>o))}async _acquireLock(i,o){this._debug("#_acquireLock","begin",i);try{if(this.lockAcquired){const f=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),x=(async()=>(await f,await o()))();return this.pendingInLock.push((async()=>{try{await x}catch{}})()),x}return await this.lock(`lock:${this.storageKey}`,i,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const f=o();for(this.pendingInLock.push((async()=>{try{await f}catch{}})()),await f;this.pendingInLock.length;){const x=[...this.pendingInLock];await Promise.all(x),this.pendingInLock.splice(0,x.length)}return await f}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(i){this._debug("#_useSession","begin");try{const o=await this.__loadSession();return await i(o)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let i=null;const o=await Li(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",o),o!==null&&(this._isValidSession(o)?i=o:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!i)return{data:{session:null},error:null};const f=i.expires_at?i.expires_at*1e3-Date.now()<Xu:!1;if(this._debug("#__loadSession()",`session has${f?"":" not"} expired`,"expires_at",i.expires_at),!f){if(this.userStorage){const w=await Li(this.userStorage,this.storageKey+"-user");w?.user?i.user=w.user:i.user=Yu()}if(this.storage.isServer&&i.user){let w=this.suppressGetSessionWarning;i=new Proxy(i,{get:(N,b,E)=>(!w&&b==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),w=!0,this.suppressGetSessionWarning=!0),Reflect.get(N,b,E))})}return{data:{session:i},error:null}}const{session:x,error:m}=await this._callRefreshToken(i.refresh_token);return m?{data:{session:null},error:m}:{data:{session:x},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(i){return i?await this._getUser(i):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(i){try{return i?await Rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:i,xform:ci}):await this._useSession(async o=>{var f,x,m;const{data:w,error:S}=o;if(S)throw S;return!(!((f=w.session)===null||f===void 0)&&f.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new li}:await Rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(m=(x=w.session)===null||x===void 0?void 0:x.access_token)!==null&&m!==void 0?m:void 0,xform:ci})})}catch(o){if(vt(o))return fp(o)&&(await this._removeSession(),await oi(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:o};throw o}}async updateUser(i,o={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(i,o))}async _updateUser(i,o={}){try{return await this._useSession(async f=>{const{data:x,error:m}=f;if(m)throw m;if(!x.session)throw new li;const w=x.session;let S=null,N=null;this.flowType==="pkce"&&i.email!=null&&([S,N]=await Ca(this.storage,this.storageKey));const{data:b,error:E}=await Rt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:o?.emailRedirectTo,body:Object.assign(Object.assign({},i),{code_challenge:S,code_challenge_method:N}),jwt:w.access_token,xform:ci});if(E)throw E;return w.user=b.user,await this._saveSession(w),await this._notifyAllSubscribers("USER_UPDATED",w),{data:{user:w.user},error:null}})}catch(f){if(vt(f))return{data:{user:null},error:f};throw f}}async setSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(i))}async _setSession(i){try{if(!i.access_token||!i.refresh_token)throw new li;const o=Date.now()/1e3;let f=o,x=!0,m=null;const{payload:w}=Ku(i.access_token);if(w.exp&&(f=w.exp,x=f<=o),x){const{session:S,error:N}=await this._callRefreshToken(i.refresh_token);if(N)return{data:{user:null,session:null},error:N};if(!S)return{data:{user:null,session:null},error:null};m=S}else{const{data:S,error:N}=await this._getUser(i.access_token);if(N)throw N;m={access_token:i.access_token,refresh_token:i.refresh_token,user:S.user,token_type:"bearer",expires_in:f-o,expires_at:f},await this._saveSession(m),await this._notifyAllSubscribers("SIGNED_IN",m)}return{data:{user:m.user,session:m},error:null}}catch(o){if(vt(o))return{data:{session:null,user:null},error:o};throw o}}async refreshSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(i))}async _refreshSession(i){try{return await this._useSession(async o=>{var f;if(!i){const{data:w,error:S}=o;if(S)throw S;i=(f=w.session)!==null&&f!==void 0?f:void 0}if(!i?.refresh_token)throw new li;const{session:x,error:m}=await this._callRefreshToken(i.refresh_token);return m?{data:{user:null,session:null},error:m}:x?{data:{user:x.user,session:x},error:null}:{data:{user:null,session:null},error:null}})}catch(o){if(vt(o))return{data:{user:null,session:null},error:o};throw o}}async _getSessionFromURL(i,o){try{if(!is())throw new ec("No browser detected.");if(i.error||i.error_description||i.error_code)throw new ec(i.error_description||"Error in URL with unspecified error_description",{error:i.error||"unspecified_error",code:i.error_code||"unspecified_code"});switch(o){case"implicit":if(this.flowType==="pkce")throw new rf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ec("Not a valid implicit grant flow url.");break;default:}if(o==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!i.code)throw new rf("No code detected.");const{data:re,error:L}=await this._exchangeCodeForSession(i.code);if(L)throw L;const Y=new URL(window.location.href);return Y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Y.toString()),{data:{session:re.session,redirectType:null},error:null}}const{provider_token:f,provider_refresh_token:x,access_token:m,refresh_token:w,expires_in:S,expires_at:N,token_type:b}=i;if(!m||!S||!w||!b)throw new ec("No session defined in URL");const E=Math.round(Date.now()/1e3),A=parseInt(S);let O=E+A;N&&(O=parseInt(N));const D=O-E;D*1e3<=Ia&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${D}s, should have been closer to ${A}s`);const z=O-A;E-z>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",z,O,E):E-z<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",z,O,E);const{data:F,error:U}=await this._getUser(m);if(U)throw U;const ie={provider_token:f,provider_refresh_token:x,access_token:m,expires_in:A,expires_at:O,refresh_token:w,token_type:b,user:F.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:ie,redirectType:i.type},error:null}}catch(f){if(vt(f))return{data:{session:null,redirectType:null},error:f};throw f}}_isImplicitGrantCallback(i){return!!(i.access_token||i.error_description)}async _isPKCECallback(i){const o=await Li(this.storage,`${this.storageKey}-code-verifier`);return!!(i.code&&o)}async signOut(i={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(i))}async _signOut({scope:i}={scope:"global"}){return await this._useSession(async o=>{var f;const{data:x,error:m}=o;if(m)return{error:m};const w=(f=x.session)===null||f===void 0?void 0:f.access_token;if(w){const{error:S}=await this.admin.signOut(w,i);if(S&&!(hp(S)&&(S.status===404||S.status===401||S.status===403)))return{error:S}}return i!=="others"&&(await this._removeSession(),await oi(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(i){const o=Np(),f={id:o,callback:i,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",o),this.stateChangeEmitters.delete(o)}};return this._debug("#onAuthStateChange()","registered callback with id",o),this.stateChangeEmitters.set(o,f),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(o)})))(),{data:{subscription:f}}}async _emitInitialSession(i){return await this._useSession(async o=>{var f,x;try{const{data:{session:m},error:w}=o;if(w)throw w;await((f=this.stateChangeEmitters.get(i))===null||f===void 0?void 0:f.callback("INITIAL_SESSION",m)),this._debug("INITIAL_SESSION","callback id",i,"session",m)}catch(m){await((x=this.stateChangeEmitters.get(i))===null||x===void 0?void 0:x.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",i,"error",m),console.error(m)}})}async resetPasswordForEmail(i,o={}){let f=null,x=null;this.flowType==="pkce"&&([f,x]=await Ca(this.storage,this.storageKey,!0));try{return await Rt(this.fetch,"POST",`${this.url}/recover`,{body:{email:i,code_challenge:f,code_challenge_method:x,gotrue_meta_security:{captcha_token:o.captchaToken}},headers:this.headers,redirectTo:o.redirectTo})}catch(m){if(vt(m))return{data:null,error:m};throw m}}async getUserIdentities(){var i;try{const{data:o,error:f}=await this.getUser();if(f)throw f;return{data:{identities:(i=o.user.identities)!==null&&i!==void 0?i:[]},error:null}}catch(o){if(vt(o))return{data:null,error:o};throw o}}async linkIdentity(i){var o;try{const{data:f,error:x}=await this._useSession(async m=>{var w,S,N,b,E;const{data:A,error:O}=m;if(O)throw O;const D=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,i.provider,{redirectTo:(w=i.options)===null||w===void 0?void 0:w.redirectTo,scopes:(S=i.options)===null||S===void 0?void 0:S.scopes,queryParams:(N=i.options)===null||N===void 0?void 0:N.queryParams,skipBrowserRedirect:!0});return await Rt(this.fetch,"GET",D,{headers:this.headers,jwt:(E=(b=A.session)===null||b===void 0?void 0:b.access_token)!==null&&E!==void 0?E:void 0})});if(x)throw x;return is()&&!(!((o=i.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(f?.url),{data:{provider:i.provider,url:f?.url},error:null}}catch(f){if(vt(f))return{data:{provider:i.provider,url:null},error:f};throw f}}async unlinkIdentity(i){try{return await this._useSession(async o=>{var f,x;const{data:m,error:w}=o;if(w)throw w;return await Rt(this.fetch,"DELETE",`${this.url}/user/identities/${i.identity_id}`,{headers:this.headers,jwt:(x=(f=m.session)===null||f===void 0?void 0:f.access_token)!==null&&x!==void 0?x:void 0})})}catch(o){if(vt(o))return{data:null,error:o};throw o}}async _refreshAccessToken(i){const o=`#_refreshAccessToken(${i.substring(0,5)}...)`;this._debug(o,"begin");try{const f=Date.now();return await Ap(async x=>(x>0&&await Sp(200*Math.pow(2,x-1)),this._debug(o,"refreshing attempt",x),await Rt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:i},headers:this.headers,xform:Rs})),(x,m)=>{const w=200*Math.pow(2,x);return m&&qu(m)&&Date.now()+w-f<Ia})}catch(f){if(this._debug(o,"error",f),vt(f))return{data:{session:null,user:null},error:f};throw f}finally{this._debug(o,"end")}}_isValidSession(i){return typeof i=="object"&&i!==null&&"access_token"in i&&"refresh_token"in i&&"expires_at"in i}async _handleProviderSignIn(i,o){const f=await this._getUrlForProvider(`${this.url}/authorize`,i,{redirectTo:o.redirectTo,scopes:o.scopes,queryParams:o.queryParams});return this._debug("#_handleProviderSignIn()","provider",i,"options",o,"url",f),is()&&!o.skipBrowserRedirect&&window.location.assign(f),{data:{provider:i,url:f},error:null}}async _recoverAndRefresh(){var i,o;const f="#_recoverAndRefresh()";this._debug(f,"begin");try{const x=await Li(this.storage,this.storageKey);if(x&&this.userStorage){let w=await Li(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!w&&(w={user:x.user},await Ta(this.userStorage,this.storageKey+"-user",w)),x.user=(i=w?.user)!==null&&i!==void 0?i:Yu()}else if(x&&!x.user&&!x.user){const w=await Li(this.storage,this.storageKey+"-user");w&&w?.user?(x.user=w.user,await oi(this.storage,this.storageKey+"-user"),await Ta(this.storage,this.storageKey,x)):x.user=Yu()}if(this._debug(f,"session from storage",x),!this._isValidSession(x)){this._debug(f,"session is not valid"),x!==null&&await this._removeSession();return}const m=((o=x.expires_at)!==null&&o!==void 0?o:1/0)*1e3-Date.now()<Xu;if(this._debug(f,`session has${m?"":" not"} expired with margin of ${Xu}s`),m){if(this.autoRefreshToken&&x.refresh_token){const{error:w}=await this._callRefreshToken(x.refresh_token);w&&(console.error(w),qu(w)||(this._debug(f,"refresh failed with a non-retryable error, removing the session",w),await this._removeSession()))}}else if(x.user&&x.user.__isUserNotAvailableProxy===!0)try{const{data:w,error:S}=await this._getUser(x.access_token);!S&&w?.user?(x.user=w.user,await this._saveSession(x),await this._notifyAllSubscribers("SIGNED_IN",x)):this._debug(f,"could not get user data, skipping SIGNED_IN notification")}catch(w){console.error("Error getting user data:",w),this._debug(f,"error getting user data, skipping SIGNED_IN notification",w)}else await this._notifyAllSubscribers("SIGNED_IN",x)}catch(x){this._debug(f,"error",x),console.error(x);return}finally{this._debug(f,"end")}}async _callRefreshToken(i){var o,f;if(!i)throw new li;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const x=`#_callRefreshToken(${i.substring(0,5)}...)`;this._debug(x,"begin");try{this.refreshingDeferred=new gc;const{data:m,error:w}=await this._refreshAccessToken(i);if(w)throw w;if(!m.session)throw new li;await this._saveSession(m.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",m.session);const S={session:m.session,error:null};return this.refreshingDeferred.resolve(S),S}catch(m){if(this._debug(x,"error",m),vt(m)){const w={session:null,error:m};return qu(m)||await this._removeSession(),(o=this.refreshingDeferred)===null||o===void 0||o.resolve(w),w}throw(f=this.refreshingDeferred)===null||f===void 0||f.reject(m),m}finally{this.refreshingDeferred=null,this._debug(x,"end")}}async _notifyAllSubscribers(i,o,f=!0){const x=`#_notifyAllSubscribers(${i})`;this._debug(x,"begin",o,`broadcast = ${f}`);try{this.broadcastChannel&&f&&this.broadcastChannel.postMessage({event:i,session:o});const m=[],w=Array.from(this.stateChangeEmitters.values()).map(async S=>{try{await S.callback(i,o)}catch(N){m.push(N)}});if(await Promise.all(w),m.length>0){for(let S=0;S<m.length;S+=1)console.error(m[S]);throw m[0]}}finally{this._debug(x,"end")}}async _saveSession(i){this._debug("#_saveSession()",i),this.suppressGetSessionWarning=!0;const o=Object.assign({},i),f=o.user&&o.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!f&&o.user&&await Ta(this.userStorage,this.storageKey+"-user",{user:o.user});const x=Object.assign({},o);delete x.user;const m=lf(x);await Ta(this.storage,this.storageKey,m)}else{const x=lf(o);await Ta(this.storage,this.storageKey,x)}}async _removeSession(){this._debug("#_removeSession()"),await oi(this.storage,this.storageKey),await oi(this.storage,this.storageKey+"-code-verifier"),await oi(this.storage,this.storageKey+"-user"),this.userStorage&&await oi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const i=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{i&&is()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",i)}catch(o){console.error("removing visibilitychange callback failed",o)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const i=setInterval(()=>this._autoRefreshTokenTick(),Ia);this.autoRefreshTicker=i,i&&typeof i=="object"&&typeof i.unref=="function"?i.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(i),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const i=this.autoRefreshTicker;this.autoRefreshTicker=null,i&&clearInterval(i)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const i=Date.now();try{return await this._useSession(async o=>{const{data:{session:f}}=o;if(!f||!f.refresh_token||!f.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const x=Math.floor((f.expires_at*1e3-i)/Ia);this._debug("#_autoRefreshTokenTick()",`access token expires in ${x} ticks, a tick lasts ${Ia}ms, refresh threshold is ${od} ticks`),x<=od&&await this._callRefreshToken(f.refresh_token)})}catch(o){console.error("Auto refresh tick failed with error. This is likely a transient error.",o)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(i){if(i.isAcquireTimeout||i instanceof l1)this._debug("auto refresh token tick lock not available");else throw i}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!is()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(i){console.error("_handleVisibilityChange",i)}}async _onVisibilityChanged(i){const o=`#_onVisibilityChanged(${i})`;this._debug(o,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),i||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(o,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(i,o,f){const x=[`provider=${encodeURIComponent(o)}`];if(f?.redirectTo&&x.push(`redirect_to=${encodeURIComponent(f.redirectTo)}`),f?.scopes&&x.push(`scopes=${encodeURIComponent(f.scopes)}`),this.flowType==="pkce"){const[m,w]=await Ca(this.storage,this.storageKey),S=new URLSearchParams({code_challenge:`${encodeURIComponent(m)}`,code_challenge_method:`${encodeURIComponent(w)}`});x.push(S.toString())}if(f?.queryParams){const m=new URLSearchParams(f.queryParams);x.push(m.toString())}return f?.skipBrowserRedirect&&x.push(`skip_http_redirect=${f.skipBrowserRedirect}`),`${i}?${x.join("&")}`}async _unenroll(i){try{return await this._useSession(async o=>{var f;const{data:x,error:m}=o;return m?{data:null,error:m}:await Rt(this.fetch,"DELETE",`${this.url}/factors/${i.factorId}`,{headers:this.headers,jwt:(f=x?.session)===null||f===void 0?void 0:f.access_token})})}catch(o){if(vt(o))return{data:null,error:o};throw o}}async _enroll(i){try{return await this._useSession(async o=>{var f,x;const{data:m,error:w}=o;if(w)return{data:null,error:w};const S=Object.assign({friendly_name:i.friendlyName,factor_type:i.factorType},i.factorType==="phone"?{phone:i.phone}:{issuer:i.issuer}),{data:N,error:b}=await Rt(this.fetch,"POST",`${this.url}/factors`,{body:S,headers:this.headers,jwt:(f=m?.session)===null||f===void 0?void 0:f.access_token});return b?{data:null,error:b}:(i.factorType==="totp"&&(!((x=N?.totp)===null||x===void 0)&&x.qr_code)&&(N.totp.qr_code=`data:image/svg+xml;utf-8,${N.totp.qr_code}`),{data:N,error:null})})}catch(o){if(vt(o))return{data:null,error:o};throw o}}async _verify(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async o=>{var f;const{data:x,error:m}=o;if(m)return{data:null,error:m};const{data:w,error:S}=await Rt(this.fetch,"POST",`${this.url}/factors/${i.factorId}/verify`,{body:{code:i.code,challenge_id:i.challengeId},headers:this.headers,jwt:(f=x?.session)===null||f===void 0?void 0:f.access_token});return S?{data:null,error:S}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+w.expires_in},w)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",w),{data:w,error:S})})}catch(o){if(vt(o))return{data:null,error:o};throw o}})}async _challenge(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async o=>{var f;const{data:x,error:m}=o;return m?{data:null,error:m}:await Rt(this.fetch,"POST",`${this.url}/factors/${i.factorId}/challenge`,{body:{channel:i.channel},headers:this.headers,jwt:(f=x?.session)===null||f===void 0?void 0:f.access_token})})}catch(o){if(vt(o))return{data:null,error:o};throw o}})}async _challengeAndVerify(i){const{data:o,error:f}=await this._challenge({factorId:i.factorId});return f?{data:null,error:f}:await this._verify({factorId:i.factorId,challengeId:o.id,code:i.code})}async _listFactors(){const{data:{user:i},error:o}=await this.getUser();if(o)return{data:null,error:o};const f=i?.factors||[],x=f.filter(w=>w.factor_type==="totp"&&w.status==="verified"),m=f.filter(w=>w.factor_type==="phone"&&w.status==="verified");return{data:{all:f,totp:x,phone:m},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async i=>{var o,f;const{data:{session:x},error:m}=i;if(m)return{data:null,error:m};if(!x)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:w}=Ku(x.access_token);let S=null;w.aal&&(S=w.aal);let N=S;((f=(o=x.user.factors)===null||o===void 0?void 0:o.filter(A=>A.status==="verified"))!==null&&f!==void 0?f:[]).length>0&&(N="aal2");const E=w.amr||[];return{data:{currentLevel:S,nextLevel:N,currentAuthenticationMethods:E},error:null}}))}async fetchJwk(i,o={keys:[]}){let f=o.keys.find(S=>S.kid===i);if(f)return f;const x=Date.now();if(f=this.jwks.keys.find(S=>S.kid===i),f&&this.jwks_cached_at+up>x)return f;const{data:m,error:w}=await Rt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(w)throw w;return!m.keys||m.keys.length===0||(this.jwks=m,this.jwks_cached_at=x,f=m.keys.find(S=>S.kid===i),!f)?null:f}async getClaims(i,o={}){try{let f=i;if(!f){const{data:D,error:z}=await this.getSession();if(z||!D.session)return{data:null,error:z};f=D.session.access_token}const{header:x,payload:m,signature:w,raw:{header:S,payload:N}}=Ku(f);o?.allowExpired||Dp(m.exp);const b=!x.alg||x.alg.startsWith("HS")||!x.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(x.kid,o?.keys?{keys:o.keys}:o?.jwks);if(!b){const{error:D}=await this.getUser(f);if(D)throw D;return{data:{claims:m,header:x,signature:w},error:null}}const E=Mp(x.alg),A=await crypto.subtle.importKey("jwk",b,E,!0,["verify"]);if(!await crypto.subtle.verify(E,A,w,vp(`${S}.${N}`)))throw new ud("Invalid JWT signature");return{data:{claims:m,header:x,signature:w},error:null}}catch(f){if(vt(f))return{data:null,error:f};throw f}}}Mo.nextInstanceID=0;const Zp=Mo;class Qp extends Zp{constructor(i){super(i)}}var Jp=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})};class e2{constructor(i,o,f){var x,m,w;if(this.supabaseUrl=i,this.supabaseKey=o,!i)throw new Error("supabaseUrl is required.");if(!o)throw new Error("supabaseKey is required.");const S=sp(i),N=new URL(S);this.realtimeUrl=new URL("realtime/v1",N),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",N),this.storageUrl=new URL("storage/v1",N),this.functionsUrl=new URL("functions/v1",N);const b=`sb-${N.hostname.split(".")[0]}-auth-token`,E={db:Ym,realtime:Qm,auth:Object.assign(Object.assign({},Zm),{storageKey:b}),global:Km},A=ip(f??{},E);this.storageKey=(x=A.auth.storageKey)!==null&&x!==void 0?x:"",this.headers=(m=A.global.headers)!==null&&m!==void 0?m:{},A.accessToken?(this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(O,D)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(D)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((w=A.auth)!==null&&w!==void 0?w:{},this.headers,A.global.fetch),this.fetch=rp(o,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.rest=new mm(new URL("rest/v1",N).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new $m(this.storageUrl.href,this.headers,this.fetch,f?.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new sm(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,o={},f={}){return this.rest.rpc(i,o,f)}channel(i,o={config:{}}){return this.realtime.channel(i,o)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var i,o;return Jp(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:f}=yield this.auth.getSession();return(o=(i=f.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:o,detectSessionInUrl:f,storage:x,storageKey:m,flowType:w,lock:S,debug:N},b,E){const A={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qp({url:this.authUrl.href,headers:Object.assign(Object.assign({},A),b),storageKey:m,autoRefreshToken:i,persistSession:o,detectSessionInUrl:f,storage:x,flowType:w,lock:S,debug:N,fetch:E,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(i){return new Om(this.realtimeUrl.href,Object.assign(Object.assign({},i),{params:Object.assign({apikey:this.supabaseKey},i?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((o,f)=>{this._handleTokenChanged(o,"CLIENT",f?.access_token)})}_handleTokenChanged(i,o,f){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==f?this.changedAccessToken=f:i==="SIGNED_OUT"&&(this.realtime.setAuth(),o=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const t2=(h,i,o)=>new e2(h,i,o);function r2(){if(typeof window<"u"||typeof process>"u")return!1;const h=process.version;if(h==null)return!1;const i=h.match(/^v(\d+)\./);return i?parseInt(i[1],10)<=18:!1}r2()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const n2="https://uefmrjuvkwrvfrfifbqv.supabase.co",s2="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVlZm1yanV2a3dydmZyZmlmYnF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1OTM2MjQsImV4cCI6MjA2NzE2OTYyNH0.CNZbIw1s_aM4U9Z_Z52dsC4OVPPZJ91lvbcLtVhIhAQ",He=t2(n2,s2);function Ln(){return new Date}function bd(){const h=new Date,i=h.getFullYear(),o=(h.getMonth()+1).toString().padStart(2,"0"),f=h.getDate().toString().padStart(2,"0");return`${i}-${o}-${f}`}function _d(){const h=new Date;return new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0)}function Nd(){const h=new Date;return new Date(h.getFullYear(),h.getMonth(),h.getDate(),23,59,59,999)}function os(h){return new Date(h)}function Ps(h){return h.toISOString()}async function c1(h,i){try{const{data:o,error:f}=await He.from("users").select("*").eq("user_id",h).eq("password",i).eq("is_active",!0).single();if(f||!o)throw new Error("잘못된 사용자 ID 또는 비밀번호입니다.");return o}catch(o){throw o}}async function u1(h){try{const{data:i}=await He.from("users").select("user_id").eq("user_id",h.user_id).maybeSingle();if(i)throw new Error("이미 존재하는 사용자 ID입니다.");const{password:o,...f}=h,x={...f,password:h.password},{data:m,error:w}=await He.from("users").insert(x).select().single();if(w)throw new Error(`회원가입 실패: ${w.message}`);if(!m)throw new Error("회원가입 후 데이터를 가져올 수 없습니다.");return m}catch(i){throw i}}async function d1(h){const{data:i,error:o}=await He.from("groups").insert(h).select().single();if(o)throw o;return i}async function Po(h){try{const{data:i}=await He.from("users").select("role").eq("id",h).single();if(!i)return[];if(i.role==="faculty")return await Vo(h);{const{data:o,error:f}=await He.from("group_memberships").select(`
          groups(*)
        `).eq("user_id",h);if(f)throw f;return(o||[]).map(x=>x.groups).filter(Boolean)}}catch(i){throw i}}async function Vo(h){try{const{data:i,error:o}=await He.from("groups").select("*").eq("faculty_id",h).eq("status","active");if(o)throw o;return await Promise.all((i||[]).map(async x=>{const{count:m}=await He.from("group_memberships").select("*",{count:"exact",head:!0}).eq("group_id",x.id);return{...x,memberCount:m||0}}))}catch(i){throw i}}async function h1(h){try{const{data:i,error:o}=await He.from("groups").select("*").eq("id",h).single();if(o)return null;const{count:f}=await He.from("group_memberships").select("*",{count:"exact",head:!0}).eq("group_id",h),{data:x}=await He.from("users").select("name").eq("id",i.faculty_id).single();return{...i,faculty_name:x?.name,memberCount:f||0}}catch{return null}}async function f1(h){const{error:i}=await He.from("groups").delete().eq("id",h);if(i)throw i}async function g1(h,i){const{data:o,error:f}=await He.from("groups").select("name, faculty_id").eq("id",h).single(),{data:x,error:m}=await He.from("users").select("name").eq("id",i).single(),{error:w}=await He.from("group_memberships").delete().eq("group_id",h).eq("user_id",i);if(w)throw w;if(o?.faculty_id)try{await C1(o.faculty_id,x?.name||"알 수 없음",o?.name||"알 수 없음","left")}catch{}}async function ko(h){try{const{data:i,error:o}=await He.from("group_memberships").select(`
        users(*)
      `).eq("group_id",h);if(o)throw o;return(i||[]).map(f=>f.users).filter(Boolean)}catch(i){throw i}}async function x1(h){try{const{data:i,error:o}=await He.from("group_memberships").select("user_id").eq("group_id",h);if(o)throw o;const f=i?.map(S=>S.user_id)||[],{data:x,error:m}=await He.from("users").select("*").eq("is_active",!0).eq("role","student");if(m)throw m;return(x||[]).filter(S=>!f.includes(S.id))}catch(i){throw i}}async function Ed(h,i){try{if(!h||i.length===0)throw new Error("그룹 ID와 사용자 ID가 필요합니다.");const o=i.map(m=>({group_id:h,user_id:m})),{data:f,error:x}=await He.from("group_memberships").insert(o).select();if(x)throw x;return f}catch(o){throw o}}async function m1(){try{const{error:h}=await He.from("users").select("count").limit(1);if(h)return!1;const{error:i}=await He.from("groups").select("count").limit(1);if(i)return!1;const{error:o}=await He.from("group_memberships").select("count").limit(1);return!o}catch{return!1}}async function Cd(h){try{const{data:i,error:o}=await He.from("group_work_settings").select("*").eq("group_id",h).maybeSingle();return o?null:i}catch{return null}}async function Sd(h,i){try{const{data:o,error:f}=await He.from("group_work_settings").select("id").eq("group_id",h).single();if(f&&f.code!=="PGRST116")throw f;let x;if(o){const{data:m,error:w}=await He.from("group_work_settings").update({checkin_deadline_hour:i.checkin_deadline_hour,checkout_start_hour:i.checkout_start_hour,updated_at:new Date().toISOString()}).eq("group_id",h).select().single();if(w)throw w;x=m}else{const{data:m,error:w}=await He.from("group_work_settings").insert({group_id:h,checkin_deadline_hour:i.checkin_deadline_hour,checkout_start_hour:i.checkout_start_hour}).select().single();if(w)throw w;x=m}return x}catch(o){throw o}}async function p1(h,i,o,f,x,m){const w=Ln(),S=w.getHours(),N=w.getMinutes(),b=S+N/60;let E=10,A=18;try{const F=await Cd(i);F&&(E=F.checkin_deadline_hour||10,A=F.checkout_start_hour||18)}catch{}let O="present";o==="checkin"?O=b>E?"late":"present":o==="checkout"&&(O=b<A?"early_leave":"present");const{data:D,error:z}=await He.from("attendance_logs").insert({user_id:h,group_id:i,scan_time:Ps(w),scan_type:o,status:O,latitude:f,longitude:x,absence_reason:m,is_manual:!1}).select(`
      *,
      groups!attendance_logs_group_id_fkey(name, faculty_id),
      users!attendance_logs_user_id_fkey(name)
    `).single();if(z)throw z;if(D&&(O==="late"||O==="early_leave"))try{const F=O==="late"?"late":"early_leave";await E1(D.groups?.faculty_id,D.users?.name||"알 수 없음",D.groups?.name||"알 수 없음",F)}catch{}return{...D,status:O}}async function y1(h,i){const o=_d(),f=Nd(),{data:x,error:m}=await He.from("attendance_logs").select("*").eq("user_id",h).eq("group_id",i).gte("scan_time",o.toISOString()).lte("scan_time",f.toISOString()).order("scan_time",{ascending:!1});if(m)throw m;return x}async function xc(h){const i=_d(),o=Nd(),{data:f,error:x}=await He.from("attendance_logs").select(`
      *,
      users!attendance_logs_user_id_fkey(name, department)
    `).eq("group_id",h).gte("scan_time",i.toISOString()).lte("scan_time",o.toISOString());if(x)throw x;const{count:m}=await He.from("group_memberships").select("*",{count:"exact"}).eq("group_id",h),w=(f||[]).filter(U=>U.scan_type==="checkin"),S=w.filter(U=>U.status==="present").length,N=w.filter(U=>U.status==="late").length,b=(m||0)-w.length,E=bd(),{count:A}=await He.from("vacation_requests").select("*",{count:"exact"}).eq("group_id",h).eq("status","approved").lte("start_date",E).gte("end_date",E),O=A||0,D=Math.max(0,b-O),z=m||0,F=z>0?(S+N)/z*100:0;return{total:z,present:S,late:N,absent:D,vacation:O,attendanceRate:isNaN(F)||!isFinite(F)?0:Math.round(F*10)/10}}async function w1(h){const{data:i,error:o}=await He.from("vacation_requests").insert({...h,status:"pending"}).select(`
      *,
      groups!vacation_requests_group_id_fkey(name, faculty_id),
      users!vacation_requests_user_id_fkey(name)
    `).single();if(o)throw o;if(i&&i.groups?.faculty_id)try{await N1(i.groups.faculty_id,i,i.users?.name||"알 수 없음",i.groups?.name||"알 수 없음")}catch(f){console.error("교직원 알림 생성 실패:",f)}return i}async function v1(h){const{data:i,error:o}=await He.from("vacation_requests").select(`
      *,
      groups(name),
      users!vacation_requests_reviewed_by_fkey(name)
    `).eq("user_id",h).order("created_at",{ascending:!1});if(o)throw o;return(i||[]).map(f=>({...f,group:f.groups,reviewer:f.users}))}async function mc(h){const{data:i,error:o}=await He.from("vacation_requests").select(`
      *,
      users!vacation_requests_user_id_fkey(name, department, user_id),
      groups(name)
    `).eq("group_id",h).eq("status","pending").order("created_at",{ascending:!1});if(o)throw o;return(i||[]).map(f=>({...f,user:f.users,group:f.groups}))}async function Ad(h,i,o,f){const{data:x,error:m}=await He.from("vacation_requests").update({status:i,reviewed_by:o,reviewed_at:Ps(Ln()),review_comment:f}).eq("id",h).select().single();if(m)throw m;if(x){const w=i==="approved"?"vacation_approved":"vacation_rejected";await _1(x.user_id,w,x,f)}return x}async function sc(h){const{data:i,error:o}=await He.from("notifications").select("*").eq("user_id",h).order("created_at",{ascending:!1}).limit(50);if(o)throw console.error("알림 조회 오류:",o),o;return i}async function b1(h){const{error:i}=await He.from("notifications").update({is_read:!0}).eq("id",h);if(i)throw i}async function _1(h,i,o,f){const x=i==="vacation_approved"?"휴가 신청이 승인되었습니다":"휴가 신청이 거절되었습니다",m=i==="vacation_approved"?`${o.start_date} ~ ${o.end_date} 휴가가 승인되었습니다.`:`${o.start_date} ~ ${o.end_date} 휴가가 거절되었습니다.`,{data:w,error:S}=await He.from("notifications").insert({user_id:h,type:i,title:x,message:m,is_read:!1,metadata:{vacation_request_id:o.id,review_comment:f}}).select().single();if(S)throw S;return w}async function Wi(h){const{count:i,error:o}=await He.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",h).eq("is_read",!1);return o?(console.error("알림 개수 조회 오류:",o),0):i||0}async function ic(h){const{error:i}=await He.from("notifications").delete().eq("id",h);return i?(console.error("알림 삭제 오류:",i),!1):!0}async function N1(h,i,o,f){const x="새로운 휴가 신청이 접수되었습니다",m=`${o}님이 ${f} 그룹에서 ${i.start_date} ~ ${i.end_date} 휴가를 신청했습니다.`,{data:w,error:S}=await He.from("notifications").insert({user_id:h,type:"vacation_request_received",title:x,message:m,is_read:!1,metadata:{vacation_request_id:i.id,student_name:o,group_name:f}}).select().single();if(S)throw console.error("알림 생성 DB 오류:",S),S;return w}async function E1(h,i,o,f){const x={late:"지각",absent:"결근",early_leave:"조기퇴근"},m="학생 출석 알림",w=`${i}님이 ${o} 그룹에서 ${x[f]}했습니다.`,{data:S,error:N}=await He.from("notifications").insert({user_id:h,type:"student_attendance_alert",title:m,message:w,is_read:!1,metadata:{student_name:i,group_name:o,alert_type:f}}).select().single();if(N)throw N;return S}async function C1(h,i,o,f){const x={joined:"그룹에 가입했습니다",left:"그룹을 탈퇴했습니다"},m="그룹 멤버 탈퇴",w=`${i}님이 ${o} 그룹을 ${x[f]}.`,{data:S,error:N}=await He.from("notifications").insert({user_id:h,type:"group_member_left",title:m,message:w,is_read:!1,metadata:{student_name:i,group_name:o,action:f}}).select().single();if(N)throw N;return S}async function S1(h){const{data:i,error:o}=await He.from("locations").select("*").eq("group_id",h).eq("is_active",!0);if(o)throw o;return i}async function A1(h){const{data:i,error:o}=await He.from("locations").insert(h).select().single();if(o)throw o;return i}async function k1(h,i=0){const o=Ln(),f=new Date(o.getTime()-o.getDay()*24*60*60*1e3-i*7*24*60*60*1e3),x=new Date(f.getTime()+6*24*60*60*1e3+23*60*60*1e3+59*60*1e3+59*1e3),{data:m,error:w}=await He.from("attendance_logs").select(`
      *,
      users!attendance_logs_user_id_fkey(name, department)
    `).eq("group_id",h).gte("scan_time",Ps(f)).lte("scan_time",Ps(x)).eq("scan_type","checkin");if(w)throw w;return m}async function I1(h){try{const{data:i,error:o}=await He.from("groups").select("id, name").eq("faculty_id",h).eq("status","active");if(o)throw o;return!i||i.length===0?[]:await Promise.all(i.map(async x=>{try{const m=await xc(x.id);return{groupId:x.id,groupName:x.name,totalStudents:m.total,presentCount:m.present,lateCount:m.late,absentCount:m.absent,vacationCount:m.vacation,attendanceRate:m.attendanceRate}}catch{return{groupId:x.id,groupName:x.name,totalStudents:0,presentCount:0,lateCount:0,absentCount:0,vacationCount:0,attendanceRate:0}}}))}catch{return[]}}async function T1(h,i=0){try{const{data:o,error:f}=await He.from("groups").select("start_date, end_date, name").eq("id",h).single();if(f||!o?.start_date)return console.error("그룹 정보 조회 실패 또는 시작일 없음:",f),["월","화","수","목","금"].map(A=>({day:A,date:"",status:"시작일없음",present:0,late:0,absent:0,isBeforeStart:!1,isEmpty:!0}));const{count:x}=await He.from("group_memberships").select("*",{count:"exact"}).eq("group_id",h),m=new Date(o.start_date);let w,S,N=!1;if(i<0)return["월","화","수","목","금"].map(A=>({day:A,date:"",status:"시작전",present:0,late:0,absent:0,isBeforeStart:!0,isEmpty:!0}));if(i===0){N=!0,w=new Date(m);const A=w.getDay(),O=A<=5?5-A:5+(7-A);S=new Date(w.getTime()+O*24*60*60*1e3+23*60*60*1e3+59*60*1e3+59*1e3)}else{const A=m.getDay();let O;A===1?O=0:A===0?O=1:O=-(A-1);const D=new Date(m.getTime()+O*24*60*60*1e3);w=new Date(D.getTime()+i*7*24*60*60*1e3),w.setHours(0,0,0,0),S=new Date(w.getTime()+4*24*60*60*1e3+23*60*60*1e3+59*60*1e3+59*1e3)}const{data:b,error:E}=await He.from("attendance_logs").select("user_id, status, scan_time").eq("group_id",h).eq("scan_type","checkin").gte("scan_time",w.toISOString()).lte("scan_time",S.toISOString()).order("scan_time",{ascending:!0});if(E)throw console.error("주간 출석 데이터 조회 실패:",E),E;if(N){const A=m.getDay(),O=A<=5?6-A:7-A+5,D=[];for(let U=0;U<O;U++){const re=new Date(m.getTime()+U*24*60*60*1e3).getDay();re>=1&&re<=5&&D.push(["일","월","화","수","목","금","토"][re])}let z=D.map((U,ie)=>{const re=new Date(m.getTime()+ie*24*60*60*1e3),L=new Date(re.getTime()+24*60*60*1e3-1),Y=(b||[]).filter(Ne=>{const Z=new Date(Ne.scan_time);return Z>=re&&Z<=L}),ne=Y.filter(Ne=>Ne.status==="present").length,ce=Y.filter(Ne=>Ne.status==="late").length,q=Math.max(0,(x||0)-Y.length);return{day:U,date:re.toLocaleDateString("ko-KR"),status:Y.length>0?ce>0?"일부지각":"정상출석":q>0?"결근자있음":"정상",present:ne,late:ce,absent:q,isBeforeStart:!1,isEmpty:!1}});const F=m.getDay();if(F>1){const U=[];for(let ie=1;ie<F;ie++)U.push({day:["일","월","화","수","목","금","토"][ie],date:"",status:"",present:0,late:0,absent:0,isBeforeStart:!0,isEmpty:!0});z=[...U,...z]}return z}else return["월","화","수","목","금"].map((A,O)=>{const D=new Date(w.getTime()+O*24*60*60*1e3),z=new Date(D.getTime()+24*60*60*1e3-1),F=(b||[]).filter(Y=>{const ne=new Date(Y.scan_time);return ne>=D&&ne<=z}),U=F.filter(Y=>Y.status==="present").length,ie=F.filter(Y=>Y.status==="late").length,re=Math.max(0,(x||0)-F.length),L=D<m;return{day:A,date:D.toLocaleDateString("ko-KR"),status:L?"시작전":F.length>0?ie>0?"일부지각":"정상출석":re>0?"결근자있음":"정상",present:U,late:ie,absent:re,isBeforeStart:L,isEmpty:!1}})}catch(o){return console.error("그룹 주간 출석 데이터 조회 실패:",o),["월","화","수","목","금"].map(f=>({day:f,date:"",status:"오류",present:0,late:0,absent:0,isBeforeStart:!1,isEmpty:!1}))}}async function j1(h,i=1){try{const{data:o,error:f}=await He.from("groups").select("id, name, start_date, end_date").eq("faculty_id",h).eq("status","active");if(f)throw console.error("그룹 조회 오류:",f),f;if(!o||o.length===0)return{weekNumber:i,dateRange:"",groupsData:[],totalStats:{present:0,late:0,absent:0,vacation:0}};const x=i-1,m=await Promise.all(o.map(async b=>{try{const{count:E}=await He.from("group_memberships").select("*",{count:"exact"}).eq("group_id",b.id),A=await T1(b.id,x);return{groupId:b.id,groupName:b.name,totalStudents:E||0,weeklyData:A}}catch(E){return console.error(`그룹 ${b.name} 데이터 조회 실패:`,E),{groupId:b.id,groupName:b.name,totalStudents:0,weeklyData:["월","화","수","목","금"].map(A=>({day:A,date:"",status:"오류",present:0,late:0,absent:0,isBeforeStart:!1,isEmpty:!1}))}}})),w=m.reduce((b,E)=>(E.weeklyData.forEach(A=>{!A.isBeforeStart&&!A.isEmpty&&(b.present+=A.present,b.late+=A.late,b.absent+=A.absent)}),b),{present:0,late:0,absent:0,vacation:0});let S="";if(m.length>0){const b=o[0];if(b&&b.start_date){const E=new Date(b.start_date),A=i-1;let O,D;if(A===0){O=new Date(E);const U=O.getDay(),ie=U<=5?5-U:5+(7-U);D=new Date(O.getTime()+ie*24*60*60*1e3)}else{const U=E.getDay();let ie;U===1?ie=0:U===0?ie=1:ie=-(U-1);const re=new Date(E.getTime()+ie*24*60*60*1e3);O=new Date(re.getTime()+A*7*24*60*60*1e3),D=new Date(O.getTime()+4*24*60*60*1e3)}const z=O.toLocaleDateString("ko-KR",{month:"long",day:"numeric"}).replace("월","월").replace("일","일"),F=D.toLocaleDateString("ko-KR",{month:"long",day:"numeric"}).replace("월","월").replace("일","일");S=`${z} - ${F}`}}return{weekNumber:i,dateRange:S,groupsData:m,totalStats:w}}catch(o){return console.error("교직원 주간 상세 통계 조회 실패:",o),{weekNumber:i,dateRange:"오류",groupsData:[],totalStats:{present:0,late:0,absent:0,vacation:0}}}}async function R1(h){try{const{data:i,error:o}=await He.from("groups").select("id, name").eq("faculty_id",h).eq("status","active");if(o||!i||i.length===0)return{currentWeek:{label:"이번주",dateRange:"",groupStats:[]},lastWeek:{label:"지난주",dateRange:"",groupStats:[]},beforeWeek:{label:"지지난주",dateRange:"",groupStats:[]}};const f=Ln(),x=new Date(f),m=x.getDay(),w=m===0?6:m-1;x.setDate(x.getDate()-w),x.setHours(0,0,0,0);const S=ie=>{const re=new Date(x);re.setDate(re.getDate()-ie*7);const L=new Date(re);return L.setDate(L.getDate()+4),L.setHours(23,59,59,999),{start:re,end:L}},N=S(0),b=S(1),E=S(2),A=async ie=>await Promise.all(i.map(async L=>{try{const{count:Y}=await He.from("group_memberships").select("*",{count:"exact"}).eq("group_id",L.id),{data:ne}=await He.from("attendance_logs").select("user_id, status").eq("group_id",L.id).eq("scan_type","checkin").gte("scan_time",ie.start.toISOString()).lte("scan_time",ie.end.toISOString()),ce=(ne||[]).filter(ge=>ge.status==="present").length,q=(ne||[]).filter(ge=>ge.status==="late").length,Ne=ce+q,Z=Math.max(0,(Y||0)*5-Ne),Ke=Y&&Y>0?Ne/(Y*5)*100:0;return{groupId:L.id,groupName:L.name,totalStudents:Y||0,presentCount:ce,lateCount:q,absentCount:Z,attendanceRate:Math.round(Ke*10)/10,totalDays:5}}catch{return{groupId:L.id,groupName:L.name,totalStudents:0,presentCount:0,lateCount:0,absentCount:0,attendanceRate:0,totalDays:5}}})),[O,D,z]=await Promise.all([A(N),A(b),A(E)]),F=(ie,re)=>`${ie.toLocaleDateString("ko-KR")} - ${re.toLocaleDateString("ko-KR")}`;return{currentWeek:{label:"이번주",dateRange:F(N.start,N.end),groupStats:O},lastWeek:{label:"지난주",dateRange:F(b.start,b.end),groupStats:D},beforeWeek:{label:"지지난주",dateRange:F(E.start,E.end),groupStats:z}}}catch{return{currentWeek:{label:"이번주",dateRange:"에러",groupStats:[]},lastWeek:{label:"지난주",dateRange:"에러",groupStats:[]},beforeWeek:{label:"지지난주",dateRange:"에러",groupStats:[]}}}}async function O1(h,i,o=30){try{const{data:f,error:x}=await He.from("groups").select("start_date, end_date").eq("id",i).single();if(x)throw console.error("그룹 정보 조회 실패:",x),x;const m=Ln();let w,S,N;if(f?.start_date){w=new Date(f.start_date);const re=Math.ceil((m.getTime()-w.getTime())/(24*60*60*1e3));S=Math.max(1,re),N=0;for(let L=0;L<S;L++){const ne=new Date(w.getTime()+L*24*60*60*1e3).getDay();ne!==0&&ne!==6&&N++}}else{w=new Date(m.getTime()-o*24*60*60*1e3),S=o,N=0;for(let re=0;re<S;re++){const Y=new Date(w.getTime()+re*24*60*60*1e3).getDay();Y!==0&&Y!==6&&N++}}const{data:b,error:E}=await He.from("attendance_logs").select("scan_time, scan_type, status").eq("user_id",h).eq("group_id",i).eq("scan_type","checkin").gte("scan_time",Ps(w)).lte("scan_time",Ps(m)).order("scan_time",{ascending:!0});if(E)throw console.error("출석 기록 조회 실패:",E),E;const A=(b||[]).filter(re=>re.status==="present"||re.status==="late").length,O=(b||[]).filter(re=>re.status==="late").length,{data:D}=await He.from("vacation_requests").select("start_date, end_date").eq("user_id",h).eq("group_id",i).eq("status","approved").gte("start_date",w.toISOString().split("T")[0]).lte("end_date",m.toISOString().split("T")[0]),z=(D||[]).reduce((re,L)=>{const Y=new Date(L.start_date),ne=new Date(L.end_date),ce=Math.ceil((ne.getTime()-Y.getTime())/(24*60*60*1e3))+1;return re+ce},0),F=N-z,U=F>0?A/F*100:0;return{totalDays:N,presentDays:A,lateDays:O,vacationDays:z,possibleDays:F,attendanceRate:Math.round(U*10)/10}}catch{const x=Math.floor(o*5/7);return{totalDays:x,presentDays:0,lateDays:0,vacationDays:0,possibleDays:x,attendanceRate:0}}}async function D1(h,i,o=0){try{const{data:f,error:x}=await He.from("groups").select("start_date, end_date").eq("id",i).single();if(x)throw console.error("그룹 정보 조회 실패:",x),x;const m=Ln();let w,S=new Date;if(f?.start_date){const D=new Date(f.start_date),z=o;if(z<0)return[];if(z===0){w=new Date(D.getTime());const F=w.getDay(),U=F<=5?5-F:5+(7-F);S=new Date(w.getTime()+U*24*60*60*1e3+23*60*60*1e3+59*60*60*1e3+59*1e3)}else{const F=z*7,U=new Date(D.getTime()+F*24*60*60*1e3),ie=U.getDay()===0?6:U.getDay()-1;w=new Date(U.getTime()-ie*24*60*60*1e3),S=new Date(w.getTime()+4*24*60*60*1e3+23*60*60*1e3+59*60*60*1e3+59*1e3)}}else{const D=m.getDay()===0?6:m.getDay()-1;w=new Date(m.getTime()-D*24*60*60*1e3-o*7*24*60*60*1e3),S=new Date(w.getTime()+4*24*60*60*1e3+23*60*60*1e3+59*60*1e3+59*1e3)}const{data:N,error:b}=await He.from("attendance_logs").select("scan_time, scan_type, status").eq("user_id",h).eq("group_id",i).eq("scan_type","checkin").gte("scan_time",Ps(w)).lte("scan_time",Ps(S)).order("scan_time",{ascending:!0});if(b)throw console.error("주간 출석 데이터 조회 실패:",b),b;let E,A;if(o===0){E=["월","화","수","목","금"];const D=w.getDay();A=E.map((z,F)=>{const U=F+1;if(U<D)return{day:z,status:"",present:0,late:0,absent:0,isBeforeStart:!0,isEmpty:!0};const re=U-D,L=new Date(w.getTime()+re*24*60*60*1e3),Y=new Date(L.getTime()+24*60*60*1e3-1),ne=Ln(),ce=L>ne,q=(N||[]).find(Ne=>{const Z=os(Ne.scan_time);return Z>=L&&Z<=Y});return{day:z,status:ce?"":q?q.status==="late"?"지각":"출근":"결근",present:q&&(q.status==="present"||q.status==="late")?1:0,late:q&&q.status==="late"?1:0,absent:ce||q?0:1,isBeforeStart:!1,isEmpty:ce}})}else E=["월","화","수","목","금"],A=E.map((D,z)=>{const F=new Date(w.getTime()+z*24*60*60*1e3),U=new Date(F.getTime()+24*60*60*1e3-1),ie=Ln(),re=F>ie,L=(N||[]).find(ce=>{const q=os(ce.scan_time);return q>=F&&q<=U}),Y=new Date(f.start_date),ne=F<Y;return{day:D,status:re?"":L?L.status==="late"?"지각":"출근":"결근",present:L&&(L.status==="present"||L.status==="late")?1:0,late:L&&L.status==="late"?1:0,absent:re||L?0:1,isBeforeStart:ne,isEmpty:re}});return A}catch{return[]}}const i2=Object.freeze(Object.defineProperty({__proto__:null,addMultipleUsersToGroup:Ed,createGroup:d1,createGroupMemberNotification:C1,createLocation:A1,createStudentAttendanceAlert:E1,createVacationNotification:_1,createVacationRequest:w1,createVacationRequestNotification:N1,deleteGroup:f1,deleteNotification:ic,getAvailableUsers:x1,getFacultyGroups:Vo,getFacultyGroupsOverallStats:I1,getFacultyGroupsWeeklyTrends:R1,getFacultyWeeklyDetailedStats:j1,getGroup:h1,getGroupLocations:S1,getGroupMembers:ko,getGroupTodayAttendance:xc,getGroupWeeklyAttendance:T1,getGroupWorkSettings:Cd,getKSTNow:Ln,getKSTTodayDateString:bd,getKSTTodayEnd:Nd,getKSTTodayStart:_d,getPendingVacationRequests:mc,getStudentAttendanceRate:O1,getStudentWeeklyAttendance:D1,getTodayAttendanceStatus:y1,getUnreadNotificationCount:Wi,getUserGroups:Po,getUserNotifications:sc,getUserVacationRequests:v1,getWeeklyAttendanceStats:k1,kstToUTCISOString:Ps,login:c1,markNotificationAsRead:b1,removeUserFromGroup:g1,saveAttendanceRecord:p1,signup:u1,supabase:He,testDatabaseConnection:m1,updateVacationRequestStatus:Ad,upsertGroupWorkSettings:Sd,utcToKSTDate:os},Symbol.toStringTag,{value:"Module"})),M1=V.createContext(void 0);function ps(){const h=V.useContext(M1);if(h===void 0)throw new Error("useAuth must be used within an AuthProvider");return h}function a2({children:h}){const[i,o]=V.useState(null),[f,x]=V.useState(!0),m=async()=>{if(!i){console.log("🔄 사용자 갱신: 로그인되지 않은 상태");return}try{console.log(`🔄 사용자 갱신 시작: ${i.user_id} (${i.role})`);const{supabase:E}=await Ba(async()=>{const{supabase:z}=await Promise.resolve().then(()=>i2);return{supabase:z}},void 0),{data:A,error:O}=await E.from("users").select("*").eq("user_id",i.user_id).single();if(O){console.error("❌ 사용자 정보 갱신 실패:",O);return}const D={...i,...A};D&&(o(D),localStorage.setItem("auth_user",JSON.stringify(D)))}catch(E){console.error("❌ 사용자 갱신 중 오류 발생:",E)}};V.useEffect(()=>{(()=>{try{const A=localStorage.getItem("auth_user"),O=localStorage.getItem("auth_login_time");if(A&&O){const D=JSON.parse(A),z=parseInt(O),F=Date.now(),U=24*60*60*1e3;F-z>U?(console.log("⏰ 세션 만료됨"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_login_time")):(o(D),console.log(`🔐 세션 복원: ${D.user_id} (${D.role})`))}}catch(A){console.error("❌ 세션 복원 실패:",A),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_login_time")}finally{x(!1)}})()},[]),V.useEffect(()=>{if(!i)return;const E=setInterval(()=>{m()},6e4);return()=>{clearInterval(E)}},[i]);const b={user:i,loading:f,login:async(E,A)=>{try{console.log(`🔑 로그인 시도: ${E}`);const O=await c1(E,A);return o(O),localStorage.setItem("auth_user",JSON.stringify(O)),localStorage.setItem("auth_login_time",Date.now().toString()),console.log(`✅ 로그인 성공: ${O.user_id} (${O.role})`),O}catch(O){throw console.error("❌ 로그인 실패:",O),O}},logout:async()=>{console.log(`🚪 로그아웃: ${i?.user_id}`),o(null),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_login_time")},signup:async E=>{try{console.log(`📝 회원가입 시도: ${E.user_id}`);const A=await u1(E);return o(A),localStorage.setItem("auth_user",JSON.stringify(A)),localStorage.setItem("auth_login_time",Date.now().toString()),console.log(`✅ 회원가입 성공: ${A.user_id} (${A.role})`),A}catch(A){throw console.error("❌ 회원가입 실패:",A),A}},refreshUser:m};return l.jsx(M1.Provider,{value:b,children:h})}var o2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const l2=h=>h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),c2=(h,i)=>{const o=V.forwardRef(({color:f="currentColor",size:x=24,strokeWidth:m=2,absoluteStrokeWidth:w,children:S,...N},b)=>V.createElement("svg",{ref:b,...o2,width:x,height:x,stroke:f,strokeWidth:w?Number(m)*24/Number(x):m,className:`lucide lucide-${l2(h)}`,...N},[...i.map(([E,A])=>V.createElement(E,A)),...(Array.isArray(S)?S:[S])||[]]));return o.displayName=`${h}`,o};var Ot=c2;const u2=Ot("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),yn=Ot("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ua=Ot("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ja=Ot("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Lo=Ot("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),d2=Ot("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),zi=Ot("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),h2=Ot("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Sn=Ot("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),hi=Ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Vi=Ot("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),di=Ot("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),tc=Ot("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),f2=Ot("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),ff=Ot("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Bo=Ot("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),pc=Ot("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Da=Ot("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),g2=Ot("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]),P1=Ot("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),x2=Ot("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),Fo=Ot("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]),yc=Ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Hi=Ot("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),L1=Ot("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),kd=Ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Ma=Ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),m2=Ot("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),B1=Ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),F1=Ot("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),p2=Ot("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),y2=Ot("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),w2=Ot("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Uo=Ot("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Wo=Ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),gf=Ot("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Pn=Ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function xf(){const h=ms(),{user:i,login:o,signup:f}=ps(),[x,m]=V.useState(!0),[w,S]=V.useState("student"),[N,b]=V.useState(!1),[E,A]=V.useState({userId:"",name:"",password:"",confirmPassword:"",department:""}),[O,D]=V.useState([]),[z,F]=V.useState(!1),[U,ie]=V.useState("");V.useEffect(()=>{i&&(i.role==="student"?h("/student-attendance"):h("/faculty-attendance"))},[i,h]);const re=()=>{const Y=[];return E.userId.trim()||Y.push("사용자 ID를 입력해주세요."),E.password||Y.push("비밀번호를 입력해주세요."),x||(E.name.trim()||Y.push("이름을 입력해주세요."),E.department.trim()||Y.push("학과를 입력해주세요."),E.password!==E.confirmPassword&&Y.push("비밀번호가 일치하지 않습니다."),E.password.length<4&&Y.push("비밀번호는 4자 이상이어야 합니다.")),Y},L=async Y=>{Y.preventDefault(),D([]),ie("");try{const ne=re();if(ne.length>0){D(ne);return}if(F(!0),x){const ce=await o(E.userId,E.password);ie("로그인 성공!"),setTimeout(()=>{ce.role==="student"?h("/student-attendance"):h("/faculty-attendance")},1e3)}else{const ce={user_id:E.userId,name:E.name,password:E.password,department:E.department,role:w,position:w==="faculty"?"교직원":void 0,is_active:!0};await f(ce),ie("회원가입이 완료되었습니다!"),setTimeout(()=>{m(!0),A(q=>({...q,password:"",confirmPassword:""})),ie("")},2e3)}}catch(ne){const ce=ne instanceof Error?ne.message:"처리 중 오류가 발생했습니다.";D([ce])}finally{F(!1)}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:l.jsx(hi,{className:"w-8 h-8 text-white"})}),l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"QR 출퇴근"}),l.jsx("p",{className:"text-gray-600",children:"간편하고 정확한 출석 관리"})]}),l.jsxs("div",{className:"bg-white rounded-3xl shadow-xl p-8",children:[l.jsxs("div",{className:"flex bg-gray-100 rounded-2xl p-1 mb-6",children:[l.jsx("button",{onClick:()=>m(!0),className:`flex-1 py-3 px-4 rounded-xl text-center transition-all font-medium ${x?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"로그인"}),l.jsx("button",{onClick:()=>m(!1),className:`flex-1 py-3 px-4 rounded-xl text-center transition-all font-medium ${x?"text-gray-600 hover:text-gray-800":"bg-white text-blue-600 shadow-sm"}`,children:"회원가입"})]}),!x&&l.jsxs("div",{className:"mb-6",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"역할 선택"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{type:"button",onClick:()=>S("student"),className:`p-4 rounded-2xl border-2 transition-all ${w==="student"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx(f2,{className:`w-8 h-8 mx-auto mb-2 ${w==="student"?"text-blue-600":"text-gray-400"}`}),l.jsx("span",{className:`text-sm font-medium ${w==="student"?"text-blue-600":"text-gray-600"}`,children:"학생"})]}),l.jsxs("button",{type:"button",onClick:()=>S("faculty"),className:`p-4 rounded-2xl border-2 transition-all ${w==="faculty"?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx(d2,{className:`w-8 h-8 mx-auto mb-2 ${w==="faculty"?"text-purple-600":"text-gray-400"}`}),l.jsx("span",{className:`text-sm font-medium ${w==="faculty"?"text-purple-600":"text-gray-600"}`,children:"교직원"})]})]})]}),x&&l.jsx("div",{className:"mb-6 p-4 bg-green-50 rounded-2xl",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Sn,{className:"w-5 h-5 text-green-600 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-green-800 mb-1",children:"등록된 계정으로 로그인"}),l.jsxs("div",{className:"text-xs text-green-600 mb-2 space-y-1",children:[l.jsx("p",{children:"• 기존 계정이 있으시면 학번/교직원번호로 로그인"}),l.jsx("p",{children:"• 계정이 없으시면 회원가입을 통해 새 계정 생성"})]})]})]})}),l.jsxs("form",{onSubmit:L,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:!x&&w==="student"?"학번":!x&&w==="faculty"?"교직원 ID":"사용자 ID"}),l.jsxs("div",{className:"relative",children:[l.jsx(Uo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",value:E.userId,onChange:Y=>A(ne=>({...ne,userId:Y.target.value})),className:"input-field pl-10",placeholder:!x&&w==="student"?"학번을 입력하세요":!x&&w==="faculty"?"교직원 ID를 입력하세요":"사용자 ID를 입력하세요"})]})]}),!x&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"이름"}),l.jsx("input",{type:"text",value:E.name,onChange:Y=>A(ne=>({...ne,name:Y.target.value})),className:"input-field",placeholder:"이름을 입력하세요"})]}),!x&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:w==="student"?"학과":"소속"}),l.jsx("input",{type:"text",value:E.department,onChange:Y=>A(ne=>({...ne,department:Y.target.value})),className:"input-field",placeholder:w==="student"?"학과를 입력하세요":"소속을 입력하세요"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"비밀번호"}),l.jsxs("div",{className:"relative",children:[l.jsx(Bo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:N?"text":"password",value:E.password,onChange:Y=>A(ne=>({...ne,password:Y.target.value})),className:"input-field pl-10 pr-10",placeholder:"비밀번호를 입력하세요"}),l.jsx("button",{type:"button",onClick:()=>b(!N),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:N?l.jsx(Vi,{className:"w-5 h-5"}):l.jsx(di,{className:"w-5 h-5"})})]})]}),!x&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"비밀번호 확인"}),l.jsxs("div",{className:"relative",children:[l.jsx(Bo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:N?"text":"password",value:E.confirmPassword,onChange:Y=>A(ne=>({...ne,confirmPassword:Y.target.value})),className:"input-field pl-10",placeholder:"비밀번호를 다시 입력하세요"})]})]}),O.length>0&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(yn,{className:"w-5 h-5 text-red-600"}),l.jsx("span",{className:"font-medium text-red-800",children:"오류가 발생했습니다"})]}),l.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:O.map((Y,ne)=>l.jsxs("li",{children:["• ",Y]},ne))})]}),U&&l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Sn,{className:"w-5 h-5 text-green-600"}),l.jsx("span",{className:"font-medium text-green-800",children:U})]})}),l.jsxs("button",{type:"submit",disabled:z,className:"btn-primary w-full flex items-center justify-center space-x-2",children:[z&&l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l.jsx("span",{children:z?"처리 중...":x?"로그인":"회원가입"})]})]})]}),l.jsx("div",{className:"text-center mt-6",children:l.jsx("p",{className:"text-sm text-gray-500",children:"QR 출퇴근 시스템 • 안전하고 편리한 출석 관리"})})]})})}var Ze;(function(h){h[h.QR_CODE=0]="QR_CODE",h[h.AZTEC=1]="AZTEC",h[h.CODABAR=2]="CODABAR",h[h.CODE_39=3]="CODE_39",h[h.CODE_93=4]="CODE_93",h[h.CODE_128=5]="CODE_128",h[h.DATA_MATRIX=6]="DATA_MATRIX",h[h.MAXICODE=7]="MAXICODE",h[h.ITF=8]="ITF",h[h.EAN_13=9]="EAN_13",h[h.EAN_8=10]="EAN_8",h[h.PDF_417=11]="PDF_417",h[h.RSS_14=12]="RSS_14",h[h.RSS_EXPANDED=13]="RSS_EXPANDED",h[h.UPC_A=14]="UPC_A",h[h.UPC_E=15]="UPC_E",h[h.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ze||(Ze={}));var mf=new Map([[Ze.QR_CODE,"QR_CODE"],[Ze.AZTEC,"AZTEC"],[Ze.CODABAR,"CODABAR"],[Ze.CODE_39,"CODE_39"],[Ze.CODE_93,"CODE_93"],[Ze.CODE_128,"CODE_128"],[Ze.DATA_MATRIX,"DATA_MATRIX"],[Ze.MAXICODE,"MAXICODE"],[Ze.ITF,"ITF"],[Ze.EAN_13,"EAN_13"],[Ze.EAN_8,"EAN_8"],[Ze.PDF_417,"PDF_417"],[Ze.RSS_14,"RSS_14"],[Ze.RSS_EXPANDED,"RSS_EXPANDED"],[Ze.UPC_A,"UPC_A"],[Ze.UPC_E,"UPC_E"],[Ze.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),pf;(function(h){h[h.UNKNOWN=0]="UNKNOWN",h[h.URL=1]="URL"})(pf||(pf={}));function v2(h){return Object.values(Ze).includes(h)}var ac;(function(h){h[h.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",h[h.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(ac||(ac={}));var b2=function(){function h(){}return h.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",h.SCAN_DEFAULT_FPS=2,h.DEFAULT_DISABLE_FLIP=!1,h.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,h.DEFAULT_SUPPORTED_SCAN_TYPE=[ac.SCAN_TYPE_CAMERA,ac.SCAN_TYPE_FILE],h}(),U1=function(){function h(i,o){this.format=i,this.formatName=o}return h.prototype.toString=function(){return this.formatName},h.create=function(i){if(!mf.has(i))throw"".concat(i," not in html5QrcodeSupportedFormatsTextMap");return new h(i,mf.get(i))},h}(),yf=function(){function h(){}return h.createFromText=function(i){var o={text:i};return{decodedText:i,result:o}},h.createFromQrcodeResult=function(i){return{decodedText:i.text,result:i}},h}(),dd;(function(h){h[h.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",h[h.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",h[h.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(dd||(dd={}));var _2=function(){function h(){}return h.createFrom=function(i){return{errorMessage:i,type:dd.UNKWOWN_ERROR}},h}(),N2=function(){function h(i){this.verbose=i}return h.prototype.log=function(i){this.verbose&&console.log(i)},h.prototype.warn=function(i){this.verbose&&console.warn(i)},h.prototype.logError=function(i,o){(this.verbose||o===!0)&&console.error(i)},h.prototype.logErrors=function(i){if(i.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(i)},h}();function Os(h){return typeof h>"u"||h===null}var Ra=function(){function h(){}return h.codeParseError=function(i){return"QR code parse error, error = ".concat(i)},h.errorGettingUserMedia=function(i){return"Error getting userMedia, error = ".concat(i)},h.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},h.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},h.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},h.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},h.scannerPaused=function(){return"Scanner paused"},h}(),W1=function(){function h(){}return h.isMediaStreamConstraintsValid=function(i,o){if(typeof i!="object"){var f=typeof i;return o.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(f,"."),!0),!1}for(var x=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],m=new Set(x),w=Object.keys(i),S=0,N=w;S<N.length;S++){var b=N[S];if(m.has(b))return o.logError("".concat(b," is not supported videoConstaints."),!0),!1}return!0},h}(),Io={exports:{}},E2=Io.exports,wf;function C2(){return wf||(wf=1,function(h,i){(function(o,f){f(i)})(E2,function(o){function f(I){return I==null}var x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,e){I.__proto__=e}||function(I,e){for(var r in e)e.hasOwnProperty(r)&&(I[r]=e[r])};function m(I,e){x(I,e);function r(){this.constructor=I}I.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function w(I,e){var r=Object.setPrototypeOf;r?r(I,e):I.__proto__=e}function S(I,e){e===void 0&&(e=I.constructor);var r=Error.captureStackTrace;r&&r(I,e)}var N=function(I){m(e,I);function e(r){var n=this.constructor,a=I.call(this,r)||this;return Object.defineProperty(a,"name",{value:n.name,enumerable:!1}),w(a,n.prototype),S(a),a}return e}(Error);class b extends N{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}b.kind="Exception";class E extends b{}E.kind="ArgumentException";class A extends b{}A.kind="IllegalArgumentException";class O{constructor(e){if(this.binarizer=e,e===null)throw new A("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,r){return this.binarizer.getBlackRow(e,r)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,r,n,a){const c=this.binarizer.getLuminanceSource().crop(e,r,n,a);return new O(this.binarizer.createBinarizer(c))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new O(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new O(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class D extends b{static getChecksumInstance(){return new D}}D.kind="ChecksumException";class z{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class F{static arraycopy(e,r,n,a,c){for(;c--;)n[a++]=e[r++]}static currentTimeMillis(){return Date.now()}}class U extends b{}U.kind="IndexOutOfBoundsException";class ie extends U{constructor(e=void 0,r=void 0){super(r),this.index=e,this.message=r}}ie.kind="ArrayIndexOutOfBoundsException";class re{static fill(e,r){for(let n=0,a=e.length;n<a;n++)e[n]=r}static fillWithin(e,r,n,a){re.rangeCheck(e.length,r,n);for(let c=r;c<n;c++)e[c]=a}static rangeCheck(e,r,n){if(r>n)throw new A("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new ie(r);if(n>e)throw new ie(n)}static asList(...e){return e}static create(e,r,n){return Array.from({length:e}).map(c=>Array.from({length:r}).fill(n))}static createInt32Array(e,r,n){return Array.from({length:e}).map(c=>Int32Array.from({length:r}).fill(n))}static equals(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(let n=0,a=e.length;n<a;n++)if(e[n]!==r[n])return!1;return!0}static hashCode(e){if(e===null)return 0;let r=1;for(const n of e)r=31*r+n;return r}static fillUint8Array(e,r){for(let n=0;n!==e.length;n++)e[n]=r}static copyOf(e,r){return e.slice(0,r)}static copyOfUint8Array(e,r){if(e.length<=r){const n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)}static copyOfRange(e,r,n){const a=n-r,c=new Int32Array(a);return F.arraycopy(e,r,c,0,a),c}static binarySearch(e,r,n){n===void 0&&(n=re.numberComparator);let a=0,c=e.length-1;for(;a<=c;){const u=c+a>>1,g=n(r,e[u]);if(g>0)a=u+1;else if(g<0)c=u-1;else return u}return-a-1}static numberComparator(e,r){return e-r}}class L{static numberOfTrailingZeros(e){let r;if(e===0)return 32;let n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,r){return Math.trunc(e/r)}static parseInt(e,r=void 0){return parseInt(e,r)}}L.MIN_VALUE_32_BITS=-2147483648,L.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Y{constructor(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=Y.makeArray(e):this.bits=r)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const r=Y.makeArray(e);F.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const r=this.size;if(e>=r)return r;const n=this.bits;let a=Math.floor(e/32),c=n[a];c&=~((1<<(e&31))-1);const u=n.length;for(;c===0;){if(++a===u)return r;c=n[a]}const g=a*32+L.numberOfTrailingZeros(c);return g>r?r:g}getNextUnset(e){const r=this.size;if(e>=r)return r;const n=this.bits;let a=Math.floor(e/32),c=~n[a];c&=~((1<<(e&31))-1);const u=n.length;for(;c===0;){if(++a===u)return r;c=~n[a]}const g=a*32+L.numberOfTrailingZeros(c);return g>r?r:g}setBulk(e,r){this.bits[Math.floor(e/32)]=r}setRange(e,r){if(r<e||e<0||r>this.size)throw new A;if(r===e)return;r--;const n=Math.floor(e/32),a=Math.floor(r/32),c=this.bits;for(let u=n;u<=a;u++){const g=u>n?0:e&31,v=(2<<(u<a?31:r&31))-(1<<g);c[u]|=v}}clear(){const e=this.bits.length,r=this.bits;for(let n=0;n<e;n++)r[n]=0}isRange(e,r,n){if(r<e||e<0||r>this.size)throw new A;if(r===e)return!0;r--;const a=Math.floor(e/32),c=Math.floor(r/32),u=this.bits;for(let g=a;g<=c;g++){const y=g>a?0:e&31,k=(2<<(g<c?31:r&31))-(1<<y)&4294967295;if((u[g]&k)!==(n?k:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,r){if(r<0||r>32)throw new A("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(let n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)}appendBitArray(e){const r=e.size;this.ensureCapacity(this.size+r);for(let n=0;n<r;n++)this.appendBit(e.get(n))}xor(e){if(this.size!==e.size)throw new A("Sizes don't match");const r=this.bits;for(let n=0,a=r.length;n<a;n++)r[n]^=e.bits[n]}toBytes(e,r,n,a){for(let c=0;c<a;c++){let u=0;for(let g=0;g<8;g++)this.get(e)&&(u|=1<<7-g),e++;r[n+c]=u}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits;for(let c=0;c<n;c++){let u=a[c];u=u>>1&1431655765|(u&1431655765)<<1,u=u>>2&858993459|(u&858993459)<<2,u=u>>4&252645135|(u&252645135)<<4,u=u>>8&16711935|(u&16711935)<<8,u=u>>16&65535|(u&65535)<<16,e[r-c]=u}if(this.size!==n*32){const c=n*32-this.size;let u=e[0]>>>c;for(let g=1;g<n;g++){const y=e[g];u|=y<<32-c,e[g-1]=u,u=y>>>c}e[n-1]=u}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof Y))return!1;const r=e;return this.size===r.size&&re.equals(this.bits,r.bits)}hashCode(){return 31*this.size+re.hashCode(this.bits)}toString(){let e="";for(let r=0,n=this.size;r<n;r++)(r&7)===0&&(e+=" "),e+=this.get(r)?"X":".";return e}clone(){return new Y(this.size,this.bits.slice())}}var ne;(function(I){I[I.OTHER=0]="OTHER",I[I.PURE_BARCODE=1]="PURE_BARCODE",I[I.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",I[I.TRY_HARDER=3]="TRY_HARDER",I[I.CHARACTER_SET=4]="CHARACTER_SET",I[I.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",I[I.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",I[I.ASSUME_GS1=7]="ASSUME_GS1",I[I.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",I[I.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",I[I.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(ne||(ne={}));var ce=ne;class q extends b{static getFormatInstance(){return new q}}q.kind="FormatException";var Ne;(function(I){I[I.Cp437=0]="Cp437",I[I.ISO8859_1=1]="ISO8859_1",I[I.ISO8859_2=2]="ISO8859_2",I[I.ISO8859_3=3]="ISO8859_3",I[I.ISO8859_4=4]="ISO8859_4",I[I.ISO8859_5=5]="ISO8859_5",I[I.ISO8859_6=6]="ISO8859_6",I[I.ISO8859_7=7]="ISO8859_7",I[I.ISO8859_8=8]="ISO8859_8",I[I.ISO8859_9=9]="ISO8859_9",I[I.ISO8859_10=10]="ISO8859_10",I[I.ISO8859_11=11]="ISO8859_11",I[I.ISO8859_13=12]="ISO8859_13",I[I.ISO8859_14=13]="ISO8859_14",I[I.ISO8859_15=14]="ISO8859_15",I[I.ISO8859_16=15]="ISO8859_16",I[I.SJIS=16]="SJIS",I[I.Cp1250=17]="Cp1250",I[I.Cp1251=18]="Cp1251",I[I.Cp1252=19]="Cp1252",I[I.Cp1256=20]="Cp1256",I[I.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",I[I.UTF8=22]="UTF8",I[I.ASCII=23]="ASCII",I[I.Big5=24]="Big5",I[I.GB18030=25]="GB18030",I[I.EUC_KR=26]="EUC_KR"})(Ne||(Ne={}));class Z{constructor(e,r,n,...a){this.valueIdentifier=e,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=a,Z.VALUE_IDENTIFIER_TO_ECI.set(e,this),Z.NAME_TO_ECI.set(n,this);const c=this.values;for(let u=0,g=c.length;u!==g;u++){const y=c[u];Z.VALUES_TO_ECI.set(y,this)}for(const u of a)Z.NAME_TO_ECI.set(u,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new q("incorect value");const r=Z.VALUES_TO_ECI.get(e);if(r===void 0)throw new q("incorect value");return r}static getCharacterSetECIByName(e){const r=Z.NAME_TO_ECI.get(e);if(r===void 0)throw new q("incorect value");return r}equals(e){if(!(e instanceof Z))return!1;const r=e;return this.getName()===r.getName()}}Z.VALUE_IDENTIFIER_TO_ECI=new Map,Z.VALUES_TO_ECI=new Map,Z.NAME_TO_ECI=new Map,Z.Cp437=new Z(Ne.Cp437,Int32Array.from([0,2]),"Cp437"),Z.ISO8859_1=new Z(Ne.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),Z.ISO8859_2=new Z(Ne.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),Z.ISO8859_3=new Z(Ne.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),Z.ISO8859_4=new Z(Ne.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),Z.ISO8859_5=new Z(Ne.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),Z.ISO8859_6=new Z(Ne.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),Z.ISO8859_7=new Z(Ne.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),Z.ISO8859_8=new Z(Ne.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),Z.ISO8859_9=new Z(Ne.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),Z.ISO8859_10=new Z(Ne.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),Z.ISO8859_11=new Z(Ne.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),Z.ISO8859_13=new Z(Ne.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),Z.ISO8859_14=new Z(Ne.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),Z.ISO8859_15=new Z(Ne.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),Z.ISO8859_16=new Z(Ne.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),Z.SJIS=new Z(Ne.SJIS,20,"SJIS","Shift_JIS"),Z.Cp1250=new Z(Ne.Cp1250,21,"Cp1250","windows-1250"),Z.Cp1251=new Z(Ne.Cp1251,22,"Cp1251","windows-1251"),Z.Cp1252=new Z(Ne.Cp1252,23,"Cp1252","windows-1252"),Z.Cp1256=new Z(Ne.Cp1256,24,"Cp1256","windows-1256"),Z.UnicodeBigUnmarked=new Z(Ne.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),Z.UTF8=new Z(Ne.UTF8,26,"UTF8","UTF-8"),Z.ASCII=new Z(Ne.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),Z.Big5=new Z(Ne.Big5,28,"Big5"),Z.GB18030=new Z(Ne.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),Z.EUC_KR=new Z(Ne.EUC_KR,30,"EUC_KR","EUC-KR");class Ke extends b{}Ke.kind="UnsupportedOperationException";class ge{static decode(e,r){const n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)}static shouldDecodeOnFallback(e){return!ge.isBrowser()&&e==="ISO-8859-1"}static encode(e,r){const n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof Z?e:Z.getCharacterSetECIByName(e)}static decodeFallback(e,r){const n=this.encodingCharacterSet(r);if(ge.isDecodeFallbackSupported(n)){let a="";for(let c=0,u=e.length;c<u;c++){let g=e[c].toString(16);g.length<2&&(g="0"+g),a+="%"+g}return decodeURIComponent(a)}if(n.equals(Z.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Ke(`Encoding ${this.encodingName(r)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(Z.UTF8)||e.equals(Z.ISO8859_1)||e.equals(Z.ASCII)}static encodeFallback(e){const n=btoa(unescape(encodeURIComponent(e))).split(""),a=[];for(let c=0;c<n.length;c++)a.push(n[c].charCodeAt(0));return new Uint8Array(a)}}class xe{static castAsNonUtf8Char(e,r=null){const n=r?r.getName():this.ISO88591;return ge.decode(new Uint8Array([e]),n)}static guessEncoding(e,r){if(r!=null&&r.get(ce.CHARACTER_SET)!==void 0)return r.get(ce.CHARACTER_SET).toString();const n=e.length;let a=!0,c=!0,u=!0,g=0,y=0,v=0,k=0,T=0,R=0,P=0,H=0,$=0,Q=0,ae=0;const Te=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let Re=0;Re<n&&(a||c||u);Re++){const be=e[Re]&255;u&&(g>0?(be&128)===0?u=!1:g--:(be&128)!==0&&((be&64)===0?u=!1:(g++,(be&32)===0?y++:(g++,(be&16)===0?v++:(g++,(be&8)===0?k++:u=!1))))),a&&(be>127&&be<160?a=!1:be>159&&(be<192||be===215||be===247)&&ae++),c&&(T>0?be<64||be===127||be>252?c=!1:T--:be===128||be===160||be>239?c=!1:be>160&&be<224?(R++,H=0,P++,P>$&&($=P)):be>127?(T++,P=0,H++,H>Q&&(Q=H)):(P=0,H=0))}return u&&g>0&&(u=!1),c&&T>0&&(c=!1),u&&(Te||y+v+k>0)?xe.UTF8:c&&(xe.ASSUME_SHIFT_JIS||$>=3||Q>=3)?xe.SHIFT_JIS:a&&c?$===2&&R===2||ae*10>=n?xe.SHIFT_JIS:xe.ISO88591:a?xe.ISO88591:c?xe.SHIFT_JIS:u?xe.UTF8:xe.PLATFORM_DEFAULT_ENCODING}static format(e,...r){let n=-1;function a(u,g,y,v,k,T){if(u==="%%")return"%";if(r[++n]===void 0)return;u=v?parseInt(v.substr(1)):void 0;let R=k?parseInt(k.substr(1)):void 0,P;switch(T){case"s":P=r[n];break;case"c":P=r[n][0];break;case"f":P=parseFloat(r[n]).toFixed(u);break;case"p":P=parseFloat(r[n]).toPrecision(u);break;case"e":P=parseFloat(r[n]).toExponential(u);break;case"x":P=parseInt(r[n]).toString(R||16);break;case"d":P=parseFloat(parseInt(r[n],R||10).toPrecision(u)).toFixed(0);break}P=typeof P=="object"?JSON.stringify(P):(+P).toString(R);let H=parseInt(y),$=y&&y[0]+""=="0"?"0":" ";for(;P.length<H;)P=g!==void 0?P+$:$+P;return P}let c=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(c,a)}static getBytes(e,r){return ge.encode(e,r)}static getCharCode(e,r=0){return e.charCodeAt(r)}static getCharAt(e){return String.fromCharCode(e)}}xe.SHIFT_JIS=Z.SJIS.getName(),xe.GB2312="GB2312",xe.ISO88591=Z.ISO8859_1.getName(),xe.EUC_JP="EUC_JP",xe.UTF8=Z.UTF8.getName(),xe.PLATFORM_DEFAULT_ENCODING=xe.UTF8,xe.ASSUME_SHIFT_JIS=!1;class Ve{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=xe.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,r,n){for(let a=r;r<r+n;a++)this.append(e[a]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)}substring(e,r){return this.value.substring(e,r)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+r.length)}}class Fe{constructor(e,r,n,a){if(this.width=e,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=e),this.height=r,e<1||r<1)throw new A("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const r=e.length,n=e[0].length,a=new Fe(n,r);for(let c=0;c<r;c++){const u=e[c];for(let g=0;g<n;g++)u[g]&&a.set(g,c)}return a}static parseFromString(e,r,n){if(e===null)throw new A("stringRepresentation cannot be null");const a=new Array(e.length);let c=0,u=0,g=-1,y=0,v=0;for(;v<e.length;)if(e.charAt(v)===`
`||e.charAt(v)==="\r"){if(c>u){if(g===-1)g=c-u;else if(c-u!==g)throw new A("row lengths do not match");u=c,y++}v++}else if(e.substring(v,v+r.length)===r)v+=r.length,a[c]=!0,c++;else if(e.substring(v,v+n.length)===n)v+=n.length,a[c]=!1,c++;else throw new A("illegal character encountered: "+e.substring(v));if(c>u){if(g===-1)g=c-u;else if(c-u!==g)throw new A("row lengths do not match");y++}const k=new Fe(g,y);for(let T=0;T<c;T++)a[T]&&k.set(Math.floor(T%g),Math.floor(T/g));return k}get(e,r){const n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0}set(e,r){const n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295}unset(e,r){const n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)}flip(e,r){const n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new A("input matrix dimensions do not match");const r=new Y(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits;for(let c=0,u=this.height;c<u;c++){const g=c*n,y=e.getRow(c,r).getBitArray();for(let v=0;v<n;v++)a[g+v]^=y[v]}}clear(){const e=this.bits,r=e.length;for(let n=0;n<r;n++)e[n]=0}setRegion(e,r,n,a){if(r<0||e<0)throw new A("Left and top must be nonnegative");if(a<1||n<1)throw new A("Height and width must be at least 1");const c=e+n,u=r+a;if(u>this.height||c>this.width)throw new A("The region must fit inside the matrix");const g=this.rowSize,y=this.bits;for(let v=r;v<u;v++){const k=v*g;for(let T=e;T<c;T++)y[k+Math.floor(T/32)]|=1<<(T&31)&4294967295}}getRow(e,r){r==null||r.getSize()<this.width?r=new Y(this.width):r.clear();const n=this.rowSize,a=this.bits,c=e*n;for(let u=0;u<n;u++)r.setBulk(u*32,a[c+u]);return r}setRow(e,r){F.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),r=this.getHeight();let n=new Y(e),a=new Y(e);for(let c=0,u=Math.floor((r+1)/2);c<u;c++)n=this.getRow(c,n),a=this.getRow(r-1-c,a),n.reverse(),a.reverse(),this.setRow(c,a),this.setRow(r-1-c,n)}getEnclosingRectangle(){const e=this.width,r=this.height,n=this.rowSize,a=this.bits;let c=e,u=r,g=-1,y=-1;for(let v=0;v<r;v++)for(let k=0;k<n;k++){const T=a[v*n+k];if(T!==0){if(v<u&&(u=v),v>y&&(y=v),k*32<c){let R=0;for(;(T<<31-R&4294967295)===0;)R++;k*32+R<c&&(c=k*32+R)}if(k*32+31>g){let R=31;for(;!(T>>>R);)R--;k*32+R>g&&(g=k*32+R)}}}return g<c||y<u?null:Int32Array.from([c,u,g-c+1,y-u+1])}getTopLeftOnBit(){const e=this.rowSize,r=this.bits;let n=0;for(;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;const a=n/e;let c=n%e*32;const u=r[n];let g=0;for(;(u<<31-g&4294967295)===0;)g++;return c+=g,Int32Array.from([c,a])}getBottomRightOnBit(){const e=this.rowSize,r=this.bits;let n=r.length-1;for(;n>=0&&r[n]===0;)n--;if(n<0)return null;const a=Math.floor(n/e);let c=Math.floor(n%e)*32;const u=r[n];let g=31;for(;!(u>>>g);)g--;return c+=g,Int32Array.from([c,a])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof Fe))return!1;const r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&re.equals(this.bits,r.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+re.hashCode(this.bits),e}toString(e="X ",r="  ",n=`
`){return this.buildToString(e,r,n)}buildToString(e,r,n){let a=new Ve;for(let c=0,u=this.height;c<u;c++){for(let g=0,y=this.width;g<y;g++)a.append(this.get(g,c)?e:r);a.append(n)}return a.toString()}clone(){return new Fe(this.width,this.height,this.rowSize,this.bits.slice())}}class X extends b{static getNotFoundInstance(){return new X}}X.kind="NotFoundException";class Ge extends z{constructor(e){super(e),this.luminances=Ge.EMPTY,this.buckets=new Int32Array(Ge.LUMINANCE_BUCKETS)}getBlackRow(e,r){const n=this.getLuminanceSource(),a=n.getWidth();r==null||r.getSize()<a?r=new Y(a):r.clear(),this.initArrays(a);const c=n.getRow(e,this.luminances),u=this.buckets;for(let y=0;y<a;y++)u[(c[y]&255)>>Ge.LUMINANCE_SHIFT]++;const g=Ge.estimateBlackPoint(u);if(a<3)for(let y=0;y<a;y++)(c[y]&255)<g&&r.set(y);else{let y=c[0]&255,v=c[1]&255;for(let k=1;k<a-1;k++){const T=c[k+1]&255;(v*4-y-T)/2<g&&r.set(k),y=v,v=T}}return r}getBlackMatrix(){const e=this.getLuminanceSource(),r=e.getWidth(),n=e.getHeight(),a=new Fe(r,n);this.initArrays(r);const c=this.buckets;for(let y=1;y<5;y++){const v=Math.floor(n*y/5),k=e.getRow(v,this.luminances),T=Math.floor(r*4/5);for(let R=Math.floor(r/5);R<T;R++){const P=k[R]&255;c[P>>Ge.LUMINANCE_SHIFT]++}}const u=Ge.estimateBlackPoint(c),g=e.getMatrix();for(let y=0;y<n;y++){const v=y*r;for(let k=0;k<r;k++)(g[v+k]&255)<u&&a.set(k,y)}return a}createBinarizer(e){return new Ge(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const r=this.buckets;for(let n=0;n<Ge.LUMINANCE_BUCKETS;n++)r[n]=0}static estimateBlackPoint(e){const r=e.length;let n=0,a=0,c=0;for(let k=0;k<r;k++)e[k]>c&&(a=k,c=e[k]),e[k]>n&&(n=e[k]);let u=0,g=0;for(let k=0;k<r;k++){const T=k-a,R=e[k]*T*T;R>g&&(u=k,g=R)}if(a>u){const k=a;a=u,u=k}if(u-a<=r/16)throw new X;let y=u-1,v=-1;for(let k=u-1;k>a;k--){const T=k-a,R=T*T*(u-k)*(n-e[k]);R>v&&(y=k,v=R)}return y<<Ge.LUMINANCE_SHIFT}}Ge.LUMINANCE_BITS=5,Ge.LUMINANCE_SHIFT=8-Ge.LUMINANCE_BITS,Ge.LUMINANCE_BUCKETS=1<<Ge.LUMINANCE_BITS,Ge.EMPTY=Uint8ClampedArray.from([0]);class Ce extends Ge{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),r=e.getWidth(),n=e.getHeight();if(r>=Ce.MINIMUM_DIMENSION&&n>=Ce.MINIMUM_DIMENSION){const a=e.getMatrix();let c=r>>Ce.BLOCK_SIZE_POWER;(r&Ce.BLOCK_SIZE_MASK)!==0&&c++;let u=n>>Ce.BLOCK_SIZE_POWER;(n&Ce.BLOCK_SIZE_MASK)!==0&&u++;const g=Ce.calculateBlackPoints(a,c,u,r,n),y=new Fe(r,n);Ce.calculateThresholdForBlock(a,c,u,r,n,g,y),this.matrix=y}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new Ce(e)}static calculateThresholdForBlock(e,r,n,a,c,u,g){const y=c-Ce.BLOCK_SIZE,v=a-Ce.BLOCK_SIZE;for(let k=0;k<n;k++){let T=k<<Ce.BLOCK_SIZE_POWER;T>y&&(T=y);const R=Ce.cap(k,2,n-3);for(let P=0;P<r;P++){let H=P<<Ce.BLOCK_SIZE_POWER;H>v&&(H=v);const $=Ce.cap(P,2,r-3);let Q=0;for(let Te=-2;Te<=2;Te++){const Re=u[R+Te];Q+=Re[$-2]+Re[$-1]+Re[$]+Re[$+1]+Re[$+2]}const ae=Q/25;Ce.thresholdBlock(e,H,T,ae,a,g)}}}static cap(e,r,n){return e<r?r:e>n?n:e}static thresholdBlock(e,r,n,a,c,u){for(let g=0,y=n*c+r;g<Ce.BLOCK_SIZE;g++,y+=c)for(let v=0;v<Ce.BLOCK_SIZE;v++)(e[y+v]&255)<=a&&u.set(r+v,n+g)}static calculateBlackPoints(e,r,n,a,c){const u=c-Ce.BLOCK_SIZE,g=a-Ce.BLOCK_SIZE,y=new Array(n);for(let v=0;v<n;v++){y[v]=new Int32Array(r);let k=v<<Ce.BLOCK_SIZE_POWER;k>u&&(k=u);for(let T=0;T<r;T++){let R=T<<Ce.BLOCK_SIZE_POWER;R>g&&(R=g);let P=0,H=255,$=0;for(let ae=0,Te=k*a+R;ae<Ce.BLOCK_SIZE;ae++,Te+=a){for(let Re=0;Re<Ce.BLOCK_SIZE;Re++){const be=e[Te+Re]&255;P+=be,be<H&&(H=be),be>$&&($=be)}if($-H>Ce.MIN_DYNAMIC_RANGE)for(ae++,Te+=a;ae<Ce.BLOCK_SIZE;ae++,Te+=a)for(let Re=0;Re<Ce.BLOCK_SIZE;Re++)P+=e[Te+Re]&255}let Q=P>>Ce.BLOCK_SIZE_POWER*2;if($-H<=Ce.MIN_DYNAMIC_RANGE&&(Q=H/2,v>0&&T>0)){const ae=(y[v-1][T]+2*y[v][T-1]+y[v-1][T-1])/4;H<ae&&(Q=ae)}y[v][T]=Q}}return y}}Ce.BLOCK_SIZE_POWER=3,Ce.BLOCK_SIZE=1<<Ce.BLOCK_SIZE_POWER,Ce.BLOCK_SIZE_MASK=Ce.BLOCK_SIZE-1,Ce.MINIMUM_DIMENSION=Ce.BLOCK_SIZE*5,Ce.MIN_DYNAMIC_RANGE=24;class he{constructor(e,r){this.width=e,this.height=r}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,r,n,a){throw new Ke("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Ke("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Ke("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let r=new Ve;for(let n=0;n<this.height;n++){const a=this.getRow(n,e);for(let c=0;c<this.width;c++){const u=a[c]&255;let g;u<64?g="#":u<128?g="+":u<192?g=".":g=" ",r.append(g)}r.append(`
`)}return r.toString()}}class je extends he{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,r){const n=this.delegate.getRow(e,r),a=this.getWidth();for(let c=0;c<a;c++)n[c]=255-(n[c]&255);return n}getMatrix(){const e=this.delegate.getMatrix(),r=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(r);for(let a=0;a<r;a++)n[a]=255-(e[a]&255);return n}isCropSupported(){return this.delegate.isCropSupported()}crop(e,r,n,a){return new je(this.delegate.crop(e,r,n,a))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new je(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new je(this.delegate.rotateCounterClockwise45())}}class ye extends he{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=ye.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const r=e.getContext("2d").getImageData(0,0,e.width,e.height);return ye.toGrayscaleBuffer(r.data,e.width,e.height)}static toGrayscaleBuffer(e,r,n){const a=new Uint8ClampedArray(r*n);for(let c=0,u=0,g=e.length;c<g;c+=4,u++){let y;if(e[c+3]===0)y=255;else{const k=e[c],T=e[c+1],R=e[c+2];y=306*k+601*T+117*R+512>>10}a[u]=y}return a}getRow(e,r){if(e<0||e>=this.getHeight())throw new A("Requested row is outside the image: "+e);const n=this.getWidth(),a=e*n;return r===null?r=this.buffer.slice(a,a+n):(r.length<n&&(r=new Uint8ClampedArray(n)),r.set(this.buffer.slice(a,a+n))),r}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,r,n,a){return super.crop(e,r,n,a),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const r=this.getTempCanvasElement(),n=r.getContext("2d"),a=e*ye.DEGREE_TO_RADIANS,c=this.canvas.width,u=this.canvas.height,g=Math.ceil(Math.abs(Math.cos(a))*c+Math.abs(Math.sin(a))*u),y=Math.ceil(Math.abs(Math.sin(a))*c+Math.abs(Math.cos(a))*u);return r.width=g,r.height=y,n.translate(g/2,y/2),n.rotate(a),n.drawImage(this.canvas,c/-2,u/-2),this.buffer=ye.makeBufferFromCanvasImageData(r),this}invert(){return new je(this)}}ye.DEGREE_TO_RADIANS=Math.PI/180;class B{constructor(e,r,n){this.deviceId=e,this.label=r,this.kind="videoinput",this.groupId=n||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var te=(globalThis||ql||self||window||void 0)&&(globalThis||ql||self||window||void 0).__awaiter||function(I,e,r,n){function a(c){return c instanceof r?c:new r(function(u){u(c)})}return new(r||(r=Promise))(function(c,u){function g(k){try{v(n.next(k))}catch(T){u(T)}}function y(k){try{v(n.throw(k))}catch(T){u(T)}}function v(k){k.done?c(k.value):a(k.value).then(g,y)}v((n=n.apply(I,e||[])).next())})};class fe{constructor(e,r=500,n){this.reader=e,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return te(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),r=[];for(const n of e){const a=n.kind==="video"?"videoinput":n.kind;if(a!=="videoinput")continue;const c=n.deviceId||n.id,u=n.label||`Video device ${r.length+1}`,g=n.groupId,y={deviceId:c,label:u,kind:a,groupId:g};r.push(y)}return r})}getVideoInputDevices(){return te(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(r=>new B(r.deviceId,r.label))})}findDeviceById(e){return te(this,void 0,void 0,function*(){const r=yield this.listVideoInputDevices();return r?r.find(n=>n.deviceId===e):null})}decodeFromInputVideoDevice(e,r){return te(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,r)})}decodeOnceFromVideoDevice(e,r){return te(this,void 0,void 0,function*(){this.reset();let n;e?n={deviceId:{exact:e}}:n={facingMode:"environment"};const a={video:n};return yield this.decodeOnceFromConstraints(a,r)})}decodeOnceFromConstraints(e,r){return te(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(n,r)})}decodeOnceFromStream(e,r){return te(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,r);return yield this.decodeOnce(n)})}decodeFromInputVideoDeviceContinuously(e,r,n){return te(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,r,n)})}decodeFromVideoDevice(e,r,n){return te(this,void 0,void 0,function*(){let a;e?a={deviceId:{exact:e}}:a={facingMode:"environment"};const c={video:a};return yield this.decodeFromConstraints(c,r,n)})}decodeFromConstraints(e,r,n){return te(this,void 0,void 0,function*(){const a=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(a,r,n)})}decodeFromStream(e,r,n){return te(this,void 0,void 0,function*(){this.reset();const a=yield this.attachStreamToVideo(e,r);return yield this.decodeContinuously(a,n)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,r){return te(this,void 0,void 0,function*(){const n=this.prepareVideoElement(r);return this.addVideoSource(n,e),this.videoElement=n,this.stream=e,yield this.playVideoOnLoadAsync(n),n})}playVideoOnLoadAsync(e){return new Promise((r,n)=>this.playVideoOnLoad(e,()=>r()))}playVideoOnLoad(e,r){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",r),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return te(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,r){const n=document.getElementById(e);if(!n)throw new E(`element with id '${e}' not found`);if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new E(`element with id '${e}' must be an ${r} element`);return n}decodeFromImage(e,r){if(!e&&!r)throw new E("either imageElement with a src set or an url must be provided");return r&&!e?this.decodeFromImageUrl(r):this.decodeFromImageElement(e)}decodeFromVideo(e,r){if(!e&&!r)throw new E("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,r,n){if(e===void 0&&r===void 0)throw new E("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(e,n)}decodeFromImageElement(e){if(!e)throw new E("An image element must be provided.");this.reset();const r=this.prepareImageElement(e);this.imageElement=r;let n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n}decodeFromVideoElement(e){const r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(r)}decodeFromVideoElementContinuously(e,r){const n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,r)}_decodeFromVideoElementSetup(e){if(!e)throw new E("A video element must be provided.");this.reset();const r=this.prepareVideoElement(e);return this.videoElement=r,r}decodeFromImageUrl(e){if(!e)throw new E("An URL must be provided.");this.reset();const r=this.prepareImageElement();this.imageElement=r;const n=this._decodeOnLoadImage(r);return r.src=e,n}decodeFromVideoUrl(e){if(!e)throw new E("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=e,n}decodeFromVideoUrlContinuously(e,r){if(!e)throw new E("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=e,a}_decodeOnLoadImage(e){return new Promise((r,n)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(r,n),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return te(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,r){return te(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,r)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let r;return typeof e>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(r=e),r}prepareVideoElement(e){let r;return!e&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(r=e),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r}decodeOnce(e,r=!0,n=!0){this._stopAsyncDecode=!1;const a=(c,u)=>{if(this._stopAsyncDecode){u(new X("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const g=this.decode(e);c(g)}catch(g){const y=r&&g instanceof X,k=(g instanceof D||g instanceof q)&&n;if(y||k)return setTimeout(a,this._timeBetweenDecodingAttempts,c,u);u(g)}};return new Promise((c,u)=>a(c,u))}decodeContinuously(e,r){this._stopContinuousDecode=!1;const n=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const a=this.decode(e);r(a,null),setTimeout(n,this.timeBetweenScansMillis)}catch(a){r(null,a);const c=a instanceof D||a instanceof q,u=a instanceof X;(c||u)&&setTimeout(n,this._timeBetweenDecodingAttempts)}};n()}decode(e){const r=this.createBinaryBitmap(e);return this.decodeBitmap(r)}_isHTMLVideoElement(e){return e.videoWidth!==0}drawFrameOnCanvas(e,r,n){r||(r={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)}drawImageOnCanvas(e,r,n=this.captureCanvasContext){r||(r={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const r=this.getCaptureCanvas(e),n=new ye(r),a=new Ce(n);return new O(a)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const n=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=n}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const r=this.createCaptureCanvas(e);this.captureCanvas=r}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const r=document.createElement("canvas");let n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,r){try{e.srcObject=r}catch{e.src=URL.createObjectURL(r)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class Be{constructor(e,r,n=r==null?0:8*r.length,a,c,u=F.currentTimeMillis()){this.text=e,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=c,this.timestamp=u,this.text=e,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=c,this.resultMetadata=null,u==null?this.timestamp=F.currentTimeMillis():this.timestamp=u}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,r)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const r=this.resultPoints;if(r===null)this.resultPoints=e;else if(e!==null&&e.length>0){const n=new Array(r.length+e.length);F.arraycopy(r,0,n,0,r.length),F.arraycopy(e,0,n,r.length,e.length),this.resultPoints=n}}getTimestamp(){return this.timestamp}toString(){return this.text}}var nt;(function(I){I[I.AZTEC=0]="AZTEC",I[I.CODABAR=1]="CODABAR",I[I.CODE_39=2]="CODE_39",I[I.CODE_93=3]="CODE_93",I[I.CODE_128=4]="CODE_128",I[I.DATA_MATRIX=5]="DATA_MATRIX",I[I.EAN_8=6]="EAN_8",I[I.EAN_13=7]="EAN_13",I[I.ITF=8]="ITF",I[I.MAXICODE=9]="MAXICODE",I[I.PDF_417=10]="PDF_417",I[I.QR_CODE=11]="QR_CODE",I[I.RSS_14=12]="RSS_14",I[I.RSS_EXPANDED=13]="RSS_EXPANDED",I[I.UPC_A=14]="UPC_A",I[I.UPC_E=15]="UPC_E",I[I.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(nt||(nt={}));var Ae=nt,mt;(function(I){I[I.OTHER=0]="OTHER",I[I.ORIENTATION=1]="ORIENTATION",I[I.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",I[I.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",I[I.ISSUE_NUMBER=4]="ISSUE_NUMBER",I[I.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",I[I.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",I[I.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",I[I.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",I[I.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",I[I.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(mt||(mt={}));var Ye=mt;class Ue{constructor(e,r,n,a,c=-1,u=-1){this.rawBytes=e,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=c,this.structuredAppendParity=u,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ct{exp(e){return this.expTable[e]}log(e){if(e===0)throw new A;return this.logTable[e]}static addOrSubtract(e,r){return e^r}}class de{constructor(e,r){if(r.length===0)throw new A;this.field=e;const n=r.length;if(n>1&&r[0]===0){let a=1;for(;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),F.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const r=this.coefficients;let n;if(e===1){n=0;for(let u=0,g=r.length;u!==g;u++){const y=r[u];n=ct.addOrSubtract(n,y)}return n}n=r[0];const a=r.length,c=this.field;for(let u=1;u<a;u++)n=ct.addOrSubtract(c.multiply(e,n),r[u]);return n}addOrSubtract(e){if(!this.field.equals(e.field))throw new A("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let r=this.coefficients,n=e.coefficients;if(r.length>n.length){const u=r;r=n,n=u}let a=new Int32Array(n.length);const c=n.length-r.length;F.arraycopy(n,0,a,0,c);for(let u=c;u<n.length;u++)a[u]=ct.addOrSubtract(r[u-c],n[u]);return new de(this.field,a)}multiply(e){if(!this.field.equals(e.field))throw new A("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const r=this.coefficients,n=r.length,a=e.coefficients,c=a.length,u=new Int32Array(n+c-1),g=this.field;for(let y=0;y<n;y++){const v=r[y];for(let k=0;k<c;k++)u[y+k]=ct.addOrSubtract(u[y+k],g.multiply(v,a[k]))}return new de(g,u)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const r=this.coefficients.length,n=this.field,a=new Int32Array(r),c=this.coefficients;for(let u=0;u<r;u++)a[u]=n.multiply(c[u],e);return new de(n,a)}multiplyByMonomial(e,r){if(e<0)throw new A;if(r===0)return this.field.getZero();const n=this.coefficients,a=n.length,c=new Int32Array(a+e),u=this.field;for(let g=0;g<a;g++)c[g]=u.multiply(n[g],r);return new de(u,c)}divide(e){if(!this.field.equals(e.field))throw new A("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new A("Divide by 0");const r=this.field;let n=r.getZero(),a=this;const c=e.getCoefficient(e.getDegree()),u=r.inverse(c);for(;a.getDegree()>=e.getDegree()&&!a.isZero();){const g=a.getDegree()-e.getDegree(),y=r.multiply(a.getCoefficient(a.getDegree()),u),v=e.multiplyByMonomial(g,y),k=r.buildMonomial(g,y);n=n.addOrSubtract(k),a=a.addOrSubtract(v)}return[n,a]}toString(){let e="";for(let r=this.getDegree();r>=0;r--){let n=this.getCoefficient(r);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),r===0||n!==1){const a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}r!==0&&(r===1?e+="x":(e+="x^",e+=r))}}return e}}class Oe extends b{}Oe.kind="ArithmeticException";class Xe extends ct{constructor(e,r,n){super(),this.primitive=e,this.size=r,this.generatorBase=n;const a=new Int32Array(r);let c=1;for(let g=0;g<r;g++)a[g]=c,c*=2,c>=r&&(c^=e,c&=r-1);this.expTable=a;const u=new Int32Array(r);for(let g=0;g<r-1;g++)u[a[g]]=g;this.logTable=u,this.zero=new de(this,Int32Array.from([0])),this.one=new de(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,r){if(e<0)throw new A;if(r===0)return this.zero;const n=new Int32Array(e+1);return n[0]=r,new de(this,n)}inverse(e){if(e===0)throw new Oe;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+L.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}Xe.AZTEC_DATA_12=new Xe(4201,4096,1),Xe.AZTEC_DATA_10=new Xe(1033,1024,1),Xe.AZTEC_DATA_6=new Xe(67,64,1),Xe.AZTEC_PARAM=new Xe(19,16,1),Xe.QR_CODE_FIELD_256=new Xe(285,256,0),Xe.DATA_MATRIX_FIELD_256=new Xe(301,256,1),Xe.AZTEC_DATA_8=Xe.DATA_MATRIX_FIELD_256,Xe.MAXICODE_FIELD_64=Xe.AZTEC_DATA_6;class Nt extends b{}Nt.kind="ReedSolomonException";class nr extends b{}nr.kind="IllegalStateException";class ke{constructor(e){this.field=e}decode(e,r){const n=this.field,a=new de(n,e),c=new Int32Array(r);let u=!0;for(let P=0;P<r;P++){const H=a.evaluateAt(n.exp(P+n.getGeneratorBase()));c[c.length-1-P]=H,H!==0&&(u=!1)}if(u)return;const g=new de(n,c),y=this.runEuclideanAlgorithm(n.buildMonomial(r,1),g,r),v=y[0],k=y[1],T=this.findErrorLocations(v),R=this.findErrorMagnitudes(k,T);for(let P=0;P<T.length;P++){const H=e.length-1-n.log(T[P]);if(H<0)throw new Nt("Bad error location");e[H]=Xe.addOrSubtract(e[H],R[P])}}runEuclideanAlgorithm(e,r,n){if(e.getDegree()<r.getDegree()){const P=e;e=r,r=P}const a=this.field;let c=e,u=r,g=a.getZero(),y=a.getOne();for(;u.getDegree()>=(n/2|0);){let P=c,H=g;if(c=u,g=y,c.isZero())throw new Nt("r_{i-1} was zero");u=P;let $=a.getZero();const Q=c.getCoefficient(c.getDegree()),ae=a.inverse(Q);for(;u.getDegree()>=c.getDegree()&&!u.isZero();){const Te=u.getDegree()-c.getDegree(),Re=a.multiply(u.getCoefficient(u.getDegree()),ae);$=$.addOrSubtract(a.buildMonomial(Te,Re)),u=u.addOrSubtract(c.multiplyByMonomial(Te,Re))}if(y=$.multiply(g).addOrSubtract(H),u.getDegree()>=c.getDegree())throw new nr("Division algorithm failed to reduce polynomial?")}const v=y.getCoefficient(0);if(v===0)throw new Nt("sigmaTilde(0) was zero");const k=a.inverse(v),T=y.multiplyScalar(k),R=u.multiplyScalar(k);return[T,R]}findErrorLocations(e){const r=e.getDegree();if(r===1)return Int32Array.from([e.getCoefficient(1)]);const n=new Int32Array(r);let a=0;const c=this.field;for(let u=1;u<c.getSize()&&a<r;u++)e.evaluateAt(u)===0&&(n[a]=c.inverse(u),a++);if(a!==r)throw new Nt("Error locator degree does not match number of roots");return n}findErrorMagnitudes(e,r){const n=r.length,a=new Int32Array(n),c=this.field;for(let u=0;u<n;u++){const g=c.inverse(r[u]);let y=1;for(let v=0;v<n;v++)if(u!==v){const k=c.multiply(r[v],g),T=(k&1)===0?k|1:k&-2;y=c.multiply(y,T)}a[u]=c.multiply(e.evaluateAt(g),c.inverse(y)),c.getGeneratorBase()!==0&&(a[u]=c.multiply(a[u],g))}return a}}var ze;(function(I){I[I.UPPER=0]="UPPER",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.DIGIT=3]="DIGIT",I[I.PUNCT=4]="PUNCT",I[I.BINARY=5]="BINARY"})(ze||(ze={}));class We{decode(e){this.ddata=e;let r=e.getBits(),n=this.extractBits(r),a=this.correctBits(n),c=We.convertBoolArrayToByteArray(a),u=We.getEncodedData(a),g=new Ue(c,u,null,null);return g.setNumBits(a.length),g}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let r=e.length,n=ze.UPPER,a=ze.UPPER,c="",u=0;for(;u<r;)if(a===ze.BINARY){if(r-u<5)break;let g=We.readCode(e,u,5);if(u+=5,g===0){if(r-u<11)break;g=We.readCode(e,u,11)+31,u+=11}for(let y=0;y<g;y++){if(r-u<8){u=r;break}const v=We.readCode(e,u,8);c+=xe.castAsNonUtf8Char(v),u+=8}a=n}else{let g=a===ze.DIGIT?4:5;if(r-u<g)break;let y=We.readCode(e,u,g);u+=g;let v=We.getCharacter(a,y);v.startsWith("CTRL_")?(n=a,a=We.getTable(v.charAt(5)),v.charAt(6)==="L"&&(n=a)):(c+=v,a=n)}return c}static getTable(e){switch(e){case"L":return ze.LOWER;case"P":return ze.PUNCT;case"M":return ze.MIXED;case"D":return ze.DIGIT;case"B":return ze.BINARY;case"U":default:return ze.UPPER}}static getCharacter(e,r){switch(e){case ze.UPPER:return We.UPPER_TABLE[r];case ze.LOWER:return We.LOWER_TABLE[r];case ze.MIXED:return We.MIXED_TABLE[r];case ze.PUNCT:return We.PUNCT_TABLE[r];case ze.DIGIT:return We.DIGIT_TABLE[r];default:throw new nr("Bad table")}}correctBits(e){let r,n;this.ddata.getNbLayers()<=2?(n=6,r=Xe.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=Xe.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=Xe.AZTEC_DATA_10):(n=12,r=Xe.AZTEC_DATA_12);let a=this.ddata.getNbDatablocks(),c=e.length/n;if(c<a)throw new q;let u=e.length%n,g=new Int32Array(c);for(let R=0;R<c;R++,u+=n)g[R]=We.readCode(e,u,n);try{new ke(r).decode(g,c-a)}catch(R){throw new q(R)}let y=(1<<n)-1,v=0;for(let R=0;R<a;R++){let P=g[R];if(P===0||P===y)throw new q;(P===1||P===y-1)&&v++}let k=new Array(a*n-v),T=0;for(let R=0;R<a;R++){let P=g[R];if(P===1||P===y-1)k.fill(P>1,T,T+n-1),T+=n-1;else for(let H=n-1;H>=0;--H)k[T++]=(P&1<<H)!==0}return k}extractBits(e){let r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,c=new Int32Array(a),u=new Array(this.totalBitsInLayer(n,r));if(r)for(let g=0;g<c.length;g++)c[g]=g;else{let g=a+1+2*L.truncDivision(L.truncDivision(a,2)-1,15),y=a/2,v=L.truncDivision(g,2);for(let k=0;k<y;k++){let T=k+L.truncDivision(k,15);c[y-k-1]=v-T-1,c[y+k]=v+T+1}}for(let g=0,y=0;g<n;g++){let v=(n-g)*4+(r?9:12),k=g*2,T=a-1-k;for(let R=0;R<v;R++){let P=R*2;for(let H=0;H<2;H++)u[y+P+H]=e.get(c[k+H],c[k+R]),u[y+2*v+P+H]=e.get(c[k+R],c[T-H]),u[y+4*v+P+H]=e.get(c[T-H],c[T-R]),u[y+6*v+P+H]=e.get(c[T-R],c[k+H])}y+=v*8}return u}static readCode(e,r,n){let a=0;for(let c=r;c<r+n;c++)a<<=1,e[c]&&(a|=1);return a}static readByte(e,r){let n=e.length-r;return n>=8?We.readCode(e,r,8):We.readCode(e,r,n)<<8-n}static convertBoolArrayToByteArray(e){let r=new Uint8Array((e.length+7)/8);for(let n=0;n<r.length;n++)r[n]=We.readByte(e,8*n);return r}totalBitsInLayer(e,r){return((r?88:112)+16*e)*e}}We.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],We.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],We.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],We.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],We.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class $e{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,r,n,a){const c=e-n,u=r-a;return Math.sqrt(c*c+u*u)}static sum(e){let r=0;for(let n=0,a=e.length;n!==a;n++){const c=e[n];r+=c}return r}}class bt{static floatToIntBits(e){return e}}bt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ee{constructor(e,r){this.x=e,this.y=r}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof Ee){const r=e;return this.x===r.x&&this.y===r.y}return!1}hashCode(){return 31*bt.floatToIntBits(this.x)+bt.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const r=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]);let c,u,g;if(n>=r&&n>=a?(u=e[0],c=e[1],g=e[2]):a>=n&&a>=r?(u=e[1],c=e[0],g=e[2]):(u=e[2],c=e[0],g=e[1]),this.crossProductZ(c,u,g)<0){const y=c;c=g,g=y}e[0]=c,e[1]=u,e[2]=g}static distance(e,r){return $e.distance(e.x,e.y,r.x,r.y)}static crossProductZ(e,r,n){const a=r.x,c=r.y;return(n.x-a)*(e.y-c)-(n.y-c)*(e.x-a)}}class _t{constructor(e,r){this.bits=e,this.points=r}getBits(){return this.bits}getPoints(){return this.points}}class sr extends _t{constructor(e,r,n,a,c){super(e,r),this.compact=n,this.nbDatablocks=a,this.nbLayers=c}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Dt{constructor(e,r,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),r==null&&(r=Dt.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);const c=r/2|0;if(this.leftInit=n-c,this.rightInit=n+c,this.upInit=a-c,this.downInit=a+c,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new X}detect(){let e=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,c=!1,u=!0,g=!1,y=!1,v=!1,k=!1,T=!1;const R=this.width,P=this.height;for(;u;){u=!1;let H=!0;for(;(H||!y)&&r<R;)H=this.containsBlackPoint(n,a,r,!1),H?(r++,u=!0,y=!0):y||r++;if(r>=R){c=!0;break}let $=!0;for(;($||!v)&&a<P;)$=this.containsBlackPoint(e,r,a,!0),$?(a++,u=!0,v=!0):v||a++;if(a>=P){c=!0;break}let Q=!0;for(;(Q||!k)&&e>=0;)Q=this.containsBlackPoint(n,a,e,!1),Q?(e--,u=!0,k=!0):k||e--;if(e<0){c=!0;break}let ae=!0;for(;(ae||!T)&&n>=0;)ae=this.containsBlackPoint(e,r,n,!0),ae?(n--,u=!0,T=!0):T||n--;if(n<0){c=!0;break}u&&(g=!0)}if(!c&&g){const H=r-e;let $=null;for(let Re=1;$===null&&Re<H;Re++)$=this.getBlackPointOnSegment(e,a-Re,e+Re,a);if($==null)throw new X;let Q=null;for(let Re=1;Q===null&&Re<H;Re++)Q=this.getBlackPointOnSegment(e,n+Re,e+Re,n);if(Q==null)throw new X;let ae=null;for(let Re=1;ae===null&&Re<H;Re++)ae=this.getBlackPointOnSegment(r,n+Re,r-Re,n);if(ae==null)throw new X;let Te=null;for(let Re=1;Te===null&&Re<H;Re++)Te=this.getBlackPointOnSegment(r,a-Re,r-Re,a);if(Te==null)throw new X;return this.centerEdges(Te,$,ae,Q)}else throw new X}getBlackPointOnSegment(e,r,n,a){const c=$e.round($e.distance(e,r,n,a)),u=(n-e)/c,g=(a-r)/c,y=this.image;for(let v=0;v<c;v++){const k=$e.round(e+v*u),T=$e.round(r+v*g);if(y.get(k,T))return new Ee(k,T)}return null}centerEdges(e,r,n,a){const c=e.getX(),u=e.getY(),g=r.getX(),y=r.getY(),v=n.getX(),k=n.getY(),T=a.getX(),R=a.getY(),P=Dt.CORR;return c<this.width/2?[new Ee(T-P,R+P),new Ee(g+P,y+P),new Ee(v-P,k-P),new Ee(c+P,u-P)]:[new Ee(T+P,R+P),new Ee(g+P,y-P),new Ee(v-P,k+P),new Ee(c-P,u-P)]}containsBlackPoint(e,r,n,a){const c=this.image;if(a){for(let u=e;u<=r;u++)if(c.get(u,n))return!0}else for(let u=e;u<=r;u++)if(c.get(n,u))return!0;return!1}}Dt.INIT_SIZE=10,Dt.CORR=1;class Er{static checkAndNudgePoints(e,r){const n=e.getWidth(),a=e.getHeight();let c=!0;for(let u=0;u<r.length&&c;u+=2){const g=Math.floor(r[u]),y=Math.floor(r[u+1]);if(g<-1||g>n||y<-1||y>a)throw new X;c=!1,g===-1?(r[u]=0,c=!0):g===n&&(r[u]=n-1,c=!0),y===-1?(r[u+1]=0,c=!0):y===a&&(r[u+1]=a-1,c=!0)}c=!0;for(let u=r.length-2;u>=0&&c;u-=2){const g=Math.floor(r[u]),y=Math.floor(r[u+1]);if(g<-1||g>n||y<-1||y>a)throw new X;c=!1,g===-1?(r[u]=0,c=!0):g===n&&(r[u]=n-1,c=!0),y===-1?(r[u+1]=0,c=!0):y===a&&(r[u+1]=a-1,c=!0)}}}class me{constructor(e,r,n,a,c,u,g,y,v){this.a11=e,this.a21=r,this.a31=n,this.a12=a,this.a22=c,this.a32=u,this.a13=g,this.a23=y,this.a33=v}static quadrilateralToQuadrilateral(e,r,n,a,c,u,g,y,v,k,T,R,P,H,$,Q){const ae=me.quadrilateralToSquare(e,r,n,a,c,u,g,y);return me.squareToQuadrilateral(v,k,T,R,P,H,$,Q).times(ae)}transformPoints(e){const r=e.length,n=this.a11,a=this.a12,c=this.a13,u=this.a21,g=this.a22,y=this.a23,v=this.a31,k=this.a32,T=this.a33;for(let R=0;R<r;R+=2){const P=e[R],H=e[R+1],$=c*P+y*H+T;e[R]=(n*P+u*H+v)/$,e[R+1]=(a*P+g*H+k)/$}}transformPointsWithValues(e,r){const n=this.a11,a=this.a12,c=this.a13,u=this.a21,g=this.a22,y=this.a23,v=this.a31,k=this.a32,T=this.a33,R=e.length;for(let P=0;P<R;P++){const H=e[P],$=r[P],Q=c*H+y*$+T;e[P]=(n*H+u*$+v)/Q,r[P]=(a*H+g*$+k)/Q}}static squareToQuadrilateral(e,r,n,a,c,u,g,y){const v=e-n+c-g,k=r-a+u-y;if(v===0&&k===0)return new me(n-e,c-n,e,a-r,u-a,r,0,0,1);{const T=n-c,R=g-c,P=a-u,H=y-u,$=T*H-R*P,Q=(v*H-R*k)/$,ae=(T*k-v*P)/$;return new me(n-e+Q*n,g-e+ae*g,e,a-r+Q*a,y-r+ae*y,r,Q,ae,1)}}static quadrilateralToSquare(e,r,n,a,c,u,g,y){return me.squareToQuadrilateral(e,r,n,a,c,u,g,y).buildAdjoint()}buildAdjoint(){return new me(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new me(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class Mt extends Er{sampleGrid(e,r,n,a,c,u,g,y,v,k,T,R,P,H,$,Q,ae,Te,Re){const be=me.quadrilateralToQuadrilateral(a,c,u,g,y,v,k,T,R,P,H,$,Q,ae,Te,Re);return this.sampleGridWithTransform(e,r,n,be)}sampleGridWithTransform(e,r,n,a){if(r<=0||n<=0)throw new X;const c=new Fe(r,n),u=new Float32Array(2*r);for(let g=0;g<n;g++){const y=u.length,v=g+.5;for(let k=0;k<y;k+=2)u[k]=k/2+.5,u[k+1]=v;a.transformPoints(u),Er.checkAndNudgePoints(e,u);try{for(let k=0;k<y;k+=2)e.get(Math.floor(u[k]),Math.floor(u[k+1]))&&c.set(k/2,g)}catch{throw new X}}return c}}class or{static setGridSampler(e){or.gridSampler=e}static getInstance(){return or.gridSampler}}or.gridSampler=new Mt;class Cr{constructor(e,r){this.x=e,this.y=r}toResultPoint(){return new Ee(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ls{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(e){let u=n[0];n[0]=n[2],n[2]=u}this.extractParameters(n);let a=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),c=this.getMatrixCornerPoints(n);return new sr(a,c,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new X;let r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],r),this.sampleLine(e[1],e[2],r),this.sampleLine(e[2],e[3],r),this.sampleLine(e[3],e[0],r)]);this.shift=this.getRotation(n,r);let a=0;for(let u=0;u<4;u++){let g=n[(this.shift+u)%4];this.compact?(a<<=7,a+=g>>1&127):(a<<=10,a+=(g>>2&992)+(g>>1&31))}let c=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(c>>6)+1,this.nbDataBlocks=(c&63)+1):(this.nbLayers=(c>>11)+1,this.nbDataBlocks=(c&2047)+1)}getRotation(e,r){let n=0;e.forEach((a,c,u)=>{let g=(a>>r-2<<1)+(a&1);n=(n<<3)+g}),n=((n&1)<<11)+(n>>1);for(let a=0;a<4;a++)if(L.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new X}getCorrectedParameterData(e,r){let n,a;r?(n=7,a=2):(n=10,a=4);let c=n-a,u=new Int32Array(n);for(let y=n-1;y>=0;--y)u[y]=e&15,e>>=4;try{new ke(Xe.AZTEC_PARAM).decode(u,c)}catch{throw new X}let g=0;for(let y=0;y<a;y++)g=(g<<4)+u[y];return g}getBullsEyeCorners(e){let r=e,n=e,a=e,c=e,u=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let T=this.getFirstDifferent(r,u,1,-1),R=this.getFirstDifferent(n,u,1,1),P=this.getFirstDifferent(a,u,-1,1),H=this.getFirstDifferent(c,u,-1,-1);if(this.nbCenterLayers>2){let $=this.distancePoint(H,T)*this.nbCenterLayers/(this.distancePoint(c,r)*(this.nbCenterLayers+2));if($<.75||$>1.25||!this.isWhiteOrBlackRectangle(T,R,P,H))break}r=T,n=R,a=P,c=H,u=!u}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new X;this.compact=this.nbCenterLayers===5;let g=new Ee(r.getX()+.5,r.getY()-.5),y=new Ee(n.getX()+.5,n.getY()+.5),v=new Ee(a.getX()-.5,a.getY()+.5),k=new Ee(c.getX()-.5,c.getY()-.5);return this.expandSquare([g,y,v,k],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,r,n,a;try{let g=new Dt(this.image).detect();e=g[0],r=g[1],n=g[2],a=g[3]}catch{let y=this.image.getWidth()/2,v=this.image.getHeight()/2;e=this.getFirstDifferent(new Cr(y+7,v-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Cr(y+7,v+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Cr(y-7,v+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Cr(y-7,v-7),!1,-1,-1).toResultPoint()}let c=$e.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=$e.round((e.getY()+a.getY()+r.getY()+n.getY())/4);try{let g=new Dt(this.image,15,c,u).detect();e=g[0],r=g[1],n=g[2],a=g[3]}catch{e=this.getFirstDifferent(new Cr(c+7,u-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Cr(c+7,u+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Cr(c-7,u+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Cr(c-7,u-7),!1,-1,-1).toResultPoint()}return c=$e.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=$e.round((e.getY()+a.getY()+r.getY()+n.getY())/4),new Cr(c,u)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,r,n,a,c){let u=or.getInstance(),g=this.getDimension(),y=g/2-this.nbCenterLayers,v=g/2+this.nbCenterLayers;return u.sampleGrid(e,g,g,y,y,v,y,v,v,y,v,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),c.getX(),c.getY())}sampleLine(e,r,n){let a=0,c=this.distanceResultPoint(e,r),u=c/n,g=e.getX(),y=e.getY(),v=u*(r.getX()-e.getX())/c,k=u*(r.getY()-e.getY())/c;for(let T=0;T<n;T++)this.image.get($e.round(g+T*v),$e.round(y+T*k))&&(a|=1<<n-T-1);return a}isWhiteOrBlackRectangle(e,r,n,a){let c=3;e=new Cr(e.getX()-c,e.getY()+c),r=new Cr(r.getX()-c,r.getY()-c),n=new Cr(n.getX()+c,n.getY()-c),a=new Cr(a.getX()+c,a.getY()+c);let u=this.getColor(a,e);if(u===0)return!1;let g=this.getColor(e,r);return g!==u||(g=this.getColor(r,n),g!==u)?!1:(g=this.getColor(n,a),g===u)}getColor(e,r){let n=this.distancePoint(e,r),a=(r.getX()-e.getX())/n,c=(r.getY()-e.getY())/n,u=0,g=e.getX(),y=e.getY(),v=this.image.get(e.getX(),e.getY()),k=Math.ceil(n);for(let R=0;R<k;R++)g+=a,y+=c,this.image.get($e.round(g),$e.round(y))!==v&&u++;let T=u/n;return T>.1&&T<.9?0:T<=.1===v?1:-1}getFirstDifferent(e,r,n,a){let c=e.getX()+n,u=e.getY()+a;for(;this.isValid(c,u)&&this.image.get(c,u)===r;)c+=n,u+=a;for(c-=n,u-=a;this.isValid(c,u)&&this.image.get(c,u)===r;)c+=n;for(c-=n;this.isValid(c,u)&&this.image.get(c,u)===r;)u+=a;return u-=a,new Cr(c,u)}expandSquare(e,r,n){let a=n/(2*r),c=e[0].getX()-e[2].getX(),u=e[0].getY()-e[2].getY(),g=(e[0].getX()+e[2].getX())/2,y=(e[0].getY()+e[2].getY())/2,v=new Ee(g+a*c,y+a*u),k=new Ee(g-a*c,y-a*u);c=e[1].getX()-e[3].getX(),u=e[1].getY()-e[3].getY(),g=(e[1].getX()+e[3].getX())/2,y=(e[1].getY()+e[3].getY())/2;let T=new Ee(g+a*c,y+a*u),R=new Ee(g-a*c,y-a*u);return[v,T,k,R]}isValid(e,r){return e>=0&&e<this.image.getWidth()&&r>0&&r<this.image.getHeight()}isValidPoint(e){let r=$e.round(e.getX()),n=$e.round(e.getY());return this.isValid(r,n)}distancePoint(e,r){return $e.distance(e.getX(),e.getY(),r.getX(),r.getY())}distanceResultPoint(e,r){return $e.distance(e.getX(),e.getY(),r.getX(),r.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(L.truncDivision(this.nbLayers-4,8)+1)+15}}class Bn{decode(e,r=null){let n=null,a=new ls(e.getBlackMatrix()),c=null,u=null;try{let k=a.detectMirror(!1);c=k.getPoints(),this.reportFoundResultPoints(r,c),u=new We().decode(k)}catch(k){n=k}if(u==null)try{let k=a.detectMirror(!0);c=k.getPoints(),this.reportFoundResultPoints(r,c),u=new We().decode(k)}catch(k){throw n??k}let g=new Be(u.getText(),u.getRawBytes(),u.getNumBits(),c,Ae.AZTEC,F.currentTimeMillis()),y=u.getByteSegments();y!=null&&g.putMetadata(Ye.BYTE_SEGMENTS,y);let v=u.getECLevel();return v!=null&&g.putMetadata(Ye.ERROR_CORRECTION_LEVEL,v),g}reportFoundResultPoints(e,r){if(e!=null){let n=e.get(ce.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach((a,c,u)=>{n.foundPossibleResultPoint(a)})}}reset(){}}class Wa extends fe{constructor(e=500){super(new Bn,e)}}class hr{decode(e,r){try{return this.doDecode(e,r)}catch{if(r&&r.get(ce.TRY_HARDER)===!0&&e.isRotateSupported()){const c=e.rotateCounterClockwise(),u=this.doDecode(c,r),g=u.getResultMetadata();let y=270;g!==null&&g.get(Ye.ORIENTATION)===!0&&(y=y+g.get(Ye.ORIENTATION)%360),u.putMetadata(Ye.ORIENTATION,y);const v=u.getResultPoints();if(v!==null){const k=c.getHeight();for(let T=0;T<v.length;T++)v[T]=new Ee(k-v[T].getY()-1,v[T].getX())}return u}else throw new X}}reset(){}doDecode(e,r){const n=e.getWidth(),a=e.getHeight();let c=new Y(n);const u=r&&r.get(ce.TRY_HARDER)===!0,g=Math.max(1,a>>(u?8:5));let y;u?y=a:y=15;const v=Math.trunc(a/2);for(let k=0;k<y;k++){const T=Math.trunc((k+1)/2),R=(k&1)===0,P=v+g*(R?T:-T);if(P<0||P>=a)break;try{c=e.getBlackRow(P,c)}catch{continue}for(let H=0;H<2;H++){if(H===1&&(c.reverse(),r&&r.get(ce.NEED_RESULT_POINT_CALLBACK)===!0)){const $=new Map;r.forEach((Q,ae)=>$.set(ae,Q)),$.delete(ce.NEED_RESULT_POINT_CALLBACK),r=$}try{const $=this.decodeRow(P,c,r);if(H===1){$.putMetadata(Ye.ORIENTATION,180);const Q=$.getResultPoints();Q!==null&&(Q[0]=new Ee(n-Q[0].getX()-1,Q[0].getY()),Q[1]=new Ee(n-Q[1].getX()-1,Q[1].getY()))}return $}catch{}}}throw new X}static recordPattern(e,r,n){const a=n.length;for(let v=0;v<a;v++)n[v]=0;const c=e.getSize();if(r>=c)throw new X;let u=!e.get(r),g=0,y=r;for(;y<c;){if(e.get(y)!==u)n[g]++;else{if(++g===a)break;n[g]=1,u=!u}y++}if(!(g===a||g===a-1&&y===c))throw new X}static recordPatternInReverse(e,r,n){let a=n.length,c=e.get(r);for(;r>0&&a>=0;)e.get(--r)!==c&&(a--,c=!c);if(a>=0)throw new X;hr.recordPattern(e,r+1,n)}static patternMatchVariance(e,r,n){const a=e.length;let c=0,u=0;for(let v=0;v<a;v++)c+=e[v],u+=r[v];if(c<u)return Number.POSITIVE_INFINITY;const g=c/u;n*=g;let y=0;for(let v=0;v<a;v++){const k=e[v],T=r[v]*g,R=k>T?k-T:T-k;if(R>n)return Number.POSITIVE_INFINITY;y+=R}return y/c}}class Pe extends hr{static findStartPattern(e){const r=e.getSize(),n=e.getNextSet(0);let a=0,c=Int32Array.from([0,0,0,0,0,0]),u=n,g=!1;const y=6;for(let v=n;v<r;v++)if(e.get(v)!==g)c[a]++;else{if(a===y-1){let k=Pe.MAX_AVG_VARIANCE,T=-1;for(let R=Pe.CODE_START_A;R<=Pe.CODE_START_C;R++){const P=hr.patternMatchVariance(c,Pe.CODE_PATTERNS[R],Pe.MAX_INDIVIDUAL_VARIANCE);P<k&&(k=P,T=R)}if(T>=0&&e.isRange(Math.max(0,u-(v-u)/2),u,!1))return Int32Array.from([u,v,T]);u+=c[0]+c[1],c=c.slice(2,c.length-1),c[a-1]=0,c[a]=0,a--}else a++;c[a]=1,g=!g}throw new X}static decodeCode(e,r,n){hr.recordPattern(e,n,r);let a=Pe.MAX_AVG_VARIANCE,c=-1;for(let u=0;u<Pe.CODE_PATTERNS.length;u++){const g=Pe.CODE_PATTERNS[u],y=this.patternMatchVariance(r,g,Pe.MAX_INDIVIDUAL_VARIANCE);y<a&&(a=y,c=u)}if(c>=0)return c;throw new X}decodeRow(e,r,n){const a=n&&n.get(ce.ASSUME_GS1)===!0,c=Pe.findStartPattern(r),u=c[2];let g=0;const y=new Uint8Array(20);y[g++]=u;let v;switch(u){case Pe.CODE_START_A:v=Pe.CODE_CODE_A;break;case Pe.CODE_START_B:v=Pe.CODE_CODE_B;break;case Pe.CODE_START_C:v=Pe.CODE_CODE_C;break;default:throw new q}let k=!1,T=!1,R="",P=c[0],H=c[1];const $=Int32Array.from([0,0,0,0,0,0]);let Q=0,ae=0,Te=u,Re=0,be=!0,At=!1,ft=!1;for(;!k;){const Jn=T;switch(T=!1,Q=ae,ae=Pe.decodeCode(r,$,H),y[g++]=ae,ae!==Pe.CODE_STOP&&(be=!0),ae!==Pe.CODE_STOP&&(Re++,Te+=Re*ae),P=H,H+=$.reduce(($s,no)=>$s+no,0),ae){case Pe.CODE_START_A:case Pe.CODE_START_B:case Pe.CODE_START_C:throw new q}switch(v){case Pe.CODE_CODE_A:if(ae<64)ft===At?R+=String.fromCharCode(32+ae):R+=String.fromCharCode(32+ae+128),ft=!1;else if(ae<96)ft===At?R+=String.fromCharCode(ae-64):R+=String.fromCharCode(ae+64),ft=!1;else switch(ae!==Pe.CODE_STOP&&(be=!1),ae){case Pe.CODE_FNC_1:a&&(R.length===0?R+="]C1":R+="");break;case Pe.CODE_FNC_2:case Pe.CODE_FNC_3:break;case Pe.CODE_FNC_4_A:!At&&ft?(At=!0,ft=!1):At&&ft?(At=!1,ft=!1):ft=!0;break;case Pe.CODE_SHIFT:T=!0,v=Pe.CODE_CODE_B;break;case Pe.CODE_CODE_B:v=Pe.CODE_CODE_B;break;case Pe.CODE_CODE_C:v=Pe.CODE_CODE_C;break;case Pe.CODE_STOP:k=!0;break}break;case Pe.CODE_CODE_B:if(ae<96)ft===At?R+=String.fromCharCode(32+ae):R+=String.fromCharCode(32+ae+128),ft=!1;else switch(ae!==Pe.CODE_STOP&&(be=!1),ae){case Pe.CODE_FNC_1:a&&(R.length===0?R+="]C1":R+="");break;case Pe.CODE_FNC_2:case Pe.CODE_FNC_3:break;case Pe.CODE_FNC_4_B:!At&&ft?(At=!0,ft=!1):At&&ft?(At=!1,ft=!1):ft=!0;break;case Pe.CODE_SHIFT:T=!0,v=Pe.CODE_CODE_A;break;case Pe.CODE_CODE_A:v=Pe.CODE_CODE_A;break;case Pe.CODE_CODE_C:v=Pe.CODE_CODE_C;break;case Pe.CODE_STOP:k=!0;break}break;case Pe.CODE_CODE_C:if(ae<100)ae<10&&(R+="0"),R+=ae;else switch(ae!==Pe.CODE_STOP&&(be=!1),ae){case Pe.CODE_FNC_1:a&&(R.length===0?R+="]C1":R+="");break;case Pe.CODE_CODE_A:v=Pe.CODE_CODE_A;break;case Pe.CODE_CODE_B:v=Pe.CODE_CODE_B;break;case Pe.CODE_STOP:k=!0;break}break}Jn&&(v=v===Pe.CODE_CODE_A?Pe.CODE_CODE_B:Pe.CODE_CODE_A)}const cn=H-P;if(H=r.getNextUnset(H),!r.isRange(H,Math.min(r.getSize(),H+(H-P)/2),!1))throw new X;if(Te-=Re*Q,Te%103!==Q)throw new D;const jn=R.length;if(jn===0)throw new X;jn>0&&be&&(v===Pe.CODE_CODE_C?R=R.substring(0,jn-2):R=R.substring(0,jn-1));const Dr=(c[1]+c[0])/2,qt=P+cn/2,br=y.length,nn=new Uint8Array(br);for(let Jn=0;Jn<br;Jn++)nn[Jn]=y[Jn];const Ns=[new Ee(Dr,e),new Ee(qt,e)];return new Be(R,nn,0,Ns,Ae.CODE_128,new Date().getTime())}}Pe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Pe.MAX_AVG_VARIANCE=.25,Pe.MAX_INDIVIDUAL_VARIANCE=.7,Pe.CODE_SHIFT=98,Pe.CODE_CODE_C=99,Pe.CODE_CODE_B=100,Pe.CODE_CODE_A=101,Pe.CODE_FNC_1=102,Pe.CODE_FNC_2=97,Pe.CODE_FNC_3=96,Pe.CODE_FNC_4_A=101,Pe.CODE_FNC_4_B=100,Pe.CODE_START_A=103,Pe.CODE_START_B=104,Pe.CODE_START_C=105,Pe.CODE_STOP=106;class mr extends hr{constructor(e=!1,r=!1){super(),this.usingCheckDigit=e,this.extendedMode=r,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,r,n){let a=this.counters;a.fill(0),this.decodeRowResult="";let c=mr.findAsteriskPattern(r,a),u=r.getNextSet(c[1]),g=r.getSize(),y,v;do{mr.recordPattern(r,u,a);let $=mr.toNarrowWidePattern(a);if($<0)throw new X;y=mr.patternToChar($),this.decodeRowResult+=y,v=u;for(let Q of a)u+=Q;u=r.getNextSet(u)}while(y!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let k=0;for(let $ of a)k+=$;let T=u-v-k;if(u!==g&&T*2<k)throw new X;if(this.usingCheckDigit){let $=this.decodeRowResult.length-1,Q=0;for(let ae=0;ae<$;ae++)Q+=mr.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ae));if(this.decodeRowResult.charAt($)!==mr.ALPHABET_STRING.charAt(Q%43))throw new D;this.decodeRowResult=this.decodeRowResult.substring(0,$)}if(this.decodeRowResult.length===0)throw new X;let R;this.extendedMode?R=mr.decodeExtended(this.decodeRowResult):R=this.decodeRowResult;let P=(c[1]+c[0])/2,H=v+k/2;return new Be(R,null,0,[new Ee(P,e),new Ee(H,e)],Ae.CODE_39,new Date().getTime())}static findAsteriskPattern(e,r){let n=e.getSize(),a=e.getNextSet(0),c=0,u=a,g=!1,y=r.length;for(let v=a;v<n;v++)if(e.get(v)!==g)r[c]++;else{if(c===y-1){if(this.toNarrowWidePattern(r)===mr.ASTERISK_ENCODING&&e.isRange(Math.max(0,u-Math.floor((v-u)/2)),u,!1))return[u,v];u+=r[0]+r[1],r.copyWithin(0,2,2+c-1),r[c-1]=0,r[c]=0,c--}else c++;r[c]=1,g=!g}throw new X}static toNarrowWidePattern(e){let r=e.length,n=0,a;do{let c=2147483647;for(let y of e)y<c&&y>n&&(c=y);n=c,a=0;let u=0,g=0;for(let y=0;y<r;y++){let v=e[y];v>n&&(g|=1<<r-1-y,a++,u+=v)}if(a===3){for(let y=0;y<r&&a>0;y++){let v=e[y];if(v>n&&(a--,v*2>=u))return-1}return g}}while(a>3);return-1}static patternToChar(e){for(let r=0;r<mr.CHARACTER_ENCODINGS.length;r++)if(mr.CHARACTER_ENCODINGS[r]===e)return mr.ALPHABET_STRING.charAt(r);if(e===mr.ASTERISK_ENCODING)return"*";throw new X}static decodeExtended(e){let r=e.length,n="";for(let a=0;a<r;a++){let c=e.charAt(a);if(c==="+"||c==="$"||c==="%"||c==="/"){let u=e.charAt(a+1),g="\0";switch(c){case"+":if(u>="A"&&u<="Z")g=String.fromCharCode(u.charCodeAt(0)+32);else throw new q;break;case"$":if(u>="A"&&u<="Z")g=String.fromCharCode(u.charCodeAt(0)-64);else throw new q;break;case"%":if(u>="A"&&u<="E")g=String.fromCharCode(u.charCodeAt(0)-38);else if(u>="F"&&u<="J")g=String.fromCharCode(u.charCodeAt(0)-11);else if(u>="K"&&u<="O")g=String.fromCharCode(u.charCodeAt(0)+16);else if(u>="P"&&u<="T")g=String.fromCharCode(u.charCodeAt(0)+43);else if(u==="U")g="\0";else if(u==="V")g="@";else if(u==="W")g="`";else if(u==="X"||u==="Y"||u==="Z")g="";else throw new q;break;case"/":if(u>="A"&&u<="O")g=String.fromCharCode(u.charCodeAt(0)-32);else if(u==="Z")g=":";else throw new q;break}n+=g,a++}else n+=c}return n}}mr.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",mr.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],mr.ASTERISK_ENCODING=148;class Ut extends hr{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,r,n){let a=this.decodeStart(r),c=this.decodeEnd(r),u=new Ve;Ut.decodeMiddle(r,a[1],c[0],u);let g=u.toString(),y=null;n!=null&&(y=n.get(ce.ALLOWED_LENGTHS)),y==null&&(y=Ut.DEFAULT_ALLOWED_LENGTHS);let v=g.length,k=!1,T=0;for(let H of y){if(v===H){k=!0;break}H>T&&(T=H)}if(!k&&v>T&&(k=!0),!k)throw new q;const R=[new Ee(a[1],e),new Ee(c[0],e)];return new Be(g,null,0,R,Ae.ITF,new Date().getTime())}static decodeMiddle(e,r,n,a){let c=new Int32Array(10),u=new Int32Array(5),g=new Int32Array(5);for(c.fill(0),u.fill(0),g.fill(0);r<n;){hr.recordPattern(e,r,c);for(let v=0;v<5;v++){let k=2*v;u[v]=c[k],g[v]=c[k+1]}let y=Ut.decodeDigit(u);a.append(y.toString()),y=this.decodeDigit(g),a.append(y.toString()),c.forEach(function(v){r+=v})}}decodeStart(e){let r=Ut.skipWhiteSpace(e),n=Ut.findGuardPattern(e,r,Ut.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n}validateQuietZone(e,r){let n=this.narrowLineWidth*10;n=n<r?n:r;for(let a=r-1;n>0&&a>=0&&!e.get(a);a--)n--;if(n!==0)throw new X}static skipWhiteSpace(e){const r=e.getSize(),n=e.getNextSet(0);if(n===r)throw new X;return n}decodeEnd(e){e.reverse();try{let r=Ut.skipWhiteSpace(e),n;try{n=Ut.findGuardPattern(e,r,Ut.END_PATTERN_REVERSED[0])}catch(c){c instanceof X&&(n=Ut.findGuardPattern(e,r,Ut.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,n[0]);let a=n[0];return n[0]=e.getSize()-n[1],n[1]=e.getSize()-a,n}finally{e.reverse()}}static findGuardPattern(e,r,n){let a=n.length,c=new Int32Array(a),u=e.getSize(),g=!1,y=0,v=r;c.fill(0);for(let k=r;k<u;k++)if(e.get(k)!==g)c[y]++;else{if(y===a-1){if(hr.patternMatchVariance(c,n,Ut.MAX_INDIVIDUAL_VARIANCE)<Ut.MAX_AVG_VARIANCE)return[v,k];v+=c[0]+c[1],F.arraycopy(c,2,c,0,y-1),c[y-1]=0,c[y]=0,y--}else y++;c[y]=1,g=!g}throw new X}static decodeDigit(e){let r=Ut.MAX_AVG_VARIANCE,n=-1,a=Ut.PATTERNS.length;for(let c=0;c<a;c++){let u=Ut.PATTERNS[c],g=hr.patternMatchVariance(e,u,Ut.MAX_INDIVIDUAL_VARIANCE);g<r?(r=g,n=c):g===r&&(n=-1)}if(n>=0)return n%10;throw new X}}Ut.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ut.MAX_AVG_VARIANCE=.38,Ut.MAX_INDIVIDUAL_VARIANCE=.5,Ut.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ut.START_PATTERN=Int32Array.from([1,1,1,1]),Ut.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Zt extends hr{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let r=!1,n,a=0,c=Int32Array.from([0,0,0]);for(;!r;){c=Int32Array.from([0,0,0]),n=Zt.findGuardPattern(e,a,!1,this.START_END_PATTERN,c);let u=n[0];a=n[1];let g=u-(a-u);g>=0&&(r=e.isRange(g,u,!1))}return n}static checkChecksum(e){return Zt.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let r=e.length;if(r===0)return!1;let n=parseInt(e.charAt(r-1),10);return Zt.getStandardUPCEANChecksum(e.substring(0,r-1))===n}static getStandardUPCEANChecksum(e){let r=e.length,n=0;for(let a=r-1;a>=0;a-=2){let c=e.charAt(a).charCodeAt(0)-48;if(c<0||c>9)throw new q;n+=c}n*=3;for(let a=r-2;a>=0;a-=2){let c=e.charAt(a).charCodeAt(0)-48;if(c<0||c>9)throw new q;n+=c}return(1e3-n)%10}static decodeEnd(e,r){return Zt.findGuardPattern(e,r,!1,Zt.START_END_PATTERN,new Int32Array(Zt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,r,n,a){return this.findGuardPattern(e,r,n,a,new Int32Array(a.length))}static findGuardPattern(e,r,n,a,c){let u=e.getSize();r=n?e.getNextUnset(r):e.getNextSet(r);let g=0,y=r,v=a.length,k=n;for(let T=r;T<u;T++)if(e.get(T)!==k)c[g]++;else{if(g===v-1){if(hr.patternMatchVariance(c,a,Zt.MAX_INDIVIDUAL_VARIANCE)<Zt.MAX_AVG_VARIANCE)return Int32Array.from([y,T]);y+=c[0]+c[1];let R=c.slice(2,c.length-1);for(let P=0;P<g-1;P++)c[P]=R[P];c[g-1]=0,c[g]=0,g--}else g++;c[g]=1,k=!k}throw new X}static decodeDigit(e,r,n,a){this.recordPattern(e,n,r);let c=this.MAX_AVG_VARIANCE,u=-1,g=a.length;for(let y=0;y<g;y++){let v=a[y],k=hr.patternMatchVariance(r,v,Zt.MAX_INDIVIDUAL_VARIANCE);k<c&&(c=k,u=y)}if(u>=0)return u;throw new X}}Zt.MAX_AVG_VARIANCE=.48,Zt.MAX_INDIVIDUAL_VARIANCE=.7,Zt.START_END_PATTERN=Int32Array.from([1,1,1]),Zt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Zt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Zt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class qn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,r,n){let a=this.decodeRowStringBuffer,c=this.decodeMiddle(r,n,a),u=a.toString(),g=qn.parseExtensionString(u),y=[new Ee((n[0]+n[1])/2,e),new Ee(c,e)],v=new Be(u,null,0,y,Ae.UPC_EAN_EXTENSION,new Date().getTime());return g!=null&&v.putAllMetadata(g),v}decodeMiddle(e,r,n){let a=this.decodeMiddleCounters;a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=e.getSize(),u=r[1],g=0;for(let v=0;v<5&&u<c;v++){let k=Zt.decodeDigit(e,a,u,Zt.L_AND_G_PATTERNS);n+=String.fromCharCode(48+k%10);for(let T of a)u+=T;k>=10&&(g|=1<<4-v),v!==4&&(u=e.getNextSet(u),u=e.getNextUnset(u))}if(n.length!==5)throw new X;let y=this.determineCheckDigit(g);if(qn.extensionChecksum(n.toString())!==y)throw new X;return u}static extensionChecksum(e){let r=e.length,n=0;for(let a=r-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(let a=r-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10}determineCheckDigit(e){for(let r=0;r<10;r++)if(e===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new X}static parseExtensionString(e){if(e.length!==5)return null;let r=qn.parseExtension5String(e);return r==null?null:new Map([[Ye.SUGGESTED_PRICE,r]])}static parseExtension5String(e){let r;switch(e.charAt(0)){case"0":r="£";break;case"5":r="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}let n=parseInt(e.substring(1)),a=(n/100).toString(),c=n%100,u=c<10?"0"+c:c.toString();return r+a+"."+u}}class ys{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,r,n){let a=this.decodeRowStringBuffer,c=this.decodeMiddle(r,n,a),u=a.toString(),g=ys.parseExtensionString(u),y=[new Ee((n[0]+n[1])/2,e),new Ee(c,e)],v=new Be(u,null,0,y,Ae.UPC_EAN_EXTENSION,new Date().getTime());return g!=null&&v.putAllMetadata(g),v}decodeMiddle(e,r,n){let a=this.decodeMiddleCounters;a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=e.getSize(),u=r[1],g=0;for(let y=0;y<2&&u<c;y++){let v=Zt.decodeDigit(e,a,u,Zt.L_AND_G_PATTERNS);n+=String.fromCharCode(48+v%10);for(let k of a)u+=k;v>=10&&(g|=1<<1-y),y!==1&&(u=e.getNextSet(u),u=e.getNextUnset(u))}if(n.length!==2)throw new X;if(parseInt(n.toString())%4!==g)throw new X;return u}static parseExtensionString(e){return e.length!==2?null:new Map([[Ye.ISSUE_NUMBER,parseInt(e)]])}}class Kn{static decodeRow(e,r,n){let a=Zt.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new qn().decodeRow(e,r,a)}catch{return new ys().decodeRow(e,r,a)}}}Kn.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Et extends Zt{constructor(){super(),this.decodeRowStringBuffer="",Et.L_AND_G_PATTERNS=Et.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let r=Et.L_PATTERNS[e-10],n=new Int32Array(r.length);for(let a=0;a<r.length;a++)n[a]=r[r.length-a-1];Et.L_AND_G_PATTERNS[e]=n}}decodeRow(e,r,n){let a=Et.findStartGuardPattern(r),c=n==null?null:n.get(ce.NEED_RESULT_POINT_CALLBACK);if(c!=null){const be=new Ee((a[0]+a[1])/2,e);c.foundPossibleResultPoint(be)}let u=this.decodeMiddle(r,a,this.decodeRowStringBuffer),g=u.rowOffset,y=u.resultString;if(c!=null){const be=new Ee(g,e);c.foundPossibleResultPoint(be)}let v=this.decodeEnd(r,g);if(c!=null){const be=new Ee((v[0]+v[1])/2,e);c.foundPossibleResultPoint(be)}let k=v[1],T=k+(k-v[0]);if(T>=r.getSize()||!r.isRange(k,T,!1))throw new X;let R=y.toString();if(R.length<8)throw new q;if(!Et.checkChecksum(R))throw new D;let P=(a[1]+a[0])/2,H=(v[1]+v[0])/2,$=this.getBarcodeFormat(),Q=[new Ee(P,e),new Ee(H,e)],ae=new Be(R,null,0,Q,$,new Date().getTime()),Te=0;try{let be=Kn.decodeRow(e,r,v[1]);ae.putMetadata(Ye.UPC_EAN_EXTENSION,be.getText()),ae.putAllMetadata(be.getResultMetadata()),ae.addResultPoints(be.getResultPoints()),Te=be.getText().length}catch{}let Re=n==null?null:n.get(ce.ALLOWED_EAN_EXTENSIONS);if(Re!=null){let be=!1;for(let At in Re)if(Te.toString()===At){be=!0;break}if(!be)throw new X}return ae}decodeEnd(e,r){return Et.findGuardPattern(e,r,!1,Et.START_END_PATTERN,new Int32Array(Et.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return Et.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let r=e.length;if(r===0)return!1;let n=parseInt(e.charAt(r-1),10);return Et.getStandardUPCEANChecksum(e.substring(0,r-1))===n}static getStandardUPCEANChecksum(e){let r=e.length,n=0;for(let a=r-1;a>=0;a-=2){let c=e.charAt(a).charCodeAt(0)-48;if(c<0||c>9)throw new q;n+=c}n*=3;for(let a=r-2;a>=0;a-=2){let c=e.charAt(a).charCodeAt(0)-48;if(c<0||c>9)throw new q;n+=c}return(1e3-n)%10}}class on extends Et{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,r,n){let a=this.decodeMiddleCounters;a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=e.getSize(),u=r[1],g=0;for(let v=0;v<6&&u<c;v++){let k=Et.decodeDigit(e,a,u,Et.L_AND_G_PATTERNS);n+=String.fromCharCode(48+k%10);for(let T of a)u+=T;k>=10&&(g|=1<<5-v)}n=on.determineFirstDigit(n,g),u=Et.findGuardPattern(e,u,!0,Et.MIDDLE_PATTERN,new Int32Array(Et.MIDDLE_PATTERN.length).fill(0))[1];for(let v=0;v<6&&u<c;v++){let k=Et.decodeDigit(e,a,u,Et.L_PATTERNS);n+=String.fromCharCode(48+k);for(let T of a)u+=T}return{rowOffset:u,resultString:n}}getBarcodeFormat(){return Ae.EAN_13}static determineFirstDigit(e,r){for(let n=0;n<10;n++)if(r===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode(48+n)+e,e;throw new X}}on.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ue extends Et{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,r,n){const a=this.decodeMiddleCounters;a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=e.getSize(),u=r[1];for(let y=0;y<4&&u<c;y++){let v=Et.decodeDigit(e,a,u,Et.L_PATTERNS);n+=String.fromCharCode(48+v);for(let k of a)u+=k}u=Et.findGuardPattern(e,u,!0,Et.MIDDLE_PATTERN,new Int32Array(Et.MIDDLE_PATTERN.length).fill(0))[1];for(let y=0;y<4&&u<c;y++){let v=Et.decodeDigit(e,a,u,Et.L_PATTERNS);n+=String.fromCharCode(48+v);for(let k of a)u+=k}return{rowOffset:u,resultString:n}}getBarcodeFormat(){return Ae.EAN_8}}class Se extends Et{constructor(){super(...arguments),this.ean13Reader=new on}getBarcodeFormat(){return Ae.UPC_A}decode(e,r){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,r,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,r,n))}decodeMiddle(e,r,n){return this.ean13Reader.decodeMiddle(e,r,n)}maybeReturnResult(e){let r=e.getText();if(r.charAt(0)==="0"){let n=new Be(r.substring(1),null,null,e.getResultPoints(),Ae.UPC_A);return e.getResultMetadata()!=null&&n.putAllMetadata(e.getResultMetadata()),n}else throw new X}reset(){this.ean13Reader.reset()}}class Le extends Et{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,r,n){const a=this.decodeMiddleCounters.map(v=>v);a[0]=0,a[1]=0,a[2]=0,a[3]=0;const c=e.getSize();let u=r[1],g=0;for(let v=0;v<6&&u<c;v++){const k=Le.decodeDigit(e,a,u,Le.L_AND_G_PATTERNS);n+=String.fromCharCode(48+k%10);for(let T of a)u+=T;k>=10&&(g|=1<<5-v)}let y=Le.determineNumSysAndCheckDigit(n,g);return{rowOffset:u,resultString:y}}decodeEnd(e,r){return Le.findGuardPatternWithoutCounters(e,r,!0,Le.MIDDLE_END_PATTERN)}checkChecksum(e){return Et.checkChecksum(Le.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,r){for(let n=0;n<=1;n++)for(let a=0;a<10;a++)if(r===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][a]){let c=String.fromCharCode(48+n),u=String.fromCharCode(48+a);return c+e+u}throw X.getNotFoundInstance()}getBarcodeFormat(){return Ae.UPC_E}static convertUPCEtoUPCA(e){const r=e.slice(1,7).split("").map(c=>c.charCodeAt(0)),n=new Ve;n.append(e.charAt(0));let a=r[5];switch(a){case 0:case 1:case 2:n.appendChars(r,0,2),n.append(a),n.append("0000"),n.appendChars(r,2,3);break;case 3:n.appendChars(r,0,3),n.append("00000"),n.appendChars(r,3,2);break;case 4:n.appendChars(r,0,4),n.append("00000"),n.append(r[4]);break;default:n.appendChars(r,0,5),n.append("0000"),n.append(a);break}return e.length>=8&&n.append(e.charAt(7)),n.toString()}}Le.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Le.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Me extends hr{constructor(e){super();let r=e==null?null:e.get(ce.POSSIBLE_FORMATS),n=[];f(r)?(n.push(new on),n.push(new Se),n.push(new ue),n.push(new Le)):(r.indexOf(Ae.EAN_13)>-1&&n.push(new on),r.indexOf(Ae.UPC_A)>-1&&n.push(new Se),r.indexOf(Ae.EAN_8)>-1&&n.push(new ue),r.indexOf(Ae.UPC_E)>-1&&n.push(new Le)),this.readers=n}decodeRow(e,r,n){for(let a of this.readers)try{const c=a.decodeRow(e,r,n),u=c.getBarcodeFormat()===Ae.EAN_13&&c.getText().charAt(0)==="0",g=n==null?null:n.get(ce.POSSIBLE_FORMATS),y=g==null||g.includes(Ae.UPC_A);if(u&&y){const v=c.getRawBytes(),k=new Be(c.getText().substring(1),v,v?v.length:null,c.getResultPoints(),Ae.UPC_A);return k.putAllMetadata(c.getResultMetadata()),k}return c}catch{}throw new X}reset(){for(let e of this.readers)e.reset()}}class kt extends hr{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,r){for(let n=0;n<r.length;n++)if(hr.patternMatchVariance(e,r[n],kt.MAX_INDIVIDUAL_VARIANCE)<kt.MAX_AVG_VARIANCE)return n;throw new X}static count(e){return $e.sum(new Int32Array(e))}static increment(e,r){let n=0,a=r[0];for(let c=1;c<e.length;c++)r[c]>a&&(a=r[c],n=c);e[n]++}static decrement(e,r){let n=0,a=r[0];for(let c=1;c<e.length;c++)r[c]<a&&(a=r[c],n=c);e[n]--}static isFinderPattern(e){let r=e[0]+e[1],n=r+e[2]+e[3],a=r/n;if(a>=kt.MIN_FINDER_PATTERN_RATIO&&a<=kt.MAX_FINDER_PATTERN_RATIO){let c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(let g of e)g>u&&(u=g),g<c&&(c=g);return u<10*c}return!1}}kt.MAX_AVG_VARIANCE=.2,kt.MAX_INDIVIDUAL_VARIANCE=.45,kt.MIN_FINDER_PATTERN_RATIO=9.5/12,kt.MAX_FINDER_PATTERN_RATIO=12.5/14;class pt{constructor(e,r){this.value=e,this.checksumPortion=r}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof pt))return!1;const r=e;return this.value===r.value&&this.checksumPortion===r.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class St{constructor(e,r,n,a,c){this.value=e,this.startEnd=r,this.value=e,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new Ee(n,c)),this.resultPoints.push(new Ee(a,c))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof St))return!1;const r=e;return this.value===r.value}hashCode(){return this.value}}class Ct{constructor(){}static getRSSvalue(e,r,n){let a=0;for(let y of e)a+=y;let c=0,u=0,g=e.length;for(let y=0;y<g-1;y++){let v;for(v=1,u|=1<<y;v<e[y];v++,u&=~(1<<y)){let k=Ct.combins(a-v-1,g-y-2);if(n&&u===0&&a-v-(g-y-1)>=g-y-1&&(k-=Ct.combins(a-v-(g-y),g-y-2)),g-y-1>1){let T=0;for(let R=a-v-(g-y-2);R>r;R--)T+=Ct.combins(a-v-R-1,g-y-3);k-=T*(g-1-y)}else a-v>r&&k--;c+=k}a-=v}return c}static combins(e,r){let n,a;e-r>r?(a=r,n=e-r):(a=e-r,n=r);let c=1,u=1;for(let g=e;g>n;g--)c*=g,u<=a&&(c/=u,u++);for(;u<=a;)c/=u,u++;return c}}class Qt{static buildBitArray(e){let r=e.length*2-1;e[e.length-1].getRightChar()==null&&(r-=1);let n=12*r,a=new Y(n),c=0,g=e[0].getRightChar().getValue();for(let y=11;y>=0;--y)(g&1<<y)!=0&&a.set(c),c++;for(let y=1;y<e.length;++y){let v=e[y],k=v.getLeftChar().getValue();for(let T=11;T>=0;--T)(k&1<<T)!=0&&a.set(c),c++;if(v.getRightChar()!=null){let T=v.getRightChar().getValue();for(let R=11;R>=0;--R)(T&1<<R)!=0&&a.set(c),c++}}return a}}class Ft{constructor(e,r){r?this.decodedInformation=null:(this.finished=e,this.decodedInformation=r)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class gt{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class ut extends gt{constructor(e,r){super(e),this.value=r}getValue(){return this.value}isFNC1(){return this.value===ut.FNC1}}ut.FNC1="$";class Pt extends gt{constructor(e,r,n){super(e),n?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=r}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Wt extends gt{constructor(e,r,n){if(super(e),r<0||r>10||n<0||n>10)throw new q;this.firstDigit=r,this.secondDigit=n}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Wt.FNC1}isSecondDigitFNC1(){return this.secondDigit===Wt.FNC1}isAnyFNC1(){return this.firstDigit===Wt.FNC1||this.secondDigit===Wt.FNC1}}Wt.FNC1=10;class we{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new X;let r=e.substring(0,2);for(let c of we.TWO_DIGIT_DATA_LENGTH)if(c[0]===r)return c[1]===we.VARIABLE_LENGTH?we.processVariableAI(2,c[2],e):we.processFixedAI(2,c[1],e);if(e.length<3)throw new X;let n=e.substring(0,3);for(let c of we.THREE_DIGIT_DATA_LENGTH)if(c[0]===n)return c[1]===we.VARIABLE_LENGTH?we.processVariableAI(3,c[2],e):we.processFixedAI(3,c[1],e);for(let c of we.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(c[0]===n)return c[1]===we.VARIABLE_LENGTH?we.processVariableAI(4,c[2],e):we.processFixedAI(4,c[1],e);if(e.length<4)throw new X;let a=e.substring(0,4);for(let c of we.FOUR_DIGIT_DATA_LENGTH)if(c[0]===a)return c[1]===we.VARIABLE_LENGTH?we.processVariableAI(4,c[2],e):we.processFixedAI(4,c[1],e);throw new X}static processFixedAI(e,r,n){if(n.length<e)throw new X;let a=n.substring(0,e);if(n.length<e+r)throw new X;let c=n.substring(e,e+r),u=n.substring(e+r),g="("+a+")"+c,y=we.parseFieldsInGeneralPurpose(u);return y==null?g:g+y}static processVariableAI(e,r,n){let a=n.substring(0,e),c;n.length<e+r?c=n.length:c=e+r;let u=n.substring(e,c),g=n.substring(c),y="("+a+")"+u,v=we.parseFieldsInGeneralPurpose(g);return v==null?y:y+v}}we.VARIABLE_LENGTH=[],we.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",we.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",we.VARIABLE_LENGTH,20],["22",we.VARIABLE_LENGTH,29],["30",we.VARIABLE_LENGTH,8],["37",we.VARIABLE_LENGTH,8],["90",we.VARIABLE_LENGTH,30],["91",we.VARIABLE_LENGTH,30],["92",we.VARIABLE_LENGTH,30],["93",we.VARIABLE_LENGTH,30],["94",we.VARIABLE_LENGTH,30],["95",we.VARIABLE_LENGTH,30],["96",we.VARIABLE_LENGTH,30],["97",we.VARIABLE_LENGTH,3],["98",we.VARIABLE_LENGTH,30],["99",we.VARIABLE_LENGTH,30]],we.THREE_DIGIT_DATA_LENGTH=[["240",we.VARIABLE_LENGTH,30],["241",we.VARIABLE_LENGTH,30],["242",we.VARIABLE_LENGTH,6],["250",we.VARIABLE_LENGTH,30],["251",we.VARIABLE_LENGTH,30],["253",we.VARIABLE_LENGTH,17],["254",we.VARIABLE_LENGTH,20],["400",we.VARIABLE_LENGTH,30],["401",we.VARIABLE_LENGTH,30],["402",17],["403",we.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",we.VARIABLE_LENGTH,20],["421",we.VARIABLE_LENGTH,15],["422",3],["423",we.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],we.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",we.VARIABLE_LENGTH,15],["391",we.VARIABLE_LENGTH,18],["392",we.VARIABLE_LENGTH,15],["393",we.VARIABLE_LENGTH,18],["703",we.VARIABLE_LENGTH,30]],we.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",we.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",we.VARIABLE_LENGTH,20],["8003",we.VARIABLE_LENGTH,30],["8004",we.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",we.VARIABLE_LENGTH,30],["8008",we.VARIABLE_LENGTH,12],["8018",18],["8020",we.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",we.VARIABLE_LENGTH,70],["8200",we.VARIABLE_LENGTH,70]];class pr{constructor(e){this.buffer=new Ve,this.information=e}decodeAllCodes(e,r){let n=r,a=null;do{let c=this.decodeGeneralPurposeField(n,a),u=we.parseFieldsInGeneralPurpose(c.getNewString());if(u!=null&&e.append(u),c.isRemaining()?a=""+c.getRemainingValue():a=null,n===c.getNewPosition())break;n=c.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let r=e;r<e+3;++r)if(this.information.get(r))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let c=this.extractNumericValueFromBitArray(e,4);return c===0?new Wt(this.information.getSize(),Wt.FNC1,Wt.FNC1):new Wt(this.information.getSize(),c-1,Wt.FNC1)}let r=this.extractNumericValueFromBitArray(e,7),n=(r-8)/11,a=(r-8)%11;return new Wt(e+7,n,a)}extractNumericValueFromBitArray(e,r){return pr.extractNumericValueFromBitArray(this.information,e,r)}static extractNumericValueFromBitArray(e,r,n){let a=0;for(let c=0;c<n;++c)e.get(r+c)&&(a|=1<<n-c-1);return a}decodeGeneralPurposeField(e,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(e);let n=this.parseBlocks();return n!=null&&n.isRemaining()?new Pt(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Pt(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,r;do{let n=this.current.getPosition();if(this.current.isAlpha()?(r=this.parseAlphaBlock(),e=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),e=r.isFinished()):(r=this.parseNumericBlock(),e=r.isFinished()),!(n!==this.current.getPosition())&&!e)break}while(!e);return r.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let r;return e.isSecondDigitFNC1()?r=new Pt(this.current.getPosition(),this.buffer.toString()):r=new Pt(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Ft(!0,r)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let r=new Pt(this.current.getPosition(),this.buffer.toString());return new Ft(!0,r)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Ft(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let r=new Pt(this.current.getPosition(),this.buffer.toString());return new Ft(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Ft(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let r=new Pt(this.current.getPosition(),this.buffer.toString());return new Ft(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Ft(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+7>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253}decodeIsoIec646(e){let r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new ut(e+5,ut.FNC1);if(r>=5&&r<15)return new ut(e+5,"0"+(r-5));let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new ut(e+7,""+(n+1));if(n>=90&&n<116)return new ut(e+7,""+(n+7));let a=this.extractNumericValueFromBitArray(e,8),c;switch(a){case 232:c="!";break;case 233:c='"';break;case 234:c="%";break;case 235:c="&";break;case 236:c="'";break;case 237:c="(";break;case 238:c=")";break;case 239:c="*";break;case 240:c="+";break;case 241:c=",";break;case 242:c="-";break;case 243:c=".";break;case 244:c="/";break;case 245:c=":";break;case 246:c=";";break;case 247:c="<";break;case 248:c="=";break;case 249:c=">";break;case 250:c="?";break;case 251:c="_";break;case 252:c=" ";break;default:throw new q}return new ut(e+8,c)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+6>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63}decodeAlphanumeric(e){let r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new ut(e+5,ut.FNC1);if(r>=5&&r<15)return new ut(e+5,"0"+(r-5));let n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new ut(e+6,""+(n+33));let a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new nr("Decoding invalid alphanumeric value: "+n)}return new ut(e+6,a)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let r=0;r<5&&r+e<this.information.getSize();++r)if(r===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+r))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let r=e;r<e+3;++r)if(this.information.get(r))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let r=0;r<4&&r+e<this.information.getSize();++r)if(this.information.get(e+r))return!1;return!0}}class en{constructor(e){this.information=e,this.generalDecoder=new pr(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class zt extends en{constructor(e){super(e)}encodeCompressedGtin(e,r){e.append("(01)");let n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,r,n)}encodeCompressedGtinWithoutAI(e,r,n){for(let a=0;a<4;++a){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(r+10*a,10);c/100===0&&e.append("0"),c/10===0&&e.append("0"),e.append(c)}zt.appendCheckDigit(e,n)}static appendCheckDigit(e,r){let n=0;for(let a=0;a<13;a++){let c=e.charAt(a+r).charCodeAt(0)-48;n+=(a&1)===0?3*c:c}n=10-n%10,n===10&&(n=0),e.append(n)}}zt.GTIN_SIZE=40;class Gt extends zt{constructor(e){super(e)}parseInformation(){let e=new Ve;e.append("(01)");let r=e.length(),n=this.getGeneralDecoder().extractNumericValueFromBitArray(Gt.HEADER_SIZE,4);return e.append(n),this.encodeCompressedGtinWithoutAI(e,Gt.HEADER_SIZE+4,r),this.getGeneralDecoder().decodeAllCodes(e,Gt.HEADER_SIZE+44)}}Gt.HEADER_SIZE=4;class $r extends en{constructor(e){super(e)}parseInformation(){let e=new Ve;return this.getGeneralDecoder().decodeAllCodes(e,$r.HEADER_SIZE)}}$r.HEADER_SIZE=5;class Xr extends zt{constructor(e){super(e)}encodeCompressedWeight(e,r,n){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(r,n);this.addWeightCode(e,a);let c=this.checkWeight(a),u=1e5;for(let g=0;g<5;++g)c/u===0&&e.append("0"),u/=10;e.append(c)}}class Jt extends Xr{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=Jt.HEADER_SIZE+Xr.GTIN_SIZE+Jt.WEIGHT_SIZE)throw new X;let e=new Ve;return this.encodeCompressedGtin(e,Jt.HEADER_SIZE),this.encodeCompressedWeight(e,Jt.HEADER_SIZE+Xr.GTIN_SIZE,Jt.WEIGHT_SIZE),e.toString()}}Jt.HEADER_SIZE=5,Jt.WEIGHT_SIZE=15;class Sr extends Jt{constructor(e){super(e)}addWeightCode(e,r){e.append("(3103)")}checkWeight(e){return e}}class gi extends Jt{constructor(e){super(e)}addWeightCode(e,r){r<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class Lr extends zt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<Lr.HEADER_SIZE+zt.GTIN_SIZE)throw new X;let e=new Ve;this.encodeCompressedGtin(e,Lr.HEADER_SIZE);let r=this.getGeneralDecoder().extractNumericValueFromBitArray(Lr.HEADER_SIZE+zt.GTIN_SIZE,Lr.LAST_DIGIT_SIZE);e.append("(392"),e.append(r),e.append(")");let n=this.getGeneralDecoder().decodeGeneralPurposeField(Lr.HEADER_SIZE+zt.GTIN_SIZE+Lr.LAST_DIGIT_SIZE,null);return e.append(n.getNewString()),e.toString()}}Lr.HEADER_SIZE=8,Lr.LAST_DIGIT_SIZE=2;class tr extends zt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<tr.HEADER_SIZE+zt.GTIN_SIZE)throw new X;let e=new Ve;this.encodeCompressedGtin(e,tr.HEADER_SIZE);let r=this.getGeneralDecoder().extractNumericValueFromBitArray(tr.HEADER_SIZE+zt.GTIN_SIZE,tr.LAST_DIGIT_SIZE);e.append("(393"),e.append(r),e.append(")");let n=this.getGeneralDecoder().extractNumericValueFromBitArray(tr.HEADER_SIZE+zt.GTIN_SIZE+tr.LAST_DIGIT_SIZE,tr.FIRST_THREE_DIGITS_SIZE);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n);let a=this.getGeneralDecoder().decodeGeneralPurposeField(tr.HEADER_SIZE+zt.GTIN_SIZE+tr.LAST_DIGIT_SIZE+tr.FIRST_THREE_DIGITS_SIZE,null);return e.append(a.getNewString()),e.toString()}}tr.HEADER_SIZE=8,tr.LAST_DIGIT_SIZE=2,tr.FIRST_THREE_DIGITS_SIZE=10;class $t extends Xr{constructor(e,r,n){super(e),this.dateCode=n,this.firstAIdigits=r}parseInformation(){if(this.getInformation().getSize()!=$t.HEADER_SIZE+$t.GTIN_SIZE+$t.WEIGHT_SIZE+$t.DATE_SIZE)throw new X;let e=new Ve;return this.encodeCompressedGtin(e,$t.HEADER_SIZE),this.encodeCompressedWeight(e,$t.HEADER_SIZE+$t.GTIN_SIZE,$t.WEIGHT_SIZE),this.encodeCompressedDate(e,$t.HEADER_SIZE+$t.GTIN_SIZE+$t.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,r){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(r,$t.DATE_SIZE);if(n==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let a=n%32;n/=32;let c=n%12+1;n/=12;let u=n;u/10==0&&e.append("0"),e.append(u),c/10==0&&e.append("0"),e.append(c),a/10==0&&e.append("0"),e.append(a)}addWeightCode(e,r){e.append("("),e.append(this.firstAIdigits),e.append(r/1e5),e.append(")")}checkWeight(e){return e%1e5}}$t.HEADER_SIZE=8,$t.WEIGHT_SIZE=20,$t.DATE_SIZE=16;function Ho(I){try{if(I.get(1))return new Gt(I);if(!I.get(2))return new $r(I);switch(pr.extractNumericValueFromBitArray(I,1,4)){case 4:return new Sr(I);case 5:return new gi(I)}switch(pr.extractNumericValueFromBitArray(I,1,5)){case 12:return new Lr(I);case 13:return new tr(I)}switch(pr.extractNumericValueFromBitArray(I,1,7)){case 56:return new $t(I,"310","11");case 57:return new $t(I,"320","11");case 58:return new $t(I,"310","13");case 59:return new $t(I,"320","13");case 60:return new $t(I,"310","15");case 61:return new $t(I,"320","15");case 62:return new $t(I,"310","17");case 63:return new $t(I,"320","17")}}catch(e){throw console.log(e),new nr("unknown decoder: "+I)}}class Kt{constructor(e,r,n,a){this.leftchar=e,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,r){return e instanceof Kt?Kt.equalsOrNull(e.leftchar,r.leftchar)&&Kt.equalsOrNull(e.rightchar,r.rightchar)&&Kt.equalsOrNull(e.finderpattern,r.finderpattern):!1}static equalsOrNull(e,r){return e===null?r===null:Kt.equals(e,r)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class za{constructor(e,r,n){this.pairs=e,this.rowNumber=r,this.wasReversed=n}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,r){return e instanceof za?this.checkEqualitity(e,r)&&e.wasReversed===r.wasReversed:!1}checkEqualitity(e,r){if(!e||!r)return;let n;return e.forEach((a,c)=>{r.forEach(u=>{a.getLeftChar().getValue()===u.getLeftChar().getValue()&&a.getRightChar().getValue()===u.getRightChar().getValue()&&a.getFinderPatter().getValue()===u.getFinderPatter().getValue()&&(n=!0)})}),n}}class pe extends kt{constructor(e){super(...arguments),this.pairs=new Array(pe.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,r,n){this.pairs.length=0,this.startFromEven=!1;try{return pe.constructResult(this.decodeRow2pairs(e,r))}catch(a){this.verbose&&console.log(a)}return this.pairs.length=0,this.startFromEven=!0,pe.constructResult(this.decodeRow2pairs(e,r))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,r){let n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(r,this.pairs,e))}catch(c){if(c instanceof X){if(!this.pairs.length)throw new X;n=!0}}if(this.checkChecksum())return this.pairs;let a;if(this.rows.length?a=!0:a=!1,this.storeRow(e,!1),a){let c=this.checkRowsBoolean(!1);if(c!=null||(c=this.checkRowsBoolean(!0),c!=null))return c}throw new X}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let r=null;try{r=this.checkRows(new Array,0)}catch(n){this.verbose&&console.log(n)}return e&&(this.rows=this.rows.reverse()),r}checkRows(e,r){for(let n=r;n<this.rows.length;n++){let a=this.rows[n];this.pairs.length=0;for(let u of e)this.pairs.push(u.getPairs());if(this.pairs.push(a.getPairs()),!pe.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let c=new Array(e);c.push(a);try{return this.checkRows(c,n+1)}catch(u){this.verbose&&console.log(u)}}throw new X}static isValidSequence(e){for(let r of pe.FINDER_PATTERN_SEQUENCES){if(e.length>r.length)continue;let n=!0;for(let a=0;a<e.length;a++)if(e[a].getFinderPattern().getValue()!=r[a]){n=!1;break}if(n)return!0}return!1}storeRow(e,r){let n=0,a=!1,c=!1;for(;n<this.rows.length;){let u=this.rows[n];if(u.getRowNumber()>e){c=u.isEquivalent(this.pairs);break}a=u.isEquivalent(this.pairs),n++}c||a||pe.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new za(this.pairs,e,r)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,r){for(let n of r)if(n.getPairs().length!==e.length){for(let a of n.getPairs())for(let c of e)if(Kt.equals(a,c))break}}static isPartialRow(e,r){for(let n of r){let a=!0;for(let c of e){let u=!1;for(let g of n.getPairs())if(c.equals(g)){u=!0;break}if(!u){a=!1;break}}if(a)return!0}return!1}getRows(){return this.rows}static constructResult(e){let r=Qt.buildBitArray(e),a=Ho(r).parseInformation(),c=e[0].getFinderPattern().getResultPoints(),u=e[e.length-1].getFinderPattern().getResultPoints(),g=[c[0],c[1],u[0],u[1]];return new Be(a,null,null,g,Ae.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),r=e.getLeftChar(),n=e.getRightChar();if(n==null)return!1;let a=n.getChecksumPortion(),c=2;for(let g=1;g<this.pairs.size();++g){let y=this.pairs.get(g);a+=y.getLeftChar().getChecksumPortion(),c++;let v=y.getRightChar();v!=null&&(a+=v.getChecksumPortion(),c++)}return a%=211,211*(c-4)+a==r.getValue()}static getNextSecondBar(e,r){let n;return e.get(r)?(n=e.getNextUnset(r),n=e.getNextSet(n)):(n=e.getNextSet(r),n=e.getNextUnset(n)),n}retrieveNextPair(e,r,n){let a=r.length%2==0;this.startFromEven&&(a=!a);let c,u=!0,g=-1;do this.findNextPair(e,r,g),c=this.parseFoundFinderPattern(e,n,a),c==null?g=pe.getNextSecondBar(e,this.startEnd[0]):u=!1;while(u);let y=this.decodeDataCharacter(e,c,a,!0);if(!this.isEmptyPair(r)&&r[r.length-1].mustBeLast())throw new X;let v;try{v=this.decodeDataCharacter(e,c,a,!1)}catch(k){v=null,this.verbose&&console.log(k)}return new Kt(y,v,c,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,r,n){let a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=e.getSize(),u;n>=0?u=n:this.isEmptyPair(r)?u=0:u=r[r.length-1].getFinderPattern().getStartEnd()[1];let g=r.length%2!=0;this.startFromEven&&(g=!g);let y=!1;for(;u<c&&(y=!e.get(u),!!y);)u++;let v=0,k=u;for(let T=u;T<c;T++)if(e.get(T)!=y)a[v]++;else{if(v==3){if(g&&pe.reverseCounters(a),pe.isFinderPattern(a)){this.startEnd[0]=k,this.startEnd[1]=T;return}g&&pe.reverseCounters(a),k+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,v--}else v++;a[v]=1,y=!y}throw new X}static reverseCounters(e){let r=e.length;for(let n=0;n<r/2;++n){let a=e[n];e[n]=e[r-n-1],e[r-n-1]=a}}parseFoundFinderPattern(e,r,n){let a,c,u;if(n){let v=this.startEnd[0]-1;for(;v>=0&&!e.get(v);)v--;v++,a=this.startEnd[0]-v,c=v,u=this.startEnd[1]}else c=this.startEnd[0],u=e.getNextUnset(this.startEnd[1]+1),a=u-this.startEnd[1];let g=this.getDecodeFinderCounters();F.arraycopy(g,0,g,1,g.length-1),g[0]=a;let y;try{y=this.parseFinderValue(g,pe.FINDER_PATTERNS)}catch{return null}return new St(y,[c,u],c,u,r)}decodeDataCharacter(e,r,n,a){let c=this.getDataCharacterCounters();for(let qt=0;qt<c.length;qt++)c[qt]=0;if(a)pe.recordPatternInReverse(e,r.getStartEnd()[0],c);else{pe.recordPattern(e,r.getStartEnd()[1],c);for(let qt=0,br=c.length-1;qt<br;qt++,br--){let nn=c[qt];c[qt]=c[br],c[br]=nn}}let u=17,g=$e.sum(new Int32Array(c))/u,y=(r.getStartEnd()[1]-r.getStartEnd()[0])/15;if(Math.abs(g-y)/y>.3)throw new X;let v=this.getOddCounts(),k=this.getEvenCounts(),T=this.getOddRoundingErrors(),R=this.getEvenRoundingErrors();for(let qt=0;qt<c.length;qt++){let br=1*c[qt]/g,nn=br+.5;if(nn<1){if(br<.3)throw new X;nn=1}else if(nn>8){if(br>8.7)throw new X;nn=8}let Ns=qt/2;(qt&1)==0?(v[Ns]=nn,T[Ns]=br-nn):(k[Ns]=nn,R[Ns]=br-nn)}this.adjustOddEvenCounts(u);let P=4*r.getValue()+(n?0:2)+(a?0:1)-1,H=0,$=0;for(let qt=v.length-1;qt>=0;qt--){if(pe.isNotA1left(r,n,a)){let br=pe.WEIGHTS[P][2*qt];$+=v[qt]*br}H+=v[qt]}let Q=0;for(let qt=k.length-1;qt>=0;qt--)if(pe.isNotA1left(r,n,a)){let br=pe.WEIGHTS[P][2*qt+1];Q+=k[qt]*br}let ae=$+Q;if((H&1)!=0||H>13||H<4)throw new X;let Te=(13-H)/2,Re=pe.SYMBOL_WIDEST[Te],be=9-Re,At=Ct.getRSSvalue(v,Re,!0),ft=Ct.getRSSvalue(k,be,!1),cn=pe.EVEN_TOTAL_SUBSET[Te],jn=pe.GSUM[Te],Dr=At*cn+ft+jn;return new pt(Dr,ae)}static isNotA1left(e,r,n){return!(e.getValue()==0&&r&&n)}adjustOddEvenCounts(e){let r=$e.sum(new Int32Array(this.getOddCounts())),n=$e.sum(new Int32Array(this.getEvenCounts())),a=!1,c=!1;r>13?c=!0:r<4&&(a=!0);let u=!1,g=!1;n>13?g=!0:n<4&&(u=!0);let y=r+n-e,v=(r&1)==1,k=(n&1)==0;if(y==1)if(v){if(k)throw new X;c=!0}else{if(!k)throw new X;g=!0}else if(y==-1)if(v){if(k)throw new X;a=!0}else{if(!k)throw new X;u=!0}else if(y==0){if(v){if(!k)throw new X;r<n?(a=!0,g=!0):(c=!0,u=!0)}else if(k)throw new X}else throw new X;if(a){if(c)throw new X;pe.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(c&&pe.decrement(this.getOddCounts(),this.getOddRoundingErrors()),u){if(g)throw new X;pe.increment(this.getEvenCounts(),this.getOddRoundingErrors())}g&&pe.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}pe.SYMBOL_WIDEST=[7,5,4,3,1],pe.EVEN_TOTAL_SUBSET=[4,20,52,104,204],pe.GSUM=[0,348,1388,2948,3988],pe.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],pe.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],pe.FINDER_PAT_A=0,pe.FINDER_PAT_B=1,pe.FINDER_PAT_C=2,pe.FINDER_PAT_D=3,pe.FINDER_PAT_E=4,pe.FINDER_PAT_F=5,pe.FINDER_PATTERN_SEQUENCES=[[pe.FINDER_PAT_A,pe.FINDER_PAT_A],[pe.FINDER_PAT_A,pe.FINDER_PAT_B,pe.FINDER_PAT_B],[pe.FINDER_PAT_A,pe.FINDER_PAT_C,pe.FINDER_PAT_B,pe.FINDER_PAT_D],[pe.FINDER_PAT_A,pe.FINDER_PAT_E,pe.FINDER_PAT_B,pe.FINDER_PAT_D,pe.FINDER_PAT_C],[pe.FINDER_PAT_A,pe.FINDER_PAT_E,pe.FINDER_PAT_B,pe.FINDER_PAT_D,pe.FINDER_PAT_D,pe.FINDER_PAT_F],[pe.FINDER_PAT_A,pe.FINDER_PAT_E,pe.FINDER_PAT_B,pe.FINDER_PAT_D,pe.FINDER_PAT_E,pe.FINDER_PAT_F,pe.FINDER_PAT_F],[pe.FINDER_PAT_A,pe.FINDER_PAT_A,pe.FINDER_PAT_B,pe.FINDER_PAT_B,pe.FINDER_PAT_C,pe.FINDER_PAT_C,pe.FINDER_PAT_D,pe.FINDER_PAT_D],[pe.FINDER_PAT_A,pe.FINDER_PAT_A,pe.FINDER_PAT_B,pe.FINDER_PAT_B,pe.FINDER_PAT_C,pe.FINDER_PAT_C,pe.FINDER_PAT_D,pe.FINDER_PAT_E,pe.FINDER_PAT_E],[pe.FINDER_PAT_A,pe.FINDER_PAT_A,pe.FINDER_PAT_B,pe.FINDER_PAT_B,pe.FINDER_PAT_C,pe.FINDER_PAT_C,pe.FINDER_PAT_D,pe.FINDER_PAT_E,pe.FINDER_PAT_F,pe.FINDER_PAT_F],[pe.FINDER_PAT_A,pe.FINDER_PAT_A,pe.FINDER_PAT_B,pe.FINDER_PAT_B,pe.FINDER_PAT_C,pe.FINDER_PAT_D,pe.FINDER_PAT_D,pe.FINDER_PAT_E,pe.FINDER_PAT_E,pe.FINDER_PAT_F,pe.FINDER_PAT_F]],pe.MAX_PAIRS=11;class Go extends pt{constructor(e,r,n){super(e,r),this.count=0,this.finderPattern=n}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class ir extends kt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,r,n){const a=this.decodePair(r,!1,e,n);ir.addOrTally(this.possibleLeftPairs,a),r.reverse();let c=this.decodePair(r,!0,e,n);ir.addOrTally(this.possibleRightPairs,c),r.reverse();for(let u of this.possibleLeftPairs)if(u.getCount()>1){for(let g of this.possibleRightPairs)if(g.getCount()>1&&ir.checkChecksum(u,g))return ir.constructResult(u,g)}throw new X}static addOrTally(e,r){if(r==null)return;let n=!1;for(let a of e)if(a.getValue()===r.getValue()){a.incrementCount(),n=!0;break}n||e.push(r)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,r){let n=4537077*e.getValue()+r.getValue(),a=new String(n).toString(),c=new Ve;for(let v=13-a.length;v>0;v--)c.append("0");c.append(a);let u=0;for(let v=0;v<13;v++){let k=c.charAt(v).charCodeAt(0)-48;u+=(v&1)===0?3*k:k}u=10-u%10,u===10&&(u=0),c.append(u.toString());let g=e.getFinderPattern().getResultPoints(),y=r.getFinderPattern().getResultPoints();return new Be(c.toString(),null,0,[g[0],g[1],y[0],y[1]],Ae.RSS_14,new Date().getTime())}static checkChecksum(e,r){let n=(e.getChecksumPortion()+16*r.getChecksumPortion())%79,a=9*e.getFinderPattern().getValue()+r.getFinderPattern().getValue();return a>72&&a--,a>8&&a--,n===a}decodePair(e,r,n,a){try{let c=this.findFinderPattern(e,r),u=this.parseFoundFinderPattern(e,n,r,c),g=a==null?null:a.get(ce.NEED_RESULT_POINT_CALLBACK);if(g!=null){let k=(c[0]+c[1])/2;r&&(k=e.getSize()-1-k),g.foundPossibleResultPoint(new Ee(k,n))}let y=this.decodeDataCharacter(e,u,!0),v=this.decodeDataCharacter(e,u,!1);return new Go(1597*y.getValue()+v.getValue(),y.getChecksumPortion()+4*v.getChecksumPortion(),u)}catch{return null}}decodeDataCharacter(e,r,n){let a=this.getDataCharacterCounters();for(let Q=0;Q<a.length;Q++)a[Q]=0;if(n)hr.recordPatternInReverse(e,r.getStartEnd()[0],a);else{hr.recordPattern(e,r.getStartEnd()[1]+1,a);for(let Q=0,ae=a.length-1;Q<ae;Q++,ae--){let Te=a[Q];a[Q]=a[ae],a[ae]=Te}}let c=n?16:15,u=$e.sum(new Int32Array(a))/c,g=this.getOddCounts(),y=this.getEvenCounts(),v=this.getOddRoundingErrors(),k=this.getEvenRoundingErrors();for(let Q=0;Q<a.length;Q++){let ae=a[Q]/u,Te=Math.floor(ae+.5);Te<1?Te=1:Te>8&&(Te=8);let Re=Math.floor(Q/2);(Q&1)===0?(g[Re]=Te,v[Re]=ae-Te):(y[Re]=Te,k[Re]=ae-Te)}this.adjustOddEvenCounts(n,c);let T=0,R=0;for(let Q=g.length-1;Q>=0;Q--)R*=9,R+=g[Q],T+=g[Q];let P=0,H=0;for(let Q=y.length-1;Q>=0;Q--)P*=9,P+=y[Q],H+=y[Q];let $=R+3*P;if(n){if((T&1)!==0||T>12||T<4)throw new X;let Q=(12-T)/2,ae=ir.OUTSIDE_ODD_WIDEST[Q],Te=9-ae,Re=Ct.getRSSvalue(g,ae,!1),be=Ct.getRSSvalue(y,Te,!0),At=ir.OUTSIDE_EVEN_TOTAL_SUBSET[Q],ft=ir.OUTSIDE_GSUM[Q];return new pt(Re*At+be+ft,$)}else{if((H&1)!==0||H>10||H<4)throw new X;let Q=(10-H)/2,ae=ir.INSIDE_ODD_WIDEST[Q],Te=9-ae,Re=Ct.getRSSvalue(g,ae,!0),be=Ct.getRSSvalue(y,Te,!1),At=ir.INSIDE_ODD_TOTAL_SUBSET[Q],ft=ir.INSIDE_GSUM[Q];return new pt(be*At+Re+ft,$)}}findFinderPattern(e,r){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let a=e.getSize(),c=!1,u=0;for(;u<a&&(c=!e.get(u),r!==c);)u++;let g=0,y=u;for(let v=u;v<a;v++)if(e.get(v)!==c)n[g]++;else{if(g===3){if(kt.isFinderPattern(n))return[y,v];y+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,g--}else g++;n[g]=1,c=!c}throw new X}parseFoundFinderPattern(e,r,n,a){let c=e.get(a[0]),u=a[0]-1;for(;u>=0&&c!==e.get(u);)u--;u++;const g=a[0]-u,y=this.getDecodeFinderCounters(),v=new Int32Array(y.length);F.arraycopy(y,0,v,1,y.length-1),v[0]=g;const k=this.parseFinderValue(v,ir.FINDER_PATTERNS);let T=u,R=a[1];return n&&(T=e.getSize()-1-T,R=e.getSize()-1-R),new St(k,[u,a[1]],T,R,r)}adjustOddEvenCounts(e,r){let n=$e.sum(new Int32Array(this.getOddCounts())),a=$e.sum(new Int32Array(this.getEvenCounts())),c=!1,u=!1,g=!1,y=!1;e?(n>12?u=!0:n<4&&(c=!0),a>12?y=!0:a<4&&(g=!0)):(n>11?u=!0:n<5&&(c=!0),a>10?y=!0:a<4&&(g=!0));let v=n+a-r,k=(n&1)===(e?1:0),T=(a&1)===1;if(v===1)if(k){if(T)throw new X;u=!0}else{if(!T)throw new X;y=!0}else if(v===-1)if(k){if(T)throw new X;c=!0}else{if(!T)throw new X;g=!0}else if(v===0){if(k){if(!T)throw new X;n<a?(c=!0,y=!0):(u=!0,g=!0)}else if(T)throw new X}else throw new X;if(c){if(u)throw new X;kt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(u&&kt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),g){if(y)throw new X;kt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&kt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ir.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],ir.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],ir.OUTSIDE_GSUM=[0,161,961,2015,2715],ir.INSIDE_GSUM=[0,336,1036,1516],ir.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],ir.INSIDE_ODD_WIDEST=[2,4,6,8],ir.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Ls extends hr{constructor(e,r){super(),this.readers=[],this.verbose=r===!0;const n=e?e.get(ce.POSSIBLE_FORMATS):null,a=e&&e.get(ce.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;n?((n.includes(Ae.EAN_13)||n.includes(Ae.UPC_A)||n.includes(Ae.EAN_8)||n.includes(Ae.UPC_E))&&this.readers.push(new Me(e)),n.includes(Ae.CODE_39)&&this.readers.push(new mr(a)),n.includes(Ae.CODE_128)&&this.readers.push(new Pe),n.includes(Ae.ITF)&&this.readers.push(new Ut),n.includes(Ae.RSS_14)&&this.readers.push(new ir),n.includes(Ae.RSS_EXPANDED)&&this.readers.push(new pe(this.verbose))):(this.readers.push(new Me(e)),this.readers.push(new mr),this.readers.push(new Me(e)),this.readers.push(new Pe),this.readers.push(new Ut),this.readers.push(new ir),this.readers.push(new pe(this.verbose)))}decodeRow(e,r,n){for(let a=0;a<this.readers.length;a++)try{return this.readers[a].decodeRow(e,r,n)}catch{}throw new X}reset(){this.readers.forEach(e=>e.reset())}}class $o extends fe{constructor(e=500,r){super(new Ls(r),e,r)}}class Bt{constructor(e,r,n){this.ecCodewords=e,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class yt{constructor(e,r){this.count=e,this.dataCodewords=r}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Tt{constructor(e,r,n,a,c,u){this.versionNumber=e,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=c,this.ecBlocks=u;let g=0;const y=u.getECCodewords(),v=u.getECBlocks();for(let k of v)g+=k.getCount()*(k.getDataCodewords()+y);this.totalCodewords=g}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,r){if((e&1)!==0||(r&1)!==0)throw new q;for(let n of Tt.VERSIONS)if(n.symbolSizeRows===e&&n.symbolSizeColumns===r)return n;throw new q}toString(){return""+this.versionNumber}static buildVersions(){return[new Tt(1,10,10,8,8,new Bt(5,new yt(1,3))),new Tt(2,12,12,10,10,new Bt(7,new yt(1,5))),new Tt(3,14,14,12,12,new Bt(10,new yt(1,8))),new Tt(4,16,16,14,14,new Bt(12,new yt(1,12))),new Tt(5,18,18,16,16,new Bt(14,new yt(1,18))),new Tt(6,20,20,18,18,new Bt(18,new yt(1,22))),new Tt(7,22,22,20,20,new Bt(20,new yt(1,30))),new Tt(8,24,24,22,22,new Bt(24,new yt(1,36))),new Tt(9,26,26,24,24,new Bt(28,new yt(1,44))),new Tt(10,32,32,14,14,new Bt(36,new yt(1,62))),new Tt(11,36,36,16,16,new Bt(42,new yt(1,86))),new Tt(12,40,40,18,18,new Bt(48,new yt(1,114))),new Tt(13,44,44,20,20,new Bt(56,new yt(1,144))),new Tt(14,48,48,22,22,new Bt(68,new yt(1,174))),new Tt(15,52,52,24,24,new Bt(42,new yt(2,102))),new Tt(16,64,64,14,14,new Bt(56,new yt(2,140))),new Tt(17,72,72,16,16,new Bt(36,new yt(4,92))),new Tt(18,80,80,18,18,new Bt(48,new yt(4,114))),new Tt(19,88,88,20,20,new Bt(56,new yt(4,144))),new Tt(20,96,96,22,22,new Bt(68,new yt(4,174))),new Tt(21,104,104,24,24,new Bt(56,new yt(6,136))),new Tt(22,120,120,18,18,new Bt(68,new yt(6,175))),new Tt(23,132,132,20,20,new Bt(62,new yt(8,163))),new Tt(24,144,144,22,22,new Bt(62,new yt(8,156),new yt(2,155))),new Tt(25,8,18,6,16,new Bt(7,new yt(1,5))),new Tt(26,8,32,6,14,new Bt(11,new yt(1,10))),new Tt(27,12,26,10,24,new Bt(14,new yt(1,16))),new Tt(28,12,36,10,16,new Bt(18,new yt(1,22))),new Tt(29,16,36,14,16,new Bt(24,new yt(1,32))),new Tt(30,16,48,14,22,new Bt(28,new yt(1,49)))]}}Tt.VERSIONS=Tt.buildVersions();class gn{constructor(e){const r=e.getHeight();if(r<8||r>144||(r&1)!==0)throw new q;this.version=gn.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new Fe(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const r=e.getHeight(),n=e.getWidth();return Tt.getVersionForDimensions(r,n)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let r=0,n=4,a=0;const c=this.mappingBitMatrix.getHeight(),u=this.mappingBitMatrix.getWidth();let g=!1,y=!1,v=!1,k=!1;do if(n===c&&a===0&&!g)e[r++]=this.readCorner1(c,u)&255,n-=2,a+=2,g=!0;else if(n===c-2&&a===0&&(u&3)!==0&&!y)e[r++]=this.readCorner2(c,u)&255,n-=2,a+=2,y=!0;else if(n===c+4&&a===2&&(u&7)===0&&!v)e[r++]=this.readCorner3(c,u)&255,n-=2,a+=2,v=!0;else if(n===c-2&&a===0&&(u&7)===4&&!k)e[r++]=this.readCorner4(c,u)&255,n-=2,a+=2,k=!0;else{do n<c&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,c,u)&255),n-=2,a+=2;while(n>=0&&a<u);n+=1,a+=3;do n>=0&&a<u&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,c,u)&255),n+=2,a-=2;while(n<c&&a>=0);n+=3,a+=1}while(n<c||a<u);if(r!==this.version.getTotalCodewords())throw new q;return e}readModule(e,r,n,a){return e<0&&(e+=n,r+=4-(n+4&7)),r<0&&(r+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(r,e),this.mappingBitMatrix.get(r,e)}readUtah(e,r,n,a){let c=0;return this.readModule(e-2,r-2,n,a)&&(c|=1),c<<=1,this.readModule(e-2,r-1,n,a)&&(c|=1),c<<=1,this.readModule(e-1,r-2,n,a)&&(c|=1),c<<=1,this.readModule(e-1,r-1,n,a)&&(c|=1),c<<=1,this.readModule(e-1,r,n,a)&&(c|=1),c<<=1,this.readModule(e,r-2,n,a)&&(c|=1),c<<=1,this.readModule(e,r-1,n,a)&&(c|=1),c<<=1,this.readModule(e,r,n,a)&&(c|=1),c}readCorner1(e,r){let n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,1,e,r)&&(n|=1),n<<=1,this.readModule(e-1,2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n}readCorner2(e,r){let n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-4,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n}readCorner3(e,r){let n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-3,e,r)&&(n|=1),n<<=1,this.readModule(1,r-2,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n}readCorner4(e,r){let n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n}extractDataRegion(e){const r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==r)throw new A("Dimension of bitMatrix must match the version size");const a=this.version.getDataRegionSizeRows(),c=this.version.getDataRegionSizeColumns(),u=r/a|0,g=n/c|0,y=u*a,v=g*c,k=new Fe(v,y);for(let T=0;T<u;++T){const R=T*a;for(let P=0;P<g;++P){const H=P*c;for(let $=0;$<a;++$){const Q=T*(a+2)+1+$,ae=R+$;for(let Te=0;Te<c;++Te){const Re=P*(c+2)+1+Te;if(e.get(Re,Q)){const be=H+Te;k.set(be,ae)}}}}}return k}}class Va{constructor(e,r){this.numDataCodewords=e,this.codewords=r}static getDataBlocks(e,r){const n=r.getECBlocks();let a=0;const c=n.getECBlocks();for(let $ of c)a+=$.getCount();const u=new Array(a);let g=0;for(let $ of c)for(let Q=0;Q<$.getCount();Q++){const ae=$.getDataCodewords(),Te=n.getECCodewords()+ae;u[g++]=new Va(ae,new Uint8Array(Te))}const v=u[0].codewords.length-n.getECCodewords(),k=v-1;let T=0;for(let $=0;$<k;$++)for(let Q=0;Q<g;Q++)u[Q].codewords[$]=e[T++];const R=r.getVersionNumber()===24,P=R?8:g;for(let $=0;$<P;$++)u[$].codewords[v-1]=e[T++];const H=u[0].codewords.length;for(let $=v;$<H;$++)for(let Q=0;Q<g;Q++){const ae=R?(Q+8)%g:Q,Te=R&&ae>7?$-1:$;u[ae].codewords[Te]=e[T++]}if(T!==e.length)throw new A;return u}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ha{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new A(""+e);let r=0,n=this.bitOffset,a=this.byteOffset;const c=this.bytes;if(n>0){const u=8-n,g=e<u?e:u,y=u-g,v=255>>8-g<<y;r=(c[a]&v)>>y,e-=g,n+=g,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)r=r<<8|c[a]&255,a++,e-=8;if(e>0){const u=8-e,g=255>>u<<u;r=r<<e|(c[a]&g)>>u,n+=e}}return this.bitOffset=n,this.byteOffset=a,r}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Rr;(function(I){I[I.PAD_ENCODE=0]="PAD_ENCODE",I[I.ASCII_ENCODE=1]="ASCII_ENCODE",I[I.C40_ENCODE=2]="C40_ENCODE",I[I.TEXT_ENCODE=3]="TEXT_ENCODE",I[I.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",I[I.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",I[I.BASE256_ENCODE=6]="BASE256_ENCODE"})(Rr||(Rr={}));class An{static decode(e){const r=new Ha(e),n=new Ve,a=new Ve,c=new Array;let u=Rr.ASCII_ENCODE;do if(u===Rr.ASCII_ENCODE)u=this.decodeAsciiSegment(r,n,a);else{switch(u){case Rr.C40_ENCODE:this.decodeC40Segment(r,n);break;case Rr.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case Rr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case Rr.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case Rr.BASE256_ENCODE:this.decodeBase256Segment(r,n,c);break;default:throw new q}u=Rr.ASCII_ENCODE}while(u!==Rr.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new Ue(e,n.toString(),c.length===0?null:c,null)}static decodeAsciiSegment(e,r,n){let a=!1;do{let c=e.readBits(8);if(c===0)throw new q;if(c<=128)return a&&(c+=128),r.append(String.fromCharCode(c-1)),Rr.ASCII_ENCODE;if(c===129)return Rr.PAD_ENCODE;if(c<=229){const u=c-130;u<10&&r.append("0"),r.append(""+u)}else switch(c){case 230:return Rr.C40_ENCODE;case 231:return Rr.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return Rr.ANSIX12_ENCODE;case 239:return Rr.TEXT_ENCODE;case 240:return Rr.EDIFACT_ENCODE;case 241:break;default:if(c!==254||e.available()!==0)throw new q;break}}while(e.available()>0);return Rr.ASCII_ENCODE}static decodeC40Segment(e,r){let n=!1;const a=[];let c=0;do{if(e.available()===8)return;const u=e.readBits(8);if(u===254)return;this.parseTwoBytes(u,e.readBits(8),a);for(let g=0;g<3;g++){const y=a[g];switch(c){case 0:if(y<3)c=y+1;else if(y<this.C40_BASIC_SET_CHARS.length){const v=this.C40_BASIC_SET_CHARS[y];n?(r.append(String.fromCharCode(v.charCodeAt(0)+128)),n=!1):r.append(v)}else throw new q;break;case 1:n?(r.append(String.fromCharCode(y+128)),n=!1):r.append(String.fromCharCode(y)),c=0;break;case 2:if(y<this.C40_SHIFT2_SET_CHARS.length){const v=this.C40_SHIFT2_SET_CHARS[y];n?(r.append(String.fromCharCode(v.charCodeAt(0)+128)),n=!1):r.append(v)}else switch(y){case 27:r.append("");break;case 30:n=!0;break;default:throw new q}c=0;break;case 3:n?(r.append(String.fromCharCode(y+224)),n=!1):r.append(String.fromCharCode(y+96)),c=0;break;default:throw new q}}}while(e.available()>0)}static decodeTextSegment(e,r){let n=!1,a=[],c=0;do{if(e.available()===8)return;const u=e.readBits(8);if(u===254)return;this.parseTwoBytes(u,e.readBits(8),a);for(let g=0;g<3;g++){const y=a[g];switch(c){case 0:if(y<3)c=y+1;else if(y<this.TEXT_BASIC_SET_CHARS.length){const v=this.TEXT_BASIC_SET_CHARS[y];n?(r.append(String.fromCharCode(v.charCodeAt(0)+128)),n=!1):r.append(v)}else throw new q;break;case 1:n?(r.append(String.fromCharCode(y+128)),n=!1):r.append(String.fromCharCode(y)),c=0;break;case 2:if(y<this.TEXT_SHIFT2_SET_CHARS.length){const v=this.TEXT_SHIFT2_SET_CHARS[y];n?(r.append(String.fromCharCode(v.charCodeAt(0)+128)),n=!1):r.append(v)}else switch(y){case 27:r.append("");break;case 30:n=!0;break;default:throw new q}c=0;break;case 3:if(y<this.TEXT_SHIFT3_SET_CHARS.length){const v=this.TEXT_SHIFT3_SET_CHARS[y];n?(r.append(String.fromCharCode(v.charCodeAt(0)+128)),n=!1):r.append(v),c=0}else throw new q;break;default:throw new q}}}while(e.available()>0)}static decodeAnsiX12Segment(e,r){const n=[];do{if(e.available()===8)return;const a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(let c=0;c<3;c++){const u=n[c];switch(u){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(u<14)r.append(String.fromCharCode(u+44));else if(u<40)r.append(String.fromCharCode(u+51));else throw new q;break}}}while(e.available()>0)}static parseTwoBytes(e,r,n){let a=(e<<8)+r-1,c=Math.floor(a/1600);n[0]=c,a-=c*1600,c=Math.floor(a/40),n[1]=c,n[2]=a-c*40}static decodeEdifactSegment(e,r){do{if(e.available()<=16)return;for(let n=0;n<4;n++){let a=e.readBits(6);if(a===31){const c=8-e.getBitOffset();c!==8&&e.readBits(c);return}(a&32)===0&&(a|=64),r.append(String.fromCharCode(a))}}while(e.available()>0)}static decodeBase256Segment(e,r,n){let a=1+e.getByteOffset();const c=this.unrandomize255State(e.readBits(8),a++);let u;if(c===0?u=e.available()/8|0:c<250?u=c:u=250*(c-249)+this.unrandomize255State(e.readBits(8),a++),u<0)throw new q;const g=new Uint8Array(u);for(let y=0;y<u;y++){if(e.available()<8)throw new q;g[y]=this.unrandomize255State(e.readBits(8),a++)}n.push(g);try{r.append(ge.decode(g,xe.ISO88591))}catch(y){throw new nr("Platform does not support required encoding: "+y.message)}}static unrandomize255State(e,r){const n=149*r%255+1,a=e-n;return a>=0?a:a+256}}An.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],An.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],An.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],An.TEXT_SHIFT2_SET_CHARS=An.C40_SHIFT2_SET_CHARS,An.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class qi{constructor(){this.rsDecoder=new ke(Xe.DATA_MATRIX_FIELD_256)}decode(e){const r=new gn(e),n=r.getVersion(),a=r.readCodewords(),c=Va.getDataBlocks(a,n);let u=0;for(let v of c)u+=v.getNumDataCodewords();const g=new Uint8Array(u),y=c.length;for(let v=0;v<y;v++){const k=c[v],T=k.getCodewords(),R=k.getNumDataCodewords();this.correctErrors(T,R);for(let P=0;P<R;P++)g[P*y+v]=T[P]}return An.decode(g)}correctErrors(e,r){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new D}for(let a=0;a<r;a++)e[a]=n[a]}}class ar{constructor(e){this.image=e,this.rectangleDetector=new Dt(this.image)}detect(){const e=this.rectangleDetector.detect();let r=this.detectSolid1(e);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new X;r=this.shiftToModuleCenter(r);const n=r[0],a=r[1],c=r[2],u=r[3];let g=this.transitionsBetween(n,u)+1,y=this.transitionsBetween(c,u)+1;(g&1)===1&&(g+=1),(y&1)===1&&(y+=1),4*g<7*y&&4*y<7*g&&(g=y=Math.max(g,y));let v=ar.sampleGrid(this.image,n,a,c,u,g,y);return new _t(v,[n,a,c,u])}static shiftPoint(e,r,n){let a=(r.getX()-e.getX())/(n+1),c=(r.getY()-e.getY())/(n+1);return new Ee(e.getX()+a,e.getY()+c)}static moveAway(e,r,n){let a=e.getX(),c=e.getY();return a<r?a-=1:a+=1,c<n?c-=1:c+=1,new Ee(a,c)}detectSolid1(e){let r=e[0],n=e[1],a=e[3],c=e[2],u=this.transitionsBetween(r,n),g=this.transitionsBetween(n,a),y=this.transitionsBetween(a,c),v=this.transitionsBetween(c,r),k=u,T=[c,r,n,a];return k>g&&(k=g,T[0]=r,T[1]=n,T[2]=a,T[3]=c),k>y&&(k=y,T[0]=n,T[1]=a,T[2]=c,T[3]=r),k>v&&(T[0]=a,T[1]=c,T[2]=r,T[3]=n),T}detectSolid2(e){let r=e[0],n=e[1],a=e[2],c=e[3],u=this.transitionsBetween(r,c),g=ar.shiftPoint(n,a,(u+1)*4),y=ar.shiftPoint(a,n,(u+1)*4),v=this.transitionsBetween(g,r),k=this.transitionsBetween(y,c);return v<k?(e[0]=r,e[1]=n,e[2]=a,e[3]=c):(e[0]=n,e[1]=a,e[2]=c,e[3]=r),e}correctTopRight(e){let r=e[0],n=e[1],a=e[2],c=e[3],u=this.transitionsBetween(r,c),g=this.transitionsBetween(n,c),y=ar.shiftPoint(r,n,(g+1)*4),v=ar.shiftPoint(a,n,(u+1)*4);u=this.transitionsBetween(y,c),g=this.transitionsBetween(v,c);let k=new Ee(c.getX()+(a.getX()-n.getX())/(u+1),c.getY()+(a.getY()-n.getY())/(u+1)),T=new Ee(c.getX()+(r.getX()-n.getX())/(g+1),c.getY()+(r.getY()-n.getY())/(g+1));if(!this.isValid(k))return this.isValid(T)?T:null;if(!this.isValid(T))return k;let R=this.transitionsBetween(y,k)+this.transitionsBetween(v,k),P=this.transitionsBetween(y,T)+this.transitionsBetween(v,T);return R>P?k:T}shiftToModuleCenter(e){let r=e[0],n=e[1],a=e[2],c=e[3],u=this.transitionsBetween(r,c)+1,g=this.transitionsBetween(a,c)+1,y=ar.shiftPoint(r,n,g*4),v=ar.shiftPoint(a,n,u*4);u=this.transitionsBetween(y,c)+1,g=this.transitionsBetween(v,c)+1,(u&1)===1&&(u+=1),(g&1)===1&&(g+=1);let k=(r.getX()+n.getX()+a.getX()+c.getX())/4,T=(r.getY()+n.getY()+a.getY()+c.getY())/4;r=ar.moveAway(r,k,T),n=ar.moveAway(n,k,T),a=ar.moveAway(a,k,T),c=ar.moveAway(c,k,T);let R,P;return y=ar.shiftPoint(r,n,g*4),y=ar.shiftPoint(y,c,u*4),R=ar.shiftPoint(n,r,g*4),R=ar.shiftPoint(R,a,u*4),v=ar.shiftPoint(a,c,g*4),v=ar.shiftPoint(v,n,u*4),P=ar.shiftPoint(c,a,g*4),P=ar.shiftPoint(P,r,u*4),[y,R,v,P]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,r,n,a,c,u,g){return or.getInstance().sampleGrid(e,u,g,.5,.5,u-.5,.5,u-.5,g-.5,.5,g-.5,r.getX(),r.getY(),c.getX(),c.getY(),a.getX(),a.getY(),n.getX(),n.getY())}transitionsBetween(e,r){let n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),c=Math.trunc(r.getX()),u=Math.trunc(r.getY()),g=Math.abs(u-a)>Math.abs(c-n);if(g){let $=n;n=a,a=$,$=c,c=u,u=$}let y=Math.abs(c-n),v=Math.abs(u-a),k=-y/2,T=a<u?1:-1,R=n<c?1:-1,P=0,H=this.image.get(g?a:n,g?n:a);for(let $=n,Q=a;$!==c;$+=R){let ae=this.image.get(g?Q:$,g?$:Q);if(ae!==H&&(P++,H=ae),k+=v,k>0){if(Q===u)break;Q+=T,k-=y}}return P}}class kn{constructor(){this.decoder=new qi}decode(e,r=null){let n,a;if(r!=null&&r.has(ce.PURE_BARCODE)){const v=kn.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(v),a=kn.NO_POINTS}else{const v=new ar(e.getBlackMatrix()).detect();n=this.decoder.decode(v.getBits()),a=v.getPoints()}const c=n.getRawBytes(),u=new Be(n.getText(),c,8*c.length,a,Ae.DATA_MATRIX,F.currentTimeMillis()),g=n.getByteSegments();g!=null&&u.putMetadata(Ye.BYTE_SEGMENTS,g);const y=n.getECLevel();return y!=null&&u.putMetadata(Ye.ERROR_CORRECTION_LEVEL,y),u}reset(){}static extractPureBits(e){const r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r==null||n==null)throw new X;const a=this.moduleSize(r,e);let c=r[1];const u=n[1];let g=r[0];const v=(n[0]-g+1)/a,k=(u-c+1)/a;if(v<=0||k<=0)throw new X;const T=a/2;c+=T,g+=T;const R=new Fe(v,k);for(let P=0;P<k;P++){const H=c+P*a;for(let $=0;$<v;$++)e.get(g+$*a,H)&&R.set($,P)}return R}static moduleSize(e,r){const n=r.getWidth();let a=e[0];const c=e[1];for(;a<n&&r.get(a,c);)a++;if(a===n)throw new X;const u=a-e[0];if(u===0)throw new X;return u}}kn.NO_POINTS=[];class wc extends fe{constructor(e=500){super(new kn,e)}}var Bs;(function(I){I[I.L=0]="L",I[I.M=1]="M",I[I.Q=2]="Q",I[I.H=3]="H"})(Bs||(Bs={}));class Yt{constructor(e,r,n){this.value=e,this.stringValue=r,this.bits=n,Yt.FOR_BITS.set(n,this),Yt.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return Yt.L;case"M":return Yt.M;case"Q":return Yt.Q;case"H":return Yt.H;default:throw new E(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof Yt))return!1;const r=e;return this.value===r.value}static forBits(e){if(e<0||e>=Yt.FOR_BITS.size)throw new A;return Yt.FOR_BITS.get(e)}}Yt.FOR_BITS=new Map,Yt.FOR_VALUE=new Map,Yt.L=new Yt(Bs.L,"L",1),Yt.M=new Yt(Bs.M,"M",0),Yt.Q=new Yt(Bs.Q,"Q",3),Yt.H=new Yt(Bs.H,"H",2);class Br{constructor(e){this.errorCorrectionLevel=Yt.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,r){return L.bitCount(e^r)}static decodeFormatInformation(e,r){const n=Br.doDecodeFormatInformation(e,r);return n!==null?n:Br.doDecodeFormatInformation(e^Br.FORMAT_INFO_MASK_QR,r^Br.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,r){let n=Number.MAX_SAFE_INTEGER,a=0;for(const c of Br.FORMAT_INFO_DECODE_LOOKUP){const u=c[0];if(u===e||u===r)return new Br(c[1]);let g=Br.numBitsDiffering(e,u);g<n&&(a=c[1],n=g),e!==r&&(g=Br.numBitsDiffering(r,u),g<n&&(a=c[1],n=g))}return n<=3?new Br(a):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof Br))return!1;const r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask}}Br.FORMAT_INFO_MASK_QR=21522,Br.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class J{constructor(e,...r){this.ecCodewordsPerBlock=e,this.ecBlocks=r}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const r=this.ecBlocks;for(const n of r)e+=n.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class M{constructor(e,r){this.count=e,this.dataCodewords=r}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class rt{constructor(e,r,...n){this.versionNumber=e,this.alignmentPatternCenters=r,this.ecBlocks=n;let a=0;const c=n[0].getECCodewordsPerBlock(),u=n[0].getECBlocks();for(const g of u)a+=g.getCount()*(g.getDataCodewords()+c);this.totalCodewords=a}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new q;try{return this.getVersionForNumber((e-17)/4)}catch{throw new q}}static getVersionForNumber(e){if(e<1||e>40)throw new A;return rt.VERSIONS[e-1]}static decodeVersionInformation(e){let r=Number.MAX_SAFE_INTEGER,n=0;for(let a=0;a<rt.VERSION_DECODE_INFO.length;a++){const c=rt.VERSION_DECODE_INFO[a];if(c===e)return rt.getVersionForNumber(a+7);const u=Br.numBitsDiffering(e,c);u<r&&(n=a+7,r=u)}return r<=3?rt.getVersionForNumber(n):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),r=new Fe(e);r.setRegion(0,0,9,9),r.setRegion(e-8,0,8,9),r.setRegion(0,e-8,9,8);const n=this.alignmentPatternCenters.length;for(let a=0;a<n;a++){const c=this.alignmentPatternCenters[a]-2;for(let u=0;u<n;u++)a===0&&(u===0||u===n-1)||a===n-1&&u===0||r.setRegion(this.alignmentPatternCenters[u]-2,c,5,5)}return r.setRegion(6,9,1,e-17),r.setRegion(9,6,e-17,1),this.versionNumber>6&&(r.setRegion(e-11,0,3,6),r.setRegion(0,e-11,6,3)),r}toString(){return""+this.versionNumber}}rt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),rt.VERSIONS=[new rt(1,new Int32Array(0),new J(7,new M(1,19)),new J(10,new M(1,16)),new J(13,new M(1,13)),new J(17,new M(1,9))),new rt(2,Int32Array.from([6,18]),new J(10,new M(1,34)),new J(16,new M(1,28)),new J(22,new M(1,22)),new J(28,new M(1,16))),new rt(3,Int32Array.from([6,22]),new J(15,new M(1,55)),new J(26,new M(1,44)),new J(18,new M(2,17)),new J(22,new M(2,13))),new rt(4,Int32Array.from([6,26]),new J(20,new M(1,80)),new J(18,new M(2,32)),new J(26,new M(2,24)),new J(16,new M(4,9))),new rt(5,Int32Array.from([6,30]),new J(26,new M(1,108)),new J(24,new M(2,43)),new J(18,new M(2,15),new M(2,16)),new J(22,new M(2,11),new M(2,12))),new rt(6,Int32Array.from([6,34]),new J(18,new M(2,68)),new J(16,new M(4,27)),new J(24,new M(4,19)),new J(28,new M(4,15))),new rt(7,Int32Array.from([6,22,38]),new J(20,new M(2,78)),new J(18,new M(4,31)),new J(18,new M(2,14),new M(4,15)),new J(26,new M(4,13),new M(1,14))),new rt(8,Int32Array.from([6,24,42]),new J(24,new M(2,97)),new J(22,new M(2,38),new M(2,39)),new J(22,new M(4,18),new M(2,19)),new J(26,new M(4,14),new M(2,15))),new rt(9,Int32Array.from([6,26,46]),new J(30,new M(2,116)),new J(22,new M(3,36),new M(2,37)),new J(20,new M(4,16),new M(4,17)),new J(24,new M(4,12),new M(4,13))),new rt(10,Int32Array.from([6,28,50]),new J(18,new M(2,68),new M(2,69)),new J(26,new M(4,43),new M(1,44)),new J(24,new M(6,19),new M(2,20)),new J(28,new M(6,15),new M(2,16))),new rt(11,Int32Array.from([6,30,54]),new J(20,new M(4,81)),new J(30,new M(1,50),new M(4,51)),new J(28,new M(4,22),new M(4,23)),new J(24,new M(3,12),new M(8,13))),new rt(12,Int32Array.from([6,32,58]),new J(24,new M(2,92),new M(2,93)),new J(22,new M(6,36),new M(2,37)),new J(26,new M(4,20),new M(6,21)),new J(28,new M(7,14),new M(4,15))),new rt(13,Int32Array.from([6,34,62]),new J(26,new M(4,107)),new J(22,new M(8,37),new M(1,38)),new J(24,new M(8,20),new M(4,21)),new J(22,new M(12,11),new M(4,12))),new rt(14,Int32Array.from([6,26,46,66]),new J(30,new M(3,115),new M(1,116)),new J(24,new M(4,40),new M(5,41)),new J(20,new M(11,16),new M(5,17)),new J(24,new M(11,12),new M(5,13))),new rt(15,Int32Array.from([6,26,48,70]),new J(22,new M(5,87),new M(1,88)),new J(24,new M(5,41),new M(5,42)),new J(30,new M(5,24),new M(7,25)),new J(24,new M(11,12),new M(7,13))),new rt(16,Int32Array.from([6,26,50,74]),new J(24,new M(5,98),new M(1,99)),new J(28,new M(7,45),new M(3,46)),new J(24,new M(15,19),new M(2,20)),new J(30,new M(3,15),new M(13,16))),new rt(17,Int32Array.from([6,30,54,78]),new J(28,new M(1,107),new M(5,108)),new J(28,new M(10,46),new M(1,47)),new J(28,new M(1,22),new M(15,23)),new J(28,new M(2,14),new M(17,15))),new rt(18,Int32Array.from([6,30,56,82]),new J(30,new M(5,120),new M(1,121)),new J(26,new M(9,43),new M(4,44)),new J(28,new M(17,22),new M(1,23)),new J(28,new M(2,14),new M(19,15))),new rt(19,Int32Array.from([6,30,58,86]),new J(28,new M(3,113),new M(4,114)),new J(26,new M(3,44),new M(11,45)),new J(26,new M(17,21),new M(4,22)),new J(26,new M(9,13),new M(16,14))),new rt(20,Int32Array.from([6,34,62,90]),new J(28,new M(3,107),new M(5,108)),new J(26,new M(3,41),new M(13,42)),new J(30,new M(15,24),new M(5,25)),new J(28,new M(15,15),new M(10,16))),new rt(21,Int32Array.from([6,28,50,72,94]),new J(28,new M(4,116),new M(4,117)),new J(26,new M(17,42)),new J(28,new M(17,22),new M(6,23)),new J(30,new M(19,16),new M(6,17))),new rt(22,Int32Array.from([6,26,50,74,98]),new J(28,new M(2,111),new M(7,112)),new J(28,new M(17,46)),new J(30,new M(7,24),new M(16,25)),new J(24,new M(34,13))),new rt(23,Int32Array.from([6,30,54,78,102]),new J(30,new M(4,121),new M(5,122)),new J(28,new M(4,47),new M(14,48)),new J(30,new M(11,24),new M(14,25)),new J(30,new M(16,15),new M(14,16))),new rt(24,Int32Array.from([6,28,54,80,106]),new J(30,new M(6,117),new M(4,118)),new J(28,new M(6,45),new M(14,46)),new J(30,new M(11,24),new M(16,25)),new J(30,new M(30,16),new M(2,17))),new rt(25,Int32Array.from([6,32,58,84,110]),new J(26,new M(8,106),new M(4,107)),new J(28,new M(8,47),new M(13,48)),new J(30,new M(7,24),new M(22,25)),new J(30,new M(22,15),new M(13,16))),new rt(26,Int32Array.from([6,30,58,86,114]),new J(28,new M(10,114),new M(2,115)),new J(28,new M(19,46),new M(4,47)),new J(28,new M(28,22),new M(6,23)),new J(30,new M(33,16),new M(4,17))),new rt(27,Int32Array.from([6,34,62,90,118]),new J(30,new M(8,122),new M(4,123)),new J(28,new M(22,45),new M(3,46)),new J(30,new M(8,23),new M(26,24)),new J(30,new M(12,15),new M(28,16))),new rt(28,Int32Array.from([6,26,50,74,98,122]),new J(30,new M(3,117),new M(10,118)),new J(28,new M(3,45),new M(23,46)),new J(30,new M(4,24),new M(31,25)),new J(30,new M(11,15),new M(31,16))),new rt(29,Int32Array.from([6,30,54,78,102,126]),new J(30,new M(7,116),new M(7,117)),new J(28,new M(21,45),new M(7,46)),new J(30,new M(1,23),new M(37,24)),new J(30,new M(19,15),new M(26,16))),new rt(30,Int32Array.from([6,26,52,78,104,130]),new J(30,new M(5,115),new M(10,116)),new J(28,new M(19,47),new M(10,48)),new J(30,new M(15,24),new M(25,25)),new J(30,new M(23,15),new M(25,16))),new rt(31,Int32Array.from([6,30,56,82,108,134]),new J(30,new M(13,115),new M(3,116)),new J(28,new M(2,46),new M(29,47)),new J(30,new M(42,24),new M(1,25)),new J(30,new M(23,15),new M(28,16))),new rt(32,Int32Array.from([6,34,60,86,112,138]),new J(30,new M(17,115)),new J(28,new M(10,46),new M(23,47)),new J(30,new M(10,24),new M(35,25)),new J(30,new M(19,15),new M(35,16))),new rt(33,Int32Array.from([6,30,58,86,114,142]),new J(30,new M(17,115),new M(1,116)),new J(28,new M(14,46),new M(21,47)),new J(30,new M(29,24),new M(19,25)),new J(30,new M(11,15),new M(46,16))),new rt(34,Int32Array.from([6,34,62,90,118,146]),new J(30,new M(13,115),new M(6,116)),new J(28,new M(14,46),new M(23,47)),new J(30,new M(44,24),new M(7,25)),new J(30,new M(59,16),new M(1,17))),new rt(35,Int32Array.from([6,30,54,78,102,126,150]),new J(30,new M(12,121),new M(7,122)),new J(28,new M(12,47),new M(26,48)),new J(30,new M(39,24),new M(14,25)),new J(30,new M(22,15),new M(41,16))),new rt(36,Int32Array.from([6,24,50,76,102,128,154]),new J(30,new M(6,121),new M(14,122)),new J(28,new M(6,47),new M(34,48)),new J(30,new M(46,24),new M(10,25)),new J(30,new M(2,15),new M(64,16))),new rt(37,Int32Array.from([6,28,54,80,106,132,158]),new J(30,new M(17,122),new M(4,123)),new J(28,new M(29,46),new M(14,47)),new J(30,new M(49,24),new M(10,25)),new J(30,new M(24,15),new M(46,16))),new rt(38,Int32Array.from([6,32,58,84,110,136,162]),new J(30,new M(4,122),new M(18,123)),new J(28,new M(13,46),new M(32,47)),new J(30,new M(48,24),new M(14,25)),new J(30,new M(42,15),new M(32,16))),new rt(39,Int32Array.from([6,26,54,82,110,138,166]),new J(30,new M(20,117),new M(4,118)),new J(28,new M(40,47),new M(7,48)),new J(30,new M(43,24),new M(22,25)),new J(30,new M(10,15),new M(67,16))),new rt(40,Int32Array.from([6,30,58,86,114,142,170]),new J(30,new M(19,118),new M(6,119)),new J(28,new M(18,47),new M(31,48)),new J(30,new M(34,24),new M(34,25)),new J(30,new M(20,15),new M(61,16)))];var Ar;(function(I){I[I.DATA_MASK_000=0]="DATA_MASK_000",I[I.DATA_MASK_001=1]="DATA_MASK_001",I[I.DATA_MASK_010=2]="DATA_MASK_010",I[I.DATA_MASK_011=3]="DATA_MASK_011",I[I.DATA_MASK_100=4]="DATA_MASK_100",I[I.DATA_MASK_101=5]="DATA_MASK_101",I[I.DATA_MASK_110=6]="DATA_MASK_110",I[I.DATA_MASK_111=7]="DATA_MASK_111"})(Ar||(Ar={}));class wt{constructor(e,r){this.value=e,this.isMasked=r}unmaskBitMatrix(e,r){for(let n=0;n<r;n++)for(let a=0;a<r;a++)this.isMasked(n,a)&&e.flip(a,n)}}wt.values=new Map([[Ar.DATA_MASK_000,new wt(Ar.DATA_MASK_000,(I,e)=>(I+e&1)===0)],[Ar.DATA_MASK_001,new wt(Ar.DATA_MASK_001,(I,e)=>(I&1)===0)],[Ar.DATA_MASK_010,new wt(Ar.DATA_MASK_010,(I,e)=>e%3===0)],[Ar.DATA_MASK_011,new wt(Ar.DATA_MASK_011,(I,e)=>(I+e)%3===0)],[Ar.DATA_MASK_100,new wt(Ar.DATA_MASK_100,(I,e)=>(Math.floor(I/2)+Math.floor(e/3)&1)===0)],[Ar.DATA_MASK_101,new wt(Ar.DATA_MASK_101,(I,e)=>I*e%6===0)],[Ar.DATA_MASK_110,new wt(Ar.DATA_MASK_110,(I,e)=>I*e%6<3)],[Ar.DATA_MASK_111,new wt(Ar.DATA_MASK_111,(I,e)=>(I+e+I*e%3&1)===0)]]);class Xo{constructor(e){const r=e.getHeight();if(r<21||(r&3)!==1)throw new q;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let c=0;c<6;c++)e=this.copyBit(c,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let c=5;c>=0;c--)e=this.copyBit(8,c,e);const r=this.bitMatrix.getHeight();let n=0;const a=r-7;for(let c=r-1;c>=a;c--)n=this.copyBit(8,c,n);for(let c=r-8;c<r;c++)n=this.copyBit(c,8,n);if(this.parsedFormatInfo=Br.decodeFormatInformation(e,n),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new q}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),r=Math.floor((e-17)/4);if(r<=6)return rt.getVersionForNumber(r);let n=0;const a=e-11;for(let u=5;u>=0;u--)for(let g=e-9;g>=a;g--)n=this.copyBit(g,u,n);let c=rt.decodeVersionInformation(n);if(c!==null&&c.getDimensionForVersion()===e)return this.parsedVersion=c,c;n=0;for(let u=5;u>=0;u--)for(let g=e-9;g>=a;g--)n=this.copyBit(u,g,n);if(c=rt.decodeVersionInformation(n),c!==null&&c.getDimensionForVersion()===e)return this.parsedVersion=c,c;throw new q}copyBit(e,r,n){return(this.isMirror?this.bitMatrix.get(r,e):this.bitMatrix.get(e,r))?n<<1|1:n<<1}readCodewords(){const e=this.readFormatInformation(),r=this.readVersion(),n=wt.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);const c=r.buildFunctionPattern();let u=!0;const g=new Uint8Array(r.getTotalCodewords());let y=0,v=0,k=0;for(let T=a-1;T>0;T-=2){T===6&&T--;for(let R=0;R<a;R++){const P=u?a-1-R:R;for(let H=0;H<2;H++)c.get(T-H,P)||(k++,v<<=1,this.bitMatrix.get(T-H,P)&&(v|=1),k===8&&(g[y++]=v,k=0,v=0))}u=!u}if(y!==r.getTotalCodewords())throw new q;return g}remask(){if(this.parsedFormatInfo===null)return;const e=wt.values[this.parsedFormatInfo.getDataMask()],r=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,r)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let r=0,n=e.getWidth();r<n;r++)for(let a=r+1,c=e.getHeight();a<c;a++)e.get(r,a)!==e.get(a,r)&&(e.flip(a,r),e.flip(r,a))}}class Ki{constructor(e,r){this.numDataCodewords=e,this.codewords=r}static getDataBlocks(e,r,n){if(e.length!==r.getTotalCodewords())throw new A;const a=r.getECBlocksForLevel(n);let c=0;const u=a.getECBlocks();for(const H of u)c+=H.getCount();const g=new Array(c);let y=0;for(const H of u)for(let $=0;$<H.getCount();$++){const Q=H.getDataCodewords(),ae=a.getECCodewordsPerBlock()+Q;g[y++]=new Ki(Q,new Uint8Array(ae))}const v=g[0].codewords.length;let k=g.length-1;for(;k>=0&&g[k].codewords.length!==v;)k--;k++;const T=v-a.getECCodewordsPerBlock();let R=0;for(let H=0;H<T;H++)for(let $=0;$<y;$++)g[$].codewords[H]=e[R++];for(let H=k;H<y;H++)g[H].codewords[T]=e[R++];const P=g[0].codewords.length;for(let H=T;H<P;H++)for(let $=0;$<y;$++){const Q=$<k?H:H+1;g[$].codewords[Q]=e[R++]}return g}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ln;(function(I){I[I.TERMINATOR=0]="TERMINATOR",I[I.NUMERIC=1]="NUMERIC",I[I.ALPHANUMERIC=2]="ALPHANUMERIC",I[I.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",I[I.BYTE=4]="BYTE",I[I.ECI=5]="ECI",I[I.KANJI=6]="KANJI",I[I.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",I[I.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",I[I.HANZI=9]="HANZI"})(ln||(ln={}));class st{constructor(e,r,n,a){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,st.FOR_BITS.set(a,this),st.FOR_VALUE.set(e,this)}static forBits(e){const r=st.FOR_BITS.get(e);if(r===void 0)throw new A;return r}getCharacterCountBits(e){const r=e.getVersionNumber();let n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof st))return!1;const r=e;return this.value===r.value}toString(){return this.stringValue}}st.FOR_BITS=new Map,st.FOR_VALUE=new Map,st.TERMINATOR=new st(ln.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),st.NUMERIC=new st(ln.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),st.ALPHANUMERIC=new st(ln.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),st.STRUCTURED_APPEND=new st(ln.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),st.BYTE=new st(ln.BYTE,"BYTE",Int32Array.from([8,16,16]),4),st.ECI=new st(ln.ECI,"ECI",Int32Array.from([0,0,0]),7),st.KANJI=new st(ln.KANJI,"KANJI",Int32Array.from([8,10,12]),8),st.FNC1_FIRST_POSITION=new st(ln.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),st.FNC1_SECOND_POSITION=new st(ln.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),st.HANZI=new st(ln.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class lr{static decode(e,r,n,a){const c=new Ha(e);let u=new Ve;const g=new Array;let y=-1,v=-1;try{let k=null,T=!1,R;do{if(c.available()<4)R=st.TERMINATOR;else{const P=c.readBits(4);R=st.forBits(P)}switch(R){case st.TERMINATOR:break;case st.FNC1_FIRST_POSITION:case st.FNC1_SECOND_POSITION:T=!0;break;case st.STRUCTURED_APPEND:if(c.available()<16)throw new q;y=c.readBits(8),v=c.readBits(8);break;case st.ECI:const P=lr.parseECIValue(c);if(k=Z.getCharacterSetECIByValue(P),k===null)throw new q;break;case st.HANZI:const H=c.readBits(4),$=c.readBits(R.getCharacterCountBits(r));H===lr.GB2312_SUBSET&&lr.decodeHanziSegment(c,u,$);break;default:const Q=c.readBits(R.getCharacterCountBits(r));switch(R){case st.NUMERIC:lr.decodeNumericSegment(c,u,Q);break;case st.ALPHANUMERIC:lr.decodeAlphanumericSegment(c,u,Q,T);break;case st.BYTE:lr.decodeByteSegment(c,u,Q,k,g,a);break;case st.KANJI:lr.decodeKanjiSegment(c,u,Q);break;default:throw new q}break}}while(R!==st.TERMINATOR)}catch{throw new q}return new Ue(e,u.toString(),g.length===0?null:g,n===null?null:n.toString(),y,v)}static decodeHanziSegment(e,r,n){if(n*13>e.available())throw new q;const a=new Uint8Array(2*n);let c=0;for(;n>0;){const u=e.readBits(13);let g=u/96<<8&4294967295|u%96;g<959?g+=41377:g+=42657,a[c]=g>>8&255,a[c+1]=g&255,c+=2,n--}try{r.append(ge.decode(a,xe.GB2312))}catch(u){throw new q(u)}}static decodeKanjiSegment(e,r,n){if(n*13>e.available())throw new q;const a=new Uint8Array(2*n);let c=0;for(;n>0;){const u=e.readBits(13);let g=u/192<<8&4294967295|u%192;g<7936?g+=33088:g+=49472,a[c]=g>>8,a[c+1]=g,c+=2,n--}try{r.append(ge.decode(a,xe.SHIFT_JIS))}catch(u){throw new q(u)}}static decodeByteSegment(e,r,n,a,c,u){if(8*n>e.available())throw new q;const g=new Uint8Array(n);for(let v=0;v<n;v++)g[v]=e.readBits(8);let y;a===null?y=xe.guessEncoding(g,u):y=a.getName();try{r.append(ge.decode(g,y))}catch(v){throw new q(v)}c.push(g)}static toAlphaNumericChar(e){if(e>=lr.ALPHANUMERIC_CHARS.length)throw new q;return lr.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,r,n,a){const c=r.length();for(;n>1;){if(e.available()<11)throw new q;const u=e.readBits(11);r.append(lr.toAlphaNumericChar(Math.floor(u/45))),r.append(lr.toAlphaNumericChar(u%45)),n-=2}if(n===1){if(e.available()<6)throw new q;r.append(lr.toAlphaNumericChar(e.readBits(6)))}if(a)for(let u=c;u<r.length();u++)r.charAt(u)==="%"&&(u<r.length()-1&&r.charAt(u+1)==="%"?r.deleteCharAt(u+1):r.setCharAt(u,""))}static decodeNumericSegment(e,r,n){for(;n>=3;){if(e.available()<10)throw new q;const a=e.readBits(10);if(a>=1e3)throw new q;r.append(lr.toAlphaNumericChar(Math.floor(a/100))),r.append(lr.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(lr.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new q;const a=e.readBits(7);if(a>=100)throw new q;r.append(lr.toAlphaNumericChar(Math.floor(a/10))),r.append(lr.toAlphaNumericChar(a%10))}else if(n===1){if(e.available()<4)throw new q;const a=e.readBits(4);if(a>=10)throw new q;r.append(lr.toAlphaNumericChar(a))}}static parseECIValue(e){const r=e.readBits(8);if((r&128)===0)return r&127;if((r&192)===128){const n=e.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){const n=e.readBits(16);return(r&31)<<16&4294967295|n}throw new q}}lr.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",lr.GB2312_SUBSET=1;class Ga{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const r=e[0];e[0]=e[2],e[2]=r}}class $a{constructor(){this.rsDecoder=new ke(Xe.QR_CODE_FIELD_256)}decodeBooleanArray(e,r){return this.decodeBitMatrix(Fe.parseFromBooleanArray(e),r)}decodeBitMatrix(e,r){const n=new Xo(e);let a=null;try{return this.decodeBitMatrixParser(n,r)}catch(c){a=c}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();const c=this.decodeBitMatrixParser(n,r);return c.setOther(new Ga(!0)),c}catch(c){throw a!==null?a:c}}decodeBitMatrixParser(e,r){const n=e.readVersion(),a=e.readFormatInformation().getErrorCorrectionLevel(),c=e.readCodewords(),u=Ki.getDataBlocks(c,n,a);let g=0;for(const k of u)g+=k.getNumDataCodewords();const y=new Uint8Array(g);let v=0;for(const k of u){const T=k.getCodewords(),R=k.getNumDataCodewords();this.correctErrors(T,R);for(let P=0;P<R;P++)y[v++]=T[P]}return lr.decode(y,n,a,r)}correctErrors(e,r){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new D}for(let a=0;a<r;a++)e[a]=n[a]}}class Fs extends Ee{constructor(e,r,n){super(e,r),this.estimatedModuleSize=n}aboutEquals(e,r,n){if(Math.abs(r-this.getY())<=e&&Math.abs(n-this.getX())<=e){const a=Math.abs(e-this.estimatedModuleSize);return a<=1||a<=this.estimatedModuleSize}return!1}combineEstimate(e,r,n){const a=(this.getX()+r)/2,c=(this.getY()+e)/2,u=(this.estimatedModuleSize+n)/2;return new Fs(a,c,u)}}class In{constructor(e,r,n,a,c,u,g){this.image=e,this.startX=r,this.startY=n,this.width=a,this.height=c,this.moduleSize=u,this.resultPointCallback=g,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,r=this.height,n=this.width,a=e+n,c=this.startY+r/2,u=new Int32Array(3),g=this.image;for(let y=0;y<r;y++){const v=c+((y&1)===0?Math.floor((y+1)/2):-Math.floor((y+1)/2));u[0]=0,u[1]=0,u[2]=0;let k=e;for(;k<a&&!g.get(k,v);)k++;let T=0;for(;k<a;){if(g.get(k,v))if(T===1)u[1]++;else if(T===2){if(this.foundPatternCross(u)){const R=this.handlePossibleCenter(u,v,k);if(R!==null)return R}u[0]=u[2],u[1]=1,u[2]=0,T=1}else u[++T]++;else T===1&&T++,u[T]++;k++}if(this.foundPatternCross(u)){const R=this.handlePossibleCenter(u,v,a);if(R!==null)return R}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new X}static centerFromEnd(e,r){return r-e[2]-e[1]/2}foundPatternCross(e){const r=this.moduleSize,n=r/2;for(let a=0;a<3;a++)if(Math.abs(r-e[a])>=n)return!1;return!0}crossCheckVertical(e,r,n,a){const c=this.image,u=c.getHeight(),g=this.crossCheckStateCount;g[0]=0,g[1]=0,g[2]=0;let y=e;for(;y>=0&&c.get(r,y)&&g[1]<=n;)g[1]++,y--;if(y<0||g[1]>n)return NaN;for(;y>=0&&!c.get(r,y)&&g[0]<=n;)g[0]++,y--;if(g[0]>n)return NaN;for(y=e+1;y<u&&c.get(r,y)&&g[1]<=n;)g[1]++,y++;if(y===u||g[1]>n)return NaN;for(;y<u&&!c.get(r,y)&&g[2]<=n;)g[2]++,y++;if(g[2]>n)return NaN;const v=g[0]+g[1]+g[2];return 5*Math.abs(v-a)>=2*a?NaN:this.foundPatternCross(g)?In.centerFromEnd(g,y):NaN}handlePossibleCenter(e,r,n){const a=e[0]+e[1]+e[2],c=In.centerFromEnd(e,n),u=this.crossCheckVertical(r,c,2*e[1],a);if(!isNaN(u)){const g=(e[0]+e[1]+e[2])/3;for(const v of this.possibleCenters)if(v.aboutEquals(g,u,c))return v.combineEstimate(u,c,g);const y=new Fs(c,u,g);this.possibleCenters.push(y),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(y)}return null}}class Fn extends Ee{constructor(e,r,n,a){super(e,r),this.estimatedModuleSize=n,this.count=a,a===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,r,n){if(Math.abs(r-this.getY())<=e&&Math.abs(n-this.getX())<=e){const a=Math.abs(e-this.estimatedModuleSize);return a<=1||a<=this.estimatedModuleSize}return!1}combineEstimate(e,r,n){const a=this.count+1,c=(this.count*this.getX()+r)/a,u=(this.count*this.getY()+e)/a,g=(this.count*this.estimatedModuleSize+n)/a;return new Fn(c,u,g,a)}}class cs{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class yr{constructor(e,r){this.image=e,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const r=e!=null&&e.get(ce.TRY_HARDER)!==void 0,n=e!=null&&e.get(ce.PURE_BARCODE)!==void 0,a=this.image,c=a.getHeight(),u=a.getWidth();let g=Math.floor(3*c/(4*yr.MAX_MODULES));(g<yr.MIN_SKIP||r)&&(g=yr.MIN_SKIP);let y=!1;const v=new Int32Array(5);for(let T=g-1;T<c&&!y;T+=g){v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0;let R=0;for(let P=0;P<u;P++)if(a.get(P,T))(R&1)===1&&R++,v[R]++;else if((R&1)===0)if(R===4)if(yr.foundPatternCross(v)){if(this.handlePossibleCenter(v,T,P,n)===!0)if(g=2,this.hasSkipped===!0)y=this.haveMultiplyConfirmedCenters();else{const $=this.findRowSkip();$>v[2]&&(T+=$-v[2]-g,P=u-1)}else{v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,R=3;continue}R=0,v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0}else v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,R=3;else v[++R]++;else v[R]++;yr.foundPatternCross(v)&&this.handlePossibleCenter(v,T,u,n)===!0&&(g=v[0],this.hasSkipped&&(y=this.haveMultiplyConfirmedCenters()))}const k=this.selectBestPatterns();return Ee.orderBestPatterns(k),new cs(k)}static centerFromEnd(e,r){return r-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let r=0;for(let c=0;c<5;c++){const u=e[c];if(u===0)return!1;r+=u}if(r<7)return!1;const n=r/7,a=n/2;return Math.abs(n-e[0])<a&&Math.abs(n-e[1])<a&&Math.abs(3*n-e[2])<3*a&&Math.abs(n-e[3])<a&&Math.abs(n-e[4])<a}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,r,n,a){const c=this.getCrossCheckStateCount();let u=0;const g=this.image;for(;e>=u&&r>=u&&g.get(r-u,e-u);)c[2]++,u++;if(e<u||r<u)return!1;for(;e>=u&&r>=u&&!g.get(r-u,e-u)&&c[1]<=n;)c[1]++,u++;if(e<u||r<u||c[1]>n)return!1;for(;e>=u&&r>=u&&g.get(r-u,e-u)&&c[0]<=n;)c[0]++,u++;if(c[0]>n)return!1;const y=g.getHeight(),v=g.getWidth();for(u=1;e+u<y&&r+u<v&&g.get(r+u,e+u);)c[2]++,u++;if(e+u>=y||r+u>=v)return!1;for(;e+u<y&&r+u<v&&!g.get(r+u,e+u)&&c[3]<n;)c[3]++,u++;if(e+u>=y||r+u>=v||c[3]>=n)return!1;for(;e+u<y&&r+u<v&&g.get(r+u,e+u)&&c[4]<n;)c[4]++,u++;if(c[4]>=n)return!1;const k=c[0]+c[1]+c[2]+c[3]+c[4];return Math.abs(k-a)<2*a&&yr.foundPatternCross(c)}crossCheckVertical(e,r,n,a){const c=this.image,u=c.getHeight(),g=this.getCrossCheckStateCount();let y=e;for(;y>=0&&c.get(r,y);)g[2]++,y--;if(y<0)return NaN;for(;y>=0&&!c.get(r,y)&&g[1]<=n;)g[1]++,y--;if(y<0||g[1]>n)return NaN;for(;y>=0&&c.get(r,y)&&g[0]<=n;)g[0]++,y--;if(g[0]>n)return NaN;for(y=e+1;y<u&&c.get(r,y);)g[2]++,y++;if(y===u)return NaN;for(;y<u&&!c.get(r,y)&&g[3]<n;)g[3]++,y++;if(y===u||g[3]>=n)return NaN;for(;y<u&&c.get(r,y)&&g[4]<n;)g[4]++,y++;if(g[4]>=n)return NaN;const v=g[0]+g[1]+g[2]+g[3]+g[4];return 5*Math.abs(v-a)>=2*a?NaN:yr.foundPatternCross(g)?yr.centerFromEnd(g,y):NaN}crossCheckHorizontal(e,r,n,a){const c=this.image,u=c.getWidth(),g=this.getCrossCheckStateCount();let y=e;for(;y>=0&&c.get(y,r);)g[2]++,y--;if(y<0)return NaN;for(;y>=0&&!c.get(y,r)&&g[1]<=n;)g[1]++,y--;if(y<0||g[1]>n)return NaN;for(;y>=0&&c.get(y,r)&&g[0]<=n;)g[0]++,y--;if(g[0]>n)return NaN;for(y=e+1;y<u&&c.get(y,r);)g[2]++,y++;if(y===u)return NaN;for(;y<u&&!c.get(y,r)&&g[3]<n;)g[3]++,y++;if(y===u||g[3]>=n)return NaN;for(;y<u&&c.get(y,r)&&g[4]<n;)g[4]++,y++;if(g[4]>=n)return NaN;const v=g[0]+g[1]+g[2]+g[3]+g[4];return 5*Math.abs(v-a)>=a?NaN:yr.foundPatternCross(g)?yr.centerFromEnd(g,y):NaN}handlePossibleCenter(e,r,n,a){const c=e[0]+e[1]+e[2]+e[3]+e[4];let u=yr.centerFromEnd(e,n),g=this.crossCheckVertical(r,Math.floor(u),e[2],c);if(!isNaN(g)&&(u=this.crossCheckHorizontal(Math.floor(u),Math.floor(g),e[2],c),!isNaN(u)&&(!a||this.crossCheckDiagonal(Math.floor(g),Math.floor(u),e[2],c)))){const y=c/7;let v=!1;const k=this.possibleCenters;for(let T=0,R=k.length;T<R;T++){const P=k[T];if(P.aboutEquals(y,g,u)){k[T]=P.combineEstimate(g,u,y),v=!0;break}}if(!v){const T=new Fn(u,g,y);k.push(T),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(T)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let r=null;for(const n of this.possibleCenters)if(n.getCount()>=yr.CENTER_QUORUM)if(r==null)r=n;else return this.hasSkipped=!0,Math.floor((Math.abs(r.getX()-n.getX())-Math.abs(r.getY()-n.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,r=0;const n=this.possibleCenters.length;for(const u of this.possibleCenters)u.getCount()>=yr.CENTER_QUORUM&&(e++,r+=u.getEstimatedModuleSize());if(e<3)return!1;const a=r/n;let c=0;for(const u of this.possibleCenters)c+=Math.abs(u.getEstimatedModuleSize()-a);return c<=.05*r}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new X;const r=this.possibleCenters;let n;if(e>3){let a=0,c=0;for(const y of this.possibleCenters){const v=y.getEstimatedModuleSize();a+=v,c+=v*v}n=a/e;let u=Math.sqrt(c/e-n*n);r.sort((y,v)=>{const k=Math.abs(v.getEstimatedModuleSize()-n),T=Math.abs(y.getEstimatedModuleSize()-n);return k<T?-1:k>T?1:0});const g=Math.max(.2*n,u);for(let y=0;y<r.length&&r.length>3;y++){const v=r[y];Math.abs(v.getEstimatedModuleSize()-n)>g&&(r.splice(y,1),y--)}}if(r.length>3){let a=0;for(const c of r)a+=c.getEstimatedModuleSize();n=a/r.length,r.sort((c,u)=>{if(u.getCount()===c.getCount()){const g=Math.abs(u.getEstimatedModuleSize()-n),y=Math.abs(c.getEstimatedModuleSize()-n);return g<y?1:g>y?-1:0}else return u.getCount()-c.getCount()}),r.splice(3)}return[r[0],r[1],r[2]]}}yr.CENTER_QUORUM=2,yr.MIN_SKIP=3,yr.MAX_MODULES=57;class Yn{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(ce.NEED_RESULT_POINT_CALLBACK);const n=new yr(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(n)}processFinderPatternInfo(e){const r=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),c=this.calculateModuleSize(r,n,a);if(c<1)throw new X("No pattern found in proccess finder.");const u=Yn.computeDimension(r,n,a,c),g=rt.getProvisionalVersionForDimension(u),y=g.getDimensionForVersion()-7;let v=null;if(g.getAlignmentPatternCenters().length>0){const P=n.getX()-r.getX()+a.getX(),H=n.getY()-r.getY()+a.getY(),$=1-3/y,Q=Math.floor(r.getX()+$*(P-r.getX())),ae=Math.floor(r.getY()+$*(H-r.getY()));for(let Te=4;Te<=16;Te<<=1)try{v=this.findAlignmentInRegion(c,Q,ae,Te);break}catch(Re){if(!(Re instanceof X))throw Re}}const k=Yn.createTransform(r,n,a,v,u),T=Yn.sampleGrid(this.image,k,u);let R;return v===null?R=[a,r,n]:R=[a,r,n,v],new _t(T,R)}static createTransform(e,r,n,a,c){const u=c-3.5;let g,y,v,k;return a!==null?(g=a.getX(),y=a.getY(),v=u-3,k=v):(g=r.getX()-e.getX()+n.getX(),y=r.getY()-e.getY()+n.getY(),v=u,k=u),me.quadrilateralToQuadrilateral(3.5,3.5,u,3.5,v,k,3.5,u,e.getX(),e.getY(),r.getX(),r.getY(),g,y,n.getX(),n.getY())}static sampleGrid(e,r,n){return or.getInstance().sampleGridWithTransform(e,n,n,r)}static computeDimension(e,r,n,a){const c=$e.round(Ee.distance(e,r)/a),u=$e.round(Ee.distance(e,n)/a);let g=Math.floor((c+u)/2)+7;switch(g&3){case 0:g++;break;case 2:g--;break;case 3:throw new X("Dimensions could be not found.")}return g}calculateModuleSize(e,r,n){return(this.calculateModuleSizeOneWay(e,r)+this.calculateModuleSizeOneWay(e,n))/2}calculateModuleSizeOneWay(e,r){const n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14}sizeOfBlackWhiteBlackRunBothWays(e,r,n,a){let c=this.sizeOfBlackWhiteBlackRun(e,r,n,a),u=1,g=e-(n-e);g<0?(u=e/(e-g),g=0):g>=this.image.getWidth()&&(u=(this.image.getWidth()-1-e)/(g-e),g=this.image.getWidth()-1);let y=Math.floor(r-(a-r)*u);return u=1,y<0?(u=r/(r-y),y=0):y>=this.image.getHeight()&&(u=(this.image.getHeight()-1-r)/(y-r),y=this.image.getHeight()-1),g=Math.floor(e+(g-e)*u),c+=this.sizeOfBlackWhiteBlackRun(e,r,g,y),c-1}sizeOfBlackWhiteBlackRun(e,r,n,a){const c=Math.abs(a-r)>Math.abs(n-e);if(c){let P=e;e=r,r=P,P=n,n=a,a=P}const u=Math.abs(n-e),g=Math.abs(a-r);let y=-u/2;const v=e<n?1:-1,k=r<a?1:-1;let T=0;const R=n+v;for(let P=e,H=r;P!==R;P+=v){const $=c?H:P,Q=c?P:H;if(T===1===this.image.get($,Q)){if(T===2)return $e.distance(P,H,e,r);T++}if(y+=g,y>0){if(H===a)break;H+=k,y-=u}}return T===2?$e.distance(n+v,a,e,r):NaN}findAlignmentInRegion(e,r,n,a){const c=Math.floor(a*e),u=Math.max(0,r-c),g=Math.min(this.image.getWidth()-1,r+c);if(g-u<e*3)throw new X("Alignment top exceeds estimated module size.");const y=Math.max(0,n-c),v=Math.min(this.image.getHeight()-1,n+c);if(v-y<e*3)throw new X("Alignment bottom exceeds estimated module size.");return new In(this.image,u,y,g-u,v-y,e,this.resultPointCallback).find()}}class tn{constructor(){this.decoder=new $a}getDecoder(){return this.decoder}decode(e,r){let n,a;if(r!=null&&r.get(ce.PURE_BARCODE)!==void 0){const y=tn.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(y,r),a=tn.NO_POINTS}else{const y=new Yn(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(y.getBits(),r),a=y.getPoints()}n.getOther()instanceof Ga&&n.getOther().applyMirroredCorrection(a);const c=new Be(n.getText(),n.getRawBytes(),void 0,a,Ae.QR_CODE,void 0),u=n.getByteSegments();u!==null&&c.putMetadata(Ye.BYTE_SEGMENTS,u);const g=n.getECLevel();return g!==null&&c.putMetadata(Ye.ERROR_CORRECTION_LEVEL,g),n.hasStructuredAppend()&&(c.putMetadata(Ye.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),c.putMetadata(Ye.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),c}reset(){}static extractPureBits(e){const r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r===null||n===null)throw new X;const a=this.moduleSize(r,e);let c=r[1],u=n[1],g=r[0],y=n[0];if(g>=y||c>=u)throw new X;if(u-c!==y-g&&(y=g+(u-c),y>=e.getWidth()))throw new X;const v=Math.round((y-g+1)/a),k=Math.round((u-c+1)/a);if(v<=0||k<=0)throw new X;if(k!==v)throw new X;const T=Math.floor(a/2);c+=T,g+=T;const R=g+Math.floor((v-1)*a)-y;if(R>0){if(R>T)throw new X;g-=R}const P=c+Math.floor((k-1)*a)-u;if(P>0){if(P>T)throw new X;c-=P}const H=new Fe(v,k);for(let $=0;$<k;$++){const Q=c+Math.floor($*a);for(let ae=0;ae<v;ae++)e.get(g+Math.floor(ae*a),Q)&&H.set(ae,$)}return H}static moduleSize(e,r){const n=r.getHeight(),a=r.getWidth();let c=e[0],u=e[1],g=!0,y=0;for(;c<a&&u<n;){if(g!==r.get(c,u)){if(++y===5)break;g=!g}c++,u++}if(c===a||u===n)throw new X;return(c-e[0])/7}}tn.NO_POINTS=new Array;class lt{PDF417Common(){}static getBitCountSum(e){return $e.sum(e)}static toIntArray(e){if(e==null||!e.length)return lt.EMPTY_INT_ARRAY;const r=new Int32Array(e.length);let n=0;for(const a of e)r[n++]=a;return r}static getCodeword(e){const r=re.binarySearch(lt.SYMBOL_TABLE,e&262143);return r<0?-1:(lt.CODEWORD_TABLE[r]-1)%lt.NUMBER_OF_CODEWORDS}}lt.NUMBER_OF_CODEWORDS=929,lt.MAX_CODEWORDS_IN_BARCODE=lt.NUMBER_OF_CODEWORDS-1,lt.MIN_ROWS_IN_BARCODE=3,lt.MAX_ROWS_IN_BARCODE=90,lt.MODULES_IN_CODEWORD=17,lt.MODULES_IN_STOP_PATTERN=18,lt.BARS_IN_MODULE=8,lt.EMPTY_INT_ARRAY=new Int32Array([]),lt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),lt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class qo{constructor(e,r){this.bits=e,this.points=r}getBits(){return this.bits}getPoints(){return this.points}}class ht{static detectMultiple(e,r,n){let a=e.getBlackMatrix(),c=ht.detect(n,a);return c.length||(a=a.clone(),a.rotate180(),c=ht.detect(n,a)),new qo(a,c)}static detect(e,r){const n=new Array;let a=0,c=0,u=!1;for(;a<r.getHeight();){const g=ht.findVertices(r,a,c);if(g[0]==null&&g[3]==null){if(!u)break;u=!1,c=0;for(const y of n)y[1]!=null&&(a=Math.trunc(Math.max(a,y[1].getY()))),y[3]!=null&&(a=Math.max(a,Math.trunc(y[3].getY())));a+=ht.ROW_STEP;continue}if(u=!0,n.push(g),!e)break;g[2]!=null?(c=Math.trunc(g[2].getX()),a=Math.trunc(g[2].getY())):(c=Math.trunc(g[4].getX()),a=Math.trunc(g[4].getY()))}return n}static findVertices(e,r,n){const a=e.getHeight(),c=e.getWidth(),u=new Array(8);return ht.copyToResult(u,ht.findRowsWithPattern(e,a,c,r,n,ht.START_PATTERN),ht.INDEXES_START_PATTERN),u[4]!=null&&(n=Math.trunc(u[4].getX()),r=Math.trunc(u[4].getY())),ht.copyToResult(u,ht.findRowsWithPattern(e,a,c,r,n,ht.STOP_PATTERN),ht.INDEXES_STOP_PATTERN),u}static copyToResult(e,r,n){for(let a=0;a<n.length;a++)e[n[a]]=r[a]}static findRowsWithPattern(e,r,n,a,c,u){const g=new Array(4);let y=!1;const v=new Int32Array(u.length);for(;a<r;a+=ht.ROW_STEP){let T=ht.findGuardPattern(e,c,a,n,!1,u,v);if(T!=null){for(;a>0;){const R=ht.findGuardPattern(e,c,--a,n,!1,u,v);if(R!=null)T=R;else{a++;break}}g[0]=new Ee(T[0],a),g[1]=new Ee(T[1],a),y=!0;break}}let k=a+1;if(y){let T=0,R=Int32Array.from([Math.trunc(g[0].getX()),Math.trunc(g[1].getX())]);for(;k<r;k++){const P=ht.findGuardPattern(e,R[0],k,n,!1,u,v);if(P!=null&&Math.abs(R[0]-P[0])<ht.MAX_PATTERN_DRIFT&&Math.abs(R[1]-P[1])<ht.MAX_PATTERN_DRIFT)R=P,T=0;else{if(T>ht.SKIPPED_ROW_COUNT_MAX)break;T++}}k-=T+1,g[2]=new Ee(R[0],k),g[3]=new Ee(R[1],k)}return k-a<ht.BARCODE_MIN_HEIGHT&&re.fill(g,null),g}static findGuardPattern(e,r,n,a,c,u,g){re.fillWithin(g,0,g.length,0);let y=r,v=0;for(;e.get(y,n)&&y>0&&v++<ht.MAX_PIXEL_DRIFT;)y--;let k=y,T=0,R=u.length;for(let P=c;k<a;k++)if(e.get(k,n)!==P)g[T]++;else{if(T===R-1){if(ht.patternMatchVariance(g,u,ht.MAX_INDIVIDUAL_VARIANCE)<ht.MAX_AVG_VARIANCE)return new Int32Array([y,k]);y+=g[0]+g[1],F.arraycopy(g,2,g,0,T-1),g[T-1]=0,g[T]=0,T--}else T++;g[T]=1,P=!P}return T===R-1&&ht.patternMatchVariance(g,u,ht.MAX_INDIVIDUAL_VARIANCE)<ht.MAX_AVG_VARIANCE?new Int32Array([y,k-1]):null}static patternMatchVariance(e,r,n){let a=e.length,c=0,u=0;for(let v=0;v<a;v++)c+=e[v],u+=r[v];if(c<u)return 1/0;let g=c/u;n*=g;let y=0;for(let v=0;v<a;v++){let k=e[v],T=r[v]*g,R=k>T?k-T:T-k;if(R>n)return 1/0;y+=R}return y/c}}ht.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),ht.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),ht.MAX_AVG_VARIANCE=.42,ht.MAX_INDIVIDUAL_VARIANCE=.8,ht.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),ht.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),ht.MAX_PIXEL_DRIFT=3,ht.MAX_PATTERN_DRIFT=5,ht.SKIPPED_ROW_COUNT_MAX=25,ht.ROW_STEP=5,ht.BARCODE_MIN_HEIGHT=10;class Fr{constructor(e,r){if(r.length===0)throw new A;this.field=e;let n=r.length;if(n>1&&r[0]===0){let a=1;for(;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),F.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let a=0;for(let c of this.coefficients)a=this.field.add(a,c);return a}let r=this.coefficients[0],n=this.coefficients.length;for(let a=1;a<n;a++)r=this.field.add(this.field.multiply(e,r),this.coefficients[a]);return r}add(e){if(!this.field.equals(e.field))throw new A("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let r=this.coefficients,n=e.coefficients;if(r.length>n.length){let u=r;r=n,n=u}let a=new Int32Array(n.length),c=n.length-r.length;F.arraycopy(n,0,a,0,c);for(let u=c;u<n.length;u++)a[u]=this.field.add(r[u-c],n[u]);return new Fr(this.field,a)}subtract(e){if(!this.field.equals(e.field))throw new A("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof Fr?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new A("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new Fr(this.field,new Int32Array([0]));let r=this.coefficients,n=r.length,a=e.coefficients,c=a.length,u=new Int32Array(n+c-1);for(let g=0;g<n;g++){let y=r[g];for(let v=0;v<c;v++)u[g+v]=this.field.add(u[g+v],this.field.multiply(y,a[v]))}return new Fr(this.field,u)}negative(){let e=this.coefficients.length,r=new Int32Array(e);for(let n=0;n<e;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new Fr(this.field,r)}multiplyScalar(e){if(e===0)return new Fr(this.field,new Int32Array([0]));if(e===1)return this;let r=this.coefficients.length,n=new Int32Array(r);for(let a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new Fr(this.field,n)}multiplyByMonomial(e,r){if(e<0)throw new A;if(r===0)return new Fr(this.field,new Int32Array([0]));let n=this.coefficients.length,a=new Int32Array(n+e);for(let c=0;c<n;c++)a[c]=this.field.multiply(this.coefficients[c],r);return new Fr(this.field,a)}toString(){let e=new Ve;for(let r=this.getDegree();r>=0;r--){let n=this.getCoefficient(r);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(r===0||n!==1)&&e.append(n),r!==0&&(r===1?e.append("x"):(e.append("x^"),e.append(r))))}return e.toString()}}class Ko{add(e,r){return(e+r)%this.modulus}subtract(e,r){return(this.modulus+e-r)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new A;return this.logTable[e]}inverse(e){if(e===0)throw new Oe;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class Us extends Ko{constructor(e,r){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let n=1;for(let a=0;a<e;a++)this.expTable[a]=n,n=n*r%e;for(let a=0;a<e-1;a++)this.logTable[this.expTable[a]]=a;this.zero=new Fr(this,new Int32Array([0])),this.one=new Fr(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,r){if(e<0)throw new A;if(r===0)return this.zero;let n=new Int32Array(e+1);return n[0]=r,new Fr(this,n)}}Us.PDF417_GF=new Us(lt.NUMBER_OF_CODEWORDS,3);class Xa{constructor(){this.field=Us.PDF417_GF}decode(e,r,n){let a=new Fr(this.field,e),c=new Int32Array(r),u=!1;for(let H=r;H>0;H--){let $=a.evaluateAt(this.field.exp(H));c[r-H]=$,$!==0&&(u=!0)}if(!u)return 0;let g=this.field.getOne();if(n!=null)for(const H of n){let $=this.field.exp(e.length-1-H),Q=new Fr(this.field,new Int32Array([this.field.subtract(0,$),1]));g=g.multiply(Q)}let y=new Fr(this.field,c),v=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),y,r),k=v[0],T=v[1],R=this.findErrorLocations(k),P=this.findErrorMagnitudes(T,k,R);for(let H=0;H<R.length;H++){let $=e.length-1-this.field.log(R[H]);if($<0)throw D.getChecksumInstance();e[$]=this.field.subtract(e[$],P[H])}return R.length}runEuclideanAlgorithm(e,r,n){if(e.getDegree()<r.getDegree()){let R=e;e=r,r=R}let a=e,c=r,u=this.field.getZero(),g=this.field.getOne();for(;c.getDegree()>=Math.round(n/2);){let R=a,P=u;if(a=c,u=g,a.isZero())throw D.getChecksumInstance();c=R;let H=this.field.getZero(),$=a.getCoefficient(a.getDegree()),Q=this.field.inverse($);for(;c.getDegree()>=a.getDegree()&&!c.isZero();){let ae=c.getDegree()-a.getDegree(),Te=this.field.multiply(c.getCoefficient(c.getDegree()),Q);H=H.add(this.field.buildMonomial(ae,Te)),c=c.subtract(a.multiplyByMonomial(ae,Te))}g=H.multiply(u).subtract(P).negative()}let y=g.getCoefficient(0);if(y===0)throw D.getChecksumInstance();let v=this.field.inverse(y),k=g.multiply(v),T=c.multiply(v);return[k,T]}findErrorLocations(e){let r=e.getDegree(),n=new Int32Array(r),a=0;for(let c=1;c<this.field.getSize()&&a<r;c++)e.evaluateAt(c)===0&&(n[a]=this.field.inverse(c),a++);if(a!==r)throw D.getChecksumInstance();return n}findErrorMagnitudes(e,r,n){let a=r.getDegree(),c=new Int32Array(a);for(let v=1;v<=a;v++)c[a-v]=this.field.multiply(v,r.getCoefficient(v));let u=new Fr(this.field,c),g=n.length,y=new Int32Array(g);for(let v=0;v<g;v++){let k=this.field.inverse(n[v]),T=this.field.subtract(0,e.evaluateAt(k)),R=this.field.inverse(u.evaluateAt(k));y[v]=this.field.multiply(T,R)}return y}}class ws{constructor(e,r,n,a,c){e instanceof ws?this.constructor_2(e):this.constructor_1(e,r,n,a,c)}constructor_1(e,r,n,a,c){const u=r==null||n==null,g=a==null||c==null;if(u&&g)throw new X;u?(r=new Ee(0,a.getY()),n=new Ee(0,c.getY())):g&&(a=new Ee(e.getWidth()-1,r.getY()),c=new Ee(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=c,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),c.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),c.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,r){return e==null?r:r==null?e:new ws(e.image,e.topLeft,e.bottomLeft,r.topRight,r.bottomRight)}addMissingRows(e,r,n){let a=this.topLeft,c=this.bottomLeft,u=this.topRight,g=this.bottomRight;if(e>0){let y=n?this.topLeft:this.topRight,v=Math.trunc(y.getY()-e);v<0&&(v=0);let k=new Ee(y.getX(),v);n?a=k:u=k}if(r>0){let y=n?this.bottomLeft:this.bottomRight,v=Math.trunc(y.getY()+r);v>=this.image.getHeight()&&(v=this.image.getHeight()-1);let k=new Ee(y.getX(),v);n?c=k:g=k}return new ws(this.image,a,c,u,g)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class xi{constructor(e,r,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Zn{constructor(){this.buffer=""}static form(e,r){let n=-1;function a(u,g,y,v,k,T){if(u==="%%")return"%";if(r[++n]===void 0)return;u=v?parseInt(v.substr(1)):void 0;let R=k?parseInt(k.substr(1)):void 0,P;switch(T){case"s":P=r[n];break;case"c":P=r[n][0];break;case"f":P=parseFloat(r[n]).toFixed(u);break;case"p":P=parseFloat(r[n]).toPrecision(u);break;case"e":P=parseFloat(r[n]).toExponential(u);break;case"x":P=parseInt(r[n]).toString(R||16);break;case"d":P=parseFloat(parseInt(r[n],R||10).toPrecision(u)).toFixed(0);break}P=typeof P=="object"?JSON.stringify(P):(+P).toString(R);let H=parseInt(y),$=y&&y[0]+""=="0"?"0":" ";for(;P.length<H;)P=g!==void 0?P+$:$+P;return P}let c=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(c,a)}format(e,...r){this.buffer+=Zn.form(e,r)}toString(){return this.buffer}}class Un{constructor(e){this.boundingBox=new ws(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let r=this.getCodeword(e);if(r!=null)return r;for(let n=1;n<Un.MAX_NEARBY_DISTANCE;n++){let a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,r){this.codewords[this.imageRowToCodewordIndex(e)]=r}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new Zn;let r=0;for(const n of this.codewords){if(n==null){e.format("%3d:    |   %n",r++);continue}e.format("%3d: %3d|%3d%n",r++,n.getRowNumber(),n.getValue())}return e.toString()}}Un.MAX_NEARBY_DISTANCE=5;class us{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let r=this.values.get(e);r==null&&(r=0),r++,this.values.set(e,r)}getValue(){let e=-1,r=new Array;for(const[n,a]of this.values.entries()){const c={getKey:()=>n,getValue:()=>a};c.getValue()>e?(e=c.getValue(),r=[],r.push(c.getKey())):c.getValue()===e&&r.push(c.getKey())}return lt.toIntArray(r)}getConfidence(e){return this.values.get(e)}}class Yo extends Un{constructor(e,r){super(e),this._isLeft=r}setRowNumbers(){for(let e of this.getCodewords())e?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let r=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(r,e);let n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),c=this._isLeft?n.getBottomLeft():n.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(a.getY())),g=this.imageRowToCodewordIndex(Math.trunc(c.getY())),y=-1,v=1,k=0;for(let T=u;T<g;T++){if(r[T]==null)continue;let R=r[T],P=R.getRowNumber()-y;if(P===0)k++;else if(P===1)v=Math.max(v,k),k=1,y=R.getRowNumber();else if(P<0||R.getRowNumber()>=e.getRowCount()||P>T)r[T]=null;else{let H;v>2?H=(v-2)*P:H=P;let $=H>=T;for(let Q=1;Q<=H&&!$;Q++)$=r[T-Q]!=null;$?r[T]=null:(y=R.getRowNumber(),k=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let r=new Int32Array(e.getRowCount());for(let n of this.getCodewords())if(n!=null){let a=n.getRowNumber();if(a>=r.length)continue;r[a]++}return r}adjustIncompleteIndicatorColumnRowNumbers(e){let r=this.getBoundingBox(),n=this._isLeft?r.getTopLeft():r.getTopRight(),a=this._isLeft?r.getBottomLeft():r.getBottomRight(),c=this.imageRowToCodewordIndex(Math.trunc(n.getY())),u=this.imageRowToCodewordIndex(Math.trunc(a.getY())),g=this.getCodewords(),y=-1;for(let v=c;v<u;v++){if(g[v]==null)continue;let k=g[v];k.setRowNumberAsRowIndicatorColumn();let T=k.getRowNumber()-y;T===0||(T===1?y=k.getRowNumber():k.getRowNumber()>=e.getRowCount()?g[v]=null:y=k.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),r=new us,n=new us,a=new us,c=new us;for(let g of e){if(g==null)continue;g.setRowNumberAsRowIndicatorColumn();let y=g.getValue()%30,v=g.getRowNumber();switch(this._isLeft||(v+=2),v%3){case 0:n.setValue(y*3+1);break;case 1:c.setValue(y/3),a.setValue(y%3);break;case 2:r.setValue(y+1);break}}if(r.getValue().length===0||n.getValue().length===0||a.getValue().length===0||c.getValue().length===0||r.getValue()[0]<1||n.getValue()[0]+a.getValue()[0]<lt.MIN_ROWS_IN_BARCODE||n.getValue()[0]+a.getValue()[0]>lt.MAX_ROWS_IN_BARCODE)return null;let u=new xi(r.getValue()[0],n.getValue()[0],a.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(e,u),u}removeIncorrectCodewords(e,r){for(let n=0;n<e.length;n++){let a=e[n];if(e[n]==null)continue;let c=a.getValue()%30,u=a.getRowNumber();if(u>r.getRowCount()){e[n]=null;continue}switch(this._isLeft||(u+=2),u%3){case 0:c*3+1!==r.getRowCountUpperPart()&&(e[n]=null);break;case 1:(Math.trunc(c/3)!==r.getErrorCorrectionLevel()||c%3!==r.getRowCountLowerPart())&&(e[n]=null);break;case 2:c+1!==r.getColumnCount()&&(e[n]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class mi{constructor(e,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=lt.MAX_CODEWORDS_IN_BARCODE,r;do r=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<r);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let r=1;r<this.barcodeColumnCount+1;r++){let n=this.detectionResultColumns[r].getCodewords();for(let a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<e.length;n++)if(e[n]!=null&&r[n]!=null&&e[n].getRowNumber()===r[n].getRowNumber())for(let a=1;a<=this.barcodeColumnCount;a++){let c=this.detectionResultColumns[a].getCodewords()[n];c!=null&&(c.setRowNumber(e[n].getRowNumber()),c.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<r.length;n++){if(r[n]==null)continue;let a=r[n].getRowNumber(),c=0;for(let u=this.barcodeColumnCount+1;u>0&&c<this.ADJUST_ROW_NUMBER_SKIP;u--){let g=this.detectionResultColumns[u].getCodewords()[n];g!=null&&(c=mi.adjustRowNumberIfValid(a,c,g),g.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,r=this.detectionResultColumns[0].getCodewords();for(let n=0;n<r.length;n++){if(r[n]==null)continue;let a=r[n].getRowNumber(),c=0;for(let u=1;u<this.barcodeColumnCount+1&&c<this.ADJUST_ROW_NUMBER_SKIP;u++){let g=this.detectionResultColumns[u].getCodewords()[n];g!=null&&(c=mi.adjustRowNumberIfValid(a,c,g),g.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),r=0):++r),r}adjustRowNumbers(e,r,n){if(!this.detectionResultColumns[e-1])return;let a=n[r],c=this.detectionResultColumns[e-1].getCodewords(),u=c;this.detectionResultColumns[e+1]!=null&&(u=this.detectionResultColumns[e+1].getCodewords());let g=new Array(14);g[2]=c[r],g[3]=u[r],r>0&&(g[0]=n[r-1],g[4]=c[r-1],g[5]=u[r-1]),r>1&&(g[8]=n[r-2],g[10]=c[r-2],g[11]=u[r-2]),r<n.length-1&&(g[1]=n[r+1],g[6]=c[r+1],g[7]=u[r+1]),r<n.length-2&&(g[9]=n[r+2],g[12]=c[r+2],g[13]=u[r+2]);for(let y of g)if(mi.adjustRowNumber(a,y))return}static adjustRowNumber(e,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===e.getBucket()?(e.setRowNumber(r.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,r){this.detectionResultColumns[e]=r}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let r=new Zn;for(let n=0;n<e.getCodewords().length;n++){r.format("CW %3d:",n);for(let a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}let c=this.detectionResultColumns[a].getCodewords()[n];if(c==null){r.format("    |   ");continue}r.format(" %3d|%3d",c.getRowNumber(),c.getValue())}r.format("%n")}return r.toString()}}class vs{constructor(e,r,n,a){this.rowNumber=vs.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==vs.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}vs.BARCODE_ROW_UNKNOWN=-1;class Ur{static initialize(){for(let e=0;e<lt.SYMBOL_TABLE.length;e++){let r=lt.SYMBOL_TABLE[e],n=r&1;for(let a=0;a<lt.BARS_IN_MODULE;a++){let c=0;for(;(r&1)===n;)c+=1,r>>=1;n=r&1,Ur.RATIOS_TABLE[e]||(Ur.RATIOS_TABLE[e]=new Array(lt.BARS_IN_MODULE)),Ur.RATIOS_TABLE[e][lt.BARS_IN_MODULE-a-1]=Math.fround(c/lt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let r=Ur.getDecodedCodewordValue(Ur.sampleBitCounts(e));return r!==-1?r:Ur.getClosestDecodedValue(e)}static sampleBitCounts(e){let r=$e.sum(e),n=new Int32Array(lt.BARS_IN_MODULE),a=0,c=0;for(let u=0;u<lt.MODULES_IN_CODEWORD;u++){let g=r/(2*lt.MODULES_IN_CODEWORD)+u*r/lt.MODULES_IN_CODEWORD;c+e[a]<=g&&(c+=e[a],a++),n[a]++}return n}static getDecodedCodewordValue(e){let r=Ur.getBitValue(e);return lt.getCodeword(r)===-1?-1:r}static getBitValue(e){let r=0;for(let n=0;n<e.length;n++)for(let a=0;a<e[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)}static getClosestDecodedValue(e){let r=$e.sum(e),n=new Array(lt.BARS_IN_MODULE);if(r>1)for(let u=0;u<n.length;u++)n[u]=Math.fround(e[u]/r);let a=bt.MAX_VALUE,c=-1;this.bSymbolTableReady||Ur.initialize();for(let u=0;u<Ur.RATIOS_TABLE.length;u++){let g=0,y=Ur.RATIOS_TABLE[u];for(let v=0;v<lt.BARS_IN_MODULE;v++){let k=Math.fround(y[v]-n[v]);if(g+=Math.fround(k*k),g>=a)break}g<a&&(a=g,c=lt.SYMBOL_TABLE[u])}return c}}Ur.bSymbolTableReady=!1,Ur.RATIOS_TABLE=new Array(lt.SYMBOL_TABLE.length).map(I=>new Array(lt.BARS_IN_MODULE));class Yi{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class qa{static parseLong(e,r=void 0){return parseInt(e,r)}}class Qn extends b{}Qn.kind="NullPointerException";class Ka{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,r,n){if(e==null)throw new Qn;if(r<0||r>e.length||n<0||r+n>e.length||r+n<0)throw new U;if(n===0)return;for(let a=0;a<n;a++)this.write(e[r+a])}flush(){}close(){}}class Zi extends b{}class Zo extends Ka{constructor(e=32){if(super(),this.count=0,e<0)throw new A("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let n=this.buf.length<<1;if(n-e<0&&(n=e),n<0){if(e<0)throw new Zi;n=L.MAX_VALUE}this.buf=re.copyOfUint8Array(this.buf,n)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,r,n){if(r<0||r>e.length||n<0||r+n-e.length>0)throw new U;this.ensureCapacity(this.count+n),F.arraycopy(e,r,this.buf,this.count,n),this.count+=n}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return re.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var Vt;(function(I){I[I.ALPHA=0]="ALPHA",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.PUNCT=3]="PUNCT",I[I.ALPHA_SHIFT=4]="ALPHA_SHIFT",I[I.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Vt||(Vt={}));function pi(){if(typeof window<"u")return window.BigInt||null;if(typeof ql<"u")return ql.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let yi;function kr(I){if(typeof yi>"u"&&(yi=pi()),yi===null)throw new Error("BigInt is not supported!");return yi(I)}function Ws(){let I=[];I[0]=kr(1);let e=kr(900);I[1]=e;for(let r=2;r<16;r++)I[r]=I[r-1]*e;return I}class oe{static decode(e,r){let n=new Ve(""),a=Z.ISO8859_1;n.enableDecoding(a);let c=1,u=e[c++],g=new Yi;for(;c<e[0];){switch(u){case oe.TEXT_COMPACTION_MODE_LATCH:c=oe.textCompaction(e,c,n);break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:c=oe.byteCompaction(u,e,a,c,n);break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[c++]);break;case oe.NUMERIC_COMPACTION_MODE_LATCH:c=oe.numericCompaction(e,c,n);break;case oe.ECI_CHARSET:Z.getCharacterSetECIByValue(e[c++]);break;case oe.ECI_GENERAL_PURPOSE:c+=2;break;case oe.ECI_USER_DEFINED:c++;break;case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:c=oe.decodeMacroBlock(e,c,g);break;case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:throw new q;default:c--,c=oe.textCompaction(e,c,n);break}if(c<e.length)u=e[c++];else throw q.getFormatInstance()}if(n.length()===0)throw q.getFormatInstance();let y=new Ue(null,n.toString(),null,r);return y.setOther(g),y}static decodeMacroBlock(e,r,n){if(r+oe.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw q.getFormatInstance();let a=new Int32Array(oe.NUMBER_OF_SEQUENCE_CODEWORDS);for(let g=0;g<oe.NUMBER_OF_SEQUENCE_CODEWORDS;g++,r++)a[g]=e[r];n.setSegmentIndex(L.parseInt(oe.decodeBase900toBase10(a,oe.NUMBER_OF_SEQUENCE_CODEWORDS)));let c=new Ve;r=oe.textCompaction(e,r,c),n.setFileId(c.toString());let u=-1;for(e[r]===oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(u=r+1);r<e[0];)switch(e[r]){case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,e[r]){case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let g=new Ve;r=oe.textCompaction(e,r+1,g),n.setFileName(g.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let y=new Ve;r=oe.textCompaction(e,r+1,y),n.setSender(y.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let v=new Ve;r=oe.textCompaction(e,r+1,v),n.setAddressee(v.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let k=new Ve;r=oe.numericCompaction(e,r+1,k),n.setSegmentCount(L.parseInt(k.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let T=new Ve;r=oe.numericCompaction(e,r+1,T),n.setTimestamp(qa.parseLong(T.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let R=new Ve;r=oe.numericCompaction(e,r+1,R),n.setChecksum(L.parseInt(R.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let P=new Ve;r=oe.numericCompaction(e,r+1,P),n.setFileSize(qa.parseLong(P.toString()));break;default:throw q.getFormatInstance()}break;case oe.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw q.getFormatInstance()}if(u!==-1){let g=r-u;n.isLastSegment()&&g--,n.setOptionalData(re.copyOfRange(e,u,u+g))}return r}static textCompaction(e,r,n){let a=new Int32Array((e[0]-r)*2),c=new Int32Array((e[0]-r)*2),u=0,g=!1;for(;r<e[0]&&!g;){let y=e[r++];if(y<oe.TEXT_COMPACTION_MODE_LATCH)a[u]=y/30,a[u+1]=y%30,u+=2;else switch(y){case oe.TEXT_COMPACTION_MODE_LATCH:a[u++]=oe.TEXT_COMPACTION_MODE_LATCH;break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:r--,g=!0;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[u]=oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,y=e[r++],c[u]=y,u++;break}}return oe.decodeTextCompaction(a,c,u,n),r}static decodeTextCompaction(e,r,n,a){let c=Vt.ALPHA,u=Vt.ALPHA,g=0;for(;g<n;){let y=e[g],v="";switch(c){case Vt.ALPHA:if(y<26)v=String.fromCharCode(65+y);else switch(y){case 26:v=" ";break;case oe.LL:c=Vt.LOWER;break;case oe.ML:c=Vt.MIXED;break;case oe.PS:u=c,c=Vt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[g]);break;case oe.TEXT_COMPACTION_MODE_LATCH:c=Vt.ALPHA;break}break;case Vt.LOWER:if(y<26)v=String.fromCharCode(97+y);else switch(y){case 26:v=" ";break;case oe.AS:u=c,c=Vt.ALPHA_SHIFT;break;case oe.ML:c=Vt.MIXED;break;case oe.PS:u=c,c=Vt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[g]);break;case oe.TEXT_COMPACTION_MODE_LATCH:c=Vt.ALPHA;break}break;case Vt.MIXED:if(y<oe.PL)v=oe.MIXED_CHARS[y];else switch(y){case oe.PL:c=Vt.PUNCT;break;case 26:v=" ";break;case oe.LL:c=Vt.LOWER;break;case oe.AL:c=Vt.ALPHA;break;case oe.PS:u=c,c=Vt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[g]);break;case oe.TEXT_COMPACTION_MODE_LATCH:c=Vt.ALPHA;break}break;case Vt.PUNCT:if(y<oe.PAL)v=oe.PUNCT_CHARS[y];else switch(y){case oe.PAL:c=Vt.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[g]);break;case oe.TEXT_COMPACTION_MODE_LATCH:c=Vt.ALPHA;break}break;case Vt.ALPHA_SHIFT:if(c=u,y<26)v=String.fromCharCode(65+y);else switch(y){case 26:v=" ";break;case oe.TEXT_COMPACTION_MODE_LATCH:c=Vt.ALPHA;break}break;case Vt.PUNCT_SHIFT:if(c=u,y<oe.PAL)v=oe.PUNCT_CHARS[y];else switch(y){case oe.PAL:c=Vt.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[g]);break;case oe.TEXT_COMPACTION_MODE_LATCH:c=Vt.ALPHA;break}break}v!==""&&a.append(v),g++}}static byteCompaction(e,r,n,a,c){let u=new Zo,g=0,y=0,v=!1;switch(e){case oe.BYTE_COMPACTION_MODE_LATCH:let k=new Int32Array(6),T=r[a++];for(;a<r[0]&&!v;)switch(k[g++]=T,y=900*y+T,T=r[a++],T){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:a--,v=!0;break;default:if(g%5===0&&g>0){for(let R=0;R<6;++R)u.write(Number(kr(y)>>kr(8*(5-R))));y=0,g=0}break}a===r[0]&&T<oe.TEXT_COMPACTION_MODE_LATCH&&(k[g++]=T);for(let R=0;R<g;R++)u.write(k[R]);break;case oe.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!v;){let R=r[a++];if(R<oe.TEXT_COMPACTION_MODE_LATCH)g++,y=900*y+R;else switch(R){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:a--,v=!0;break}if(g%5===0&&g>0){for(let P=0;P<6;++P)u.write(Number(kr(y)>>kr(8*(5-P))));y=0,g=0}}break}return c.append(ge.decode(u.toByteArray(),n)),a}static numericCompaction(e,r,n){let a=0,c=!1,u=new Int32Array(oe.MAX_NUMERIC_CODEWORDS);for(;r<e[0]&&!c;){let g=e[r++];if(r===e[0]&&(c=!0),g<oe.TEXT_COMPACTION_MODE_LATCH)u[a]=g,a++;else switch(g){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:r--,c=!0;break}(a%oe.MAX_NUMERIC_CODEWORDS===0||g===oe.NUMERIC_COMPACTION_MODE_LATCH||c)&&a>0&&(n.append(oe.decodeBase900toBase10(u,a)),a=0)}return r}static decodeBase900toBase10(e,r){let n=kr(0);for(let c=0;c<r;c++)n+=oe.EXP900[r-c-1]*kr(e[c]);let a=n.toString();if(a.charAt(0)!=="1")throw new q;return a.substring(1)}}oe.TEXT_COMPACTION_MODE_LATCH=900,oe.BYTE_COMPACTION_MODE_LATCH=901,oe.NUMERIC_COMPACTION_MODE_LATCH=902,oe.BYTE_COMPACTION_MODE_LATCH_6=924,oe.ECI_USER_DEFINED=925,oe.ECI_GENERAL_PURPOSE=926,oe.ECI_CHARSET=927,oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,oe.MACRO_PDF417_TERMINATOR=922,oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,oe.MAX_NUMERIC_CODEWORDS=15,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,oe.PL=25,oe.LL=27,oe.AS=27,oe.ML=28,oe.AL=28,oe.PS=29,oe.PAL=29,oe.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,oe.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",oe.EXP900=pi()?Ws():[],oe.NUMBER_OF_SEQUENCE_CODEWORDS=2;class xt{constructor(){}static decode(e,r,n,a,c,u,g){let y=new ws(e,r,n,a,c),v=null,k=null,T;for(let H=!0;;H=!1){if(r!=null&&(v=xt.getRowIndicatorColumn(e,y,r,!0,u,g)),a!=null&&(k=xt.getRowIndicatorColumn(e,y,a,!1,u,g)),T=xt.merge(v,k),T==null)throw X.getNotFoundInstance();let $=T.getBoundingBox();if(H&&$!=null&&($.getMinY()<y.getMinY()||$.getMaxY()>y.getMaxY()))y=$;else break}T.setBoundingBox(y);let R=T.getBarcodeColumnCount()+1;T.setDetectionResultColumn(0,v),T.setDetectionResultColumn(R,k);let P=v!=null;for(let H=1;H<=R;H++){let $=P?H:R-H;if(T.getDetectionResultColumn($)!==void 0)continue;let Q;$===0||$===R?Q=new Yo(y,$===0):Q=new Un(y),T.setDetectionResultColumn($,Q);let ae=-1,Te=ae;for(let Re=y.getMinY();Re<=y.getMaxY();Re++){if(ae=xt.getStartColumn(T,$,Re,P),ae<0||ae>y.getMaxX()){if(Te===-1)continue;ae=Te}let be=xt.detectCodeword(e,y.getMinX(),y.getMaxX(),P,ae,Re,u,g);be!=null&&(Q.setCodeword(Re,be),Te=ae,u=Math.min(u,be.getWidth()),g=Math.max(g,be.getWidth()))}}return xt.createDecoderResult(T)}static merge(e,r){if(e==null&&r==null)return null;let n=xt.getBarcodeMetadata(e,r);if(n==null)return null;let a=ws.merge(xt.adjustBoundingBox(e),xt.adjustBoundingBox(r));return new mi(n,a)}static adjustBoundingBox(e){if(e==null)return null;let r=e.getRowHeights();if(r==null)return null;let n=xt.getMax(r),a=0;for(let g of r)if(a+=n-g,g>0)break;let c=e.getCodewords();for(let g=0;a>0&&c[g]==null;g++)a--;let u=0;for(let g=r.length-1;g>=0&&(u+=n-r[g],!(r[g]>0));g--);for(let g=c.length-1;u>0&&c[g]==null;g--)u--;return e.getBoundingBox().addMissingRows(a,u,e.isLeft())}static getMax(e){let r=-1;for(let n of e)r=Math.max(r,n);return r}static getBarcodeMetadata(e,r){let n;if(e==null||(n=e.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();let a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n}static getRowIndicatorColumn(e,r,n,a,c,u){let g=new Yo(r,a);for(let y=0;y<2;y++){let v=y===0?1:-1,k=Math.trunc(Math.trunc(n.getX()));for(let T=Math.trunc(Math.trunc(n.getY()));T<=r.getMaxY()&&T>=r.getMinY();T+=v){let R=xt.detectCodeword(e,0,e.getWidth(),a,k,T,c,u);R!=null&&(g.setCodeword(T,R),a?k=R.getStartX():k=R.getEndX())}}return g}static adjustCodewordCount(e,r){let n=r[0][1],a=n.getValue(),c=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-xt.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(c<1||c>lt.MAX_CODEWORDS_IN_BARCODE)throw X.getNotFoundInstance();n.setValue(c)}else a[0]!==c&&n.setValue(c)}static createDecoderResult(e){let r=xt.createBarcodeMatrix(e);xt.adjustCodewordCount(e,r);let n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),c=[],u=new Array;for(let y=0;y<e.getBarcodeRowCount();y++)for(let v=0;v<e.getBarcodeColumnCount();v++){let k=r[y][v+1].getValue(),T=y*e.getBarcodeColumnCount()+v;k.length===0?n.push(T):k.length===1?a[T]=k[0]:(u.push(T),c.push(k))}let g=new Array(c.length);for(let y=0;y<g.length;y++)g[y]=c[y];return xt.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,lt.toIntArray(n),lt.toIntArray(u),g)}static createDecoderResultFromAmbiguousValues(e,r,n,a,c){let u=new Int32Array(a.length),g=100;for(;g-- >0;){for(let y=0;y<u.length;y++)r[a[y]]=c[y][u[y]];try{return xt.decodeCodewords(r,e,n)}catch(y){if(!(y instanceof D))throw y}if(u.length===0)throw D.getChecksumInstance();for(let y=0;y<u.length;y++)if(u[y]<c[y].length-1){u[y]++;break}else if(u[y]=0,y===u.length-1)throw D.getChecksumInstance()}throw D.getChecksumInstance()}static createBarcodeMatrix(e){let r=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let a=0;a<r.length;a++)for(let c=0;c<r[a].length;c++)r[a][c]=new us;let n=0;for(let a of e.getDetectionResultColumns()){if(a!=null){for(let c of a.getCodewords())if(c!=null){let u=c.getRowNumber();if(u>=0){if(u>=r.length)continue;r[u][n].setValue(c.getValue())}}}n++}return r}static isValidBarcodeColumn(e,r){return r>=0&&r<=e.getBarcodeColumnCount()+1}static getStartColumn(e,r,n,a){let c=a?1:-1,u=null;if(xt.isValidBarcodeColumn(e,r-c)&&(u=e.getDetectionResultColumn(r-c).getCodeword(n)),u!=null)return a?u.getEndX():u.getStartX();if(u=e.getDetectionResultColumn(r).getCodewordNearby(n),u!=null)return a?u.getStartX():u.getEndX();if(xt.isValidBarcodeColumn(e,r-c)&&(u=e.getDetectionResultColumn(r-c).getCodewordNearby(n)),u!=null)return a?u.getEndX():u.getStartX();let g=0;for(;xt.isValidBarcodeColumn(e,r-c);){r-=c;for(let y of e.getDetectionResultColumn(r).getCodewords())if(y!=null)return(a?y.getEndX():y.getStartX())+c*g*(y.getEndX()-y.getStartX());g++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,r,n,a,c,u,g,y){c=xt.adjustCodewordStartColumn(e,r,n,a,c,u);let v=xt.getModuleBitCount(e,r,n,a,c,u);if(v==null)return null;let k,T=$e.sum(v);if(a)k=c+T;else{for(let H=0;H<v.length/2;H++){let $=v[H];v[H]=v[v.length-1-H],v[v.length-1-H]=$}k=c,c=k-T}if(!xt.checkCodewordSkew(T,g,y))return null;let R=Ur.getDecodedValue(v),P=lt.getCodeword(R);return P===-1?null:new vs(c,k,xt.getCodewordBucketNumber(R),P)}static getModuleBitCount(e,r,n,a,c,u){let g=c,y=new Int32Array(8),v=0,k=a?1:-1,T=a;for(;(a?g<n:g>=r)&&v<y.length;)e.get(g,u)===T?(y[v]++,g+=k):(v++,T=!T);return v===y.length||g===(a?n:r)&&v===y.length-1?y:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,r,n,a,c,u){let g=c,y=a?-1:1;for(let v=0;v<2;v++){for(;(a?g>=r:g<n)&&a===e.get(g,u);){if(Math.abs(c-g)>xt.CODEWORD_SKEW_SIZE)return c;g+=y}y=-y,a=!a}return g}static checkCodewordSkew(e,r,n){return r-xt.CODEWORD_SKEW_SIZE<=e&&e<=n+xt.CODEWORD_SKEW_SIZE}static decodeCodewords(e,r,n){if(e.length===0)throw q.getFormatInstance();let a=1<<r+1,c=xt.correctErrors(e,n,a);xt.verifyCodewordCount(e,a);let u=oe.decode(e,""+r);return u.setErrorsCorrected(c),u.setErasures(n.length),u}static correctErrors(e,r,n){if(r!=null&&r.length>n/2+xt.MAX_ERRORS||n<0||n>xt.MAX_EC_CODEWORDS)throw D.getChecksumInstance();return xt.errorCorrection.decode(e,n,r)}static verifyCodewordCount(e,r){if(e.length<4)throw q.getFormatInstance();let n=e[0];if(n>e.length)throw q.getFormatInstance();if(n===0)if(r<e.length)e[0]=e.length-r;else throw q.getFormatInstance()}static getBitCountForCodeword(e){let r=new Int32Array(8),n=0,a=r.length-1;for(;!((e&1)!==n&&(n=e&1,a--,a<0));)r[a]++,e>>=1;return r}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return xt.getCodewordBucketNumber(xt.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let r=new Zn;for(let n=0;n<e.length;n++){r.format("Row %2d: ",n);for(let a=0;a<e[n].length;a++){let c=e[n][a];c.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",c.getValue()[0],c.getConfidence(c.getValue()[0]))}r.format("%n")}return r.toString()}}xt.CODEWORD_SKEW_SIZE=2,xt.MAX_ERRORS=3,xt.MAX_EC_CODEWORDS=512,xt.errorCorrection=new Xa;class Wr{decode(e,r=null){let n=Wr.decode(e,r,!1);if(n==null||n.length===0||n[0]==null)throw X.getNotFoundInstance();return n[0]}decodeMultiple(e,r=null){try{return Wr.decode(e,r,!0)}catch(n){throw n instanceof q||n instanceof D?X.getNotFoundInstance():n}}static decode(e,r,n){const a=new Array,c=ht.detectMultiple(e,r,n);for(const u of c.getPoints()){const g=xt.decode(c.getBits(),u[4],u[5],u[6],u[7],Wr.getMinCodewordWidth(u),Wr.getMaxCodewordWidth(u)),y=new Be(g.getText(),g.getRawBytes(),void 0,u,Ae.PDF_417);y.putMetadata(Ye.ERROR_CORRECTION_LEVEL,g.getECLevel());const v=g.getOther();v!=null&&y.putMetadata(Ye.PDF417_EXTRA_METADATA,v),a.push(y)}return a.map(u=>u)}static getMaxWidth(e,r){return e==null||r==null?0:Math.trunc(Math.abs(e.getX()-r.getX()))}static getMinWidth(e,r){return e==null||r==null?L.MAX_VALUE:Math.trunc(Math.abs(e.getX()-r.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(Wr.getMaxWidth(e[0],e[4]),Wr.getMaxWidth(e[6],e[2])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN),Math.max(Wr.getMaxWidth(e[1],e[5]),Wr.getMaxWidth(e[7],e[3])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(Wr.getMinWidth(e[0],e[4]),Wr.getMinWidth(e[6],e[2])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN),Math.min(Wr.getMinWidth(e[1],e[5]),Wr.getMinWidth(e[7],e[3])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN)))}reset(){}}class zs extends b{}zs.kind="ReaderException";class Qi{constructor(e,r){this.verbose=e===!0,r&&this.setHints(r)}decode(e,r){return r&&this.setHints(r),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const r=!f(e)&&e.get(ce.TRY_HARDER)===!0,n=f(e)?null:e.get(ce.POSSIBLE_FORMATS),a=new Array;if(!f(n)){const c=n.some(u=>u===Ae.UPC_A||u===Ae.UPC_E||u===Ae.EAN_13||u===Ae.EAN_8||u===Ae.CODABAR||u===Ae.CODE_39||u===Ae.CODE_93||u===Ae.CODE_128||u===Ae.ITF||u===Ae.RSS_14||u===Ae.RSS_EXPANDED);c&&!r&&a.push(new Ls(e,this.verbose)),n.includes(Ae.QR_CODE)&&a.push(new tn),n.includes(Ae.DATA_MATRIX)&&a.push(new kn),n.includes(Ae.AZTEC)&&a.push(new Bn),n.includes(Ae.PDF_417)&&a.push(new Wr),c&&r&&a.push(new Ls(e,this.verbose))}a.length===0&&(r||a.push(new Ls(e,this.verbose)),a.push(new tn),a.push(new kn),a.push(new Bn),a.push(new Wr),r&&a.push(new Ls(e,this.verbose))),this.readers=a}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new zs("No readers where selected, nothing can be read.");for(const r of this.readers)try{return r.decode(e,this.hints)}catch(n){if(n instanceof zs)continue}throw new X("No MultiFormat Readers were able to detect the code.")}}class wi extends fe{constructor(e=null,r=500){const n=new Qi;n.setHints(e),super(n,r)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class Ji extends fe{constructor(e=500){super(new Wr,e)}}class Qo extends fe{constructor(e=500){super(new tn,e)}}var Ya;(function(I){I[I.ERROR_CORRECTION=0]="ERROR_CORRECTION",I[I.CHARACTER_SET=1]="CHARACTER_SET",I[I.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",I[I.MIN_SIZE=3]="MIN_SIZE",I[I.MAX_SIZE=4]="MAX_SIZE",I[I.MARGIN=5]="MARGIN",I[I.PDF417_COMPACT=6]="PDF417_COMPACT",I[I.PDF417_COMPACTION=7]="PDF417_COMPACTION",I[I.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",I[I.AZTEC_LAYERS=9]="AZTEC_LAYERS",I[I.QR_VERSION=10]="QR_VERSION"})(Ya||(Ya={}));var Or=Ya;class Za{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new de(e,Int32Array.from([1])))}buildGenerator(e){const r=this.cachedGenerators;if(e>=r.length){let n=r[r.length-1];const a=this.field;for(let c=r.length;c<=e;c++){const u=n.multiply(new de(a,Int32Array.from([1,a.exp(c-1+a.getGeneratorBase())])));r.push(u),n=u}}return r[e]}encode(e,r){if(r===0)throw new A("No error correction bytes");const n=e.length-r;if(n<=0)throw new A("No data bytes provided");const a=this.buildGenerator(r),c=new Int32Array(n);F.arraycopy(e,0,c,0,n);let u=new de(this.field,c);u=u.multiplyByMonomial(r,1);const y=u.divide(a)[1].getCoefficients(),v=r-y.length;for(let k=0;k<v;k++)e[n+k]=0;F.arraycopy(y,0,e,n+v,y.length)}}class cr{constructor(){}static applyMaskPenaltyRule1(e){return cr.applyMaskPenaltyRule1Internal(e,!0)+cr.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let r=0;const n=e.getArray(),a=e.getWidth(),c=e.getHeight();for(let u=0;u<c-1;u++){const g=n[u];for(let y=0;y<a-1;y++){const v=g[y];v===g[y+1]&&v===n[u+1][y]&&v===n[u+1][y+1]&&r++}}return cr.N2*r}static applyMaskPenaltyRule3(e){let r=0;const n=e.getArray(),a=e.getWidth(),c=e.getHeight();for(let u=0;u<c;u++)for(let g=0;g<a;g++){const y=n[u];g+6<a&&y[g]===1&&y[g+1]===0&&y[g+2]===1&&y[g+3]===1&&y[g+4]===1&&y[g+5]===0&&y[g+6]===1&&(cr.isWhiteHorizontal(y,g-4,g)||cr.isWhiteHorizontal(y,g+7,g+11))&&r++,u+6<c&&n[u][g]===1&&n[u+1][g]===0&&n[u+2][g]===1&&n[u+3][g]===1&&n[u+4][g]===1&&n[u+5][g]===0&&n[u+6][g]===1&&(cr.isWhiteVertical(n,g,u-4,u)||cr.isWhiteVertical(n,g,u+7,u+11))&&r++}return r*cr.N3}static isWhiteHorizontal(e,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(let a=r;a<n;a++)if(e[a]===1)return!1;return!0}static isWhiteVertical(e,r,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(let c=n;c<a;c++)if(e[c][r]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let r=0;const n=e.getArray(),a=e.getWidth(),c=e.getHeight();for(let y=0;y<c;y++){const v=n[y];for(let k=0;k<a;k++)v[k]===1&&r++}const u=e.getHeight()*e.getWidth();return Math.floor(Math.abs(r*2-u)*10/u)*cr.N4}static getDataMaskBit(e,r,n){let a,c;switch(e){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:c=n*r,a=(c&1)+c%3;break;case 6:c=n*r,a=(c&1)+c%3&1;break;case 7:c=n*r,a=c%3+(n+r&1)&1;break;default:throw new A("Invalid mask pattern: "+e)}return a===0}static applyMaskPenaltyRule1Internal(e,r){let n=0;const a=r?e.getHeight():e.getWidth(),c=r?e.getWidth():e.getHeight(),u=e.getArray();for(let g=0;g<a;g++){let y=0,v=-1;for(let k=0;k<c;k++){const T=r?u[g][k]:u[k][g];T===v?y++:(y>=5&&(n+=cr.N1+(y-5)),y=1,v=T)}y>=5&&(n+=cr.N1+(y-5))}return n}}cr.N1=3,cr.N2=3,cr.N3=40,cr.N4=10;class ea{constructor(e,r){this.width=e,this.height=r;const n=new Array(r);for(let a=0;a!==r;a++)n[a]=new Uint8Array(e);this.bytes=n}getHeight(){return this.height}getWidth(){return this.width}get(e,r){return this.bytes[r][e]}getArray(){return this.bytes}setNumber(e,r,n){this.bytes[r][e]=n}setBoolean(e,r,n){this.bytes[r][e]=n?1:0}clear(e){for(const r of this.bytes)re.fill(r,e)}equals(e){if(!(e instanceof ea))return!1;const r=e;if(this.width!==r.width||this.height!==r.height)return!1;for(let n=0,a=this.height;n<a;++n){const c=this.bytes[n],u=r.bytes[n];for(let g=0,y=this.width;g<y;++g)if(c[g]!==u[g])return!1}return!0}toString(){const e=new Ve;for(let r=0,n=this.height;r<n;++r){const a=this.bytes[r];for(let c=0,u=this.width;c<u;++c)switch(a[c]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class bs{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new Ve;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<bs.NUM_MASK_PATTERNS}}bs.NUM_MASK_PATTERNS=8;class er extends b{}er.kind="WriterException";class it{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,r,n,a,c){it.clearMatrix(c),it.embedBasicPatterns(n,c),it.embedTypeInfo(r,a,c),it.maybeEmbedVersionInfo(n,c),it.embedDataBits(e,a,c)}static embedBasicPatterns(e,r){it.embedPositionDetectionPatternsAndSeparators(r),it.embedDarkDotAtLeftBottomCorner(r),it.maybeEmbedPositionAdjustmentPatterns(e,r),it.embedTimingPatterns(r)}static embedTypeInfo(e,r,n){const a=new Y;it.makeTypeInfoBits(e,r,a);for(let c=0,u=a.getSize();c<u;++c){const g=a.get(a.getSize()-1-c),y=it.TYPE_INFO_COORDINATES[c],v=y[0],k=y[1];if(n.setBoolean(v,k,g),c<8){const T=n.getWidth()-c-1;n.setBoolean(T,8,g)}else{const R=n.getHeight()-7+(c-8);n.setBoolean(8,R,g)}}}static maybeEmbedVersionInfo(e,r){if(e.getVersionNumber()<7)return;const n=new Y;it.makeVersionInfoBits(e,n);let a=6*3-1;for(let c=0;c<6;++c)for(let u=0;u<3;++u){const g=n.get(a);a--,r.setBoolean(c,r.getHeight()-11+u,g),r.setBoolean(r.getHeight()-11+u,c,g)}}static embedDataBits(e,r,n){let a=0,c=-1,u=n.getWidth()-1,g=n.getHeight()-1;for(;u>0;){for(u===6&&(u-=1);g>=0&&g<n.getHeight();){for(let y=0;y<2;++y){const v=u-y;if(!it.isEmpty(n.get(v,g)))continue;let k;a<e.getSize()?(k=e.get(a),++a):k=!1,r!==255&&cr.getDataMaskBit(r,v,g)&&(k=!k),n.setBoolean(v,g,k)}g+=c}c=-c,g+=c,u-=2}if(a!==e.getSize())throw new er("Not all bits consumed: "+a+"/"+e.getSize())}static findMSBSet(e){return 32-L.numberOfLeadingZeros(e)}static calculateBCHCode(e,r){if(r===0)throw new A("0 polynomial");const n=it.findMSBSet(r);for(e<<=n-1;it.findMSBSet(e)>=n;)e^=r<<it.findMSBSet(e)-n;return e}static makeTypeInfoBits(e,r,n){if(!bs.isValidMaskPattern(r))throw new er("Invalid mask pattern");const a=e.getBits()<<3|r;n.appendBits(a,5);const c=it.calculateBCHCode(a,it.TYPE_INFO_POLY);n.appendBits(c,10);const u=new Y;if(u.appendBits(it.TYPE_INFO_MASK_PATTERN,15),n.xor(u),n.getSize()!==15)throw new er("should not happen but we got: "+n.getSize())}static makeVersionInfoBits(e,r){r.appendBits(e.getVersionNumber(),6);const n=it.calculateBCHCode(e.getVersionNumber(),it.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new er("should not happen but we got: "+r.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let r=8;r<e.getWidth()-8;++r){const n=(r+1)%2;it.isEmpty(e.get(r,6))&&e.setNumber(r,6,n),it.isEmpty(e.get(6,r))&&e.setNumber(6,r,n)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new er;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,r,n){for(let a=0;a<8;++a){if(!it.isEmpty(n.get(e+a,r)))throw new er;n.setNumber(e+a,r,0)}}static embedVerticalSeparationPattern(e,r,n){for(let a=0;a<7;++a){if(!it.isEmpty(n.get(e,r+a)))throw new er;n.setNumber(e,r+a,0)}}static embedPositionAdjustmentPattern(e,r,n){for(let a=0;a<5;++a){const c=it.POSITION_ADJUSTMENT_PATTERN[a];for(let u=0;u<5;++u)n.setNumber(e+u,r+a,c[u])}}static embedPositionDetectionPattern(e,r,n){for(let a=0;a<7;++a){const c=it.POSITION_DETECTION_PATTERN[a];for(let u=0;u<7;++u)n.setNumber(e+u,r+a,c[u])}}static embedPositionDetectionPatternsAndSeparators(e){const r=it.POSITION_DETECTION_PATTERN[0].length;it.embedPositionDetectionPattern(0,0,e),it.embedPositionDetectionPattern(e.getWidth()-r,0,e),it.embedPositionDetectionPattern(0,e.getWidth()-r,e);const n=8;it.embedHorizontalSeparationPattern(0,n-1,e),it.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),it.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);const a=7;it.embedVerticalSeparationPattern(a,0,e),it.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),it.embedVerticalSeparationPattern(a,e.getHeight()-a,e)}static maybeEmbedPositionAdjustmentPatterns(e,r){if(e.getVersionNumber()<2)return;const n=e.getVersionNumber()-1,a=it.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n];for(let c=0,u=a.length;c!==u;c++){const g=a[c];if(g>=0)for(let y=0;y!==u;y++){const v=a[y];v>=0&&it.isEmpty(r.get(v,g))&&it.embedPositionAdjustmentPattern(v-2,g-2,r)}}}}it.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),it.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),it.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),it.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),it.VERSION_INFO_POLY=7973,it.TYPE_INFO_POLY=1335,it.TYPE_INFO_MASK_PATTERN=21522;class vc{constructor(e,r){this.dataBytes=e,this.errorCorrectionBytes=r}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class rr{constructor(){}static calculateMaskPenalty(e){return cr.applyMaskPenaltyRule1(e)+cr.applyMaskPenaltyRule2(e)+cr.applyMaskPenaltyRule3(e)+cr.applyMaskPenaltyRule4(e)}static encode(e,r,n=null){let a=rr.DEFAULT_BYTE_MODE_ENCODING;const c=n!==null&&n.get(Or.CHARACTER_SET)!==void 0;c&&(a=n.get(Or.CHARACTER_SET).toString());const u=this.chooseMode(e,a),g=new Y;if(u===st.BYTE&&(c||rr.DEFAULT_BYTE_MODE_ENCODING!==a)){const Re=Z.getCharacterSetECIByName(a);Re!==void 0&&this.appendECI(Re,g)}this.appendModeInfo(u,g);const y=new Y;this.appendBytes(e,u,y,a);let v;if(n!==null&&n.get(Or.QR_VERSION)!==void 0){const Re=Number.parseInt(n.get(Or.QR_VERSION).toString(),10);v=rt.getVersionForNumber(Re);const be=this.calculateBitsNeeded(u,g,y,v);if(!this.willFit(be,v,r))throw new er("Data too big for requested version")}else v=this.recommendVersion(r,u,g,y);const k=new Y;k.appendBitArray(g);const T=u===st.BYTE?y.getSizeInBytes():e.length;this.appendLengthInfo(T,v,u,k),k.appendBitArray(y);const R=v.getECBlocksForLevel(r),P=v.getTotalCodewords()-R.getTotalECCodewords();this.terminateBits(P,k);const H=this.interleaveWithECBytes(k,v.getTotalCodewords(),P,R.getNumBlocks()),$=new bs;$.setECLevel(r),$.setMode(u),$.setVersion(v);const Q=v.getDimensionForVersion(),ae=new ea(Q,Q),Te=this.chooseMaskPattern(H,r,v,ae);return $.setMaskPattern(Te),it.buildMatrix(H,r,v,Te,ae),$.setMatrix(ae),$}static recommendVersion(e,r,n,a){const c=this.calculateBitsNeeded(r,n,a,rt.getVersionForNumber(1)),u=this.chooseVersion(c,e),g=this.calculateBitsNeeded(r,n,a,u);return this.chooseVersion(g,e)}static calculateBitsNeeded(e,r,n,a){return r.getSize()+e.getCharacterCountBits(a)+n.getSize()}static getAlphanumericCode(e){return e<rr.ALPHANUMERIC_TABLE.length?rr.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,r=null){if(Z.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(e))return st.KANJI;let n=!1,a=!1;for(let c=0,u=e.length;c<u;++c){const g=e.charAt(c);if(rr.isDigit(g))n=!0;else if(this.getAlphanumericCode(g.charCodeAt(0))!==-1)a=!0;else return st.BYTE}return a?st.ALPHANUMERIC:n?st.NUMERIC:st.BYTE}static isOnlyDoubleByteKanji(e){let r;try{r=ge.encode(e,Z.SJIS)}catch{return!1}const n=r.length;if(n%2!==0)return!1;for(let a=0;a<n;a+=2){const c=r[a]&255;if((c<129||c>159)&&(c<224||c>235))return!1}return!0}static chooseMaskPattern(e,r,n,a){let c=Number.MAX_SAFE_INTEGER,u=-1;for(let g=0;g<bs.NUM_MASK_PATTERNS;g++){it.buildMatrix(e,r,n,g,a);let y=this.calculateMaskPenalty(a);y<c&&(c=y,u=g)}return u}static chooseVersion(e,r){for(let n=1;n<=40;n++){const a=rt.getVersionForNumber(n);if(rr.willFit(e,a,r))return a}throw new er("Data too big")}static willFit(e,r,n){const a=r.getTotalCodewords(),u=r.getECBlocksForLevel(n).getTotalECCodewords(),g=a-u,y=(e+7)/8;return g>=y}static terminateBits(e,r){const n=e*8;if(r.getSize()>n)throw new er("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(let u=0;u<4&&r.getSize()<n;++u)r.appendBit(!1);const a=r.getSize()&7;if(a>0)for(let u=a;u<8;u++)r.appendBit(!1);const c=e-r.getSizeInBytes();for(let u=0;u<c;++u)r.appendBits((u&1)===0?236:17,8);if(r.getSize()!==n)throw new er("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,r,n,a,c,u){if(a>=n)throw new er("Block ID too large");const g=e%n,y=n-g,v=Math.floor(e/n),k=v+1,T=Math.floor(r/n),R=T+1,P=v-T,H=k-R;if(P!==H)throw new er("EC bytes mismatch");if(n!==y+g)throw new er("RS blocks mismatch");if(e!==(T+P)*y+(R+H)*g)throw new er("Total bytes mismatch");a<y?(c[0]=T,u[0]=P):(c[0]=R,u[0]=H)}static interleaveWithECBytes(e,r,n,a){if(e.getSizeInBytes()!==n)throw new er("Number of bits and data bytes does not match");let c=0,u=0,g=0;const y=new Array;for(let k=0;k<a;++k){const T=new Int32Array(1),R=new Int32Array(1);rr.getNumDataBytesAndNumECBytesForBlockID(r,n,a,k,T,R);const P=T[0],H=new Uint8Array(P);e.toBytes(8*c,H,0,P);const $=rr.generateECBytes(H,R[0]);y.push(new vc(H,$)),u=Math.max(u,P),g=Math.max(g,$.length),c+=T[0]}if(n!==c)throw new er("Data bytes does not match offset");const v=new Y;for(let k=0;k<u;++k)for(const T of y){const R=T.getDataBytes();k<R.length&&v.appendBits(R[k],8)}for(let k=0;k<g;++k)for(const T of y){const R=T.getErrorCorrectionBytes();k<R.length&&v.appendBits(R[k],8)}if(r!==v.getSizeInBytes())throw new er("Interleaving error: "+r+" and "+v.getSizeInBytes()+" differ.");return v}static generateECBytes(e,r){const n=e.length,a=new Int32Array(n+r);for(let u=0;u<n;u++)a[u]=e[u]&255;new Za(Xe.QR_CODE_FIELD_256).encode(a,r);const c=new Uint8Array(r);for(let u=0;u<r;u++)c[u]=a[n+u];return c}static appendModeInfo(e,r){r.appendBits(e.getBits(),4)}static appendLengthInfo(e,r,n,a){const c=n.getCharacterCountBits(r);if(e>=1<<c)throw new er(e+" is bigger than "+((1<<c)-1));a.appendBits(e,c)}static appendBytes(e,r,n,a){switch(r){case st.NUMERIC:rr.appendNumericBytes(e,n);break;case st.ALPHANUMERIC:rr.appendAlphanumericBytes(e,n);break;case st.BYTE:rr.append8BitBytes(e,n,a);break;case st.KANJI:rr.appendKanjiBytes(e,n);break;default:throw new er("Invalid mode: "+r)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const r=rr.getDigit(e);return r>=0&&r<=9}static appendNumericBytes(e,r){const n=e.length;let a=0;for(;a<n;){const c=rr.getDigit(e.charAt(a));if(a+2<n){const u=rr.getDigit(e.charAt(a+1)),g=rr.getDigit(e.charAt(a+2));r.appendBits(c*100+u*10+g,10),a+=3}else if(a+1<n){const u=rr.getDigit(e.charAt(a+1));r.appendBits(c*10+u,7),a+=2}else r.appendBits(c,4),a++}}static appendAlphanumericBytes(e,r){const n=e.length;let a=0;for(;a<n;){const c=rr.getAlphanumericCode(e.charCodeAt(a));if(c===-1)throw new er;if(a+1<n){const u=rr.getAlphanumericCode(e.charCodeAt(a+1));if(u===-1)throw new er;r.appendBits(c*45+u,11),a+=2}else r.appendBits(c,6),a++}}static append8BitBytes(e,r,n){let a;try{a=ge.encode(e,n)}catch(c){throw new er(c)}for(let c=0,u=a.length;c!==u;c++){const g=a[c];r.appendBits(g,8)}}static appendKanjiBytes(e,r){let n;try{n=ge.encode(e,Z.SJIS)}catch(c){throw new er(c)}const a=n.length;for(let c=0;c<a;c+=2){const u=n[c]&255,g=n[c+1]&255,y=u<<8&4294967295|g;let v=-1;if(y>=33088&&y<=40956?v=y-33088:y>=57408&&y<=60351&&(v=y-49472),v===-1)throw new er("Invalid byte sequence");const k=(v>>8)*192+(v&255);r.appendBits(k,13)}}static appendECI(e,r){r.appendBits(st.ECI.getBits(),4),r.appendBits(e.getValue(),8)}}rr.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),rr.DEFAULT_BYTE_MODE_ENCODING=Z.UTF8.getName();class _s{write(e,r,n,a=null){if(e.length===0)throw new A("Found empty contents");if(r<0||n<0)throw new A("Requested dimensions are too small: "+r+"x"+n);let c=Yt.L,u=_s.QUIET_ZONE_SIZE;a!==null&&(a.get(Or.ERROR_CORRECTION)!==void 0&&(c=Yt.fromString(a.get(Or.ERROR_CORRECTION).toString())),a.get(Or.MARGIN)!==void 0&&(u=Number.parseInt(a.get(Or.MARGIN).toString(),10)));const g=rr.encode(e,c,a);return this.renderResult(g,r,n,u)}writeToDom(e,r,n,a,c=null){typeof e=="string"&&(e=document.querySelector(e));const u=this.write(r,n,a,c);e&&e.appendChild(u)}renderResult(e,r,n,a){const c=e.getMatrix();if(c===null)throw new nr;const u=c.getWidth(),g=c.getHeight(),y=u+a*2,v=g+a*2,k=Math.max(r,y),T=Math.max(n,v),R=Math.min(Math.floor(k/y),Math.floor(T/v)),P=Math.floor((k-u*R)/2),H=Math.floor((T-g*R)/2),$=this.createSVGElement(k,T);for(let Q=0,ae=H;Q<g;Q++,ae+=R)for(let Te=0,Re=P;Te<u;Te++,Re+=R)if(c.get(Te,Q)===1){const be=this.createSvgRectElement(Re,ae,R,R);$.appendChild(be)}return $}createSVGElement(e,r){const n=document.createElementNS(_s.SVG_NS,"svg");return n.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width",r.toString()),n}createSvgRectElement(e,r,n,a){const c=document.createElementNS(_s.SVG_NS,"rect");return c.setAttributeNS(null,"x",e.toString()),c.setAttributeNS(null,"y",r.toString()),c.setAttributeNS(null,"height",n.toString()),c.setAttributeNS(null,"width",a.toString()),c.setAttributeNS(null,"fill","#000000"),c}}_s.QUIET_ZONE_SIZE=4,_s.SVG_NS="http://www.w3.org/2000/svg";class Vs{encode(e,r,n,a,c){if(e.length===0)throw new A("Found empty contents");if(r!==Ae.QR_CODE)throw new A("Can only encode QR_CODE, but got "+r);if(n<0||a<0)throw new A(`Requested dimensions are too small: ${n}x${a}`);let u=Yt.L,g=Vs.QUIET_ZONE_SIZE;c!==null&&(c.get(Or.ERROR_CORRECTION)!==void 0&&(u=Yt.fromString(c.get(Or.ERROR_CORRECTION).toString())),c.get(Or.MARGIN)!==void 0&&(g=Number.parseInt(c.get(Or.MARGIN).toString(),10)));const y=rr.encode(e,u,c);return Vs.renderResult(y,n,a,g)}static renderResult(e,r,n,a){const c=e.getMatrix();if(c===null)throw new nr;const u=c.getWidth(),g=c.getHeight(),y=u+a*2,v=g+a*2,k=Math.max(r,y),T=Math.max(n,v),R=Math.min(Math.floor(k/y),Math.floor(T/v)),P=Math.floor((k-u*R)/2),H=Math.floor((T-g*R)/2),$=new Fe(k,T);for(let Q=0,ae=H;Q<g;Q++,ae+=R)for(let Te=0,Re=P;Te<u;Te++,Re+=R)c.get(Te,Q)===1&&$.setRegion(Re,ae,R,R);return $}}Vs.QUIET_ZONE_SIZE=4;class bc{encode(e,r,n,a,c){let u;switch(r){case Ae.QR_CODE:u=new Vs;break;default:throw new A("No encoder available for format "+r)}return u.encode(e,r,n,a,c)}}class Wn extends he{constructor(e,r,n,a,c,u,g,y){if(super(u,g),this.yuvData=e,this.dataWidth=r,this.dataHeight=n,this.left=a,this.top=c,a+u>r||c+g>n)throw new A("Crop rectangle does not fit within image data.");y&&this.reverseHorizontal(u,g)}getRow(e,r){if(e<0||e>=this.getHeight())throw new A("Requested row is outside the image: "+e);const n=this.getWidth();(r==null||r.length<n)&&(r=new Uint8ClampedArray(n));const a=(e+this.top)*this.dataWidth+this.left;return F.arraycopy(this.yuvData,a,r,0,n),r}getMatrix(){const e=this.getWidth(),r=this.getHeight();if(e===this.dataWidth&&r===this.dataHeight)return this.yuvData;const n=e*r,a=new Uint8ClampedArray(n);let c=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return F.arraycopy(this.yuvData,c,a,0,n),a;for(let u=0;u<r;u++){const g=u*e;F.arraycopy(this.yuvData,c,a,g,e),c+=this.dataWidth}return a}isCropSupported(){return!0}crop(e,r,n,a){return new Wn(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+r,n,a,!1)}renderThumbnail(){const e=this.getWidth()/Wn.THUMBNAIL_SCALE_FACTOR,r=this.getHeight()/Wn.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(e*r),a=this.yuvData;let c=this.top*this.dataWidth+this.left;for(let u=0;u<r;u++){const g=u*e;for(let y=0;y<e;y++){const v=a[c+y*Wn.THUMBNAIL_SCALE_FACTOR]&255;n[g+y]=4278190080|v*65793}c+=this.dataWidth*Wn.THUMBNAIL_SCALE_FACTOR}return n}getThumbnailWidth(){return this.getWidth()/Wn.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Wn.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,r){const n=this.yuvData;for(let a=0,c=this.top*this.dataWidth+this.left;a<r;a++,c+=this.dataWidth){const u=c+e/2;for(let g=c,y=c+e-1;g<u;g++,y--){const v=n[g];n[g]=n[y],n[y]=v}}}invert(){return new je(this)}}Wn.THUMBNAIL_SCALE_FACTOR=2;class vi extends he{constructor(e,r,n,a,c,u,g){if(super(r,n),this.dataWidth=a,this.dataHeight=c,this.left=u,this.top=g,e.BYTES_PER_ELEMENT===4){const y=r*n,v=new Uint8ClampedArray(y);for(let k=0;k<y;k++){const T=e[k],R=T>>16&255,P=T>>7&510,H=T&255;v[k]=(R+P+H)/4&255}this.luminances=v}else this.luminances=e;if(a===void 0&&(this.dataWidth=r),c===void 0&&(this.dataHeight=n),u===void 0&&(this.left=0),g===void 0&&(this.top=0),this.left+r>this.dataWidth||this.top+n>this.dataHeight)throw new A("Crop rectangle does not fit within image data.")}getRow(e,r){if(e<0||e>=this.getHeight())throw new A("Requested row is outside the image: "+e);const n=this.getWidth();(r==null||r.length<n)&&(r=new Uint8ClampedArray(n));const a=(e+this.top)*this.dataWidth+this.left;return F.arraycopy(this.luminances,a,r,0,n),r}getMatrix(){const e=this.getWidth(),r=this.getHeight();if(e===this.dataWidth&&r===this.dataHeight)return this.luminances;const n=e*r,a=new Uint8ClampedArray(n);let c=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return F.arraycopy(this.luminances,c,a,0,n),a;for(let u=0;u<r;u++){const g=u*e;F.arraycopy(this.luminances,c,a,g,e),c+=this.dataWidth}return a}isCropSupported(){return!0}crop(e,r,n,a){return new vi(this.luminances,n,a,this.dataWidth,this.dataHeight,this.left+e,this.top+r)}invert(){return new je(this)}}class Jo extends Z{static forName(e){return this.getCharacterSetECIByName(e)}}class Qa{}Qa.ISO_8859_1=Z.ISO8859_1;class el{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Ja{static singletonList(e){return[e]}static min(e,r){return e.sort(r)[0]}}class _c{constructor(e){this.previous=e}getPrevious(){return this.previous}}class Hs extends _c{constructor(e,r,n){super(e),this.value=r,this.bitCount=n}appendTo(e,r){e.appendBits(this.value,this.bitCount)}add(e,r){return new Hs(this,e,r)}addBinaryShift(e,r){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Hs(this,e,r)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+L.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class eo extends Hs{constructor(e,r,n){super(e,0,0),this.binaryShiftStart=r,this.binaryShiftByteCount=n}appendTo(e,r){for(let n=0;n<this.binaryShiftByteCount;n++)(n===0||n===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):n===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(r[this.binaryShiftStart+n],8)}addBinaryShift(e,r){return new eo(this,e,r)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Nc(I,e,r){return new eo(I,e,r)}function bi(I,e,r){return new Hs(I,e,r)}const Ec=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],ds=0,Gs=1,qr=2,tl=3,Tn=4,rl=new Hs(null,0,0),ta=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function nl(I){for(let e of I)re.fill(e,-1);return I[ds][Tn]=0,I[Gs][Tn]=0,I[Gs][ds]=28,I[tl][Tn]=0,I[qr][Tn]=0,I[qr][ds]=15,I}const to=nl(re.createInt32Array(6,6));class rn{constructor(e,r,n,a){this.token=e,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,r){let n=this.bitCount,a=this.token;if(e!==this.mode){let u=ta[this.mode][e];a=bi(a,u&65535,u>>16),n+=u>>16}let c=e===qr?4:5;return a=bi(a,r,c),new rn(a,e,0,n+c)}shiftAndAppend(e,r){let n=this.token,a=this.mode===qr?4:5;return n=bi(n,to[this.mode][e],a),n=bi(n,r,5),new rn(n,this.mode,0,this.bitCount+a+5)}addBinaryShiftChar(e){let r=this.token,n=this.mode,a=this.bitCount;if(this.mode===Tn||this.mode===qr){let g=ta[n][ds];r=bi(r,g&65535,g>>16),a+=g>>16,n=ds}let c=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,u=new rn(r,n,this.binaryShiftByteCount+1,a+c);return u.binaryShiftByteCount===2078&&(u=u.endBinaryShift(e+1)),u}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let r=this.token;return r=Nc(r,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new rn(r,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let r=this.bitCount+(ta[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?r+=rn.calculateBinaryShiftCost(e)-rn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(r+=10),r<=e.bitCount}toBitArray(e){let r=[];for(let a=this.endBinaryShift(e.length).token;a!==null;a=a.getPrevious())r.unshift(a);let n=new Y;for(const a of r)a.appendTo(n,e);return n}toString(){return xe.format("%s bits=%d bytes=%d",Ec[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}rn.INITIAL_STATE=new rn(rl,ds,0,0);function Cc(I){const e=xe.getCharCode(" "),r=xe.getCharCode("."),n=xe.getCharCode(",");I[ds][e]=1;const a=xe.getCharCode("Z"),c=xe.getCharCode("A");for(let R=c;R<=a;R++)I[ds][R]=R-c+2;I[Gs][e]=1;const u=xe.getCharCode("z"),g=xe.getCharCode("a");for(let R=g;R<=u;R++)I[Gs][R]=R-g+2;I[qr][e]=1;const y=xe.getCharCode("9"),v=xe.getCharCode("0");for(let R=v;R<=y;R++)I[qr][R]=R-v+2;I[qr][n]=12,I[qr][r]=13;const k=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let R=0;R<k.length;R++)I[tl][xe.getCharCode(k[R])]=R;const T=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let R=0;R<T.length;R++)xe.getCharCode(T[R])>0&&(I[Tn][xe.getCharCode(T[R])]=R);return I}const ro=Cc(re.createInt32Array(5,256));class _i{constructor(e){this.text=e}encode(){const e=xe.getCharCode(" "),r=xe.getCharCode(`
`);let n=Ja.singletonList(rn.INITIAL_STATE);for(let c=0;c<this.text.length;c++){let u,g=c+1<this.text.length?this.text[c+1]:0;switch(this.text[c]){case xe.getCharCode("\r"):u=g===r?2:0;break;case xe.getCharCode("."):u=g===e?3:0;break;case xe.getCharCode(","):u=g===e?4:0;break;case xe.getCharCode(":"):u=g===e?5:0;break;default:u=0}u>0?(n=_i.updateStateListForPair(n,c,u),c++):n=this.updateStateListForChar(n,c)}return Ja.min(n,(c,u)=>c.getBitCount()-u.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,r){const n=[];for(let a of e)this.updateStateForChar(a,r,n);return _i.simplifyStates(n)}updateStateForChar(e,r,n){let a=this.text[r]&255,c=ro[e.getMode()][a]>0,u=null;for(let g=0;g<=Tn;g++){let y=ro[g][a];if(y>0){if(u==null&&(u=e.endBinaryShift(r)),!c||g===e.getMode()||g===qr){const v=u.latchAndAppend(g,y);n.push(v)}if(!c&&to[e.getMode()][g]>=0){const v=u.shiftAndAppend(g,y);n.push(v)}}}if(e.getBinaryShiftByteCount()>0||ro[e.getMode()][a]===0){let g=e.addBinaryShiftChar(r);n.push(g)}}static updateStateListForPair(e,r,n){const a=[];for(let c of e)this.updateStateForPair(c,r,n,a);return this.simplifyStates(a)}static updateStateForPair(e,r,n,a){let c=e.endBinaryShift(r);if(a.push(c.latchAndAppend(Tn,n)),e.getMode()!==Tn&&a.push(c.shiftAndAppend(Tn,n)),n===3||n===4){let u=c.latchAndAppend(qr,16-n).latchAndAppend(qr,1);a.push(u)}if(e.getBinaryShiftByteCount()>0){let u=e.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(u)}}static simplifyStates(e){let r=[];for(const n of e){let a=!0;for(const c of r){if(c.isBetterThanOrEqualTo(n)){a=!1;break}n.isBetterThanOrEqualTo(c)&&(r=r.filter(u=>u!==c))}a&&r.push(n)}return r}}class Lt{constructor(){}static encodeBytes(e){return Lt.encode(e,Lt.DEFAULT_EC_PERCENT,Lt.DEFAULT_AZTEC_LAYERS)}static encode(e,r,n){let a=new _i(e).encode(),c=L.truncDivision(a.getSize()*r,100)+11,u=a.getSize()+c,g,y,v,k,T;if(n!==Lt.DEFAULT_AZTEC_LAYERS){if(g=n<0,y=Math.abs(n),y>(g?Lt.MAX_NB_BITS_COMPACT:Lt.MAX_NB_BITS))throw new A(xe.format("Illegal value %s for layers",n));v=Lt.totalBitsInLayer(y,g),k=Lt.WORD_SIZE[y];let be=v-v%k;if(T=Lt.stuffBits(a,k),T.getSize()+c>be)throw new A("Data to large for user specified layer");if(g&&T.getSize()>k*64)throw new A("Data to large for user specified layer")}else{k=0,T=null;for(let be=0;;be++){if(be>Lt.MAX_NB_BITS)throw new A("Data too large for an Aztec code");if(g=be<=3,y=g?be+1:be,v=Lt.totalBitsInLayer(y,g),u>v)continue;(T==null||k!==Lt.WORD_SIZE[y])&&(k=Lt.WORD_SIZE[y],T=Lt.stuffBits(a,k));let At=v-v%k;if(!(g&&T.getSize()>k*64)&&T.getSize()+c<=At)break}}let R=Lt.generateCheckWords(T,v,k),P=T.getSize()/k,H=Lt.generateModeMessage(g,y,P),$=(g?11:14)+y*4,Q=new Int32Array($),ae;if(g){ae=$;for(let be=0;be<Q.length;be++)Q[be]=be}else{ae=$+1+2*L.truncDivision(L.truncDivision($,2)-1,15);let be=L.truncDivision($,2),At=L.truncDivision(ae,2);for(let ft=0;ft<be;ft++){let cn=ft+L.truncDivision(ft,15);Q[be-ft-1]=At-cn-1,Q[be+ft]=At+cn+1}}let Te=new Fe(ae);for(let be=0,At=0;be<y;be++){let ft=(y-be)*4+(g?9:12);for(let cn=0;cn<ft;cn++){let jn=cn*2;for(let Dr=0;Dr<2;Dr++)R.get(At+jn+Dr)&&Te.set(Q[be*2+Dr],Q[be*2+cn]),R.get(At+ft*2+jn+Dr)&&Te.set(Q[be*2+cn],Q[$-1-be*2-Dr]),R.get(At+ft*4+jn+Dr)&&Te.set(Q[$-1-be*2-Dr],Q[$-1-be*2-cn]),R.get(At+ft*6+jn+Dr)&&Te.set(Q[$-1-be*2-cn],Q[be*2+Dr])}At+=ft*8}if(Lt.drawModeMessage(Te,g,ae,H),g)Lt.drawBullsEye(Te,L.truncDivision(ae,2),5);else{Lt.drawBullsEye(Te,L.truncDivision(ae,2),7);for(let be=0,At=0;be<L.truncDivision($,2)-1;be+=15,At+=16)for(let ft=L.truncDivision(ae,2)&1;ft<ae;ft+=2)Te.set(L.truncDivision(ae,2)-At,ft),Te.set(L.truncDivision(ae,2)+At,ft),Te.set(ft,L.truncDivision(ae,2)-At),Te.set(ft,L.truncDivision(ae,2)+At)}let Re=new el;return Re.setCompact(g),Re.setSize(ae),Re.setLayers(y),Re.setCodeWords(P),Re.setMatrix(Te),Re}static drawBullsEye(e,r,n){for(let a=0;a<n;a+=2)for(let c=r-a;c<=r+a;c++)e.set(c,r-a),e.set(c,r+a),e.set(r-a,c),e.set(r+a,c);e.set(r-n,r-n),e.set(r-n+1,r-n),e.set(r-n,r-n+1),e.set(r+n,r-n),e.set(r+n,r-n+1),e.set(r+n,r+n-1)}static generateModeMessage(e,r,n){let a=new Y;return e?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=Lt.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=Lt.generateCheckWords(a,40,4)),a}static drawModeMessage(e,r,n,a){let c=L.truncDivision(n,2);if(r)for(let u=0;u<7;u++){let g=c-3+u;a.get(u)&&e.set(g,c-5),a.get(u+7)&&e.set(c+5,g),a.get(20-u)&&e.set(g,c+5),a.get(27-u)&&e.set(c-5,g)}else for(let u=0;u<10;u++){let g=c-5+u+L.truncDivision(u,5);a.get(u)&&e.set(g,c-7),a.get(u+10)&&e.set(c+7,g),a.get(29-u)&&e.set(g,c+7),a.get(39-u)&&e.set(c-7,g)}}static generateCheckWords(e,r,n){let a=e.getSize()/n,c=new Za(Lt.getGF(n)),u=L.truncDivision(r,n),g=Lt.bitsToWords(e,n,u);c.encode(g,u-a);let y=r%n,v=new Y;v.appendBits(0,y);for(const k of Array.from(g))v.appendBits(k,n);return v}static bitsToWords(e,r,n){let a=new Int32Array(n),c,u;for(c=0,u=e.getSize()/r;c<u;c++){let g=0;for(let y=0;y<r;y++)g|=e.get(c*r+y)?1<<r-y-1:0;a[c]=g}return a}static getGF(e){switch(e){case 4:return Xe.AZTEC_PARAM;case 6:return Xe.AZTEC_DATA_6;case 8:return Xe.AZTEC_DATA_8;case 10:return Xe.AZTEC_DATA_10;case 12:return Xe.AZTEC_DATA_12;default:throw new A("Unsupported word size "+e)}}static stuffBits(e,r){let n=new Y,a=e.getSize(),c=(1<<r)-2;for(let u=0;u<a;u+=r){let g=0;for(let y=0;y<r;y++)(u+y>=a||e.get(u+y))&&(g|=1<<r-1-y);(g&c)===c?(n.appendBits(g&c,r),u--):(g&c)===0?(n.appendBits(g|1,r),u--):n.appendBits(g,r)}return n}static totalBitsInLayer(e,r){return((r?88:112)+16*e)*e}}Lt.DEFAULT_EC_PERCENT=33,Lt.DEFAULT_AZTEC_LAYERS=0,Lt.MAX_NB_BITS=32,Lt.MAX_NB_BITS_COMPACT=4,Lt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ni{encode(e,r,n,a){return this.encodeWithHints(e,r,n,a,null)}encodeWithHints(e,r,n,a,c){let u=Qa.ISO_8859_1,g=Lt.DEFAULT_EC_PERCENT,y=Lt.DEFAULT_AZTEC_LAYERS;return c!=null&&(c.has(Or.CHARACTER_SET)&&(u=Jo.forName(c.get(Or.CHARACTER_SET).toString())),c.has(Or.ERROR_CORRECTION)&&(g=L.parseInt(c.get(Or.ERROR_CORRECTION).toString())),c.has(Or.AZTEC_LAYERS)&&(y=L.parseInt(c.get(Or.AZTEC_LAYERS).toString()))),Ni.encodeLayers(e,r,n,a,u,g,y)}static encodeLayers(e,r,n,a,c,u,g){if(r!==Ae.AZTEC)throw new A("Can only encode AZTEC, but got "+r);let y=Lt.encode(xe.getBytes(e,c),u,g);return Ni.renderResult(y,n,a)}static renderResult(e,r,n){let a=e.getMatrix();if(a==null)throw new nr;let c=a.getWidth(),u=a.getHeight(),g=Math.max(r,c),y=Math.max(n,u),v=Math.min(g/c,y/u),k=(g-c*v)/2,T=(y-u*v)/2,R=new Fe(g,y);for(let P=0,H=T;P<u;P++,H+=v)for(let $=0,Q=k;$<c;$++,Q+=v)a.get($,P)&&R.setRegion(Q,H,v,v);return R}}o.AbstractExpandedDecoder=en,o.ArgumentException=E,o.ArithmeticException=Oe,o.AztecCode=el,o.AztecCodeReader=Bn,o.AztecCodeWriter=Ni,o.AztecDecoder=We,o.AztecDetector=ls,o.AztecDetectorResult=sr,o.AztecEncoder=Lt,o.AztecHighLevelEncoder=_i,o.AztecPoint=Cr,o.BarcodeFormat=Ae,o.Binarizer=z,o.BinaryBitmap=O,o.BitArray=Y,o.BitMatrix=Fe,o.BitSource=Ha,o.BrowserAztecCodeReader=Wa,o.BrowserBarcodeReader=$o,o.BrowserCodeReader=fe,o.BrowserDatamatrixCodeReader=wc,o.BrowserMultiFormatReader=wi,o.BrowserPDF417Reader=Ji,o.BrowserQRCodeReader=Qo,o.BrowserQRCodeSvgWriter=_s,o.CharacterSetECI=Z,o.ChecksumException=D,o.Code128Reader=Pe,o.Code39Reader=mr,o.DataMatrixDecodedBitStreamParser=An,o.DataMatrixReader=kn,o.DecodeHintType=ce,o.DecoderResult=Ue,o.DefaultGridSampler=Mt,o.DetectorResult=_t,o.EAN13Reader=on,o.EncodeHintType=Or,o.Exception=b,o.FormatException=q,o.GenericGF=Xe,o.GenericGFPoly=de,o.GlobalHistogramBinarizer=Ge,o.GridSampler=Er,o.GridSamplerInstance=or,o.HTMLCanvasElementLuminanceSource=ye,o.HybridBinarizer=Ce,o.ITFReader=Ut,o.IllegalArgumentException=A,o.IllegalStateException=nr,o.InvertedLuminanceSource=je,o.LuminanceSource=he,o.MathUtils=$e,o.MultiFormatOneDReader=Ls,o.MultiFormatReader=Qi,o.MultiFormatWriter=bc,o.NotFoundException=X,o.OneDReader=hr,o.PDF417DecodedBitStreamParser=oe,o.PDF417DecoderErrorCorrection=Xa,o.PDF417Reader=Wr,o.PDF417ResultMetadata=Yi,o.PerspectiveTransform=me,o.PlanarYUVLuminanceSource=Wn,o.QRCodeByteMatrix=ea,o.QRCodeDataMask=wt,o.QRCodeDecodedBitStreamParser=lr,o.QRCodeDecoderErrorCorrectionLevel=Yt,o.QRCodeDecoderFormatInformation=Br,o.QRCodeEncoder=rr,o.QRCodeEncoderQRCode=bs,o.QRCodeMaskUtil=cr,o.QRCodeMatrixUtil=it,o.QRCodeMode=st,o.QRCodeReader=tn,o.QRCodeVersion=rt,o.QRCodeWriter=Vs,o.RGBLuminanceSource=vi,o.RSS14Reader=ir,o.RSSExpandedReader=pe,o.ReaderException=zs,o.ReedSolomonDecoder=ke,o.ReedSolomonEncoder=Za,o.ReedSolomonException=Nt,o.Result=Be,o.ResultMetadataType=Ye,o.ResultPoint=Ee,o.StringUtils=xe,o.UnsupportedOperationException=Ke,o.VideoInputDevice=B,o.WhiteRectangleDetector=Dt,o.WriterException=er,o.ZXingArrays=re,o.ZXingCharset=Jo,o.ZXingInteger=L,o.ZXingStandardCharsets=Qa,o.ZXingStringBuilder=Ve,o.ZXingStringEncoding=ge,o.ZXingSystem=F,o.createAbstractExpandedDecoder=Ho,Object.defineProperty(o,"__esModule",{value:!0})})}(Io,Io.exports)),Io.exports}var xr=C2();const S2=uc(xr),A2=jf({__proto__:null,default:S2},[xr]);var vf=function(){function h(i,o,f){if(this.formatMap=new Map([[Ze.QR_CODE,xr.BarcodeFormat.QR_CODE],[Ze.AZTEC,xr.BarcodeFormat.AZTEC],[Ze.CODABAR,xr.BarcodeFormat.CODABAR],[Ze.CODE_39,xr.BarcodeFormat.CODE_39],[Ze.CODE_93,xr.BarcodeFormat.CODE_93],[Ze.CODE_128,xr.BarcodeFormat.CODE_128],[Ze.DATA_MATRIX,xr.BarcodeFormat.DATA_MATRIX],[Ze.MAXICODE,xr.BarcodeFormat.MAXICODE],[Ze.ITF,xr.BarcodeFormat.ITF],[Ze.EAN_13,xr.BarcodeFormat.EAN_13],[Ze.EAN_8,xr.BarcodeFormat.EAN_8],[Ze.PDF_417,xr.BarcodeFormat.PDF_417],[Ze.RSS_14,xr.BarcodeFormat.RSS_14],[Ze.RSS_EXPANDED,xr.BarcodeFormat.RSS_EXPANDED],[Ze.UPC_A,xr.BarcodeFormat.UPC_A],[Ze.UPC_E,xr.BarcodeFormat.UPC_E],[Ze.UPC_EAN_EXTENSION,xr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!A2)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=o,this.logger=f;var x=this.createZXingFormats(i),m=new Map;m.set(xr.DecodeHintType.POSSIBLE_FORMATS,x),m.set(xr.DecodeHintType.TRY_HARDER,!1),this.hints=m}return h.prototype.decodeAsync=function(i){var o=this;return new Promise(function(f,x){try{f(o.decode(i))}catch(m){x(m)}})},h.prototype.decode=function(i){var o=new xr.MultiFormatReader(this.verbose,this.hints),f=new xr.HTMLCanvasElementLuminanceSource(i),x=new xr.BinaryBitmap(new xr.HybridBinarizer(f)),m=o.decode(x);return{text:m.text,format:U1.create(this.toHtml5QrcodeSupportedFormats(m.format)),debugData:this.createDebugData()}},h.prototype.createReverseFormatMap=function(){var i=new Map;return this.formatMap.forEach(function(o,f,x){i.set(o,f)}),i},h.prototype.toHtml5QrcodeSupportedFormats=function(i){if(!this.reverseFormatMap.has(i))throw"reverseFormatMap doesn't have ".concat(i);return this.reverseFormatMap.get(i)},h.prototype.createZXingFormats=function(i){for(var o=[],f=0,x=i;f<x.length;f++){var m=x[f];this.formatMap.has(m)?o.push(this.formatMap.get(m)):this.logger.logError("".concat(m," is not supported by")+"ZXingHtml5QrcodeShim")}return o},h.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},h}(),k2=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})},I2=function(h,i){var o={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},f,x,m,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(b){return function(E){return N([b,E])}}function N(b){if(f)throw new TypeError("Generator is already executing.");for(;w&&(w=0,b[0]&&(o=0)),o;)try{if(f=1,x&&(m=b[0]&2?x.return:b[0]?x.throw||((m=x.return)&&m.call(x),0):x.next)&&!(m=m.call(x,b[1])).done)return m;switch(x=0,m&&(b=[b[0]&2,m.value]),b[0]){case 0:case 1:m=b;break;case 4:return o.label++,{value:b[1],done:!1};case 5:o.label++,x=b[1],b=[0];continue;case 7:b=o.ops.pop(),o.trys.pop();continue;default:if(m=o.trys,!(m=m.length>0&&m[m.length-1])&&(b[0]===6||b[0]===2)){o=0;continue}if(b[0]===3&&(!m||b[1]>m[0]&&b[1]<m[3])){o.label=b[1];break}if(b[0]===6&&o.label<m[1]){o.label=m[1],m=b;break}if(m&&o.label<m[2]){o.label=m[2],o.ops.push(b);break}m[2]&&o.ops.pop(),o.trys.pop();continue}b=i.call(h,o)}catch(E){b=[6,E],x=0}finally{f=m=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}},bf=function(){function h(i,o,f){if(this.formatMap=new Map([[Ze.QR_CODE,"qr_code"],[Ze.AZTEC,"aztec"],[Ze.CODABAR,"codabar"],[Ze.CODE_39,"code_39"],[Ze.CODE_93,"code_93"],[Ze.CODE_128,"code_128"],[Ze.DATA_MATRIX,"data_matrix"],[Ze.ITF,"itf"],[Ze.EAN_13,"ean_13"],[Ze.EAN_8,"ean_8"],[Ze.PDF_417,"pdf417"],[Ze.UPC_A,"upc_a"],[Ze.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!h.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=o,this.logger=f;var x=this.createBarcodeDetectorFormats(i);if(this.detector=new BarcodeDetector(x),!this.detector)throw"BarcodeDetector detector not supported"}return h.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var i=new BarcodeDetector({formats:["qr_code"]});return typeof i<"u"},h.prototype.decodeAsync=function(i){return k2(this,void 0,void 0,function(){var o,f;return I2(this,function(x){switch(x.label){case 0:return[4,this.detector.detect(i)];case 1:if(o=x.sent(),!o||o.length===0)throw"No barcode or QR code detected.";return f=this.selectLargestBarcode(o),[2,{text:f.rawValue,format:U1.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}]}})})},h.prototype.selectLargestBarcode=function(i){for(var o=null,f=0,x=0,m=i;x<m.length;x++){var w=m[x],S=w.boundingBox.width*w.boundingBox.height;S>f&&(f=S,o=w)}if(!o)throw"No largest barcode found";return o},h.prototype.createBarcodeDetectorFormats=function(i){for(var o=[],f=0,x=i;f<x.length;f++){var m=x[f];this.formatMap.has(m)?o.push(this.formatMap.get(m)):this.logger.warn("".concat(m," is not supported by")+"BarcodeDetectorDelegate")}return{formats:o}},h.prototype.toHtml5QrcodeSupportedFormats=function(i){if(!this.reverseFormatMap.has(i))throw"reverseFormatMap doesn't have ".concat(i);return this.reverseFormatMap.get(i)},h.prototype.createReverseFormatMap=function(){var i=new Map;return this.formatMap.forEach(function(o,f,x){i.set(o,f)}),i},h.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},h}(),_f=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})},Nf=function(h,i){var o={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},f,x,m,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(b){return function(E){return N([b,E])}}function N(b){if(f)throw new TypeError("Generator is already executing.");for(;w&&(w=0,b[0]&&(o=0)),o;)try{if(f=1,x&&(m=b[0]&2?x.return:b[0]?x.throw||((m=x.return)&&m.call(x),0):x.next)&&!(m=m.call(x,b[1])).done)return m;switch(x=0,m&&(b=[b[0]&2,m.value]),b[0]){case 0:case 1:m=b;break;case 4:return o.label++,{value:b[1],done:!1};case 5:o.label++,x=b[1],b=[0];continue;case 7:b=o.ops.pop(),o.trys.pop();continue;default:if(m=o.trys,!(m=m.length>0&&m[m.length-1])&&(b[0]===6||b[0]===2)){o=0;continue}if(b[0]===3&&(!m||b[1]>m[0]&&b[1]<m[3])){o.label=b[1];break}if(b[0]===6&&o.label<m[1]){o.label=m[1],m=b;break}if(m&&o.label<m[2]){o.label=m[2],o.ops.push(b);break}m[2]&&o.ops.pop(),o.trys.pop();continue}b=i.call(h,o)}catch(E){b=[6,E],x=0}finally{f=m=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}},T2=function(){function h(i,o,f,x){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=f,o&&bf.isSupported()?(this.primaryDecoder=new bf(i,f,x),this.secondaryDecoder=new vf(i,f,x)):this.primaryDecoder=new vf(i,f,x)}return h.prototype.decodeAsync=function(i){return _f(this,void 0,void 0,function(){var o;return Nf(this,function(f){switch(f.label){case 0:o=performance.now(),f.label=1;case 1:return f.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(i)];case 2:return[2,f.sent()];case 3:return this.possiblyLogPerformance(o),[7];case 4:return[2]}})})},h.prototype.decodeRobustlyAsync=function(i){return _f(this,void 0,void 0,function(){var o,f;return Nf(this,function(x){switch(x.label){case 0:o=performance.now(),x.label=1;case 1:return x.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(i)];case 2:return[2,x.sent()];case 3:if(f=x.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(i)];throw f;case 4:return this.possiblyLogPerformance(o),[7];case 5:return[2]}})})},h.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},h.prototype.possiblyLogPerformance=function(i){if(this.verbose){var o=performance.now()-i;this.executionResults.push(o),this.executions++,this.possiblyFlushPerformanceReport()}},h.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var i=0,o=0,f=this.executionResults;o<f.length;o++){var x=f[o];i+=x}var m=i/this.executionResults.length;console.log("".concat(m," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},h}(),Id=function(){var h=function(i,o){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,x){f.__proto__=x}||function(f,x){for(var m in x)Object.prototype.hasOwnProperty.call(x,m)&&(f[m]=x[m])},h(i,o)};return function(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");h(i,o);function f(){this.constructor=i}i.prototype=o===null?Object.create(o):(f.prototype=o.prototype,new f)}}(),oc=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})},lc=function(h,i){var o={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},f,x,m,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(b){return function(E){return N([b,E])}}function N(b){if(f)throw new TypeError("Generator is already executing.");for(;w&&(w=0,b[0]&&(o=0)),o;)try{if(f=1,x&&(m=b[0]&2?x.return:b[0]?x.throw||((m=x.return)&&m.call(x),0):x.next)&&!(m=m.call(x,b[1])).done)return m;switch(x=0,m&&(b=[b[0]&2,m.value]),b[0]){case 0:case 1:m=b;break;case 4:return o.label++,{value:b[1],done:!1};case 5:o.label++,x=b[1],b=[0];continue;case 7:b=o.ops.pop(),o.trys.pop();continue;default:if(m=o.trys,!(m=m.length>0&&m[m.length-1])&&(b[0]===6||b[0]===2)){o=0;continue}if(b[0]===3&&(!m||b[1]>m[0]&&b[1]<m[3])){o.label=b[1];break}if(b[0]===6&&o.label<m[1]){o.label=m[1],m=b;break}if(m&&o.label<m[2]){o.label=m[2],o.ops.push(b);break}m[2]&&o.ops.pop(),o.trys.pop();continue}b=i.call(h,o)}catch(E){b=[6,E],x=0}finally{f=m=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}},z1=function(){function h(i,o){this.name=i,this.track=o}return h.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},h.prototype.apply=function(i){var o={};o[this.name]=i;var f={advanced:[o]};return this.track.applyConstraints(f)},h.prototype.value=function(){var i=this.track.getSettings();if(this.name in i){var o=i[this.name];return o}return null},h}(),j2=function(h){Id(i,h);function i(o,f){return h.call(this,o,f)||this}return i.prototype.min=function(){return this.getCapabilities().min},i.prototype.max=function(){return this.getCapabilities().max},i.prototype.step=function(){return this.getCapabilities().step},i.prototype.apply=function(o){var f={};f[this.name]=o;var x={advanced:[f]};return this.track.applyConstraints(x)},i.prototype.getCapabilities=function(){this.failIfNotSupported();var o=this.track.getCapabilities(),f=o[this.name];return{min:f.min,max:f.max,step:f.step}},i.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},i}(z1),R2=function(h){Id(i,h);function i(o){return h.call(this,"zoom",o)||this}return i}(j2),O2=function(h){Id(i,h);function i(o){return h.call(this,"torch",o)||this}return i}(z1),D2=function(){function h(i){this.track=i}return h.prototype.zoomFeature=function(){return new R2(this.track)},h.prototype.torchFeature=function(){return new O2(this.track)},h}(),M2=function(){function h(i,o,f){this.isClosed=!1,this.parentElement=i,this.mediaStream=o,this.callbacks=f,this.surface=this.createVideoElement(this.parentElement.clientWidth),i.append(this.surface)}return h.prototype.createVideoElement=function(i){var o=document.createElement("video");return o.style.width="".concat(i,"px"),o.style.display="block",o.muted=!0,o.setAttribute("muted","true"),o.playsInline=!0,o},h.prototype.setupSurface=function(){var i=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var o=function(){var f=i.surface.clientWidth,x=i.surface.clientHeight;i.callbacks.onRenderSurfaceReady(f,x),i.surface.removeEventListener("playing",o)};this.surface.addEventListener("playing",o),this.surface.srcObject=this.mediaStream,this.surface.play()},h.create=function(i,o,f,x){return oc(this,void 0,void 0,function(){var m,w;return lc(this,function(S){switch(S.label){case 0:return m=new h(i,o,x),f.aspectRatio?(w={aspectRatio:f.aspectRatio},[4,m.getFirstTrackOrFail().applyConstraints(w)]):[3,2];case 1:S.sent(),S.label=2;case 2:return m.setupSurface(),[2,m]}})})},h.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},h.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},h.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},h.prototype.resume=function(i){this.failIfClosed();var o=this,f=function(){setTimeout(i,200),o.surface.removeEventListener("playing",f)};this.surface.addEventListener("playing",f),this.surface.play()},h.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},h.prototype.getSurface=function(){return this.failIfClosed(),this.surface},h.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},h.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},h.prototype.applyVideoConstraints=function(i){return oc(this,void 0,void 0,function(){return lc(this,function(o){if("aspectRatio"in i)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(i)]})})},h.prototype.close=function(){if(this.isClosed)return Promise.resolve();var i=this;return new Promise(function(o,f){var x=i.mediaStream.getVideoTracks(),m=x.length,w=0;i.mediaStream.getVideoTracks().forEach(function(S){i.mediaStream.removeTrack(S),S.stop(),++w,w>=m&&(i.isClosed=!0,i.parentElement.removeChild(i.surface),o())})})},h.prototype.getCapabilities=function(){return new D2(this.getFirstTrackOrFail())},h}(),P2=function(){function h(i){this.mediaStream=i}return h.prototype.render=function(i,o,f){return oc(this,void 0,void 0,function(){return lc(this,function(x){return[2,M2.create(i,this.mediaStream,o,f)]})})},h.create=function(i){return oc(this,void 0,void 0,function(){var o,f;return lc(this,function(x){switch(x.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return o={audio:!1,video:i},[4,navigator.mediaDevices.getUserMedia(o)];case 1:return f=x.sent(),[2,new h(f)]}})})},h}(),Ef=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})},Cf=function(h,i){var o={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},f,x,m,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(b){return function(E){return N([b,E])}}function N(b){if(f)throw new TypeError("Generator is already executing.");for(;w&&(w=0,b[0]&&(o=0)),o;)try{if(f=1,x&&(m=b[0]&2?x.return:b[0]?x.throw||((m=x.return)&&m.call(x),0):x.next)&&!(m=m.call(x,b[1])).done)return m;switch(x=0,m&&(b=[b[0]&2,m.value]),b[0]){case 0:case 1:m=b;break;case 4:return o.label++,{value:b[1],done:!1};case 5:o.label++,x=b[1],b=[0];continue;case 7:b=o.ops.pop(),o.trys.pop();continue;default:if(m=o.trys,!(m=m.length>0&&m[m.length-1])&&(b[0]===6||b[0]===2)){o=0;continue}if(b[0]===3&&(!m||b[1]>m[0]&&b[1]<m[3])){o.label=b[1];break}if(b[0]===6&&o.label<m[1]){o.label=m[1],m=b;break}if(m&&o.label<m[2]){o.label=m[2],o.ops.push(b);break}m[2]&&o.ops.pop(),o.trys.pop();continue}b=i.call(h,o)}catch(E){b=[6,E],x=0}finally{f=m=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}},L2=function(){function h(){}return h.failIfNotSupported=function(){return Ef(this,void 0,void 0,function(){return Cf(this,function(i){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new h]})})},h.prototype.create=function(i){return Ef(this,void 0,void 0,function(){return Cf(this,function(o){return[2,P2.create(i)]})})},h}(),B2=function(h,i,o,f){function x(m){return m instanceof o?m:new o(function(w){w(m)})}return new(o||(o=Promise))(function(m,w){function S(E){try{b(f.next(E))}catch(A){w(A)}}function N(E){try{b(f.throw(E))}catch(A){w(A)}}function b(E){E.done?m(E.value):x(E.value).then(S,N)}b((f=f.apply(h,i||[])).next())})},F2=function(h,i){var o={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},f,x,m,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(b){return function(E){return N([b,E])}}function N(b){if(f)throw new TypeError("Generator is already executing.");for(;w&&(w=0,b[0]&&(o=0)),o;)try{if(f=1,x&&(m=b[0]&2?x.return:b[0]?x.throw||((m=x.return)&&m.call(x),0):x.next)&&!(m=m.call(x,b[1])).done)return m;switch(x=0,m&&(b=[b[0]&2,m.value]),b[0]){case 0:case 1:m=b;break;case 4:return o.label++,{value:b[1],done:!1};case 5:o.label++,x=b[1],b=[0];continue;case 7:b=o.ops.pop(),o.trys.pop();continue;default:if(m=o.trys,!(m=m.length>0&&m[m.length-1])&&(b[0]===6||b[0]===2)){o=0;continue}if(b[0]===3&&(!m||b[1]>m[0]&&b[1]<m[3])){o.label=b[1];break}if(b[0]===6&&o.label<m[1]){o.label=m[1],m=b;break}if(m&&o.label<m[2]){o.label=m[2],o.ops.push(b);break}m[2]&&o.ops.pop(),o.trys.pop();continue}b=i.call(h,o)}catch(E){b=[6,E],x=0}finally{f=m=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}},U2=function(){function h(){}return h.retrieve=function(){if(navigator.mediaDevices)return h.getCamerasFromMediaDevices();var i=MediaStreamTrack;return MediaStreamTrack&&i.getSources?h.getCamerasFromMediaStreamTrack():h.rejectWithError()},h.rejectWithError=function(){var i=Ra.unableToQuerySupportedDevices();return h.isHttpsOrLocalhost()||(i=Ra.insecureContextCameraQueryError()),Promise.reject(i)},h.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var i=location.host.split(":")[0];return i==="127.0.0.1"||i==="localhost"},h.getCamerasFromMediaDevices=function(){return B2(this,void 0,void 0,function(){var i,o,f,x,m,w,S;return F2(this,function(N){switch(N.label){case 0:return i=function(b){for(var E=b.getVideoTracks(),A=0,O=E;A<O.length;A++){var D=O[A];D.enabled=!1,D.stop(),b.removeTrack(D)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return o=N.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(f=N.sent(),x=[],m=0,w=f;m<w.length;m++)S=w[m],S.kind==="videoinput"&&x.push({id:S.deviceId,label:S.label});return i(o),[2,x]}})})},h.getCamerasFromMediaStreamTrack=function(){return new Promise(function(i,o){var f=function(m){for(var w=[],S=0,N=m;S<N.length;S++){var b=N[S];b.kind==="video"&&w.push({id:b.id,label:b.label})}i(w)},x=MediaStreamTrack;x.getSources(f)})},h}(),jr;(function(h){h[h.UNKNOWN=0]="UNKNOWN",h[h.NOT_STARTED=1]="NOT_STARTED",h[h.SCANNING=2]="SCANNING",h[h.PAUSED=3]="PAUSED"})(jr||(jr={}));var W2=function(){function h(){this.state=jr.NOT_STARTED,this.onGoingTransactionNewState=jr.UNKNOWN}return h.prototype.directTransition=function(i){this.failIfTransitionOngoing(),this.validateTransition(i),this.state=i},h.prototype.startTransition=function(i){return this.failIfTransitionOngoing(),this.validateTransition(i),this.onGoingTransactionNewState=i,this},h.prototype.execute=function(){if(this.onGoingTransactionNewState===jr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var i=this.onGoingTransactionNewState;this.onGoingTransactionNewState=jr.UNKNOWN,this.directTransition(i)},h.prototype.cancel=function(){if(this.onGoingTransactionNewState===jr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=jr.UNKNOWN},h.prototype.getState=function(){return this.state},h.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==jr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},h.prototype.validateTransition=function(i){switch(this.state){case jr.UNKNOWN:throw"Transition from unknown is not allowed";case jr.NOT_STARTED:this.failIfNewStateIs(i,[jr.PAUSED]);break;case jr.SCANNING:break;case jr.PAUSED:break}},h.prototype.failIfNewStateIs=function(i,o){for(var f=0,x=o;f<x.length;f++){var m=x[f];if(i===m)throw"Cannot transition from ".concat(this.state," to ").concat(i)}},h}(),z2=function(){function h(i){this.stateManager=i}return h.prototype.startTransition=function(i){return this.stateManager.startTransition(i)},h.prototype.directTransition=function(i){this.stateManager.directTransition(i)},h.prototype.getState=function(){return this.stateManager.getState()},h.prototype.canScanFile=function(){return this.stateManager.getState()===jr.NOT_STARTED},h.prototype.isScanning=function(){return this.stateManager.getState()!==jr.NOT_STARTED},h.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===jr.SCANNING},h.prototype.isPaused=function(){return this.stateManager.getState()===jr.PAUSED},h}(),V2=function(){function h(){}return h.create=function(){return new z2(new W2)},h}(),H2=function(){var h=function(i,o){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,x){f.__proto__=x}||function(f,x){for(var m in x)Object.prototype.hasOwnProperty.call(x,m)&&(f[m]=x[m])},h(i,o)};return function(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");h(i,o);function f(){this.constructor=i}i.prototype=o===null?Object.create(o):(f.prototype=o.prototype,new f)}}(),Mn=function(h){H2(i,h);function i(){return h!==null&&h.apply(this,arguments)||this}return i.DEFAULT_WIDTH=300,i.DEFAULT_WIDTH_OFFSET=2,i.FILE_SCAN_MIN_HEIGHT=300,i.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,i.MIN_QR_BOX_SIZE=50,i.SHADED_LEFT=1,i.SHADED_RIGHT=2,i.SHADED_TOP=3,i.SHADED_BOTTOM=4,i.SHADED_REGION_ELEMENT_ID="qr-shaded-region",i.VERBOSE=!1,i.BORDER_SHADER_DEFAULT_COLOR="#ffffff",i.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",i}(b2),G2=function(){function h(i,o){this.logger=o,this.fps=Mn.SCAN_DEFAULT_FPS,i?(i.fps&&(this.fps=i.fps),this.disableFlip=i.disableFlip===!0,this.qrbox=i.qrbox,this.aspectRatio=i.aspectRatio,this.videoConstraints=i.videoConstraints):this.disableFlip=Mn.DEFAULT_DISABLE_FLIP}return h.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?W1.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},h.prototype.isShadedBoxEnabled=function(){return!Os(this.qrbox)},h.create=function(i,o){return new h(i,o)},h}(),$2=function(){function h(i,o){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(i))throw"HTML Element with id=".concat(i," not found");this.elementId=i,this.verbose=!1;var f;typeof o=="boolean"?this.verbose=o===!0:o&&(f=o,this.verbose=f.verbose===!0,f.experimentalFeatures),this.logger=new N2(this.verbose),this.qrcode=new T2(this.getSupportedFormats(o),this.getUseBarCodeDetectorIfSupported(f),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=V2.create()}return h.prototype.start=function(i,o,f,x){var m=this;if(!i)throw"cameraIdOrConfig is required";if(!f||typeof f!="function")throw"qrCodeSuccessCallback is required and should be a function.";var w;x?w=x:w=this.verbose?this.logger.log:function(){};var S=G2.create(o,this.logger);this.clearElement();var N=!1;S.videoConstraints&&(S.isMediaStreamConstraintsValid()?N=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var b=N,E=document.getElementById(this.elementId);E.clientWidth?E.clientWidth:Mn.DEFAULT_WIDTH,E.style.position="relative",this.shouldScan=!0,this.element=E;var A=this,O=this.stateManagerProxy.startTransition(jr.SCANNING);return new Promise(function(D,z){var F=b?S.videoConstraints:A.createVideoConstraints(i);if(!F){O.cancel(),z("videoConstraints should be defined");return}var U={};(!b||S.aspectRatio)&&(U.aspectRatio=S.aspectRatio);var ie={onRenderSurfaceReady:function(re,L){A.setupUi(re,L,S),A.isScanning=!0,A.foreverScan(S,f,w)}};L2.failIfNotSupported().then(function(re){re.create(F).then(function(L){return L.render(m.element,U,ie).then(function(Y){A.renderedCamera=Y,O.execute(),D(null)}).catch(function(Y){O.cancel(),z(Y)})}).catch(function(L){O.cancel(),z(Ra.errorGettingUserMedia(L))})}).catch(function(re){O.cancel(),z(Ra.cameraStreamingNotSupported())})})},h.prototype.pause=function(i){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(jr.PAUSED),this.showPausedState(),(Os(i)||i!==!0)&&(i=!1),i&&this.renderedCamera&&this.renderedCamera.pause()},h.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var i=this,o=function(){i.stateManagerProxy.directTransition(jr.SCANNING),i.hidePausedState()};if(!this.renderedCamera.isPaused()){o();return}this.renderedCamera.resume(function(){o()})},h.prototype.getState=function(){return this.stateManagerProxy.getState()},h.prototype.stop=function(){var i=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var o=this.stateManagerProxy.startTransition(jr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var f=function(){if(i.element){var m=document.getElementById(Mn.SHADED_REGION_ELEMENT_ID);m&&i.element.removeChild(m)}},x=this;return this.renderedCamera.close().then(function(){return x.renderedCamera=null,x.element&&(x.element.removeChild(x.canvasElement),x.canvasElement=null),f(),x.qrRegion&&(x.qrRegion=null),x.context&&(x.context=null),o.execute(),x.hidePausedState(),x.isScanning=!1,Promise.resolve()})},h.prototype.scanFile=function(i,o){return this.scanFileV2(i,o).then(function(f){return f.decodedText})},h.prototype.scanFileV2=function(i,o){var f=this;if(!i||!(i instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Os(o)&&(o=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(x,m){f.possiblyCloseLastScanImageFile(),f.clearElement(),f.lastScanImageFile=URL.createObjectURL(i);var w=new Image;w.onload=function(){var S=w.width,N=w.height,b=document.getElementById(f.elementId),E=b.clientWidth?b.clientWidth:Mn.DEFAULT_WIDTH,A=Math.max(b.clientHeight?b.clientHeight:N,Mn.FILE_SCAN_MIN_HEIGHT),O=f.computeCanvasDrawConfig(S,N,E,A);if(o){var D=f.createCanvasElement(E,A,"qr-canvas-visible");D.style.display="inline-block",b.appendChild(D);var z=D.getContext("2d");if(!z)throw"Unable to get 2d context from canvas";z.canvas.width=E,z.canvas.height=A,z.drawImage(w,0,0,S,N,O.x,O.y,O.width,O.height)}var F=Mn.FILE_SCAN_HIDDEN_CANVAS_PADDING,U=Math.max(w.width,O.width),ie=Math.max(w.height,O.height),re=U+2*F,L=ie+2*F,Y=f.createCanvasElement(re,L);b.appendChild(Y);var ne=Y.getContext("2d");if(!ne)throw"Unable to get 2d context from canvas";ne.canvas.width=re,ne.canvas.height=L,ne.drawImage(w,0,0,S,N,F,F,U,ie);try{f.qrcode.decodeRobustlyAsync(Y).then(function(ce){x(yf.createFromQrcodeResult(ce))}).catch(m)}catch(ce){m("QR code parse error, error = ".concat(ce))}},w.onerror=m,w.onabort=m,w.onstalled=m,w.onsuspend=m,w.src=URL.createObjectURL(i)})},h.prototype.clear=function(){this.clearElement()},h.getCameras=function(){return U2.retrieve()},h.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},h.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},h.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},h.prototype.applyVideoConstraints=function(i){if(i){if(!W1.isMediaStreamConstraintsValid(i,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(i)},h.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},h.prototype.getSupportedFormats=function(i){var o=[Ze.QR_CODE,Ze.AZTEC,Ze.CODABAR,Ze.CODE_39,Ze.CODE_93,Ze.CODE_128,Ze.DATA_MATRIX,Ze.MAXICODE,Ze.ITF,Ze.EAN_13,Ze.EAN_8,Ze.PDF_417,Ze.RSS_14,Ze.RSS_EXPANDED,Ze.UPC_A,Ze.UPC_E,Ze.UPC_EAN_EXTENSION];if(!i||typeof i=="boolean"||!i.formatsToSupport)return o;if(!Array.isArray(i.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(i.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var f=[],x=0,m=i.formatsToSupport;x<m.length;x++){var w=m[x];v2(w)?f.push(w):this.logger.warn("Invalid format: ".concat(w," passed in config, ignoring."))}if(f.length===0)throw"None of formatsToSupport match supported values.";return f},h.prototype.getUseBarCodeDetectorIfSupported=function(i){if(Os(i))return!0;if(!Os(i.useBarCodeDetectorIfSupported))return i.useBarCodeDetectorIfSupported!==!1;if(Os(i.experimentalFeatures))return!0;var o=i.experimentalFeatures;return Os(o.useBarCodeDetectorIfSupported)?!0:o.useBarCodeDetectorIfSupported!==!1},h.prototype.validateQrboxSize=function(i,o,f){var x=this,m=f.qrbox;this.validateQrboxConfig(m);var w=this.toQrdimensions(i,o,m),S=function(b){if(b<Mn.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Mn.MIN_QR_BOX_SIZE,"px.")},N=function(b){return b>i&&(x.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),b=i),b};S(w.width),S(w.height),w.width=N(w.width)},h.prototype.validateQrboxConfig=function(i){if(typeof i!="number"&&typeof i!="function"&&(i.width===void 0||i.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},h.prototype.toQrdimensions=function(i,o,f){if(typeof f=="number")return{width:f,height:f};if(typeof f=="function")try{return f(i,o)}catch(x){throw new Error("qrbox config was passed as a function but it failed with unknown error"+x)}return f},h.prototype.setupUi=function(i,o,f){f.isShadedBoxEnabled()&&this.validateQrboxSize(i,o,f);var x=Os(f.qrbox)?{width:i,height:o}:f.qrbox;this.validateQrboxConfig(x);var m=this.toQrdimensions(i,o,x);m.height>o&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var w=f.isShadedBoxEnabled()&&m.height<=o,S={x:0,y:0,width:i,height:o},N=w?this.getShadedRegionBounds(i,o,m):S,b=this.createCanvasElement(N.width,N.height),E={willReadFrequently:!0},A=b.getContext("2d",E);A.canvas.width=N.width,A.canvas.height=N.height,this.element.append(b),w&&this.possiblyInsertShadingElement(this.element,i,o,m),this.createScannerPausedUiElement(this.element),this.qrRegion=N,this.context=A,this.canvasElement=b},h.prototype.createScannerPausedUiElement=function(i){var o=document.createElement("div");o.innerText=Ra.scannerPaused(),o.style.display="none",o.style.position="absolute",o.style.top="0px",o.style.zIndex="1",o.style.background="rgba(9, 9, 9, 0.46)",o.style.color="#FFECEC",o.style.textAlign="center",o.style.width="100%",i.appendChild(o),this.scannerPausedUiElement=o},h.prototype.scanContext=function(i,o){var f=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(x){return i(x.text,yf.createFromQrcodeResult(x)),f.possiblyUpdateShaders(!0),!0}).catch(function(x){f.possiblyUpdateShaders(!1);var m=Ra.codeParseError(x);return o(m,_2.createFrom(m)),!1})},h.prototype.foreverScan=function(i,o,f){var x=this;if(this.shouldScan&&this.renderedCamera){var m=this.renderedCamera.getSurface(),w=m.videoWidth/m.clientWidth,S=m.videoHeight/m.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var N=this.qrRegion.width*w,b=this.qrRegion.height*S,E=this.qrRegion.x*w,A=this.qrRegion.y*S;this.context.drawImage(m,E,A,N,b,0,0,this.qrRegion.width,this.qrRegion.height);var O=function(){x.foreverScanTimeout=setTimeout(function(){x.foreverScan(i,o,f)},x.getTimeoutFps(i.fps))};this.scanContext(o,f).then(function(D){!D&&i.disableFlip!==!0?(x.context.translate(x.context.canvas.width,0),x.context.scale(-1,1),x.scanContext(o,f).finally(function(){O()})):O()}).catch(function(D){x.logger.logError("Error happend while scanning context",D),O()})}},h.prototype.createVideoConstraints=function(i){if(typeof i=="string")return{deviceId:{exact:i}};if(typeof i=="object"){var o="facingMode",f="deviceId",x={user:!0,environment:!0},m="exact",w=function(z){if(z in x)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(z,"'")},S=Object.keys(i);if(S.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(S.length," keys");var N=Object.keys(i)[0];if(N!==o&&N!==f)throw"Only '".concat(o,"' and '").concat(f,"' ")+" are supported for 'cameraIdOrConfig'";if(N===o){var b=i.facingMode;if(typeof b=="string"){if(w(b))return{facingMode:b}}else if(typeof b=="object")if(m in b){if(w(b["".concat(m)]))return{facingMode:{exact:b["".concat(m)]}}}else throw"'facingMode' should be string or object with"+" ".concat(m," as key.");else{var E=typeof b;throw"Invalid type of 'facingMode' = ".concat(E)}}else{var A=i.deviceId;if(typeof A=="string")return{deviceId:A};if(typeof A=="object"){if(m in A)return{deviceId:{exact:A["".concat(m)]}};throw"'deviceId' should be string or object with"+" ".concat(m," as key.")}else{var O=typeof A;throw"Invalid type of 'deviceId' = ".concat(O)}}}var D=typeof i;throw"Invalid type of 'cameraIdOrConfig' = ".concat(D)},h.prototype.computeCanvasDrawConfig=function(i,o,f,x){if(i<=f&&o<=x){var m=(f-i)/2,w=(x-o)/2;return{x:m,y:w,width:i,height:o}}else{var S=i,N=o;return i>f&&(o=f/i*o,i=f),o>x&&(i=x/o*i,o=x),this.logger.log("Image downsampled from "+"".concat(S,"X").concat(N)+" to ".concat(i,"X").concat(o,".")),this.computeCanvasDrawConfig(i,o,f,x)}},h.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var i=document.getElementById(this.elementId);i&&(i.innerHTML="")},h.prototype.possiblyUpdateShaders=function(i){this.qrMatch!==i&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(o){o.style.backgroundColor=i?Mn.BORDER_SHADER_MATCH_COLOR:Mn.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=i)},h.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},h.prototype.createCanvasElement=function(i,o,f){var x=i,m=o,w=document.createElement("canvas");return w.style.width="".concat(x,"px"),w.style.height="".concat(m,"px"),w.style.display="none",w.id=Os(f)?"qr-canvas":f,w},h.prototype.getShadedRegionBounds=function(i,o,f){if(f.width>i||f.height>o)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(i-f.width)/2,y:(o-f.height)/2,width:f.width,height:f.height}},h.prototype.possiblyInsertShadingElement=function(i,o,f,x){if(!(o-x.width<1||f-x.height<1)){var m=document.createElement("div");m.style.position="absolute";var w=(o-x.width)/2,S=(f-x.height)/2;if(m.style.borderLeft="".concat(w,"px solid rgba(0, 0, 0, 0.48)"),m.style.borderRight="".concat(w,"px solid rgba(0, 0, 0, 0.48)"),m.style.borderTop="".concat(S,"px solid rgba(0, 0, 0, 0.48)"),m.style.borderBottom="".concat(S,"px solid rgba(0, 0, 0, 0.48)"),m.style.boxSizing="border-box",m.style.top="0px",m.style.bottom="0px",m.style.left="0px",m.style.right="0px",m.id="".concat(Mn.SHADED_REGION_ELEMENT_ID),o-x.width<11||f-x.height<11)this.hasBorderShaders=!1;else{var N=5,b=40;this.insertShaderBorders(m,b,N,-N,null,0,!0),this.insertShaderBorders(m,b,N,-N,null,0,!1),this.insertShaderBorders(m,b,N,null,-N,0,!0),this.insertShaderBorders(m,b,N,null,-N,0,!1),this.insertShaderBorders(m,N,b+N,-N,null,-N,!0),this.insertShaderBorders(m,N,b+N,null,-N,-N,!0),this.insertShaderBorders(m,N,b+N,-N,null,-N,!1),this.insertShaderBorders(m,N,b+N,null,-N,-N,!1),this.hasBorderShaders=!0}i.append(m)}},h.prototype.insertShaderBorders=function(i,o,f,x,m,w,S){var N=document.createElement("div");N.style.position="absolute",N.style.backgroundColor=Mn.BORDER_SHADER_DEFAULT_COLOR,N.style.width="".concat(o,"px"),N.style.height="".concat(f,"px"),x!==null&&(N.style.top="".concat(x,"px")),m!==null&&(N.style.bottom="".concat(m,"px")),S?N.style.left="".concat(w,"px"):N.style.right="".concat(w,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(N),i.appendChild(N)},h.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},h.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},h.prototype.getTimeoutFps=function(i){return 1e3/i},h}(),Sf;(function(h){h[h.STATUS_DEFAULT=0]="STATUS_DEFAULT",h[h.STATUS_SUCCESS=1]="STATUS_SUCCESS",h[h.STATUS_WARNING=2]="STATUS_WARNING",h[h.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Sf||(Sf={}));function X2({onScan:h,onClose:i}){const[o,f]=V.useState(!1),[x,m]=V.useState(null),w=V.useRef(null),S=V.useRef(null),N=V.useCallback(async()=>{if(S.current)try{if(m(null),f(!0),w.current){try{await w.current.stop()}catch{}w.current=null}S.current&&(S.current.innerHTML="");const E=new $2("qr-scanner-container");w.current=E;const A={fps:10,qrbox:{width:250,height:250},aspectRatio:1};await E.start({facingMode:"environment"},A,O=>{h(O),b(),i()},O=>{console.error("QR Scanner error:",O)})}catch{m("카메라를 시작할 수 없습니다. 카메라 권한을 확인해주세요."),f(!1)}},[h]),b=V.useCallback(async()=>{if(f(!1),w.current)try{await w.current.stop()}catch{}finally{w.current=null}S.current&&(S.current.innerHTML="")},[]);return V.useEffect(()=>()=>{b()},[b]),l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"QR 코드 스캔"}),l.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Pn,{size:20,className:"text-gray-600"})})]}),l.jsx("div",{className:"p-4",children:x?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(yn,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"스캔할 수 없습니다"}),l.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:x}),l.jsx("button",{onClick:()=>{m(null),N()},className:"bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"다시 시도"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative aspect-square bg-gray-100 rounded-xl overflow-hidden",children:[l.jsx("div",{ref:S,id:"qr-scanner-container",className:"w-full h-full"}),!o&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50",children:l.jsxs("div",{className:"text-center text-white",children:[l.jsx(h2,{className:"w-12 h-12 mx-auto mb-2"}),l.jsx("p",{className:"text-sm",children:"카메라를 시작하려면 버튼을 누르세요"})]})})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"QR 코드를 사각형 안에 맞춰주세요"}),l.jsx("button",{onClick:o?b:N,className:`w-full py-3 rounded-xl font-medium transition-colors ${o?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:o?"스캔 중지":"스캔 시작"})]}),l.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 p-3 rounded-lg",children:l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:["HTTPS: ",window.location.protocol==="https:"?"✅":"❌"]}),l.jsxs("div",{children:["스캔: ",o?"🟢":"⚪"]}),l.jsxs("div",{children:["모바일: ",/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"📱":"💻"]}),l.jsxs("div",{children:["브라우저: ",navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Safari")?"Safari":"기타"]})]})})]})})]})})}function q2(){const h=ms(),{user:i,logout:o}=ps(),[f,x]=V.useState("home"),[m,w]=V.useState(null),[S,N]=V.useState("1"),[b,E]=V.useState("overview"),[A,O]=V.useState(!0),[D,z]=V.useState([]),[F,U]=V.useState(null),[ie,re]=V.useState(!1),[L,Y]=V.useState(!1),[ne,ce]=V.useState(null),[q,Ne]=V.useState([]),[Z,Ke]=V.useState(!1),[ge,xe]=V.useState({checkin:null,checkout:null,status:"미출근",workingHours:""}),[Ve,Fe]=V.useState([]),[X,Ge]=V.useState({attendanceRate:0,totalDays:0,presentDays:0,lateDays:0,vacationDays:0,possibleDays:0,weeklyData:[]}),[Ce,he]=V.useState({totalMembers:0,presentToday:0,lateToday:0,absentToday:0,vacationToday:0,overallRate:0}),[je,ye]=V.useState(0);q.filter(ke=>!ke.is_read).length,V.useEffect(()=>{if(!i){h("/");return}},[i,h]),V.useEffect(()=>{if(!i)return;B();const ke=setInterval(()=>{F&&(te(F.id),Be(F.id),Wi(i.id).then(ze=>{ye(ze)}))},15e3);return()=>clearInterval(ke)},[i]),V.useEffect(()=>{const ke=()=>{i&&F&&(te(F.id),Be(F.id))};return window.addEventListener("focus",ke),()=>window.removeEventListener("focus",ke)},[i,F]);const B=async()=>{if(i)try{O(!0);const ke=await Po(i.id);if(z(ke),ke.length>0){const $e=ke[0];U($e),await te($e.id),await mt(),await fe($e.id,0),await Be($e.id)}const ze=await sc(i.id);Ne(ze);const We=await Wi(i.id);ye(We)}catch(ke){console.error("데이터 로드 실패:",ke)}finally{O(!1)}},te=async ke=>{if(i)try{const ze=Ln(),We=bd(),$e=await y1(i.id,ke);if($e.length>0){const bt=$e.find(_t=>_t.scan_type==="checkin"),Ee=$e.find(_t=>_t.scan_type==="checkout");xe({checkin:bt?(()=>{const _t=os(bt.scan_time),sr=_t.getHours(),Dt=_t.getMinutes();return`${sr.toString().padStart(2,"0")}:${Dt.toString().padStart(2,"0")}`})():null,checkout:Ee?(()=>{const _t=os(Ee.scan_time),sr=_t.getHours(),Dt=_t.getMinutes();return`${sr.toString().padStart(2,"0")}:${Dt.toString().padStart(2,"0")}`})():null,status:Ee?"퇴근":bt?"출근":"미출근",workingHours:bt&&Ee?Ye(bt.scan_time,Ee.scan_time):""})}else xe({checkin:null,checkout:null,status:"미출근",workingHours:""});Fe($e)}catch{}},fe=async(ke,ze=0)=>{if(i)try{const We=await O1(i.id,ke,30),$e=await D1(i.id,ke,ze);Ge({attendanceRate:We.attendanceRate,totalDays:We.totalDays,presentDays:We.presentDays,lateDays:We.lateDays,vacationDays:We.vacationDays,possibleDays:We.possibleDays,weeklyData:$e})}catch{}},Be=async ke=>{try{const ze=await xc(ke);he({totalMembers:ze.total,presentToday:ze.present,lateToday:ze.late,absentToday:ze.absent,vacationToday:ze.vacation,overallRate:ze.attendanceRate})}catch(ze){console.error("그룹 출석률 로드 실패:",ze)}},[nt,Ae]=V.useState([]);V.useEffect(()=>{},[nt]),V.useEffect(()=>{F&&i&&mt()},[F,i]),V.useEffect(()=>{f==="home"&&F&&i&&(te(F.id),Be(F.id))},[f,F,i]),V.useEffect(()=>{if(f==="records"&&b==="trends"&&F&&i&&nt.length>0&&nt.length>0){const ke=nt[0];if(S===ke.value){const ze=parseInt(ke.value)-1;fe(F.id,ze)}}},[f,b,F,i,nt]);const mt=async()=>{if(!(!i||!F))try{if(!F.start_date){console.error("그룹 시작일이 없습니다");return}const ke=new Date(F.start_date),ze=Ln(),We=Math.ceil((ze.getTime()-ke.getTime())/(7*24*60*60*1e3)),$e=Math.max(1,We),bt=[];for(let _t=1;_t<=$e;_t++){const sr=new Date(ke.getTime()+(_t-1)*7*24*60*60*1e3);let Dt;if(_t===1){const Mt=sr.getDay(),or=Mt<=5?5-Mt:5+(7-Mt);Dt=new Date(sr.getTime()+or*24*60*60*1e3)}else{const Mt=sr.getDay()===0?6:sr.getDay()-1,or=new Date(sr.getTime()-Mt*24*60*60*1e3);Dt=new Date(or.getTime()+4*24*60*60*1e3)}const Er=sr.toLocaleDateString("ko-KR",{month:"short",day:"numeric"}),me=Dt.toLocaleDateString("ko-KR",{month:"short",day:"numeric"});bt.push({value:_t.toString(),label:`${_t}주차 (${Er} ~ ${me})`,startDate:sr,endDate:Dt})}const Ee=bt.sort((_t,sr)=>sr.startDate.getTime()-_t.startDate.getTime());if(Ae(Ee),Ee.length>0){const _t=Ee[0],sr=parseInt(_t.value);N(_t.value);const Dt=sr-1;await fe(F.id,Dt)}}catch{}},Ye=(ke,ze)=>{const We=os(ke),bt=os(ze).getTime()-We.getTime(),Ee=Math.floor(bt/(1e3*60*60)),_t=Math.floor(bt%(1e3*60*60)/(1e3*60));return`${Ee}시간 ${_t}분`},Ue=ke=>{if(!i||!F){w("그룹이 선택되지 않았습니다");return}try{const ze=JSON.parse(ke);if(!ze.type||ze.type!=="location"||!ze.id||!ze.name){w("잘못된 QR 코드입니다");return}const We=ge.checkin?"checkout":"checkin";ce({type:We,locationData:ze}),Y(!0)}catch(ze){console.error("QR 스캔 처리 실패:",ze),w("QR 코드 처리에 실패했습니다")}},ct=ke=>{w(ke)},de=()=>{re(!1)},Oe=async()=>{if(!(!i||!F||!ne))try{const ke=ne.locationData,ze=ke.latitude?parseFloat(ke.latitude):void 0,We=ke.longitude?parseFloat(ke.longitude):void 0,$e=await p1(i.id,F.id,ne.type,ze,We);w(`${$e.scan_type==="checkin"?"출근":"퇴근"} 처리 완료`),await te(F.id),Y(!1),ce(null)}catch(ke){w("처리 중 오류가 발생했습니다"),console.error("출근/퇴근 처리 실패:",ke),Y(!1),ce(null)}},Xe=()=>{Y(!1),ce(null),w("취소되었습니다")},Nt=async ke=>{try{await b1(ke),Ne(ze=>ze.map(We=>We.id===ke?{...We,is_read:!0}:We)),ye(ze=>Math.max(0,ze-1))}catch(ze){console.error("알림 읽음 처리 실패:",ze)}},nr=async ke=>{try{if(await ic(ke)){if(Ne(We=>We.filter($e=>$e.id!==ke)),i){const We=await Wi(i.id);ye(We)}}else console.error("알림 삭제 실패")}catch(ze){console.error("알림 삭제 중 오류:",ze)}};return i?A?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"데이터를 불러오는 중..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[l.jsx("div",{className:"bg-white shadow-sm px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"QR 출퇴근"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[i?.name||"사용자"," • ",i?.department||"소속없음"]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("button",{onClick:()=>Ke(!0),className:"relative p-2 text-gray-600 hover:text-gray-800 rounded-lg hover:bg-gray-100",children:[l.jsx(Lo,{size:20}),je>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:je})]}),l.jsx("button",{onClick:()=>h("/vacation"),className:"p-2 text-blue-600 hover:text-blue-800 rounded-lg hover:bg-blue-50",title:"휴가 신청",children:l.jsx(Fo,{size:20})}),l.jsx("button",{onClick:()=>{o(),h("/")},className:"p-2 text-gray-600 hover:text-red-600 rounded-lg",children:l.jsx(pc,{size:20})})]})]})}),l.jsxs("div",{className:"p-4",children:[f==="home"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-gray-100 rounded-2xl shadow-lg border border-gray-200 p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center text-gray-800",children:[l.jsx(ff,{className:"w-5 h-5 mr-2 text-blue-600"}),"오늘"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[l.jsxs("div",{className:"text-center bg-white rounded-xl p-4 shadow-sm border border-gray-100",children:[l.jsx("div",{className:"text-3xl font-bold mb-1 text-gray-800",children:ge.checkin||"--:--"}),l.jsx("div",{className:"text-sm text-gray-600",children:"출근"})]}),l.jsxs("div",{className:"text-center bg-white rounded-xl p-4 shadow-sm border border-gray-100",children:[l.jsx("div",{className:"text-3xl font-bold mb-1 text-gray-800",children:ge.checkout||"--:--"}),l.jsx("div",{className:"text-sm text-gray-600",children:"퇴근"})]})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-medium ${ge.status==="출근"?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-800 border border-gray-200"}`,children:["✨ ",ge.status]}),ge.status==="출근"&&l.jsx("p",{className:"text-sm text-gray-600 mt-2",children:ge.workingHours})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("button",{onClick:()=>x("scan"),className:"bg-blue-50 text-blue-700 border-2 border-blue-200 p-6 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300 hover:bg-blue-100 hover:border-blue-300",children:[l.jsx(Hi,{className:"w-8 h-8 mx-auto mb-2 text-blue-600"}),l.jsx("div",{className:"font-medium",children:"QR 스캔"}),l.jsx("div",{className:"text-xs opacity-80",children:"출퇴근 체크"})]}),l.jsxs("button",{onClick:()=>h("/vacation"),className:"bg-purple-50 text-purple-700 border-2 border-purple-200 p-6 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300 hover:bg-purple-100 hover:border-purple-300",children:[l.jsx(Fo,{className:"w-8 h-8 mx-auto mb-2 text-purple-600"}),l.jsx("div",{className:"font-medium",children:"휴가 신청"}),l.jsx("div",{className:"text-xs opacity-80",children:"신청하기"})]})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"전체 출석"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[l.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center border border-green-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"정상출석"}),l.jsx("p",{className:"text-2xl font-bold text-green-600",children:X.presentDays-X.lateDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center border border-yellow-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"지각"}),l.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:X.lateDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center border border-orange-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"조기퇴근"}),l.jsx("p",{className:"text-2xl font-bold text-orange-500",children:"0"}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center border border-red-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"결근"}),l.jsx("p",{className:"text-2xl font-bold text-red-600",children:X.totalDays-X.presentDays-X.vacationDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center border border-purple-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"휴가"}),l.jsx("p",{className:"text-2xl font-bold text-purple-600",children:X.vacationDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]})]})]})]}),f==="scan"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"QR 코드 스캔"}),l.jsx("p",{className:"text-gray-600",children:"QR 코드를 스캔하여 출퇴근을 기록하세요"})]}),l.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:l.jsxs("div",{className:"text-center space-y-4",children:[l.jsx("div",{className:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto",children:l.jsx(Hi,{className:"w-12 h-12 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"QR 스캔 시작"}),l.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"카메라를 사용하여 QR 코드를 스캔합니다"})]}),l.jsx("button",{onClick:()=>re(!0),className:"w-full bg-blue-600 text-white py-4 rounded-xl font-medium hover:bg-blue-700 transition-colors",children:"QR 스캔 시작"}),m&&l.jsx("div",{className:`border rounded-xl p-4 ${m.includes("완료")?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:l.jsxs("div",{className:"flex items-center space-x-2",children:[m.includes("완료")?l.jsx(Sn,{className:"w-5 h-5 text-green-600"}):l.jsx(yn,{className:"w-5 h-5 text-red-600"}),l.jsx("span",{className:m.includes("완료")?"text-green-800":"text-red-800",children:m})]})})]})})]}),f==="records"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"bg-white rounded-2xl shadow-sm mb-6",children:l.jsxs("div",{className:"flex border-b border-gray-100",children:[l.jsxs("button",{onClick:()=>E("overview"),className:`flex-1 px-6 py-4 text-center flex items-center justify-center space-x-2 transition-colors ${b==="overview"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[l.jsx(x2,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium",children:"현황"})]}),l.jsxs("button",{onClick:()=>E("trends"),className:`flex-1 px-6 py-4 text-center flex items-center justify-center space-x-2 transition-colors ${b==="trends"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[l.jsx(F1,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium",children:"추이"})]})]})}),b==="overview"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"전체 출석 상세"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[l.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center border border-green-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"정상출석"}),l.jsx("p",{className:"text-2xl font-bold text-green-600",children:X.presentDays-X.lateDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center border border-yellow-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"지각"}),l.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:X.lateDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center border border-orange-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"조기퇴근"}),l.jsx("p",{className:"text-2xl font-bold text-orange-500",children:"0"}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center border border-red-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"결근"}),l.jsx("p",{className:"text-2xl font-bold text-red-600",children:X.totalDays-X.presentDays-X.vacationDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center border border-purple-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"휴가"}),l.jsx("p",{className:"text-2xl font-bold text-purple-600",children:X.vacationDays}),l.jsx("p",{className:"text-xs text-gray-500",children:"일"})]})]})]})}),b==="trends"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"주차 및 기간 선택"}),l.jsx("select",{value:S,onChange:ke=>{if(N(ke.target.value),F){const We=parseInt(ke.target.value)-1;fe(F.id,We)}},className:"bg-gray-50 border border-gray-200 rounded-lg px-4 py-2.5 text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:bg-white transition-colors",children:nt.length>0?nt.map(ke=>l.jsx("option",{value:ke.value,children:ke.label},ke.value)):l.jsx("option",{value:"1",children:"1주차 (로딩 중...)"})})]})}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-8",children:[S,"주차 출석 기록"]}),l.jsx("div",{className:"grid grid-cols-5 gap-3 mb-8",children:X.weeklyData.map((ke,ze)=>{const $e={출근:{text:"출근",color:"bg-green-50 text-green-700 border-green-200"},지각:{text:"지각",color:"bg-yellow-50 text-yellow-600 border-yellow-200"},결근:{text:"결근",color:"bg-red-50 text-red-700 border-red-200"}}[ke.status]||{text:ke.status,color:"bg-gray-50 text-gray-700 border-gray-200"},bt=ke.isEmpty,Ee=ke.isBeforeStart;return l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`text-sm font-medium mb-3 ${bt?"text-gray-300":Ee?"text-gray-400":"text-gray-500"}`,children:ke.day}),l.jsx("div",{className:`w-14 h-14 rounded-lg flex items-center justify-center mx-auto border transition-all ${bt?"bg-gray-50 border-gray-100":Ee?"bg-gray-100 text-gray-400 border-gray-200 hover:scale-105":`${$e.color} hover:scale-105`}`,children:l.jsx("span",{className:"text-xs font-bold",children:bt?"":Ee?"시작전":$e.text})}),l.jsx("div",{className:`text-xs mt-2 ${bt?"text-gray-300":"text-gray-400"}`,children:bt?"":Ee?"시작전":ke.status})]},`${ke.day}-${ze}`)})}),l.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[l.jsxs("h4",{className:"text-md font-semibold text-gray-700 mb-4",children:[S,"주차 요약"]}),l.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[l.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center border border-green-200",children:[l.jsx("div",{className:"text-lg font-bold text-green-600",children:X.presentDays-X.lateDays}),l.jsx("div",{className:"text-xs text-gray-500",children:"정상출석"})]}),l.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3 text-center border border-yellow-200",children:[l.jsx("div",{className:"text-lg font-bold text-yellow-500",children:X.lateDays}),l.jsx("div",{className:"text-xs text-gray-500",children:"지각"})]}),l.jsxs("div",{className:"bg-red-50 rounded-lg p-3 text-center border border-red-200",children:[l.jsx("div",{className:"text-lg font-bold text-red-600",children:X.totalDays-X.presentDays-X.vacationDays}),l.jsx("div",{className:"text-xs text-gray-500",children:"결근"})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center border border-purple-200",children:[l.jsx("div",{className:"text-lg font-bold text-purple-600",children:X.vacationDays}),l.jsx("div",{className:"text-xs text-gray-500",children:"휴가"})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center border border-blue-200",children:[l.jsx("div",{className:"text-lg font-bold text-blue-600",children:X.totalDays}),l.jsx("div",{className:"text-xs text-gray-500",children:"전체"})]})]})]})]})]})]})]}),l.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2",children:l.jsxs("div",{className:"flex justify-around",children:[l.jsxs("button",{onClick:()=>x("home"),className:`flex flex-col items-center py-2 px-3 rounded-lg ${f==="home"?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[l.jsx(ff,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"홈"})]}),l.jsxs("button",{onClick:()=>x("scan"),className:`flex flex-col items-center py-2 px-3 rounded-lg ${f==="scan"?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[l.jsx(Hi,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"스캔"})]}),l.jsxs("button",{onClick:()=>x("records"),className:`flex flex-col items-center py-2 px-3 rounded-lg ${f==="records"?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[l.jsx(zi,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"기록"})]}),l.jsxs("button",{onClick:()=>h("/password-change"),className:"flex flex-col items-center py-2 px-3 rounded-lg text-gray-600 hover:text-blue-600",children:[l.jsx(Ma,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"비밀번호"})]})]})}),Z&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md flex flex-col max-h-[80vh]",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"알림"}),l.jsx("button",{onClick:()=>Ke(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Pn,{size:20,className:"text-gray-600"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l.jsx("div",{className:"space-y-4",children:q.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"알림이 없습니다"})}):q.map(ke=>l.jsxs("div",{className:`p-4 rounded-2xl transition-colors ${ke.is_read?"bg-gray-50":"bg-blue-50 border border-blue-200"}`,children:[l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:ke.title}),l.jsx("span",{className:"text-xs text-gray-500",children:new Date(new Date(ke.created_at).getTime()+9*60*60*1e3).toLocaleDateString("ko-KR")})]}),l.jsx("p",{className:"text-sm text-gray-600",children:ke.message}),!ke.is_read&&l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"})]}),l.jsx("button",{onClick:ze=>{ze.stopPropagation(),nr(ke.id)},className:"p-1 hover:bg-red-100 rounded text-red-500 hover:text-red-700 transition-colors",title:"알림 삭제",children:l.jsx(Pn,{size:16})})]}),!ke.is_read&&l.jsx("button",{onClick:()=>Nt(ke.id),className:"mt-2 text-xs text-blue-600 hover:text-blue-800 font-medium",children:"읽음 처리"})]},ke.id))})}),l.jsx("div",{className:"p-6 border-t border-gray-200 space-y-3 flex-shrink-0",children:l.jsxs("button",{onClick:()=>{Ke(!1),h("/vacation")},className:"w-full bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 flex items-center justify-center space-x-2",children:[l.jsx(yc,{size:20}),l.jsx("span",{children:"새 휴가 신청"})]})})]})}),ie&&l.jsx(X2,{onScan:Ue,onError:ct,onClose:de}),L&&ne&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:ne.type==="checkin"?l.jsx(hi,{className:"w-8 h-8 text-blue-600"}):l.jsx(Sn,{className:"w-8 h-8 text-green-600"})}),l.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:[ne.type==="checkin"?"출근":"퇴근"," 확인"]}),l.jsx("p",{className:"text-gray-600",children:ne.type==="checkin"?"출근을 기록하시겠습니까?":"퇴근을 기록하시겠습니까?"})]}),ne.locationData&&l.jsx("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Da,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-800 mb-1",children:"위치 정보"}),ne.locationData.name&&l.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:["장소: ",ne.locationData.name]}),ne.locationData.address&&l.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:["주소: ",ne.locationData.address]}),ne.locationData.latitude&&ne.locationData.longitude&&l.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:["좌표: ",ne.locationData.latitude.toFixed(6),", ",ne.locationData.longitude.toFixed(6)]}),l.jsxs("p",{className:"text-xs text-gray-500",children:["시간: ",(()=>{const ke=new Date,ze=ke.getFullYear(),We=(ke.getMonth()+1).toString().padStart(2,"0"),$e=ke.getDate().toString().padStart(2,"0"),bt=ke.getHours(),Ee=ke.getMinutes().toString().padStart(2,"0"),_t=ke.getSeconds().toString().padStart(2,"0");return`${ze}. ${We}. ${$e}. ${bt.toString().padStart(2,"0")}:${Ee}:${_t}`})()]})]})]})}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:Xe,className:"flex-1 py-3 px-4 text-gray-700 bg-gray-100 rounded-xl font-medium hover:bg-gray-200 transition-colors",children:"취소"}),l.jsxs("button",{onClick:Oe,className:`flex-1 py-3 px-4 text-white rounded-xl font-medium transition-colors ${ne.type==="checkin"?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"}`,children:[ne.type==="checkin"?"출근":"퇴근"," 확인"]})]})]})})]}):null}function K2(){const h=ms(),{user:i,logout:o}=ps(),[f,x]=V.useState("dashboard"),[m,w]=V.useState(!0),[S,N]=V.useState(!1),[b,E]=V.useState([]),[A,O]=V.useState(null),[D,z]=V.useState([]),[F,U]=V.useState(!1),[ie,re]=V.useState({total:0,present:0,late:0,absent:0,vacation:0,attendanceRate:0}),[L,Y]=V.useState([]),[ne,ce]=V.useState([]),[q,Ne]=V.useState([]),[Z,Ke]=V.useState({currentWeek:{label:"이번주",dateRange:"",groupStats:[]},lastWeek:{label:"지난주",dateRange:"",groupStats:[]},beforeWeek:{label:"지지난주",dateRange:"",groupStats:[]}}),[ge,xe]=V.useState("1"),[Ve,Fe]=V.useState([]),[X,Ge]=V.useState({weekNumber:1,dateRange:"",groupsData:[],totalStats:{present:0,late:0,absent:0,vacation:0}}),[Ce,he]=V.useState(0);V.useEffect(()=>{if(!i){w(!1),h("/");return}if(i.role!=="faculty"){w(!1),h("/");return}je()},[i,h]),V.useEffect(()=>{if(!i||i.role!=="faculty")return;const de=setInterval(async()=>{try{A&&(N(!0),await te(A.id),N(!1)),await Ue()}catch{N(!1)}},15e3),Oe=setInterval(async()=>{try{A&&(await ye(A.id),await B(A.id))}catch{}},3e4),Xe=setInterval(async()=>{try{await fe(),await Be(),await Ae(parseInt(ge))}catch{}},6e4);return()=>{clearInterval(de),clearInterval(Oe),clearInterval(Xe)}},[i,A,ge]);const je=async()=>{if(!i){w(!1);return}try{w(!0),N(!0);const de=await Vo(i.id);if(E(de),de.length>0){const Nt=de[0];O(Nt),await ye(Nt.id),await B(Nt.id),await te(Nt.id)}await fe(),await Be(),await nt();const Oe=await sc(i.id);z(Oe);const Xe=await Wi(i.id);he(Xe)}catch(de){console.error("데이터 로드 실패:",de)}finally{w(!1),N(!1)}},ye=async de=>{try{const Oe=await xc(de);re(Xe=>JSON.stringify(Xe)!==JSON.stringify(Oe)?Oe:Xe)}catch{}},B=async de=>{try{const Oe=await mc(de);Y(Oe)}catch{}},te=async de=>{try{const Oe=new Date;Oe.setHours(Oe.getHours()-1);const{data:Xe,error:Nt}=await He.from("attendance_logs").select(`
          *,
          users!attendance_logs_user_id_fkey(name, department)
        `).eq("group_id",de).gte("scan_time",Oe.toISOString()).order("scan_time",{ascending:!1}).limit(5);if(Nt)return;const{data:nr,error:ke}=await He.from("vacation_requests").select(`
          *,
          users!vacation_requests_user_id_fkey(name, department)
        `).eq("group_id",de).gte("created_at",Oe.toISOString()).order("created_at",{ascending:!1}).limit(3),ze=[...(Xe||[]).map(We=>({...We,type:"attendance",displayTime:os(We.scan_time)})),...(nr||[]).map(We=>({...We,type:"vacation",displayTime:os(We.created_at)}))].sort((We,$e)=>$e.displayTime.getTime()-We.displayTime.getTime()).slice(0,8);ce(We=>JSON.stringify(We)!==JSON.stringify(ze)?ze:We)}catch{}},fe=async()=>{if(i)try{const de=await I1(i.id);Ne(de)}catch{}},Be=async()=>{if(i)try{const de=await R1(i.id);Ke(de)}catch{}},nt=async()=>{if(i)try{const{data:de,error:Oe}=await He.from("groups").select("id, name, start_date").eq("faculty_id",i.id).order("start_date",{ascending:!1});if(Oe||!de||de.length===0)return;const Xe=de[0];if(!Xe.start_date)return;const Nt=new Date(Xe.start_date),ke=Math.ceil((new Date().getTime()-Nt.getTime())/(7*24*60*60*1e3)),ze=Math.min(Math.max(1,ke),8),We=[];for(let $e=1;$e<=ze;$e++){let bt,Ee;if($e===1){bt=new Date(Nt);const Dt=bt.getDay(),Er=Dt<=5?5-Dt:5+(7-Dt);Ee=new Date(bt.getTime()+Er*24*60*60*1e3)}else{const Dt=Nt.getDay();let Er;Dt===1?Er=0:Dt===0?Er=1:Er=-(Dt-1);const me=new Date(Nt.getTime()+Er*24*60*60*1e3);bt=new Date(me.getTime()+($e-1)*7*24*60*60*1e3),Ee=new Date(bt.getTime()+4*24*60*60*1e3)}const _t=bt.toLocaleDateString("ko-KR",{month:"short",day:"numeric"}),sr=Ee.toLocaleDateString("ko-KR",{month:"short",day:"numeric"});We.push({value:$e.toString(),label:`${$e}주차 (${_t} ~ ${sr})`})}Fe(We),xe("1"),await Ae(1)}catch{}},Ae=async de=>{if(i)try{const Oe=await j1(i.id,de);Ge(Oe)}catch{}},mt=({percentage:de,size:Oe=100})=>{const Xe=isNaN(de)?0:de,Nt=(Oe-8)/2,nr=2*Math.PI*Nt,ke=nr,We=nr-Xe/100*nr;return l.jsxs("div",{className:"relative",style:{width:Oe,height:Oe},children:[l.jsxs("svg",{className:"transform -rotate-90",width:Oe,height:Oe,children:[l.jsx("circle",{cx:Oe/2,cy:Oe/2,r:Nt,stroke:"#e5e7eb",strokeWidth:"8",fill:"transparent"}),l.jsx("circle",{cx:Oe/2,cy:Oe/2,r:Nt,stroke:"#059669",strokeWidth:"8",fill:"transparent",strokeDasharray:ke,strokeDashoffset:We,strokeLinecap:"round",className:"transition-all duration-1000 ease-out"})]}),l.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:l.jsxs("span",{className:"text-lg font-bold text-green-600",children:[Math.round(Xe),"%"]})})]})},Ye=async de=>{try{await ic(de),z(Oe=>Oe.map(Xe=>Xe.id===de?{...Xe,is_read:!0}:Xe)),he(Oe=>Math.max(0,Oe-1))}catch{}},Ue=async()=>{if(i)try{const de=await Wi(i.id);if(de>Ce){const Oe=await sc(i.id);z(Oe),he(de)}else he(de)}catch{}},ct=async de=>{try{if(await ic(de)&&(z(Xe=>Xe.filter(Nt=>Nt.id!==de)),i)){const Xe=await Wi(i.id);he(Xe)}}catch{}};return m||!i||i.role!=="faculty"?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:i?i.role!=="faculty"?"권한 확인 중...":"데이터를 불러오는 중...":"로그인 중..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[l.jsx("div",{className:"bg-white shadow-sm px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"출석 관리"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[i?.name||"교수님"," • ",i?.department||"소속없음"]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("button",{onClick:()=>U(!0),className:"relative p-2 text-gray-600 hover:text-gray-800 rounded-lg hover:bg-gray-100",children:[l.jsx(Lo,{size:20}),Ce>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:Ce})]}),l.jsx("button",{onClick:()=>h("/work-time-settings"),className:"p-2 text-gray-600 hover:text-gray-800 rounded-lg hover:bg-gray-100",title:"출퇴근 시간 설정",children:l.jsx(Ma,{size:20})}),l.jsx("button",{onClick:()=>{o(),h("/")},className:"p-2 text-gray-600 hover:text-red-600 rounded-lg",children:l.jsx(pc,{size:20})})]})]})}),l.jsx("div",{className:"p-4",children:f==="dashboard"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-2xl p-6 text-gray-900",children:[l.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[l.jsx(ja,{className:"w-5 h-5 mr-2"}),"오늘 현황"]}),l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"grid grid-cols-4 gap-4 flex-1",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:q.reduce((de,Oe)=>de+Oe.presentCount,0)}),l.jsx("div",{className:"text-xs opacity-80",children:"출석"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:q.reduce((de,Oe)=>de+Oe.lateCount,0)}),l.jsx("div",{className:"text-xs opacity-80",children:"지각"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:q.reduce((de,Oe)=>de+Oe.absentCount,0)}),l.jsx("div",{className:"text-xs opacity-80",children:"결근"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:q.reduce((de,Oe)=>de+Oe.vacationCount,0)}),l.jsx("div",{className:"text-xs opacity-80",children:"휴가"})]})]}),l.jsx(mt,{percentage:q.length>0?Math.round(q.reduce((de,Oe)=>de+Oe.attendanceRate*Oe.totalStudents,0)/q.reduce((de,Oe)=>de+Oe.totalStudents,0)*10)/10:0})]}),l.jsxs("div",{className:"mb-2 text-sm text-gray-600 flex justify-between",children:[l.jsxs("span",{children:["전체: ",q.reduce((de,Oe)=>de+Oe.totalStudents,0),"명 (관리 그룹: ",q.length,"개)"]}),l.jsxs("span",{className:"text-green-600 font-medium",children:["실시간 출석률: ",q.length>0?Math.round(q.reduce((de,Oe)=>de+Oe.attendanceRate*Oe.totalStudents,0)/q.reduce((de,Oe)=>de+Oe.totalStudents,0)*10)/10:0,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all",style:{width:`${q.length>0?Math.round(q.reduce((de,Oe)=>de+Oe.attendanceRate*Oe.totalStudents,0)/q.reduce((de,Oe)=>de+Oe.totalStudents,0)*10)/10:0}%`}})})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"빠른 액션"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("button",{onClick:()=>h("/group-management"),className:"flex flex-col items-center p-4 bg-blue-50 rounded-2xl hover:bg-blue-100 transition-colors border-2 border-blue-200",children:[l.jsx(ja,{className:"w-8 h-8 text-blue-600 mb-2"}),l.jsx("span",{className:"text-sm font-medium text-blue-900",children:"그룹 관리"})]}),l.jsxs("button",{onClick:()=>h("/qr_generator"),className:"flex flex-col items-center p-4 bg-green-50 rounded-2xl hover:bg-green-100 transition-colors border-2 border-green-200",children:[l.jsx(Hi,{className:"w-8 h-8 text-green-600 mb-2"}),l.jsx("span",{className:"text-sm font-medium text-green-900",children:"QR 생성"})]}),l.jsxs("button",{onClick:()=>h("/faculty-vacation-approval"),className:"flex flex-col items-center p-4 bg-purple-50 rounded-2xl hover:bg-purple-100 transition-colors border-2 border-purple-200",children:[l.jsx(zi,{className:"w-8 h-8 text-purple-600 mb-2"}),l.jsx("span",{className:"text-sm font-medium text-purple-900",children:"휴가 관리"})]}),l.jsxs("button",{onClick:()=>h("/work-time-settings"),className:"flex flex-col items-center p-4 bg-orange-50 rounded-2xl hover:bg-orange-100 transition-colors border-2 border-orange-200",children:[l.jsx(Ma,{className:"w-8 h-8 text-orange-600 mb-2"}),l.jsx("span",{className:"text-sm font-medium text-orange-900",children:"근무시간"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(hi,{className:"w-5 h-5 mr-2 text-blue-600"}),"실시간 활동"]}),l.jsx("div",{className:"space-y-3",children:ne.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"오늘 활동이 없습니다"})}):ne.map((de,Oe)=>{const Nt=(de.displayTime||os(de.scan_time||de.created_at)).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"});return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${de.type==="vacation"?"bg-purple-100":de.scan_type==="checkin"?"bg-green-100":"bg-blue-100"}`,children:de.type==="vacation"?l.jsx(Fo,{className:"w-4 h-4 text-purple-600"}):de.scan_type==="checkin"?l.jsx(p2,{className:`w-4 h-4 ${de.status==="late"?"text-yellow-600":"text-green-600"}`}):l.jsx(w2,{className:"w-4 h-4 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:de.users?.name||"알 수 없음"}),l.jsxs("p",{className:"text-xs text-gray-500",children:[de.type==="vacation"?`휴가 신청 (${de.vacation_type==="annual"?"연차":de.vacation_type==="sick"?"병가":"개인사정"})`:`${de.scan_type==="checkin"?"출근":"퇴근"}`,de.type==="attendance"&&de.status==="late"&&" (지각)"]})]})]}),l.jsx("div",{className:"text-xs text-gray-500",children:Nt})]},`${de.type}-${de.id}-${Oe}`)})})]})]})}),l.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2",children:l.jsxs("div",{className:"flex justify-around",children:[l.jsxs("button",{onClick:()=>x("dashboard"),className:`flex flex-col items-center py-2 px-3 rounded-lg ${f==="dashboard"?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[l.jsx(ja,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"대시보드"})]}),l.jsxs("button",{onClick:()=>h("/group-management"),className:"flex flex-col items-center py-2 px-3 rounded-lg text-gray-600 hover:text-blue-600",children:[l.jsx(Wo,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"그룹"})]}),l.jsxs("button",{onClick:()=>h("/qr_generator"),className:"flex flex-col items-center py-2 px-3 rounded-lg text-gray-600 hover:text-blue-600",children:[l.jsx(Hi,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"QR관리"})]}),l.jsxs("button",{onClick:()=>h("/password-change"),className:"flex flex-col items-center py-2 px-3 rounded-lg text-gray-600 hover:text-blue-600",children:[l.jsx(Ma,{size:20}),l.jsx("span",{className:"text-xs mt-1",children:"비밀번호"})]})]})}),F&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md flex flex-col max-h-[80vh]",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"알림"}),l.jsx("button",{onClick:()=>U(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Pn,{size:20,className:"text-gray-600"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l.jsx("div",{className:"space-y-4",children:D.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"알림이 없습니다"})}):D.map(de=>l.jsxs("div",{className:`p-4 rounded-2xl transition-colors ${de.is_read?"bg-gray-50":"bg-blue-50 border border-blue-200"}`,children:[l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:de.title}),l.jsx("span",{className:"text-xs text-gray-500",children:os(de.created_at).toLocaleDateString("ko-KR")})]}),l.jsx("p",{className:"text-sm text-gray-600",children:de.message}),!de.is_read&&l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"})]}),l.jsx("button",{onClick:Oe=>{Oe.stopPropagation(),ct(de.id)},className:"p-1 hover:bg-red-100 rounded text-red-500 hover:text-red-700 transition-colors",title:"알림 삭제",children:l.jsx(Pn,{size:16})})]}),!de.is_read&&l.jsx("button",{onClick:()=>Ye(de.id),className:"mt-2 text-xs text-blue-600 hover:text-blue-800 font-medium",children:"읽음 처리"})]},de.id))})}),l.jsxs("div",{className:"p-6 border-t border-gray-200 space-y-3 flex-shrink-0",children:[l.jsxs("button",{onClick:()=>{U(!1),h("/vacation")},className:"w-full bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 flex items-center justify-center space-x-2",children:[l.jsx(Fo,{size:20}),l.jsx("span",{children:"휴가 관리"})]}),l.jsxs("button",{onClick:()=>{U(!1),h("/stats")},className:"w-full bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 flex items-center justify-center space-x-2",children:[l.jsx(ja,{size:20}),l.jsx("span",{children:"상세 통계"})]})]})]})})]})}const Af=()=>{const h=ms(),{user:i}=ps(),[o,f]=V.useState([]),[x,m]=V.useState(!0),[w,S]=V.useState(!1),[N,b]=V.useState([]),[E,A]=V.useState(""),[O,D]=V.useState(!1),[z,F]=V.useState(!1),[U,ie]=V.useState(!1),[re,L]=V.useState(!1),[Y,ne]=V.useState(!1),[ce,q]=V.useState(null),[Ne,Z]=V.useState(null),[Ke,ge]=V.useState(null),[xe,Ve]=V.useState({name:"",description:"",start_date:"",end_date:""}),[Fe,X]=V.useState([]),[Ge,Ce]=V.useState([]),[he,je]=V.useState(""),[ye,B]=V.useState([]),[te,fe]=V.useState(!1),[Be,nt]=V.useState({checkin_deadline_hour:10,checkout_start_hour:18}),[Ae,mt]=V.useState([]),[Ye,Ue]=V.useState(""),[ct,de]=V.useState(!1);V.useEffect(()=>{if(!i||i.role!=="faculty"){h("/");return}},[i,h]),V.useEffect(()=>{!i||i.role!=="faculty"||Oe()},[i]);const Oe=async()=>{try{if(!await m1()){b(["데이터베이스 연결에 실패했습니다. 관리자에게 문의하세요."]),m(!1);return}await Xe()}catch{b(["애플리케이션 초기화에 실패했습니다."]),m(!1)}},Xe=async()=>{if(i)try{m(!0),b([]);const me=await Vo(i.id);f(me)}catch{b(["그룹 목록을 불러오는데 실패했습니다. 새로고침을 시도해보세요."])}finally{m(!1)}},Nt=async()=>{if(!(!i||xe.name.trim()===""))try{const me={name:xe.name,description:xe.description,faculty_id:i.id,start_date:xe.start_date||void 0,end_date:xe.end_date||void 0};await d1(me),Ve({name:"",description:"",start_date:"",end_date:""}),D(!1),A("그룹이 성공적으로 생성되었습니다!"),setTimeout(()=>A(""),3e3),Xe()}catch{b(["그룹 생성에 실패했습니다."])}},nr=me=>{Z(me),F(!0)},ke=async()=>{if(Ne)try{S(!0),await f1(Ne),F(!1),Z(null),await Xe()}catch{}finally{S(!1)}},ze=()=>{F(!1),Z(null)},We=me=>{h(`/group-attendance/${me}`)},$e=async()=>{if(!(ye.length===0||!ce))try{S(!0),await Ed(ce,ye),ie(!1),B([]),je(""),q(null),await Xe(),A("구성원이 추가되었습니다!"),setTimeout(()=>A(""),3e3)}catch(me){console.error("구성원 추가 실패:",me),b(["구성원 추가에 실패했습니다."]),setTimeout(()=>b([]),5e3)}finally{S(!1)}},bt=Ge.filter(me=>me.name.toLowerCase().includes(he.toLowerCase())||me.user_id.toLowerCase().includes(he.toLowerCase())||me.department.toLowerCase().includes(he.toLowerCase())),Ee=me=>{B(Mt=>Mt.includes(me)?Mt.filter(or=>or!==me):[...Mt,me])},_t=(me,Mt)=>{const or=parseInt(Mt,10);isNaN(or)||or<0||or>23||(nt(Cr=>({...Cr,[me]:or})),mt([]),Ue(""))},sr=()=>{const me=[];return Be.checkin_deadline_hour>=Be.checkout_start_hour&&me.push("출근 마감 시간은 퇴근 시작 시간보다 빨라야 합니다."),(Be.checkin_deadline_hour<6||Be.checkin_deadline_hour>12)&&me.push("출근 마감 시간은 06:00~12:00 사이여야 합니다."),(Be.checkout_start_hour<14||Be.checkout_start_hour>22)&&me.push("퇴근 시작 시간은 14:00~22:00 사이여야 합니다."),me},Dt=async()=>{if(!Ke)return;de(!0),mt([]),Ue("");const me=sr();if(me.length>0){mt(me),de(!1);return}try{await Sd(Ke.id,{checkin_deadline_hour:Be.checkin_deadline_hour,checkout_start_hour:Be.checkout_start_hour}),Ue("출퇴근 시간 설정이 저장되었습니다."),setTimeout(()=>{Ue("")},3e3)}catch(Mt){mt(["설정 저장에 실패했습니다."]),console.error("설정 저장 실패:",Mt)}finally{de(!1)}},Er=me=>`${me.toString().padStart(2,"0")}:00`;return!i||i.role!=="faculty"?null:x?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"그룹 목록을 불러오는 중..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[l.jsx("button",{onClick:()=>h("/faculty-attendance"),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors flex-shrink-0",children:l.jsx(Ua,{className:"w-5 h-5"})}),l.jsx("h1",{className:"text-xl font-semibold text-gray-900 truncate",children:"그룹 관리"})]}),l.jsxs("button",{onClick:()=>D(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-3 py-2 sm:px-4 rounded-lg hover:bg-blue-700 transition-colors flex-shrink-0",children:[l.jsx(yc,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"새 그룹"}),l.jsx("span",{className:"sm:hidden",children:"추가"})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[N.length>0&&l.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Pn,{className:"h-5 w-5 text-red-400"})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-red-800",children:"오류가 발생했습니다"}),l.jsx("div",{className:"mt-2 text-sm text-red-700",children:l.jsx("ul",{className:"list-disc space-y-1 pl-5",children:N.map((me,Mt)=>l.jsx("li",{children:me},Mt))})})]})]})}),E&&l.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("p",{className:"text-sm font-medium text-green-800",children:E})})]})}),l.jsxs("div",{className:"grid grid-cols-3 gap-3 sm:gap-6 mb-6 sm:mb-8",children:[l.jsx("div",{className:"bg-white p-3 sm:p-6 rounded-lg shadow-sm",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"mb-2 sm:mb-0",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"전체 그룹"}),l.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:o.length})]}),l.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-lg self-end sm:self-auto",children:l.jsx(ja,{className:"w-4 h-4 sm:w-6 sm:h-6 text-blue-600"})})]})}),l.jsx("div",{className:"bg-white p-3 sm:p-6 rounded-lg shadow-sm",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"mb-2 sm:mb-0",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"활성 그룹"}),l.jsx("p",{className:"text-lg sm:text-2xl font-bold text-green-600",children:o.filter(me=>me.status==="active").length})]}),l.jsx("div",{className:"p-2 sm:p-3 bg-green-100 rounded-lg self-end sm:self-auto",children:l.jsx(zi,{className:"w-4 h-4 sm:w-6 sm:h-6 text-green-600"})})]})}),l.jsx("div",{className:"bg-white p-3 sm:p-6 rounded-lg shadow-sm",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"mb-2 sm:mb-0",children:[l.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"전체 참여자"}),l.jsx("p",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:o.reduce((me,Mt)=>me+(Mt.memberCount||0),0)})]}),l.jsx("div",{className:"p-2 sm:p-3 bg-purple-100 rounded-lg self-end sm:self-auto",children:l.jsx(Wo,{className:"w-4 h-4 sm:w-6 sm:h-6 text-purple-600"})})]})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[l.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200",children:l.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"그룹 목록"})}),l.jsx("div",{className:"divide-y divide-gray-200",children:o.map(me=>l.jsx("div",{className:"p-4 sm:p-6 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[l.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 truncate",children:me.name}),l.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full flex-shrink-0 ${me.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:me.status==="active"?"활성":"비활성"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-2 break-words",children:me.description}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-1 sm:space-y-0 text-xs sm:text-sm text-gray-500",children:[l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(Wo,{className:"w-3 h-3 sm:w-4 sm:h-4"}),l.jsxs("span",{children:[me.memberCount,"명"]})]}),l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(zi,{className:"w-3 h-3 sm:w-4 sm:h-4"}),l.jsxs("span",{children:["생성일: ",me.created_at.split("T")[0]]})]}),me.start_date&&me.end_date&&l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(zi,{className:"w-3 h-3 sm:w-4 sm:h-4"}),l.jsxs("span",{children:["기간: ",me.start_date," ~ ",me.end_date]})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[l.jsxs("button",{onClick:()=>We(me.id),className:"flex items-center space-x-2 bg-blue-600 text-white px-3 py-2 sm:px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[l.jsx(ja,{className:"w-3 h-3 sm:w-4 sm:h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"출퇴근 관리"}),l.jsx("span",{className:"sm:hidden",children:"관리"})]}),l.jsx("button",{onClick:()=>nr(me.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:l.jsx(B1,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]})},me.id))})]})]}),O&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-md",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-4",children:"새 그룹 생성"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"그룹 이름"}),l.jsx("input",{type:"text",value:xe.name,onChange:me=>Ve({...xe,name:me.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base",placeholder:"그룹 이름을 입력하세요"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),l.jsx("textarea",{value:xe.description,onChange:me=>Ve({...xe,description:me.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base",rows:3,placeholder:"그룹 설명을 입력하세요"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"시작일"}),l.jsx("input",{type:"date",value:xe.start_date,onChange:me=>Ve({...xe,start_date:me.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"종료일"}),l.jsx("input",{type:"date",value:xe.end_date,onChange:me=>Ve({...xe,end_date:me.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base",min:xe.start_date})]})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{D(!1),Ve({name:"",description:"",start_date:"",end_date:""})},className:"w-full sm:w-auto px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm sm:text-base order-2 sm:order-1",children:"취소"}),l.jsx("button",{onClick:Nt,disabled:xe.name.trim()==="",className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors text-sm sm:text-base order-1 sm:order-2",children:"생성"})]})]})})}),U&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"구성원 추가"}),l.jsx("button",{onClick:()=>{ie(!1),B([]),je(""),q(null)},className:"text-gray-400 hover:text-gray-600",children:l.jsx(Pn,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"mb-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(kd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsx("input",{type:"text",value:he,onChange:me=>je(me.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"이름, 학번, 학과로 검색..."})]})}),ye.length>0&&l.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-700",children:[ye.length,"명 선택됨"]})}),l.jsx("div",{className:"border border-gray-200 rounded-lg max-h-96 overflow-y-auto",children:te?l.jsx("div",{className:"p-6 text-center text-gray-500",children:"사용자 목록을 불러오는 중..."}):bt.length===0?l.jsx("div",{className:"p-6 text-center text-gray-500",children:"검색 결과가 없습니다."}):l.jsx("div",{className:"divide-y divide-gray-200",children:bt.map(me=>l.jsx("div",{className:"p-4 hover:bg-gray-50",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:ye.includes(me.id),onChange:()=>Ee(me.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:me.name}),l.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${me.role==="student"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:me.role==="student"?"학생":"교직원"})]}),l.jsxs("p",{className:"text-sm text-gray-600",children:[me.user_id," · ",me.department]})]})]})},me.id))})}),l.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{ie(!1),B([]),je(""),q(null)},className:"w-full sm:w-auto px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm sm:text-base",children:"취소"}),l.jsx("button",{onClick:$e,disabled:ye.length===0||w,className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:w?"추가 중...":ye.length>0?`${ye.length}명 추가`:"추가"})]})]})})}),re&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"그룹 구성원"}),l.jsx("button",{onClick:()=>{L(!1),q(null)},className:"text-gray-400 hover:text-gray-600",children:l.jsx(Pn,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"border border-gray-200 rounded-lg max-h-96 overflow-y-auto",children:Fe.length===0?l.jsx("div",{className:"p-6 text-center text-gray-500",children:"아직 구성원이 없습니다."}):l.jsx("div",{className:"divide-y divide-gray-200",children:Fe.map(me=>l.jsx("div",{className:"p-4",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("div",{className:"flex items-center space-x-3",children:l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:me.user.name}),l.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${me.user.role==="student"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:me.user.role==="student"?"학생":"교직원"})]}),l.jsxs("p",{className:"text-sm text-gray-600",children:[me.user.user_id," · ",me.user.department]}),l.jsxs("p",{className:"text-xs text-gray-500",children:["가입일: ",me.joined_at]})]})})})},me.id))})}),l.jsx("div",{className:"flex justify-end mt-6",children:l.jsx("button",{onClick:()=>{L(!1),q(null)},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm sm:text-base",children:"닫기"})})]})})}),z&&Ne&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm mx-4",children:l.jsxs("div",{className:"p-6 text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.316 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"그룹 삭제"}),l.jsxs("p",{className:"text-sm text-gray-600 mb-6 leading-relaxed",children:["정말로 ",l.jsxs("span",{className:"font-medium text-gray-900",children:['"',o.find(me=>me.id===Ne)?.name,'"']})," 그룹을 삭제하시겠습니까?",l.jsx("br",{}),l.jsx("span",{className:"text-red-600",children:"이 작업은 되돌릴 수 없습니다."})]}),l.jsxs("div",{className:"flex flex-col space-y-3",children:[l.jsx("button",{onClick:ke,className:"w-full py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm",children:"예, 삭제합니다"}),l.jsx("button",{onClick:ze,className:"w-full py-3 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium text-sm",children:"아니오, 취소합니다"})]})]})})}),Y&&Ke&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:[Ke.name," - 출퇴근 시간 설정"]}),l.jsx("button",{onClick:()=>{ne(!1),ge(null)},className:"text-gray-400 hover:text-gray-600",children:l.jsx(Pn,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-4 mb-6",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(yn,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"text-blue-800 flex-1",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"출퇴근 시간 설정 안내"}),l.jsxs("div",{className:"space-y-1 text-sm",children:[l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{children:["출근 마감 시간 전까지는 ",l.jsx("strong",{children:"'출근'"}),"으로 처리"]})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{children:["출근 마감 시간 이후는 ",l.jsx("strong",{children:"'지각'"}),"으로 처리"]})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{children:["퇴근 시작 시간 이후로는 ",l.jsx("strong",{children:"'퇴근'"}),"으로 처리"]})]})]})]})]})}),Ye&&l.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 p-4 rounded-2xl mb-6",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Sn,{size:20}),l.jsx("span",{className:"font-medium",children:Ye})]})}),Ae.length>0&&l.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-2xl mb-6",children:[l.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[l.jsx(yn,{size:20,className:"mt-0.5 flex-shrink-0"}),l.jsx("span",{className:"font-semibold",children:"설정 오류"})]}),l.jsx("ul",{className:"text-sm space-y-2 ml-8",children:Ae.map((me,Mt)=>l.jsxs("li",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full mt-2 flex-shrink-0"}),l.jsx("span",{className:"leading-relaxed break-words",children:me})]},Mt))})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"출근 마감 시간"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[l.jsx("select",{value:Be.checkin_deadline_hour,onChange:me=>_t("checkin_deadline_hour",me.target.value),disabled:ct,className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-medium w-full sm:w-auto disabled:opacity-50",children:Array.from({length:24},(me,Mt)=>l.jsx("option",{value:Mt,children:Er(Mt)},Mt))}),l.jsx("div",{className:"flex-1 bg-green-50 px-4 py-3 rounded-xl min-w-0",children:l.jsxs("span",{className:"text-green-700 font-medium text-sm sm:text-base leading-relaxed break-words",children:[Er(Be.checkin_deadline_hour)," 전까지는 정상 출근으로 처리됩니다"]})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"퇴근 시작 시간"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[l.jsx("select",{value:Be.checkout_start_hour,onChange:me=>_t("checkout_start_hour",me.target.value),disabled:ct,className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-medium w-full sm:w-auto disabled:opacity-50",children:Array.from({length:24},(me,Mt)=>l.jsx("option",{value:Mt,children:Er(Mt)},Mt))}),l.jsx("div",{className:"flex-1 bg-blue-50 px-4 py-3 rounded-xl min-w-0",children:l.jsxs("span",{className:"text-blue-700 font-medium text-sm sm:text-base leading-relaxed break-words",children:[Er(Be.checkout_start_hour)," 이후로는 퇴근으로 처리됩니다"]})})]})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 mt-8",children:[l.jsx("button",{onClick:()=>{ne(!1),ge(null)},className:"w-full sm:w-auto px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm sm:text-base",children:"취소"}),l.jsxs("button",{onClick:Dt,disabled:ct,className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors text-sm sm:text-base flex items-center justify-center space-x-2",children:[ct&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:ct?"저장 중...":"저장"})]})]})]})})})]})},Y2=({percentage:h,size:i=80,strokeWidth:o=8,color:f="#059669"})=>{const x=(i-o)/2,m=x*2*Math.PI,w=m-h/100*m;return l.jsxs("div",{className:"relative",style:{width:i,height:i},children:[l.jsxs("svg",{width:i,height:i,className:"transform -rotate-90",children:[l.jsx("circle",{cx:i/2,cy:i/2,r:x,stroke:"#e5e7eb",strokeWidth:o,fill:"transparent"}),l.jsx("circle",{cx:i/2,cy:i/2,r:x,stroke:f,strokeWidth:o,fill:"transparent",strokeDasharray:m,strokeDashoffset:w,className:"transition-all duration-1000 ease-out"})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[Math.round(h),"%"]})})]})},kf=()=>{const h=ms(),{user:i}=ps(),{groupId:o}=Ox(),[f,x]=V.useState(!0),[m,w]=V.useState(null),[S,N]=V.useState([]),[b,E]=V.useState("dashboard"),[A,O]=V.useState("overview"),[D,z]=V.useState(""),[F,U]=V.useState(null),[ie,re]=V.useState(!1),[L,Y]=V.useState([]),[ne,ce]=V.useState({checkin_deadline_hour:10,checkout_start_hour:18}),[q,Ne]=V.useState([]),[Z,Ke]=V.useState(""),[ge,xe]=V.useState(!1),[Ve,Fe]=V.useState(!1),[X,Ge]=V.useState([]),[Ce,he]=V.useState(""),[je,ye]=V.useState([]),[B,te]=V.useState(!1),[fe,Be]=V.useState({total:0,present:0,late:0,absent:0,vacation:0,attendanceRate:0}),nt=[],[Ae,mt]=V.useState([]),[Ye,Ue]=V.useState([]);V.useEffect(()=>{if(!i){h("/");return}},[i,h]),V.useEffect(()=>{!i||!o||ct()},[i,o]),V.useEffect(()=>{m&&S.length>0&&(async()=>{const Le=await Ee(D||"week-1");Ue(Le)})()},[m,S,D]),V.useEffect(()=>{A==="overview"&&m&&o&&de(o)},[A,m,o]),V.useEffect(()=>{A==="details"&&m&&S.length>0&&(async()=>await Dt(D))()},[A,m,S,D]);const ct=async()=>{if(!(!i||!o))try{x(!0);const ue=await h1(o);if(!ue){h("/group-management");return}if(w(ue),i.role!=="faculty"||ue.faculty_id!==i.id){h("/");return}const Se=await ko(o);N(Se),await de(o),await Oe(o),await Xe(o)}catch(ue){console.error("데이터 로드 실패:",ue)}finally{x(!1)}},de=async ue=>{try{const Se=Ln(),Le=Se.toISOString().split("T")[0];let Me=S.length;if(Me===0){const we=await ko(ue);N(we),Me=we.length}const kt=new Date(Se);kt.setHours(0,0,0,0);const pt=new Date(Se);pt.setHours(23,59,59,999);const{data:St,error:Ct}=await He.from("attendance_logs").select("user_id, status, scan_type, scan_time").eq("group_id",ue).eq("scan_type","checkin").gte("scan_time",kt.toISOString()).lte("scan_time",pt.toISOString());if(Ct){console.error("오늘 출석 데이터 조회 실패:",Ct);return}const{count:Qt}=await He.from("vacation_requests").select("*",{count:"exact"}).eq("group_id",ue).eq("status","approved").lte("start_date",Le).gte("end_date",Le),Ft=(St||[]).filter(we=>we.status==="present").length,gt=(St||[]).filter(we=>we.status==="late").length,ut=Math.max(0,Me-Ft-gt-(Qt||0)),Pt=Me>0?(Ft+gt)/Me*100:0,Wt={total:Me,present:Ft,late:gt,absent:ut,vacation:Qt||0,attendanceRate:Math.round(Pt*10)/10};Be(Wt)}catch(Se){console.error("오늘 출석 현황 로드 실패:",Se)}},Oe=async ue=>{try{const Se=await k1(ue,0);mt([{day:"월",present:0,late:0,absent:0},{day:"화",present:0,late:0,absent:0},{day:"수",present:0,late:0,absent:0},{day:"목",present:0,late:0,absent:0},{day:"금",present:0,late:0,absent:0}]);const kt=await Ee(D||"week-1");Ue(kt)}catch(Se){console.error("주간 통계 로드 실패:",Se)}},Xe=async ue=>{try{const Se=await Cd(ue);Se&&ce({checkin_deadline_hour:Se.checkin_deadline_hour,checkout_start_hour:Se.checkout_start_hour})}catch(Se){console.error("근무 시간 설정 로드 실패:",Se)}},Nt=ue=>{const Se=ue||D;if(!S||S.length===0)return{월:[{name:"샘플 학생",dept:"컴퓨터공학과",checkin:"09:00",checkout:"18:00",note:"정상출근"}],화:[{name:"샘플 학생",dept:"컴퓨터공학과",checkin:"09:15",checkout:"18:00",note:"지각"}],수:[{name:"샘플 학생",dept:"컴퓨터공학과",checkin:"09:00",checkout:"18:00",note:"정상출근"}],목:[{name:"샘플 학생",dept:"컴퓨터공학과",checkin:"",checkout:"",note:"결근"}],금:[{name:"샘플 학생",dept:"컴퓨터공학과",checkin:"09:00",checkout:"18:00",note:"정상출근"}]};const Me=(Ft=>{const ut=(parseInt(Ft.split("-")[1])||1)%3;return[{statusPatterns:["정상출근","지각","정상출근","결근","정상출근"],checkinTimes:["09:00","09:15","08:55","","09:05"],checkoutTimes:["18:30","18:00","18:25","","18:15"]},{statusPatterns:["지각","지각","정상출근","지각","정상출근"],checkinTimes:["09:20","09:30","08:50","09:45","09:00"],checkoutTimes:["18:10","18:20","18:30","18:00","18:25"]},{statusPatterns:["정상출근","결근","정상출근","결근","지각"],checkinTimes:["09:00","","08:55","","09:10"],checkoutTimes:["18:15","","18:20","","18:05"]}][ut]})(Se),kt=["월","화","수","목","금"],{statusPatterns:pt,checkinTimes:St,checkoutTimes:Ct}=Me,Qt={};return kt.forEach((Ft,gt)=>{Qt[Ft]=S.map((ut,Pt)=>{const Wt=(gt+Pt)%pt.length,we=pt[Wt];return{name:ut.name,dept:ut.department||"미지정",checkin:we==="결근"?"":St[Wt],checkout:we==="결근"?"":Ct[Wt],note:we}})}),Qt},nr=(ue=0)=>{if(!m?.start_date)return{weekNumber:1,label:"1주차",dateRange:"",fullLabel:"1주차"};const Se=new Date(m.start_date),Le=Ln(),Me=gt=>{const ut=gt.getMonth()+1,Pt=gt.getDate();return`${ut}월 ${Pt}일`},kt=Le.getTime()-Se.getTime(),pt=Math.floor(kt/(1e3*60*60*24)),St=Math.max(1,Math.floor(pt/7)+1),Ct=Math.max(1,St-ue);let Qt,Ft;if(Ct===1){Qt=new Date(Se);const gt=Qt.getDay(),ut=gt<=5?5-gt:5+(7-gt);Ft=new Date(Qt.getTime()+ut*24*60*60*1e3)}else{const gt=Se.getDay();let ut;gt===1?ut=0:gt===0?ut=1:ut=-(gt-1);const Pt=new Date(Se.getTime()+ut*24*60*60*1e3);Qt=new Date(Pt.getTime()+(Ct-1)*7*24*60*60*1e3),Ft=new Date(Qt.getTime()+4*24*60*60*1e3)}return{weekNumber:Ct,label:ue===0?"이번주":ue===1?"지난주":`${Ct}주차`,dateRange:`${Me(Qt)} ~ ${Me(Ft)}`,fullLabel:`${Ct}주차 (${Me(Qt)} ~ ${Me(Ft)})`}},ke=()=>nr(0).weekNumber,ze=()=>{const ue=ke(),Se=[];for(let Le=0;Le<ue;Le++){const Me=nr(Le);Me.weekNumber>=1&&Se.push({value:`week-${Me.weekNumber}`,...Me})}return Se.sort((Le,Me)=>Me.weekNumber-Le.weekNumber)};vr.useEffect(()=>{if(m?.start_date){const ue=ze();if(Y(ue),ue.length>0&&!D){const Se=ue[0].value;z(Se)}}},[m]),vr.useEffect(()=>{D&&o&&S.length>0&&(async()=>{try{const Se=await Ee(D);Ue(Se)}catch(Se){console.error("차트 데이터 업데이트 실패:",Se)}})()},[D,o,S]);const We=()=>{const ue={};return L.forEach(Se=>{ue[Se.value]={label:Se.label,dateRange:Se.dateRange,stackData:[],dayDetails:Nt(),studentData:[]}}),ue},$e=vr.useMemo(()=>We(),[L]);(()=>{if(!D||!L.find(Se=>Se.value===D))return{label:"데이터 없음",dateRange:"",stackData:[],dayDetails:{},studentData:[]};const ue=L.find(Se=>Se.value===D);return{label:ue?.label||"",dateRange:ue?.dateRange||"",stackData:[],dayDetails:Nt(D),studentData:[]}})();const Ee=async ue=>{const Se=ue||D;if(!o||!m?.start_date||!S||S.length===0)return[{day:"월",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"화",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"수",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"목",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"금",출근:0,지각:0,결근:0,기타:0,noData:!0}];try{const{data:Le,error:Me}=await He.from("attendance_logs").select("user_id, group_id, status, scan_time, scan_type").eq("group_id",o).order("scan_time",{ascending:!1}).limit(20);if(Me)console.error("전체 데이터 조회 실패:",Me);else if(Le&&Le.length>0){const kt=Le.reduce((St,Ct)=>(St[Ct.status]=(St[Ct.status]||0)+1,St),{}),pt=Le.reduce((St,Ct)=>(St[Ct.scan_type]=(St[Ct.scan_type]||0)+1,St),{})}}catch(Le){console.error("DB 조회 중 에러:",Le)}try{const Le=parseInt(Se.split("-")[1])||1,Me=new Date(m.start_date);Me.setHours(0,0,0,0);const kt=7*24*60*60*1e3;let pt,St;if(Le===1){pt=new Date(Me);const we=Me.getDay();if(we<=5){const pr=5-we;St=new Date(Me.getTime()+pr*24*60*60*1e3)}else{const pr=12-we;St=new Date(Me.getTime()+pr*24*60*60*1e3)}}else{const we=Me.getDay();let pr;if(we<=5){const zt=8-we;pr=new Date(Me.getTime()+zt*24*60*60*1e3)}else{const zt=8-we;pr=new Date(Me.getTime()+zt*24*60*60*1e3)}const en=Le-2;pt=new Date(pr.getTime()+en*kt),St=new Date(pt.getTime()+4*24*60*60*1e3)}St.setHours(23,59,59,999);const{data:Ct,error:Qt}=await He.from("attendance_logs").select("user_id, status, scan_time, scan_type").eq("group_id",o).gte("scan_time",pt.toISOString()).lte("scan_time",St.toISOString()).order("scan_time",{ascending:!0});if(Qt)throw console.error("DB 조회 실패:",Qt),Qt;const Ft=Ct?.filter(we=>we.scan_type==="checkin")||[],gt=[],ut=["월","화","수","목","금"],Pt=new Date;Pt.setHours(0,0,0,0);const Wt=new Date(St);if(Le===1){const we=Me.getDay(),pr=we===0?6:we-1;for(let en=0;en<5;en++){const zt=ut[en];if(en<pr)gt.push({day:zt,출근:0,지각:0,결근:0,기타:0,noData:!0,isEmpty:!0});else{const Gt=en-pr,$r=new Date(Me.getTime()+Gt*24*60*60*1e3),Xr=$r>Pt,Jt=$r>Wt,Sr={day:zt,출근:0,지각:0,결근:0,기타:0,noData:Xr||Jt};if(!Xr&&!Jt){Ft.filter(tr=>{const $t=new Date(tr.scan_time);return $t.setHours(0,0,0,0),$t.getTime()===$r.getTime()}).forEach(tr=>{switch(tr.status){case"present":Sr.출근++;break;case"late":Sr.지각++;break;case"absent":Sr.결근++;break;default:Sr.기타++;break}});const Lr=Sr.출근+Sr.지각+Sr.기타;Lr<S.length&&(Sr.결근=S.length-Lr)}gt.push(Sr)}}}else for(let we=0;we<5;we++){const pr=new Date(pt.getTime()+we*24*60*60*1e3),en=ut[we],zt=pr>Pt,Gt={day:en,출근:0,지각:0,결근:0,기타:0,noData:zt};if(!zt){Ft.filter(Jt=>{const Sr=new Date(Jt.scan_time);return Sr.setHours(0,0,0,0),Sr.getTime()===pr.getTime()}).forEach(Jt=>{switch(Jt.status){case"present":Gt.출근++;break;case"late":Gt.지각++;break;case"absent":Gt.결근++;break;default:Gt.기타++;break}});const Xr=Gt.출근+Gt.지각+Gt.기타;Xr<S.length&&(Gt.결근=S.length-Xr)}gt.push(Gt)}return gt}catch{return[{day:"월",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"화",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"수",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"목",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"금",출근:0,지각:0,결근:0,기타:0,noData:!0}]}},[_t,sr]=V.useState([]),Dt=async ue=>{if(!S||S.length===0||!o)return[];const Se=ue||D||"week-1";try{const Le=parseInt(Se.split("-")[1])||1,Me=new Date(m?.start_date||new Date);Me.setHours(0,0,0,0);const kt=7*24*60*60*1e3;let pt,St;if(Le===1){pt=new Date(Me);const gt=Me.getDay();if(gt<=5){const ut=5-gt;St=new Date(Me.getTime()+ut*24*60*60*1e3)}else{const ut=12-gt;St=new Date(Me.getTime()+ut*24*60*60*1e3)}}else{const gt=Me.getDay();let ut;if(gt<=5){const Wt=8-gt;ut=new Date(Me.getTime()+Wt*24*60*60*1e3)}else{const Wt=8-gt;ut=new Date(Me.getTime()+Wt*24*60*60*1e3)}const Pt=Le-2;pt=new Date(ut.getTime()+Pt*kt),St=new Date(pt.getTime()+4*24*60*60*1e3)}St.setHours(23,59,59,999);const{data:Ct,error:Qt}=await He.from("attendance_logs").select("user_id, status, scan_time, scan_type").eq("group_id",o).eq("scan_type","checkin").gte("scan_time",pt.toISOString()).lte("scan_time",St.toISOString()).order("scan_time",{ascending:!0});if(Qt)throw console.error("주간 출석 데이터 조회 실패:",Qt),Qt;const Ft=S.map(gt=>{const ut=["월","화","수","목","금"],Pt=[];let Wt=0,we=0;const pr=new Date(St);if(Le===1){const zt=Me.getDay(),Gt=zt===0?6:zt-1;for(let $r=0;$r<5;$r++)if($r<Gt)Pt.push("");else{const Xr=$r-Gt,Jt=new Date(Me.getTime()+Xr*24*60*60*1e3),Sr=Jt>new Date,gi=Jt>pr;if(Sr||gi)Pt.push("");else{we++;const Lr=(Ct||[]).find(tr=>{const $t=new Date(tr.scan_time);return $t.setHours(0,0,0,0),$t.getTime()===Jt.getTime()&&tr.user_id===gt.id});if(Lr){const tr=Lr.status==="late"?"지각":"출근";Pt.push(tr),tr==="출근"&&Wt++}else Pt.push("결근")}}}else for(let zt=0;zt<5;zt++){const Gt=new Date(pt.getTime()+zt*24*60*60*1e3);if(Gt>new Date)Pt.push("");else{we++;const Xr=(Ct||[]).find(Jt=>{const Sr=new Date(Jt.scan_time);return Sr.setHours(0,0,0,0),Sr.getTime()===Gt.getTime()&&Jt.user_id===gt.id});if(Xr){const Jt=Xr.status==="late"?"지각":"출근";Pt.push(Jt),Jt==="출근"&&Wt++}else Pt.push("결근")}}const en=we>0?Math.round(Wt/we*100):0;return{name:gt.name,id:gt.user_id||`user_${gt.id}`,dept:gt.department||"미지정",attendance:Pt,rate:`${en}%`}});return sr(Ft),Ft}catch(Le){return console.error("학생별 출석 현황 데이터 생성 실패:",Le),[]}},Er=ue=>{switch(ue){case"checkin":return"🟢";case"checkout":return"🔵";case"late":return"🟡";case"vacation":return"🟣";default:return"⚪"}},me=({data:ue})=>{const Se=Math.max(S.length,1),Le=160;return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[l.jsx("div",{className:"flex items-end justify-between h-50 space-x-2",children:ue.map((Me,kt)=>{const pt=Me.출근+Me.지각+Me.결근+Me.기타;if(Me.isEmpty||Me.noData)return l.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[l.jsx("div",{className:"w-full max-w-12 h-40 bg-gray-50 rounded-lg flex items-end",children:l.jsx("div",{className:"w-full h-1 bg-gray-200 rounded"})}),l.jsx("span",{className:"text-xs text-gray-400 mt-2",children:Me.day}),l.jsxs("span",{className:"text-xs font-medium text-gray-400 mt-1",children:[S.length,"명"]})]},kt);const Ct=Me.출근/Se*Le,Qt=Me.지각/Se*Le,Ft=Me.결근/Se*Le,gt=Me.기타/Se*Le;return l.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[l.jsxs("div",{className:"w-full max-w-12 h-40 flex flex-col-reverse rounded-lg overflow-hidden shadow-sm",children:[Me.출근>0&&l.jsx("div",{className:"w-full bg-green-300",style:{height:`${Ct}px`}}),Me.지각>0&&l.jsx("div",{className:"w-full bg-yellow-300",style:{height:`${Qt}px`}}),Me.결근>0&&l.jsx("div",{className:"w-full bg-red-300",style:{height:`${Ft}px`}}),Me.기타>0&&l.jsx("div",{className:"w-full bg-purple-300",style:{height:`${gt}px`}}),pt===0&&l.jsx("div",{className:"w-full h-1 bg-gray-200 rounded"})]}),l.jsx("span",{className:"text-xs text-gray-600 mt-2",children:Me.day}),l.jsxs("span",{className:`text-xs font-medium mt-1 ${pt>0?"text-gray-800":"text-gray-600"}`,children:[pt>0?pt:S.length,"명"]})]},kt)})}),l.jsxs("div",{className:"flex justify-center space-x-6 mt-2 text-sm",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-green-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:"출근"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-yellow-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:"지각"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-red-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:"결근"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-purple-300 rounded"}),l.jsx("span",{className:"text-gray-600",children:"기타"})]})]})]})},Mt=({students:ue})=>{const Se=Me=>{switch(Me){case"출근":return"bg-green-500";case"지각":return"bg-yellow-400";case"결근":return"bg-red-500";case"기타":return"bg-purple-500";default:return"bg-gray-300"}},Le=Me=>{switch(Me){case"출근":return"✓";case"지각":return"!";case"결근":return"✗";case"기타":return"V";default:return"?"}};return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[l.jsx("div",{className:"bg-gray-50 px-3 sm:px-4 py-2 sm:py-3 border-b border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-12 gap-1 sm:gap-2 items-center",children:[l.jsx("div",{className:"col-span-4 sm:col-span-3",children:l.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"학생 정보"})}),l.jsxs("div",{className:"col-span-6 sm:col-span-7 grid grid-cols-5 gap-1 sm:gap-2",children:[l.jsx("div",{className:"text-center",children:l.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"월"})}),l.jsx("div",{className:"text-center",children:l.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"화"})}),l.jsx("div",{className:"text-center",children:l.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"수"})}),l.jsx("div",{className:"text-center",children:l.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"목"})}),l.jsx("div",{className:"text-center",children:l.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"금"})})]}),l.jsx("div",{className:"col-span-2 text-center",children:l.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"출석률"})})]})}),l.jsx("div",{className:"divide-y divide-gray-100",children:ue.length===0?l.jsx("div",{className:"px-3 sm:px-4 py-8 text-center",children:l.jsx("p",{className:"text-gray-500",children:"학생별 출석 데이터를 불러오는 중..."})}):ue.map((Me,kt)=>l.jsx("div",{className:"px-3 sm:px-4 py-2 sm:py-3 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"grid grid-cols-12 gap-1 sm:gap-2 items-center",children:[l.jsx("div",{className:"col-span-4 sm:col-span-3",children:l.jsxs("div",{className:"min-w-0",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("h4",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:Me.name}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-1 text-xs text-gray-500",children:[l.jsx("span",{className:"truncate",children:Me.id}),l.jsx("span",{children:"•"}),l.jsx("span",{className:"truncate",children:Me.dept})]})]}),l.jsx("div",{className:"sm:hidden",children:l.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[Me.id," • ",Me.dept]})})]})}),l.jsx("div",{className:"col-span-6 sm:col-span-7 grid grid-cols-5 gap-1 sm:gap-2",children:Me.attendance.map((pt,St)=>l.jsx("div",{className:"flex justify-center",children:l.jsxs("div",{className:`w-6 h-6 sm:w-8 sm:h-8 rounded-md sm:rounded-lg ${Se(pt)} flex items-center justify-center text-white text-xs font-medium shadow-sm`,children:[l.jsx("span",{className:"hidden sm:inline",children:Le(pt)}),l.jsx("span",{className:"sm:hidden text-xs",children:pt==="출근"?"✓":pt==="지각"?"!":pt==="결근"?"✗":pt==="기타"?"V":"?"})]})},St))}),l.jsx("div",{className:"col-span-2 text-center",children:l.jsx("span",{className:`text-xs sm:text-sm font-bold ${parseFloat(Me.rate.replace("%",""))>=90?"text-green-600":parseFloat(Me.rate.replace("%",""))>=80?"text-yellow-600":"text-red-600"}`,children:Me.rate})})]})},kt))}),l.jsx("div",{className:"bg-gray-50 px-3 sm:px-4 py-3 border-t border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap gap-2 sm:gap-3 text-xs",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),l.jsx("span",{className:"text-gray-600",children:"출근"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded"}),l.jsx("span",{className:"text-gray-600",children:"지각"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),l.jsx("span",{className:"text-gray-600",children:"조기퇴근"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),l.jsx("span",{className:"text-gray-600",children:"휴가"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),l.jsx("span",{className:"text-gray-600",children:"결근"})]})]})})]})},or=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"오늘 현황"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[l.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"출석"}),l.jsx("p",{className:"text-2xl font-bold text-green-600",children:fe.present})]}),l.jsx(Wo,{className:"w-8 h-8 text-green-600"})]})}),l.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"지각"}),l.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:fe.late})]}),l.jsx(hi,{className:"w-8 h-8 text-yellow-600"})]})}),l.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"결근"}),l.jsx("p",{className:"text-2xl font-bold text-red-600",children:fe.absent})]}),l.jsx(Wo,{className:"w-8 h-8 text-red-600"})]})}),l.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"휴가"}),l.jsx("p",{className:"text-2xl font-bold text-purple-600",children:fe.vacation})]}),l.jsx(zi,{className:"w-8 h-8 text-purple-600"})]})})]}),l.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx(Y2,{percentage:fe.attendanceRate}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"전체 출석률"}),l.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[fe.attendanceRate,"%"]}),l.jsxs("p",{className:"text-sm text-gray-500",children:[fe.present+fe.late,"/",fe.total,"명 출석"]})]})]}),l.jsxs("div",{className:"flex-1 ml-8",children:[l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l.jsx("div",{className:"bg-green-600 h-3 rounded-full transition-all duration-1000",style:{width:`${(fe.present+fe.late)/fe.total*100}%`}})}),l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["실시간 출석률: ",Math.round((fe.present+fe.late)/fe.total*100),"%"]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"실시간 활동"}),l.jsx("div",{className:"space-y-3",children:nt.map((ue,Se)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-lg",children:Er(ue.type)}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:ue.name}),l.jsx("p",{className:"text-sm text-gray-600",children:ue.dept})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"font-medium text-gray-900",children:ue.action}),l.jsx("p",{className:"text-sm text-gray-500",children:ue.time})]})]},Se))})]})]}),Cr=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-2xl shadow-sm",children:l.jsxs("div",{className:"flex min-w-0",children:[l.jsxs("button",{onClick:()=>O("overview"),className:`flex-1 px-4 py-4 text-center flex items-center justify-center space-x-2 transition-colors min-w-0 ${A==="overview"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[l.jsx(u2,{className:"w-5 h-5 flex-shrink-0"}),l.jsx("span",{className:"font-medium text-sm whitespace-nowrap",children:"전체 현황"})]}),l.jsxs("button",{onClick:()=>O("trends"),className:`flex-1 px-4 py-4 text-center flex items-center justify-center space-x-2 transition-colors min-w-0 ${A==="trends"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[l.jsx(F1,{className:"w-5 h-5 flex-shrink-0"}),l.jsx("span",{className:"font-medium text-sm whitespace-nowrap",children:"주간 추이"})]}),l.jsxs("button",{onClick:()=>O("details"),className:`flex-1 px-4 py-4 text-center flex items-center justify-center space-x-2 transition-colors min-w-0 ${A==="details"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[l.jsx(di,{className:"w-5 h-5 flex-shrink-0"}),l.jsx("span",{className:"font-medium text-sm whitespace-nowrap",children:"학생별 상세"})]})]})}),A==="overview"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6 text-center",children:"전체 출석률"}),l.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-center space-y-6 lg:space-y-0 lg:space-x-8 px-4",children:[l.jsxs("div",{className:"relative flex-shrink-0",children:[l.jsxs("svg",{width:"180",height:"180",className:"transform -rotate-90",children:[l.jsx("circle",{cx:"90",cy:"90",r:"75",stroke:"#e5e7eb",strokeWidth:"10",fill:"transparent"}),fe.present>0&&(fe.total>0||S.length>0)&&l.jsx("circle",{cx:"90",cy:"90",r:"75",stroke:"#86efac",strokeWidth:"10",fill:"transparent",strokeDasharray:`${fe.present/(fe.total>0?fe.total:S.length)*471.2} 471.2`,strokeDashoffset:"0",className:"transition-all duration-1000 ease-out"}),fe.late>0&&(fe.total>0||S.length>0)&&l.jsx("circle",{cx:"90",cy:"90",r:"75",stroke:"#fde047",strokeWidth:"10",fill:"transparent",strokeDasharray:`${fe.late/(fe.total>0?fe.total:S.length)*471.2} 471.2`,strokeDashoffset:`-${fe.present/(fe.total>0?fe.total:S.length)*471.2}`,className:"transition-all duration-1000 ease-out"}),fe.absent>0&&(fe.total>0||S.length>0)&&l.jsx("circle",{cx:"90",cy:"90",r:"75",stroke:"#fca5a5",strokeWidth:"10",fill:"transparent",strokeDasharray:`${fe.absent/(fe.total>0?fe.total:S.length)*471.2} 471.2`,strokeDashoffset:`-${(fe.present+fe.late)/(fe.total>0?fe.total:S.length)*471.2}`,className:"transition-all duration-1000 ease-out"}),fe.vacation>0&&(fe.total>0||S.length>0)&&l.jsx("circle",{cx:"90",cy:"90",r:"75",stroke:"#c4b5fd",strokeWidth:"10",fill:"transparent",strokeDasharray:`${fe.vacation/(fe.total>0?fe.total:S.length)*471.2} 471.2`,strokeDashoffset:`-${(fe.present+fe.late+fe.absent)/(fe.total>0?fe.total:S.length)*471.2}`,className:"transition-all duration-1000 ease-out"})]}),l.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[l.jsxs("span",{className:"text-3xl font-bold text-gray-800",children:[fe.total>0?fe.total:S.length,"명"]}),l.jsx("span",{className:"text-sm text-gray-600",children:"전체 학생"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full max-w-xs",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-green-300 rounded"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700",children:"출석"}),l.jsxs("div",{className:"text-lg font-bold text-green-600",children:[fe.present,"명"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-yellow-300 rounded"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700",children:"지각"}),l.jsxs("div",{className:"text-lg font-bold text-yellow-600",children:[fe.late,"명"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-red-300 rounded"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700",children:"결석"}),l.jsxs("div",{className:"text-lg font-bold text-red-600",children:[fe.absent,"명"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-purple-300 rounded"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700",children:"휴가"}),l.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[fe.vacation,"명"]})]})]})]})]})]})}),A==="trends"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"기간 선택"}),l.jsx("select",{value:D,onChange:async ue=>{const Se=ue.target.value;z(Se);try{const Le=await Ee(Se);Ue(Le)}catch(Le){console.error("trends 탭 주차 변경 시 차트 데이터 업데이트 실패:",Le)}},className:"border border-gray-200 rounded-lg px-4 py-2 text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:L.map(ue=>l.jsx("option",{value:ue.value,children:ue.fullLabel},ue.value))})]})}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"주간 출석 현황 (명 단위)"}),l.jsx(me,{data:Ye.length>0?Ye:[{day:"월",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"화",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"수",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"목",출근:0,지각:0,결근:0,기타:0,noData:!0},{day:"금",출근:0,지각:0,결근:0,기타:0,noData:!0}]})]})]}),A==="details"&&l.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-sm p-4",children:l.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[l.jsx("div",{className:"flex-1",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"학생별 출석 현황"})}),l.jsx("div",{className:"w-full sm:w-auto",children:l.jsx("select",{value:D,onChange:async ue=>{const Se=ue.target.value;z(Se);try{const Le=await Ee(Se);Ue(Le),await Dt(Se)}catch(Le){console.error("주차 변경 시 데이터 업데이트 실패:",Le)}},className:"w-full sm:w-auto border border-gray-200 rounded-lg px-3 py-2 sm:px-4 text-sm font-medium focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:L.map(ue=>l.jsx("option",{value:ue.value,children:ue.fullLabel},ue.value))})})]})}),l.jsx(Mt,{students:_t})]})]}),ls=()=>l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"구성원 관리"}),l.jsxs("button",{onClick:Bn,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(y2,{className:"w-4 h-4"}),l.jsx("span",{children:"구성원 추가"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("h3",{className:"text-md font-medium text-gray-700",children:["현재 구성원 (",S.length,"명)"]})}),S.length===0?l.jsx("p",{className:"text-gray-500 text-center py-8",children:"아직 구성원이 없습니다."}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(ue=>l.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Uo,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:ue.name}),l.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${ue.role==="student"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:ue.role==="student"?"학생":"교직원"})]}),l.jsxs("p",{className:"text-xs text-gray-600 truncate",children:[ue.user_id," · ",ue.department]})]})]}),l.jsx("button",{onClick:()=>Pe(ue.id,ue.name),className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors",title:"구성원 삭제",children:l.jsx(Pn,{className:"w-4 h-4"})})]})},ue.id))})]})]}),Bn=()=>{o&&(Fe(!0),Wa(o))},Wa=async ue=>{te(!0);try{const Se=await x1(ue);Ge(Se)}catch(Se){console.error("사용자 목록 로드 실패:",Se),Ne(["사용자 목록을 불러오는데 실패했습니다."])}finally{te(!1)}},hr=async()=>{if(!(je.length===0||!o))try{xe(!0),await Ed(o,je),Fe(!1),ye([]),he("");const ue=await ko(o);N(ue),Ke("구성원이 추가되었습니다!"),setTimeout(()=>Ke(""),3e3)}catch(ue){console.error("구성원 추가 실패:",ue),Ne(["구성원 추가에 실패했습니다."])}finally{xe(!1)}},Pe=async(ue,Se)=>{if(o&&confirm(`${Se}님을 그룹에서 제거하시겠습니까?

이 작업은 되돌릴 수 없습니다.`))try{xe(!0),await g1(o,ue);const Le=await ko(o);N(Le),Ke(`${Se}님이 그룹에서 제거되었습니다.`),setTimeout(()=>Ke(""),3e3)}catch(Le){console.error("구성원 제거 실패:",Le),Ne(["구성원 제거에 실패했습니다."])}finally{xe(!1)}},mr=X.filter(ue=>ue.name.toLowerCase().includes(Ce.toLowerCase())||ue.user_id.toLowerCase().includes(Ce.toLowerCase())||ue.department.toLowerCase().includes(Ce.toLowerCase())),Ut=ue=>{ye(Se=>Se.includes(ue)?Se.filter(Le=>Le!==ue):[...Se,ue])},Zt=(ue,Se)=>{const Le=parseInt(Se,10);isNaN(Le)||Le<0||Le>23||(ce(Me=>({...Me,[ue]:Le})),Ne([]),Ke(""))},qn=()=>{const ue=[];return ne.checkin_deadline_hour>=ne.checkout_start_hour&&ue.push("출근 마감 시간은 퇴근 시작 시간보다 빨라야 합니다."),(ne.checkin_deadline_hour<6||ne.checkin_deadline_hour>12)&&ue.push("출근 마감 시간은 06:00~12:00 사이여야 합니다."),(ne.checkout_start_hour<14||ne.checkout_start_hour>22)&&ue.push("퇴근 시작 시간은 14:00~22:00 사이여야 합니다."),ue},ys=async()=>{if(!o)return;xe(!0),Ne([]),Ke("");const ue=qn();if(ue.length>0){Ne(ue),xe(!1);return}try{await Sd(o,{checkin_deadline_hour:ne.checkin_deadline_hour,checkout_start_hour:ne.checkout_start_hour}),Ke("출퇴근 시간 설정이 저장되었습니다."),setTimeout(()=>{Ke("")},3e3)}catch(Se){Ne(["설정 저장에 실패했습니다."]),console.error("설정 저장 실패:",Se)}finally{xe(!1)}},Kn=ue=>`${ue.toString().padStart(2,"0")}:00`,Et=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(yn,{className:"w-6 h-6 text-blue-600 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"text-blue-800 flex-1",children:[l.jsx("h3",{className:"font-semibold mb-3",children:"출퇴근 시간 설정 안내"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{className:"leading-relaxed",children:["출근 마감 시간 전까지는 ",l.jsx("strong",{children:"'출근'"}),"으로 처리됩니다"]})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{className:"leading-relaxed",children:["출근 마감 시간 이후는 ",l.jsx("strong",{children:"'지각'"}),"으로 처리됩니다"]})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{className:"leading-relaxed",children:["퇴근 시작 시간 이후로는 ",l.jsx("strong",{children:"'퇴근'"}),"으로 처리됩니다"]})]})]})]})]})}),Z&&l.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 p-4 rounded-2xl",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Sn,{size:20}),l.jsx("span",{className:"font-medium",children:Z})]})}),q.length>0&&l.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-2xl",children:[l.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[l.jsx(yn,{size:20,className:"mt-0.5 flex-shrink-0"}),l.jsx("span",{className:"font-semibold",children:"설정 오류"})]}),l.jsx("ul",{className:"text-sm space-y-2 ml-8",children:q.map((ue,Se)=>l.jsxs("li",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full mt-2 flex-shrink-0"}),l.jsx("span",{className:"leading-relaxed break-words",children:ue})]},Se))})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx(hi,{className:"w-6 h-6 mr-3 text-blue-600"}),"근무 시간 설정"]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"출근 마감 시간"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[l.jsx("select",{value:ne.checkin_deadline_hour,onChange:ue=>Zt("checkin_deadline_hour",ue.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-medium w-full sm:w-auto",children:Array.from({length:24},(ue,Se)=>l.jsx("option",{value:Se,children:Kn(Se)},Se))}),l.jsx("div",{className:"flex-1 bg-green-50 px-4 py-3 rounded-xl min-w-0",children:l.jsxs("span",{className:"text-green-700 font-medium text-sm sm:text-base leading-relaxed break-words",children:[Kn(ne.checkin_deadline_hour)," 전까지는 정상 출근으로 처리됩니다"]})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"퇴근 시작 시간"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[l.jsx("select",{value:ne.checkout_start_hour,onChange:ue=>Zt("checkout_start_hour",ue.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-medium w-full sm:w-auto",children:Array.from({length:24},(ue,Se)=>l.jsx("option",{value:Se,children:Kn(Se)},Se))}),l.jsx("div",{className:"flex-1 bg-blue-50 px-4 py-3 rounded-xl min-w-0",children:l.jsxs("span",{className:"text-blue-700 font-medium text-sm sm:text-base leading-relaxed break-words",children:[Kn(ne.checkout_start_hour)," 이후로는 퇴근으로 처리됩니다"]})})]})]}),l.jsx("button",{onClick:ys,disabled:ge,className:"w-full bg-blue-600 text-white py-4 rounded-xl font-medium text-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3",children:ge?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"저장 중..."]}):l.jsxs(l.Fragment,{children:[l.jsx(L1,{size:20}),"설정 저장"]})})]})]})]}),on=()=>{if(!ie||!F)return null;const ue=$e[D],Se=ue.dayDetails?.[F]||[];return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[F," 상세 정보"]}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ue.dateRange})]}),l.jsx("button",{onClick:()=>re(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Pn,{className:"w-5 h-5 text-gray-500"})})]}),l.jsx("div",{className:"overflow-auto max-h-[calc(90vh-120px)]",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"이름"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"소속"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"출근시간"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"퇴근시간"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"비고"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Se.map((Le,Me)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Le.name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Le.dept}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Le.checkin||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Le.checkout||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Le.note?l.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${Le.note.includes("지각")?"bg-yellow-100 text-yellow-800":Le.note.includes("결근")?"bg-red-100 text-red-800":Le.note.includes("휴가")?"bg-purple-100 text-purple-800":Le.note.includes("조기퇴근")?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:Le.note}):l.jsx("span",{className:"text-gray-400",children:"-"})})]},Me))})]})}),l.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:l.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[l.jsxs("span",{children:["총 ",Se.length,"명"]}),l.jsx("button",{onClick:()=>re(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"닫기"})]})})]})})};return i?f?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"데이터를 불러오는 중..."})]})}):m?l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[l.jsx("button",{onClick:()=>h("/group-management"),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors flex-shrink-0",children:l.jsx(Ua,{className:"w-5 h-5"})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:m?.name||"그룹"}),l.jsxs("p",{className:"text-xs sm:text-sm text-gray-600",children:[S.length,"명의 구성원"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-shrink-0",children:[l.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:l.jsx(Lo,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"})}),l.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:l.jsx(Ma,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"})})]})]})})}),l.jsx("div",{className:"bg-white border-b border-gray-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex space-x-4 sm:space-x-8 overflow-x-auto",children:[l.jsx("button",{onClick:()=>E("dashboard"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${b==="dashboard"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"대시보드"}),l.jsx("button",{onClick:()=>E("stats"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${b==="stats"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"통계"}),l.jsx("button",{onClick:()=>E("members"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${b==="members"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"구성원"}),l.jsx("button",{onClick:()=>E("settings"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${b==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"설정"})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[q.length>0&&l.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsxs("div",{className:"flex",children:[l.jsx(yn,{className:"w-5 h-5 text-red-600 mr-2"}),l.jsx("div",{children:q.map((ue,Se)=>l.jsx("p",{className:"text-sm text-red-800",children:ue},Se))})]})}),Z&&l.jsx("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:l.jsxs("div",{className:"flex",children:[l.jsx(Sn,{className:"w-5 h-5 text-green-600 mr-2"}),l.jsx("p",{className:"text-sm text-green-800",children:Z})]})}),b==="dashboard"&&or(),b==="stats"&&Cr(),b==="members"&&ls(),b==="settings"&&Et()]}),Ve&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:l.jsxs("div",{className:"p-4 sm:p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"구성원 추가"}),l.jsx("button",{onClick:()=>{Fe(!1),ye([]),he("")},className:"text-gray-400 hover:text-gray-600",children:l.jsx(Pn,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"mb-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(kd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsx("input",{type:"text",value:Ce,onChange:ue=>he(ue.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"이름, 학번, 학과로 검색..."})]})}),je.length>0&&l.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-700",children:[je.length,"명 선택됨"]})}),l.jsx("div",{className:"border border-gray-200 rounded-lg max-h-96 overflow-y-auto",children:B?l.jsx("div",{className:"p-6 text-center text-gray-500",children:"사용자 목록을 불러오는 중..."}):mr.length===0?l.jsx("div",{className:"p-6 text-center text-gray-500",children:"검색 결과가 없습니다."}):l.jsx("div",{className:"divide-y divide-gray-200",children:mr.map(ue=>l.jsx("div",{className:"p-4 hover:bg-gray-50",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:je.includes(ue.id),onChange:()=>Ut(ue.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:ue.name}),l.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${ue.role==="student"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:ue.role==="student"?"학생":"교직원"})]}),l.jsxs("p",{className:"text-sm text-gray-600",children:[ue.user_id," · ",ue.department]})]})]})},ue.id))})}),l.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{Fe(!1),ye([]),he("")},className:"w-full sm:w-auto px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm sm:text-base",children:"취소"}),l.jsx("button",{onClick:hr,disabled:je.length===0||ge,className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:ge?"추가 중...":je.length>0?`${je.length}명 추가`:"추가"})]})]})})}),l.jsx(on,{})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600",children:"그룹을 찾을 수 없습니다."}),l.jsx("button",{onClick:()=>h("/group-management"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"그룹 관리로 돌아가기"})]})}):null};var Z2=Object.defineProperty,cc=Object.getOwnPropertySymbols,V1=Object.prototype.hasOwnProperty,H1=Object.prototype.propertyIsEnumerable,If=(h,i,o)=>i in h?Z2(h,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[i]=o,hd=(h,i)=>{for(var o in i||(i={}))V1.call(i,o)&&If(h,o,i[o]);if(cc)for(var o of cc(i))H1.call(i,o)&&If(h,o,i[o]);return h},fd=(h,i)=>{var o={};for(var f in h)V1.call(h,f)&&i.indexOf(f)<0&&(o[f]=h[f]);if(h!=null&&cc)for(var f of cc(h))i.indexOf(f)<0&&H1.call(h,f)&&(o[f]=h[f]);return o};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Gi;(h=>{const i=class jt{constructor(N,b,E,A){if(this.version=N,this.errorCorrectionLevel=b,this.modules=[],this.isFunction=[],N<jt.MIN_VERSION||N>jt.MAX_VERSION)throw new RangeError("Version value out of range");if(A<-1||A>7)throw new RangeError("Mask value out of range");this.size=N*4+17;let O=[];for(let z=0;z<this.size;z++)O.push(!1);for(let z=0;z<this.size;z++)this.modules.push(O.slice()),this.isFunction.push(O.slice());this.drawFunctionPatterns();const D=this.addEccAndInterleave(E);if(this.drawCodewords(D),A==-1){let z=1e9;for(let F=0;F<8;F++){this.applyMask(F),this.drawFormatBits(F);const U=this.getPenaltyScore();U<z&&(A=F,z=U),this.applyMask(F)}}x(0<=A&&A<=7),this.mask=A,this.applyMask(A),this.drawFormatBits(A),this.isFunction=[]}static encodeText(N,b){const E=h.QrSegment.makeSegments(N);return jt.encodeSegments(E,b)}static encodeBinary(N,b){const E=h.QrSegment.makeBytes(N);return jt.encodeSegments([E],b)}static encodeSegments(N,b,E=1,A=40,O=-1,D=!0){if(!(jt.MIN_VERSION<=E&&E<=A&&A<=jt.MAX_VERSION)||O<-1||O>7)throw new RangeError("Invalid value");let z,F;for(z=E;;z++){const L=jt.getNumDataCodewords(z,b)*8,Y=w.getTotalBits(N,z);if(Y<=L){F=Y;break}if(z>=A)throw new RangeError("Data too long")}for(const L of[jt.Ecc.MEDIUM,jt.Ecc.QUARTILE,jt.Ecc.HIGH])D&&F<=jt.getNumDataCodewords(z,L)*8&&(b=L);let U=[];for(const L of N){o(L.mode.modeBits,4,U),o(L.numChars,L.mode.numCharCountBits(z),U);for(const Y of L.getData())U.push(Y)}x(U.length==F);const ie=jt.getNumDataCodewords(z,b)*8;x(U.length<=ie),o(0,Math.min(4,ie-U.length),U),o(0,(8-U.length%8)%8,U),x(U.length%8==0);for(let L=236;U.length<ie;L^=253)o(L,8,U);let re=[];for(;re.length*8<U.length;)re.push(0);return U.forEach((L,Y)=>re[Y>>>3]|=L<<7-(Y&7)),new jt(z,b,re,O)}getModule(N,b){return 0<=N&&N<this.size&&0<=b&&b<this.size&&this.modules[b][N]}getModules(){return this.modules}drawFunctionPatterns(){for(let E=0;E<this.size;E++)this.setFunctionModule(6,E,E%2==0),this.setFunctionModule(E,6,E%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const N=this.getAlignmentPatternPositions(),b=N.length;for(let E=0;E<b;E++)for(let A=0;A<b;A++)E==0&&A==0||E==0&&A==b-1||E==b-1&&A==0||this.drawAlignmentPattern(N[E],N[A]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(N){const b=this.errorCorrectionLevel.formatBits<<3|N;let E=b;for(let O=0;O<10;O++)E=E<<1^(E>>>9)*1335;const A=(b<<10|E)^21522;x(A>>>15==0);for(let O=0;O<=5;O++)this.setFunctionModule(8,O,f(A,O));this.setFunctionModule(8,7,f(A,6)),this.setFunctionModule(8,8,f(A,7)),this.setFunctionModule(7,8,f(A,8));for(let O=9;O<15;O++)this.setFunctionModule(14-O,8,f(A,O));for(let O=0;O<8;O++)this.setFunctionModule(this.size-1-O,8,f(A,O));for(let O=8;O<15;O++)this.setFunctionModule(8,this.size-15+O,f(A,O));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let N=this.version;for(let E=0;E<12;E++)N=N<<1^(N>>>11)*7973;const b=this.version<<12|N;x(b>>>18==0);for(let E=0;E<18;E++){const A=f(b,E),O=this.size-11+E%3,D=Math.floor(E/3);this.setFunctionModule(O,D,A),this.setFunctionModule(D,O,A)}}drawFinderPattern(N,b){for(let E=-4;E<=4;E++)for(let A=-4;A<=4;A++){const O=Math.max(Math.abs(A),Math.abs(E)),D=N+A,z=b+E;0<=D&&D<this.size&&0<=z&&z<this.size&&this.setFunctionModule(D,z,O!=2&&O!=4)}}drawAlignmentPattern(N,b){for(let E=-2;E<=2;E++)for(let A=-2;A<=2;A++)this.setFunctionModule(N+A,b+E,Math.max(Math.abs(A),Math.abs(E))!=1)}setFunctionModule(N,b,E){this.modules[b][N]=E,this.isFunction[b][N]=!0}addEccAndInterleave(N){const b=this.version,E=this.errorCorrectionLevel;if(N.length!=jt.getNumDataCodewords(b,E))throw new RangeError("Invalid argument");const A=jt.NUM_ERROR_CORRECTION_BLOCKS[E.ordinal][b],O=jt.ECC_CODEWORDS_PER_BLOCK[E.ordinal][b],D=Math.floor(jt.getNumRawDataModules(b)/8),z=A-D%A,F=Math.floor(D/A);let U=[];const ie=jt.reedSolomonComputeDivisor(O);for(let L=0,Y=0;L<A;L++){let ne=N.slice(Y,Y+F-O+(L<z?0:1));Y+=ne.length;const ce=jt.reedSolomonComputeRemainder(ne,ie);L<z&&ne.push(0),U.push(ne.concat(ce))}let re=[];for(let L=0;L<U[0].length;L++)U.forEach((Y,ne)=>{(L!=F-O||ne>=z)&&re.push(Y[L])});return x(re.length==D),re}drawCodewords(N){if(N.length!=Math.floor(jt.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let b=0;for(let E=this.size-1;E>=1;E-=2){E==6&&(E=5);for(let A=0;A<this.size;A++)for(let O=0;O<2;O++){const D=E-O,F=(E+1&2)==0?this.size-1-A:A;!this.isFunction[F][D]&&b<N.length*8&&(this.modules[F][D]=f(N[b>>>3],7-(b&7)),b++)}}x(b==N.length*8)}applyMask(N){if(N<0||N>7)throw new RangeError("Mask value out of range");for(let b=0;b<this.size;b++)for(let E=0;E<this.size;E++){let A;switch(N){case 0:A=(E+b)%2==0;break;case 1:A=b%2==0;break;case 2:A=E%3==0;break;case 3:A=(E+b)%3==0;break;case 4:A=(Math.floor(E/3)+Math.floor(b/2))%2==0;break;case 5:A=E*b%2+E*b%3==0;break;case 6:A=(E*b%2+E*b%3)%2==0;break;case 7:A=((E+b)%2+E*b%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[b][E]&&A&&(this.modules[b][E]=!this.modules[b][E])}}getPenaltyScore(){let N=0;for(let O=0;O<this.size;O++){let D=!1,z=0,F=[0,0,0,0,0,0,0];for(let U=0;U<this.size;U++)this.modules[O][U]==D?(z++,z==5?N+=jt.PENALTY_N1:z>5&&N++):(this.finderPenaltyAddHistory(z,F),D||(N+=this.finderPenaltyCountPatterns(F)*jt.PENALTY_N3),D=this.modules[O][U],z=1);N+=this.finderPenaltyTerminateAndCount(D,z,F)*jt.PENALTY_N3}for(let O=0;O<this.size;O++){let D=!1,z=0,F=[0,0,0,0,0,0,0];for(let U=0;U<this.size;U++)this.modules[U][O]==D?(z++,z==5?N+=jt.PENALTY_N1:z>5&&N++):(this.finderPenaltyAddHistory(z,F),D||(N+=this.finderPenaltyCountPatterns(F)*jt.PENALTY_N3),D=this.modules[U][O],z=1);N+=this.finderPenaltyTerminateAndCount(D,z,F)*jt.PENALTY_N3}for(let O=0;O<this.size-1;O++)for(let D=0;D<this.size-1;D++){const z=this.modules[O][D];z==this.modules[O][D+1]&&z==this.modules[O+1][D]&&z==this.modules[O+1][D+1]&&(N+=jt.PENALTY_N2)}let b=0;for(const O of this.modules)b=O.reduce((D,z)=>D+(z?1:0),b);const E=this.size*this.size,A=Math.ceil(Math.abs(b*20-E*10)/E)-1;return x(0<=A&&A<=9),N+=A*jt.PENALTY_N4,x(0<=N&&N<=2568888),N}getAlignmentPatternPositions(){if(this.version==1)return[];{const N=Math.floor(this.version/7)+2,b=this.version==32?26:Math.ceil((this.version*4+4)/(N*2-2))*2;let E=[6];for(let A=this.size-7;E.length<N;A-=b)E.splice(1,0,A);return E}}static getNumRawDataModules(N){if(N<jt.MIN_VERSION||N>jt.MAX_VERSION)throw new RangeError("Version number out of range");let b=(16*N+128)*N+64;if(N>=2){const E=Math.floor(N/7)+2;b-=(25*E-10)*E-55,N>=7&&(b-=36)}return x(208<=b&&b<=29648),b}static getNumDataCodewords(N,b){return Math.floor(jt.getNumRawDataModules(N)/8)-jt.ECC_CODEWORDS_PER_BLOCK[b.ordinal][N]*jt.NUM_ERROR_CORRECTION_BLOCKS[b.ordinal][N]}static reedSolomonComputeDivisor(N){if(N<1||N>255)throw new RangeError("Degree out of range");let b=[];for(let A=0;A<N-1;A++)b.push(0);b.push(1);let E=1;for(let A=0;A<N;A++){for(let O=0;O<b.length;O++)b[O]=jt.reedSolomonMultiply(b[O],E),O+1<b.length&&(b[O]^=b[O+1]);E=jt.reedSolomonMultiply(E,2)}return b}static reedSolomonComputeRemainder(N,b){let E=b.map(A=>0);for(const A of N){const O=A^E.shift();E.push(0),b.forEach((D,z)=>E[z]^=jt.reedSolomonMultiply(D,O))}return E}static reedSolomonMultiply(N,b){if(N>>>8||b>>>8)throw new RangeError("Byte out of range");let E=0;for(let A=7;A>=0;A--)E=E<<1^(E>>>7)*285,E^=(b>>>A&1)*N;return x(E>>>8==0),E}finderPenaltyCountPatterns(N){const b=N[1];x(b<=this.size*3);const E=b>0&&N[2]==b&&N[3]==b*3&&N[4]==b&&N[5]==b;return(E&&N[0]>=b*4&&N[6]>=b?1:0)+(E&&N[6]>=b*4&&N[0]>=b?1:0)}finderPenaltyTerminateAndCount(N,b,E){return N&&(this.finderPenaltyAddHistory(b,E),b=0),b+=this.size,this.finderPenaltyAddHistory(b,E),this.finderPenaltyCountPatterns(E)}finderPenaltyAddHistory(N,b){b[0]==0&&(N+=this.size),b.pop(),b.unshift(N)}};i.MIN_VERSION=1,i.MAX_VERSION=40,i.PENALTY_N1=3,i.PENALTY_N2=3,i.PENALTY_N3=40,i.PENALTY_N4=10,i.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],i.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],h.QrCode=i;function o(S,N,b){if(N<0||N>31||S>>>N)throw new RangeError("Value out of range");for(let E=N-1;E>=0;E--)b.push(S>>>E&1)}function f(S,N){return(S>>>N&1)!=0}function x(S){if(!S)throw new Error("Assertion error")}const m=class Tr{constructor(N,b,E){if(this.mode=N,this.numChars=b,this.bitData=E,b<0)throw new RangeError("Invalid argument");this.bitData=E.slice()}static makeBytes(N){let b=[];for(const E of N)o(E,8,b);return new Tr(Tr.Mode.BYTE,N.length,b)}static makeNumeric(N){if(!Tr.isNumeric(N))throw new RangeError("String contains non-numeric characters");let b=[];for(let E=0;E<N.length;){const A=Math.min(N.length-E,3);o(parseInt(N.substring(E,E+A),10),A*3+1,b),E+=A}return new Tr(Tr.Mode.NUMERIC,N.length,b)}static makeAlphanumeric(N){if(!Tr.isAlphanumeric(N))throw new RangeError("String contains unencodable characters in alphanumeric mode");let b=[],E;for(E=0;E+2<=N.length;E+=2){let A=Tr.ALPHANUMERIC_CHARSET.indexOf(N.charAt(E))*45;A+=Tr.ALPHANUMERIC_CHARSET.indexOf(N.charAt(E+1)),o(A,11,b)}return E<N.length&&o(Tr.ALPHANUMERIC_CHARSET.indexOf(N.charAt(E)),6,b),new Tr(Tr.Mode.ALPHANUMERIC,N.length,b)}static makeSegments(N){return N==""?[]:Tr.isNumeric(N)?[Tr.makeNumeric(N)]:Tr.isAlphanumeric(N)?[Tr.makeAlphanumeric(N)]:[Tr.makeBytes(Tr.toUtf8ByteArray(N))]}static makeEci(N){let b=[];if(N<0)throw new RangeError("ECI assignment value out of range");if(N<128)o(N,8,b);else if(N<16384)o(2,2,b),o(N,14,b);else if(N<1e6)o(6,3,b),o(N,21,b);else throw new RangeError("ECI assignment value out of range");return new Tr(Tr.Mode.ECI,0,b)}static isNumeric(N){return Tr.NUMERIC_REGEX.test(N)}static isAlphanumeric(N){return Tr.ALPHANUMERIC_REGEX.test(N)}getData(){return this.bitData.slice()}static getTotalBits(N,b){let E=0;for(const A of N){const O=A.mode.numCharCountBits(b);if(A.numChars>=1<<O)return 1/0;E+=4+O+A.bitData.length}return E}static toUtf8ByteArray(N){N=encodeURI(N);let b=[];for(let E=0;E<N.length;E++)N.charAt(E)!="%"?b.push(N.charCodeAt(E)):(b.push(parseInt(N.substring(E+1,E+3),16)),E+=2);return b}};m.NUMERIC_REGEX=/^[0-9]*$/,m.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,m.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let w=m;h.QrSegment=m})(Gi||(Gi={}));(h=>{(i=>{const o=class{constructor(x,m){this.ordinal=x,this.formatBits=m}};o.LOW=new o(0,1),o.MEDIUM=new o(1,0),o.QUARTILE=new o(2,3),o.HIGH=new o(3,2),i.Ecc=o})(h.QrCode||(h.QrCode={}))})(Gi||(Gi={}));(h=>{(i=>{const o=class{constructor(x,m){this.modeBits=x,this.numBitsCharCount=m}numCharCountBits(x){return this.numBitsCharCount[Math.floor((x+7)/17)]}};o.NUMERIC=new o(1,[10,12,14]),o.ALPHANUMERIC=new o(2,[9,11,13]),o.BYTE=new o(4,[8,16,16]),o.KANJI=new o(8,[8,10,12]),o.ECI=new o(7,[0,0,0]),i.Mode=o})(h.QrSegment||(h.QrSegment={}))})(Gi||(Gi={}));var Oa=Gi;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Q2={L:Oa.QrCode.Ecc.LOW,M:Oa.QrCode.Ecc.MEDIUM,Q:Oa.QrCode.Ecc.QUARTILE,H:Oa.QrCode.Ecc.HIGH},G1=128,$1="L",X1="#FFFFFF",q1="#000000",K1=!1,Y1=1,J2=4,ey=0,ty=.1;function Z1(h,i=0){const o=[];return h.forEach(function(f,x){let m=null;f.forEach(function(w,S){if(!w&&m!==null){o.push(`M${m+i} ${x+i}h${S-m}v1H${m+i}z`),m=null;return}if(S===f.length-1){if(!w)return;m===null?o.push(`M${S+i},${x+i} h1v1H${S+i}z`):o.push(`M${m+i},${x+i} h${S+1-m}v1H${m+i}z`);return}w&&m===null&&(m=S)})}),o.join("")}function Q1(h,i){return h.slice().map((o,f)=>f<i.y||f>=i.y+i.h?o:o.map((x,m)=>m<i.x||m>=i.x+i.w?x:!1))}function ry(h,i,o,f){if(f==null)return null;const x=h.length+o*2,m=Math.floor(i*ty),w=x/i,S=(f.width||m)*w,N=(f.height||m)*w,b=f.x==null?h.length/2-S/2:f.x*w,E=f.y==null?h.length/2-N/2:f.y*w,A=f.opacity==null?1:f.opacity;let O=null;if(f.excavate){let z=Math.floor(b),F=Math.floor(E),U=Math.ceil(S+b-z),ie=Math.ceil(N+E-F);O={x:z,y:F,w:U,h:ie}}const D=f.crossOrigin;return{x:b,y:E,h:N,w:S,excavation:O,opacity:A,crossOrigin:D}}function ny(h,i){return i!=null?Math.max(Math.floor(i),0):h?J2:ey}function J1({value:h,level:i,minVersion:o,includeMargin:f,marginSize:x,imageSettings:m,size:w,boostLevel:S}){let N=vr.useMemo(()=>{const z=(Array.isArray(h)?h:[h]).reduce((F,U)=>(F.push(...Oa.QrSegment.makeSegments(U)),F),[]);return Oa.QrCode.encodeSegments(z,Q2[i],o,void 0,void 0,S)},[h,i,o,S]);const{cells:b,margin:E,numCells:A,calculatedImageSettings:O}=vr.useMemo(()=>{let D=N.getModules();const z=ny(f,x),F=D.length+z*2,U=ry(D,w,z,m);return{cells:D,margin:z,numCells:F,calculatedImageSettings:U}},[N,w,m,f,x]);return{qrcode:N,margin:E,cells:b,numCells:A,calculatedImageSettings:O}}var sy=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),eg=vr.forwardRef(function(i,o){const f=i,{value:x,size:m=G1,level:w=$1,bgColor:S=X1,fgColor:N=q1,includeMargin:b=K1,minVersion:E=Y1,boostLevel:A,marginSize:O,imageSettings:D}=f,F=fd(f,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:U}=F,ie=fd(F,["style"]),re=D?.src,L=vr.useRef(null),Y=vr.useRef(null),ne=vr.useCallback(Fe=>{L.current=Fe,typeof o=="function"?o(Fe):o&&(o.current=Fe)},[o]),[ce,q]=vr.useState(!1),{margin:Ne,cells:Z,numCells:Ke,calculatedImageSettings:ge}=J1({value:x,level:w,minVersion:E,boostLevel:A,includeMargin:b,marginSize:O,imageSettings:D,size:m});vr.useEffect(()=>{if(L.current!=null){const Fe=L.current,X=Fe.getContext("2d");if(!X)return;let Ge=Z;const Ce=Y.current,he=ge!=null&&Ce!==null&&Ce.complete&&Ce.naturalHeight!==0&&Ce.naturalWidth!==0;he&&ge.excavation!=null&&(Ge=Q1(Z,ge.excavation));const je=window.devicePixelRatio||1;Fe.height=Fe.width=m*je;const ye=m/Ke*je;X.scale(ye,ye),X.fillStyle=S,X.fillRect(0,0,Ke,Ke),X.fillStyle=N,sy?X.fill(new Path2D(Z1(Ge,Ne))):Z.forEach(function(B,te){B.forEach(function(fe,Be){fe&&X.fillRect(Be+Ne,te+Ne,1,1)})}),ge&&(X.globalAlpha=ge.opacity),he&&X.drawImage(Ce,ge.x+Ne,ge.y+Ne,ge.w,ge.h)}}),vr.useEffect(()=>{q(!1)},[re]);const xe=hd({height:m,width:m},U);let Ve=null;return re!=null&&(Ve=vr.createElement("img",{src:re,key:re,style:{display:"none"},onLoad:()=>{q(!0)},ref:Y,crossOrigin:ge?.crossOrigin})),vr.createElement(vr.Fragment,null,vr.createElement("canvas",hd({style:xe,height:m,width:m,ref:ne,role:"img"},ie)),Ve)});eg.displayName="QRCodeCanvas";var iy=vr.forwardRef(function(i,o){const f=i,{value:x,size:m=G1,level:w=$1,bgColor:S=X1,fgColor:N=q1,includeMargin:b=K1,minVersion:E=Y1,boostLevel:A,title:O,marginSize:D,imageSettings:z}=f,F=fd(f,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:U,cells:ie,numCells:re,calculatedImageSettings:L}=J1({value:x,level:w,minVersion:E,boostLevel:A,includeMargin:b,marginSize:D,imageSettings:z,size:m});let Y=ie,ne=null;z!=null&&L!=null&&(L.excavation!=null&&(Y=Q1(ie,L.excavation)),ne=vr.createElement("image",{href:z.src,height:L.h,width:L.w,x:L.x+U,y:L.y+U,preserveAspectRatio:"none",opacity:L.opacity,crossOrigin:L.crossOrigin}));const ce=Z1(Y,U);return vr.createElement("svg",hd({height:m,width:m,viewBox:`0 0 ${re} ${re}`,ref:o,role:"img"},F),!!O&&vr.createElement("title",null,O),vr.createElement("path",{fill:S,d:`M0,0 h${re}v${re}H0z`,shapeRendering:"crispEdges"}),vr.createElement("path",{fill:N,d:ce,shapeRendering:"crispEdges"}),ne)});iy.displayName="QRCodeSVG";const ay=({onLocationSelect:h,onCancel:i,initialLat:o=37.5665,initialLng:f=126.978})=>{const x=V.useRef(null),m=V.useRef(null),[w,S]=V.useState(null),[N,b]=V.useState(null),[E,A]=V.useState(null),[O,D]=V.useState(""),[z,F]=V.useState(!1),[U,ie]=V.useState([]),[re,L]=V.useState(!1),[Y,ne]=V.useState(!1);V.useEffect(()=>{if(!N){if(typeof window<"u"&&window.kakao&&window.kakao.maps)ce();else{const Fe=setInterval(()=>{typeof window<"u"&&window.kakao&&window.kakao.maps&&(clearInterval(Fe),ce())},100)}return()=>{E&&E.setMap(null),N&&window.kakao.maps.event.clearListeners(N,"click")}}},[]);const ce=()=>{if(!x.current||N)return;const Fe={center:new window.kakao.maps.LatLng(o,f),level:3},X=new window.kakao.maps.Map(x.current,Fe);b(X);const Ge=new window.kakao.maps.Marker({position:X.getCenter()});Ge.setMap(X),A(Ge),window.kakao.maps.event.addListener(X,"click",Ce=>{const he=Ce.latLng,je=he.getLat(),ye=he.getLng();Ge.setPosition(he),q(je,ye).then(B=>{S({lat:je,lng:ye,address:B})})})},q=async(Fe,X)=>new Promise(Ge=>{const Ce=new window.kakao.maps.services.Geocoder,he=new window.kakao.maps.LatLng(Fe,X);Ce.coord2Address(he.getLng(),he.getLat(),(je,ye)=>{if(ye===window.kakao.maps.services.Status.OK){const B=je[0].address.address_name;Ge(B)}else Ge("주소 정보 없음")})}),Ne=async()=>{if(!(!O.trim()||!N)){F(!0),L(!1);try{new window.kakao.maps.services.Places().keywordSearch(O,(X,Ge)=>{if(F(!1),Ge===window.kakao.maps.services.Status.OK){if(ie(X),L(!0),X.length>0){const Ce=X[0],he=new window.kakao.maps.LatLng(Ce.y,Ce.x);N.setCenter(he),N.setLevel(3)}}else ie([]),L(!0)})}catch{F(!1)}}},Z=Fe=>{const X=parseFloat(Fe.y),Ge=parseFloat(Fe.x),Ce=new window.kakao.maps.LatLng(X,Ge);N.setCenter(Ce),N.setLevel(3),E&&E.setPosition(Ce),S({lat:X,lng:Ge,address:Fe.address_name}),L(!1),D("")},Ke=()=>{navigator.geolocation?(ne(!0),S(null),navigator.geolocation.getCurrentPosition(async Fe=>{const X=Fe.coords.latitude,Ge=Fe.coords.longitude,Ce=new window.kakao.maps.LatLng(X,Ge);N.setCenter(Ce),N.setLevel(3),E&&E.setPosition(Ce),S({lat:X,lng:Ge,address:"주소 정보 로딩 중..."}),q(X,Ge).then(he=>{S(je=>je?{...je,address:he}:null),ne(!1)}).catch(()=>{S(he=>he?{...he,address:"주소 정보 없음"}:null),ne(!1)})},Fe=>{console.error("Kakao Map load error:",Fe)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})):alert("이 브라우저에서는 위치 정보를 지원하지 않습니다.")},ge=()=>{w&&h(w.lat,w.lng,w.address)},xe=()=>{i()},Ve=Fe=>{Fe.key==="Enter"&&Ne()};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"지도에서 위치 선택"}),l.jsx("button",{onClick:xe,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Pn,{size:20,className:"text-gray-600"})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(kd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{ref:m,type:"text",value:O,onChange:Fe=>D(Fe.target.value),onKeyPress:Ve,placeholder:"장소를 검색하세요 (예: 서울역, 강남역)",className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("button",{onClick:Ne,disabled:z,className:"absolute right-2 top-1/2 transform -translate-y-1/2 px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50",children:z?"검색중...":"검색"})]}),re&&l.jsx("div",{className:"absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto mt-1",children:U.length>0?U.map((Fe,X)=>l.jsxs("button",{onClick:()=>Z(Fe),className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[l.jsx("div",{className:"font-medium text-gray-900",children:Fe.place_name}),l.jsx("div",{className:"text-sm text-gray-600",children:Fe.address_name})]},X)):l.jsx("div",{className:"p-3 text-gray-500 text-center",children:"검색 결과가 없습니다."})})]}),l.jsx("div",{ref:x,className:"w-full h-96 rounded-lg overflow-hidden border border-gray-200",style:{minHeight:"400px"}}),w?l.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Da,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-blue-800 mb-1",children:"선택된 위치"}),l.jsxs("p",{className:"text-xs text-blue-600 font-mono mb-1",children:["위도: ",w.lat.toFixed(6),l.jsx("br",{}),"경도: ",w.lng.toFixed(6)]}),w.address&&l.jsx("p",{className:"text-xs text-blue-600",children:w.address})]})]})}):l.jsx("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Da,{className:"w-5 h-5 text-gray-400 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"위치 선택 안내"}),l.jsx("p",{className:"text-xs text-gray-500",children:"지도를 클릭하거나 검색하여 위치를 선택해주세요."})]})]})}),l.jsxs("div",{className:"flex justify-between items-center mt-6",children:[l.jsxs("button",{onClick:Ke,disabled:Y,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(P1,{size:16}),l.jsx("span",{children:Y?"위치 확인 중...":"현재 위치"})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:xe,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"취소"}),l.jsx("button",{onClick:ge,disabled:!w,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:w?"위치 확인":"위치를 선택해주세요"})]})]})]})})})};function Tf(){const h=ms(),{user:i,logout:o}=ps(),[f,x]=V.useState(!0),[m,w]=V.useState(!1),[S,N]=V.useState([]),[b,E]=V.useState([]),[A,O]=V.useState(null),[D,z]=V.useState(""),[F,U]=V.useState(!1),[ie,re]=V.useState(!1),[L,Y]=V.useState(null);V.useEffect(()=>{if(!i||i.role!=="faculty"){h("/");return}},[i,h]),V.useEffect(()=>{!i||i.role!=="faculty"||ne()},[i]);const ne=async()=>{if(i)try{x(!0);const ge=await Vo(i.id);if(E(ge),ge.length>0){const xe=ge[0];O(xe),await ce(xe.id)}}catch(ge){console.error("데이터 로드 실패:",ge)}finally{x(!1)}},ce=async ge=>{try{const xe=await S1(ge);N(xe)}catch(xe){console.error("위치 목록 로드 실패:",xe)}},q=()=>{D.trim()&&U(!0)},Ne=async()=>{if(!(!D.trim()||!L||!A))try{w(!0);const ge={group_id:A.id,name:D.trim(),latitude:L.lat,longitude:L.lng,address:L.address||"",is_active:!0};await A1(ge),z(""),Y(null),U(!1),re(!1),await ce(A.id)}catch(ge){console.error("위치 저장 실패:",ge)}finally{w(!1)}},Z=async ge=>{if(confirm("이 장소를 삭제하시겠습니까?"))try{N(xe=>xe.filter(Ve=>Ve.id!==ge))}catch(xe){console.error("위치 삭제 실패:",xe)}},Ke=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(ge=>{Y({lat:ge.coords.latitude,lng:ge.coords.longitude})},ge=>{alert("위치 정보를 가져올 수 없습니다.")})};return!i||i.role!=="faculty"?null:f?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"위치 목록을 불러오는 중..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm px-4 py-4",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>window.history.back(),className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Ua,{size:20,className:"text-gray-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"QR 코드 관리"}),l.jsx("p",{className:"text-sm text-gray-600",children:"장소별 출퇴근 QR 코드를 생성하고 관리하세요"})]})]})}),l.jsxs("div",{className:"p-4 space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(yc,{className:"w-5 h-5 mr-2 text-blue-600"}),"새 장소 추가"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"장소 이름"}),l.jsx("input",{type:"text",value:D,onChange:ge=>z(ge.target.value),placeholder:"예: 3층 강의실, 회의실 A 등",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("button",{onClick:q,disabled:!D.trim(),className:"w-full bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[l.jsx(Da,{size:20}),l.jsx("span",{children:"위치 설정하고 추가"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[l.jsx(Hi,{className:"w-5 h-5 mr-2 text-green-600"}),"등록된 장소 (",S.length,"개)"]}),S.length===0?l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-8 text-center",children:[l.jsx(Hi,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"등록된 장소가 없습니다."}),l.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"위에서 새 장소를 추가해보세요."})]}):l.jsx("div",{className:"grid gap-4",children:S.map(ge=>l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:ge.name}),ge.latitude&&ge.longitude&&l.jsxs("div",{className:"flex items-start text-sm text-gray-500 mt-1",children:[l.jsx(Da,{size:14,className:"mr-1 mt-0.5 flex-shrink-0"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-mono text-xs",children:[ge.latitude.toFixed(6),", ",ge.longitude.toFixed(6)]}),ge.address&&l.jsx("div",{className:"text-xs text-gray-400 mt-1",children:ge.address})]})]})]}),l.jsx("button",{onClick:()=>Z(ge.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:l.jsx(B1,{size:18})})]}),l.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:items-start space-y-4 lg:space-y-0 lg:space-x-6",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"bg-white p-4 rounded-xl border-2 border-gray-100",children:l.jsx(eg,{value:JSON.stringify({type:"location",id:ge.id,name:ge.name,latitude:ge.latitude,longitude:ge.longitude,address:ge.address}),size:200,level:"M",includeMargin:!0})})}),l.jsx("div",{className:"flex-1 w-full",children:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[l.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"QR 코드 정보"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"코드 ID:"}),l.jsx("span",{className:"font-mono text-gray-800",children:ge.id})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"생성일:"}),l.jsx("span",{className:"text-gray-800",children:"2024년 1월 17일"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"사용 횟수:"}),l.jsx("span",{className:"text-gray-800",children:"156회"})]})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{className:"flex-1 bg-blue-100 text-blue-700 py-2 px-4 rounded-lg font-medium hover:bg-blue-200 transition-colors text-sm",children:"QR 다운로드"}),l.jsx("button",{className:"flex-1 bg-green-100 text-green-700 py-2 px-4 rounded-lg font-medium hover:bg-green-200 transition-colors text-sm",children:"위치 확인"})]})]})})]})]},ge.id))})]})]}),F&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(Da,{className:"w-5 h-5 mr-2 text-blue-600"}),'"',D,'" 위치 설정']}),l.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"QR 코드 스캔 시 위치 확인을 위해 정확한 장소의 좌표를 설정해주세요."}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("button",{onClick:Ke,className:"w-full bg-green-600 text-white py-3 rounded-xl font-medium hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx(P1,{size:20}),l.jsx("span",{children:"현재 위치 사용"})]}),l.jsxs("button",{onClick:()=>re(!0),className:"w-full bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx(g2,{size:20}),l.jsx("span",{children:"지도에서 선택"})]}),L&&l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[l.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"선택된 위치:"}),l.jsxs("p",{className:"text-xs text-blue-600 font-mono mb-2",children:["위도: ",L.lat.toFixed(6),l.jsx("br",{}),"경도: ",L.lng.toFixed(6)]}),L.address&&l.jsx("p",{className:"text-xs text-blue-600",children:L.address})]})]}),l.jsxs("div",{className:"flex space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{U(!1),Y(null)},className:"flex-1 bg-gray-200 text-gray-800 py-3 rounded-xl font-medium hover:bg-gray-300 transition-colors",children:"취소"}),l.jsx("button",{onClick:Ne,disabled:!L,className:"flex-1 bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"저장"})]})]})}),ie&&l.jsx(ay,{onLocationSelect:(ge,xe,Ve)=>{Y({lat:ge,lng:xe,address:Ve}),re(!1)},onCancel:()=>{re(!1),Y(null)},initialLat:37.5665,initialLng:126.978})]})}function oy(){const h=ms(),{user:i,logout:o}=ps(),[f,x]=V.useState("list"),[m,w]=V.useState(!0),[S,N]=V.useState(!1),[b,E]=V.useState(null),[A,O]=V.useState([]),[D,z]=V.useState([]),[F,U]=V.useState([]),[ie,re]=V.useState(null),[L,Y]=V.useState(0),[ne,ce]=V.useState({startDate:"",endDate:"",reason:"",requestType:"annual"}),[q,Ne]=V.useState(null),[Z,Ke]=V.useState("");V.useEffect(()=>{if(!i){h("/");return}},[i,h]),V.useEffect(()=>{i?.role==="faculty"&&x("pending")},[i]),V.useEffect(()=>{i&&ge()},[i]);const ge=async()=>{if(i)try{if(w(!0),i.role==="student"){const B=await v1(i.id);O(B);const te=await Po(i.id);U(te),te.length>0&&re(te[0])}else if(i.role==="faculty"){const B=await Po(i.id);if(U(B),B.length>0){const te=[];for(const fe of B){const{data:Be}=await He.from("group_memberships").select("user_id").eq("group_id",fe.id),nt=await mc(fe.id);te.push(...nt)}z(te),Y(te.length),re(B[0])}}}catch{E({type:"error",text:"데이터를 불러오는데 실패했습니다."})}finally{w(!1)}},xe=B=>{switch(B){case"annual":return"휴가";case"sick":return"병가";case"personal":return"개인사정";case"official":return"공무";default:return B}},Ve=B=>{switch(B){case"pending":return"대기중";case"approved":return"승인";case"rejected":return"거절";default:return B}},Fe=B=>{switch(B){case"pending":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},X=B=>new Date(B).toLocaleDateString("ko-KR"),Ge=(B,te)=>{const fe=new Date(B),Be=new Date(te),nt=Math.abs(Be.getTime()-fe.getTime());return Math.ceil(nt/(1e3*60*60*24))+1},Ce=async B=>{if(B.preventDefault(),N(!0),E(null),!i||!ie){E({type:"error",text:"사용자 정보 또는 그룹 정보가 없습니다."}),N(!1);return}if(!ne.startDate||!ne.endDate||!ne.reason.trim()){E({type:"error",text:"모든 필드를 입력해주세요."}),N(!1);return}if(new Date(ne.startDate)>new Date(ne.endDate)){E({type:"error",text:"종료일은 시작일보다 늦어야 합니다."}),N(!1);return}try{await w1({user_id:i.id,group_id:ie.id,vacation_type:ne.requestType,start_date:ne.startDate,end_date:ne.endDate,reason:ne.reason}),E({type:"success",text:"휴가 신청이 성공적으로 제출되었습니다."}),ce({startDate:"",endDate:"",reason:"",requestType:"annual"}),x("list"),await ge()}catch{E({type:"error",text:"휴가 신청에 실패했습니다."})}finally{N(!1)}},he=async(B,te)=>{if(i){N(!0);try{await Ad(B,te,i.id,Z),E({type:"success",text:`휴가 신청이 ${te==="approved"?"승인":"거절"}되었습니다.`}),Ne(null),Ke(""),await ge()}catch{E({type:"error",text:"처리 중 오류가 발생했습니다."})}finally{N(!1)}}},je=()=>D,ye=()=>A;return i?m?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"데이터를 불러오는 중..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("button",{onClick:()=>h(i.role==="faculty"?"/faculty-attendance":"/student-attendance"),className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Ua,{size:20,className:"text-gray-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"휴가 관리"}),l.jsx("p",{className:"text-sm text-gray-600",children:"휴가 신청 및 관리"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Uo,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-gray-800",children:i?.name||"사용자"}),l.jsx("div",{className:"text-gray-500",children:i?.role==="faculty"?"교직원":"학생"})]})]}),l.jsx("button",{onClick:()=>{o(),h("/")},className:"p-2 text-gray-600 hover:text-red-600 rounded-lg",children:l.jsx(pc,{size:20})})]})]})}),l.jsxs("div",{className:"p-4",children:[l.jsx("div",{className:"bg-white rounded-2xl shadow-sm mb-6",children:l.jsxs("div",{className:"flex border-b border-gray-200",children:[i?.role==="student"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>x("list"),className:`flex-1 py-4 px-6 text-center transition-colors ${f==="list"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"}`,children:l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[l.jsx(tc,{size:20}),l.jsx("span",{className:"text-sm font-medium",children:"내 신청"})]})}),l.jsx("button",{onClick:()=>x("create"),className:`flex-1 py-4 px-6 text-center transition-colors ${f==="create"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"}`,children:l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[l.jsx(yc,{size:20}),l.jsx("span",{className:"text-sm font-medium",children:"신청하기"})]})})]}),i?.role==="faculty"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>x("pending"),className:`flex-1 py-4 px-6 text-center transition-colors relative ${f==="pending"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"}`,children:l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Lo,{size:20}),L>0&&l.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:L})]}),l.jsx("span",{className:"text-sm font-medium",children:"대기중"})]})}),l.jsx("button",{onClick:()=>x("list"),className:`flex-1 py-4 px-6 text-center transition-colors ${f==="list"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800"}`,children:l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[l.jsx(tc,{size:20}),l.jsx("span",{className:"text-sm font-medium",children:"전체 신청"})]})})]})]})}),b&&l.jsxs("div",{className:`mb-6 p-4 rounded-xl flex items-center space-x-3 ${b.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:[b.type==="success"?l.jsx(Sn,{size:20}):l.jsx(gf,{size:20}),l.jsx("span",{className:"font-medium",children:b.text})]}),l.jsxs("div",{className:"space-y-6",children:[f==="create"&&i?.role==="student"&&l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx(Fo,{className:"w-6 h-6 mr-3 text-blue-600"}),"새 휴가 신청"]}),l.jsxs("form",{onSubmit:Ce,className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"신청 종류"}),l.jsxs("select",{value:ne.requestType,onChange:B=>ce(te=>({...te,requestType:B.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"annual",children:"휴가"}),l.jsx("option",{value:"sick",children:"병가"}),l.jsx("option",{value:"personal",children:"개인사정"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"시작일"}),l.jsx("input",{type:"date",value:ne.startDate,onChange:B=>ce(te=>({...te,startDate:B.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"종료일"}),l.jsx("input",{type:"date",value:ne.endDate,onChange:B=>ce(te=>({...te,endDate:B.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"신청 사유"}),l.jsx("textarea",{value:ne.reason,onChange:B=>ce(te=>({...te,reason:B.target.value})),rows:4,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"휴가 신청 사유를 상세히 입력해주세요...",required:!0})]}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>x("list"),className:"px-6 py-3 border border-gray-200 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"취소"}),l.jsxs("button",{type:"submit",disabled:S,className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-2",children:[S&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:S?"신청 중...":"신청하기"})]})]})]})]}),f==="pending"&&i?.role==="faculty"&&l.jsxs("div",{children:[l.jsx("div",{className:"flex justify-between items-center mb-6",children:l.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[l.jsx(Lo,{className:"w-6 h-6 mr-3 text-orange-600"}),"대기 중인 휴가 신청 (",L,"건)"]})}),je().length===0?l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-12 text-center",children:[l.jsx(hi,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"대기 중인 휴가 신청이 없습니다."})]}):l.jsx("div",{className:"space-y-4",children:je().map(B=>l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[B.user?.name," (",B.user?.user_id,")"]}),l.jsxs("p",{className:"text-sm text-gray-500",children:[B.user?.department," • ",B.group?.name]})]}),l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${Fe(B.status)}`,children:Ve(B.status)})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"신청 종류"}),l.jsx("p",{className:"text-gray-900",children:xe(B.vacation_type)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"기간"}),l.jsxs("p",{className:"text-gray-900",children:[X(B.start_date)," ~ ",X(B.end_date),l.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",Ge(B.start_date,B.end_date),"일)"]})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"신청일"}),l.jsx("p",{className:"text-gray-900",children:X(B.created_at)})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"신청 사유"}),l.jsx("p",{className:"text-gray-900 mt-1 bg-gray-50 p-3 rounded-lg",children:B.reason})]}),q===B.id?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"검토 의견 (선택사항)"}),l.jsx("textarea",{value:Z,onChange:te=>Ke(te.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"검토 의견을 입력해주세요..."})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:()=>{Ne(null),Ke("")},className:"px-4 py-2 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"취소"}),l.jsxs("button",{onClick:()=>he(B.id,"rejected"),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[l.jsx(gf,{className:"w-4 h-4"}),"거절"]}),l.jsxs("button",{onClick:()=>he(B.id,"approved"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[l.jsx(Sn,{className:"w-4 h-4"}),"승인"]})]})]}):l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{onClick:()=>Ne(B.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"검토하기"})})]},B.id))})]}),f==="list"&&l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx(tc,{className:"w-6 h-6 mr-3 text-green-600"}),i?.role==="faculty"?"전체 휴가 신청 내역":"내 휴가 신청 현황"]}),ye().length===0?l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-12 text-center",children:[l.jsx(zi,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 mb-4",children:(i?.role==="faculty","휴가 신청 내역이 없습니다.")}),i?.role==="student"&&l.jsx("button",{onClick:()=>x("create"),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:"새 휴가 신청하기"})]}):l.jsx("div",{className:"space-y-4",children:ye().map(B=>l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[i?.role==="faculty"&&l.jsxs(l.Fragment,{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[B.user?.name," (",B.user?.user_id,")"]}),l.jsxs("p",{className:"text-sm text-gray-500",children:[B.user?.department," • ",B.group?.name]})]}),i?.role==="student"&&l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:xe(B.vacation_type)})]}),l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex-shrink-0 ${Fe(B.status)}`,children:Ve(B.status)})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"기간"}),l.jsxs("p",{className:"text-gray-900",children:[X(B.start_date)," ~ ",X(B.end_date),l.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",Ge(B.start_date,B.end_date),"일)"]})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"신청일"}),l.jsx("p",{className:"text-gray-900",children:X(B.created_at)})]}),B.reviewed_at&&l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"처리일"}),l.jsx("p",{className:"text-gray-900",children:X(B.reviewed_at)})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"신청 사유"}),l.jsx("p",{className:"text-gray-900 mt-1 bg-gray-50 p-3 rounded-lg",children:B.reason})]}),B.review_comment&&l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[l.jsx("span",{className:"text-sm font-medium text-blue-800",children:"검토 의견"}),l.jsx("p",{className:"text-blue-900 mt-1",children:B.review_comment}),B.reviewer&&l.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:["검토자: ",B.reviewer.name]})]})]},B.id))})]})]})]})]}):null}function ly(){const h=ms(),{user:i,logout:o}=ps(),[f,x]=V.useState([]),[m,w]=V.useState(!0),[S,N]=V.useState(null),[b,E]=V.useState(null),[A,O]=V.useState(""),[D,z]=V.useState(!1),[F,U]=V.useState([]),[ie,re]=V.useState(0);V.useEffect(()=>{if(!i){h("/");return}},[i,h]),V.useEffect(()=>{i&&L()},[i]);const L=async()=>{if(i)try{if(w(!0),i.role==="faculty"){const Z=await Po(i.id);if(U(Z),Z.length>0){const Ke=[];for(const ge of Z){const{data:xe}=await He.from("group_memberships").select("user_id").eq("group_id",ge.id),Ve=await mc(ge.id);Ke.push(...Ve)}x(Ke),re(Ke.length)}}}catch{N({type:"error",text:"데이터를 불러오는데 실패했습니다."})}finally{w(!1)}},Y=Z=>{switch(Z){case"annual":return"휴가";case"sick":return"병가";case"personal":return"개인사정";case"official":return"공무";default:return Z}},ne=Z=>{switch(Z){case"annual":return"bg-blue-100 text-blue-800";case"sick":return"bg-red-100 text-red-800";case"personal":return"bg-purple-100 text-purple-800";case"official":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},ce=Z=>new Date(Z).toLocaleDateString("ko-KR"),q=(Z,Ke)=>{const ge=new Date(Z),xe=new Date(Ke),Ve=Math.abs(xe.getTime()-ge.getTime());return Math.ceil(Ve/(1e3*60*60*24))+1},Ne=async(Z,Ke)=>{if(i){z(!0);try{await Ad(Z,Ke,i.id,A),N({type:"success",text:`휴가 신청이 ${Ke==="approved"?"승인":"거절"}되었습니다.`}),E(null),O(""),await L()}catch{N({type:"error",text:"처리 중 오류가 발생했습니다."})}finally{z(!1)}}};return i?m?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"데이터를 불러오는 중..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("button",{onClick:()=>h("/faculty-attendance"),className:"p-2 text-gray-600 hover:text-gray-800 rounded-lg hover:bg-gray-100 flex-shrink-0"}),l.jsx("div",{className:"flex-1",children:l.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"휴가 승인 관리"})})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Uo,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-gray-800",children:i?.name||"교수님"}),l.jsx("div",{className:"text-gray-500",children:"교직원"})]})]}),l.jsx("button",{onClick:()=>{o(),h("/")},className:"p-2 text-gray-600 hover:text-red-600 rounded-lg",children:l.jsx(pc,{size:20})})]})]})}),l.jsxs("div",{className:"p-4 space-y-4",children:[S&&l.jsx("div",{className:`p-4 rounded-xl flex items-center space-x-3 ${S.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:l.jsx("span",{className:"font-medium",children:S.text})}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-800 flex items-center",children:"휴가 승인 현황"}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xl font-bold text-purple-600",children:ie}),l.jsx("div",{className:"text-xs text-gray-600",children:"대기중"})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[l.jsx("div",{className:"text-lg font-bold text-blue-600",children:"휴가"}),l.jsx("div",{className:"text-xs text-blue-600",children:"일반 휴가"})]}),l.jsxs("div",{className:"bg-red-50 rounded-lg p-3 text-center",children:[l.jsx("div",{className:"text-lg font-bold text-red-600",children:"병가"}),l.jsx("div",{className:"text-xs text-red-600",children:"질병 휴가"})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[l.jsx("div",{className:"text-lg font-bold text-purple-600",children:"개인사정"}),l.jsx("div",{className:"text-xs text-purple-600",children:"기타 사유"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:["대기 중인 휴가 신청 (",ie,"건)"]})}),f.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500 text-sm",children:"대기 중인 휴가 신청이 없습니다."})}):l.jsx("div",{className:"space-y-4",children:f.map(Z=>l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx(Uo,{className:"w-5 h-5 text-purple-600"})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900 truncate",children:[Z.user?.name," (",Z.user?.user_id,")"]}),l.jsxs("p",{className:"text-sm text-gray-600",children:[Z.user?.department," • ",Z.group?.name]})]})]}),l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex-shrink-0 ${ne(Z.vacation_type)}`,children:Y(Z.vacation_type)})]}),l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"휴가 기간"}),l.jsxs("p",{className:"text-base text-gray-900 mt-1",children:[ce(Z.start_date)," ~ ",ce(Z.end_date),l.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",q(Z.start_date,Z.end_date),"일)"]})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"신청일"}),l.jsx("p",{className:"text-base text-gray-900 mt-1",children:ce(Z.created_at)})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"신청 사유"}),l.jsx("p",{className:"text-base text-gray-900 mt-2 bg-gray-50 p-4 rounded-lg break-words leading-relaxed",children:Z.reason})]})]}),b===Z.id?l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"검토 의견 (선택사항)"}),l.jsx("textarea",{value:A,onChange:Ke=>O(Ke.target.value),rows:3,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"검토 의견을 입력해주세요..."})]}),l.jsxs("div",{className:"flex flex-col space-y-2",children:[l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Ne(Z.id,"approved"),disabled:D,className:"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 text-sm disabled:opacity-50",children:"승인"}),l.jsx("button",{onClick:()=>Ne(Z.id,"rejected"),disabled:D,className:"flex-1 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2 text-sm disabled:opacity-50",children:"거절"})]}),l.jsx("button",{onClick:()=>{E(null),O("")},className:"w-full py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"취소"})]})]}):l.jsxs("button",{onClick:()=>E(Z.id),className:"w-full py-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-colors flex items-center justify-center gap-2 text-base font-medium",children:[l.jsx(tc,{className:"w-5 h-5"}),"검토하기"]})]},Z.id))})]})]})]}):null}function cy(){const h=ms(),{user:i}=ps(),[o]=V.useState({name:"",role:"faculty"}),[f,x]=V.useState({checkin_deadline_hour:10,checkout_start_hour:18}),[m,w]=V.useState([]),[S,N]=V.useState(""),[b,E]=V.useState(!1),[A,O]=V.useState(!1),[D,z]=V.useState("late"),[F,U]=V.useState(""),[ie,re]=V.useState(""),[L,Y]=V.useState(""),[ne,ce]=V.useState(""),[q,Ne]=V.useState(!1),[Z,Ke]=V.useState(!1),[ge,xe]=V.useState(!1),[Ve,Fe]=V.useState(!1),[X,Ge]=V.useState(""),[Ce,he]=V.useState(""),je=(Ue,ct)=>{const de=parseInt(ct,10);isNaN(de)||de<0||de>23||(x(Oe=>({...Oe,[Ue]:de})),w([]),N(""))},ye=()=>{const Ue=[];return f.checkin_deadline_hour>=f.checkout_start_hour&&Ue.push("출근 마감 시간은 퇴근 시작 시간보다 빨라야 합니다."),(f.checkin_deadline_hour<6||f.checkin_deadline_hour>12)&&Ue.push("출근 마감 시간은 06:00~12:00 사이여야 합니다."),(f.checkout_start_hour<14||f.checkout_start_hour>22)&&Ue.push("퇴근 시작 시간은 14:00~22:00 사이여야 합니다."),Ue},B=async()=>{E(!0),w([]),N("");const Ue=ye();if(Ue.length>0){w(Ue),E(!1);return}setTimeout(()=>{N("출퇴근 시간 설정이 저장되었습니다."),E(!1),setTimeout(()=>{N("")},3e3)},1e3)},te=Ue=>`${Ue.toString().padStart(2,"0")}:00`,fe=Ue=>{z(Ue),U(""),O(!0)},Be=()=>{alert(`${D==="late"?"지각":"조기퇴근"} 사유가 저장되었습니다: ${F}`),O(!1),U("")},nt=()=>{O(!1),U("")},Ae=async Ue=>{Ue.preventDefault(),Fe(!0),Ge("");try{if(!ie||!L||!ne){Ge("모든 필드를 입력해주세요."),he("error");return}if(L!==ne){Ge("새 비밀번호가 일치하지 않습니다."),he("error");return}if(L.length<6){Ge("새 비밀번호는 최소 6자 이상이어야 합니다."),he("error");return}if(ie===L){Ge("새 비밀번호는 현재 비밀번호와 달라야 합니다."),he("error");return}const{data:{user:ct}}=await He.auth.getUser();if(!ct?.email){Ge("사용자 정보를 가져올 수 없습니다."),he("error");return}const{error:de}=await He.auth.signInWithPassword({email:ct.email,password:ie});if(de){Ge("현재 비밀번호가 올바르지 않습니다."),he("error");return}const{error:Oe}=await He.auth.updateUser({password:L});if(Oe){Ge("비밀번호 변경에 실패했습니다. 다시 시도해주세요."),he("error");return}Ge("비밀번호가 성공적으로 변경되었습니다."),he("success"),re(""),Y(""),ce("")}catch{Ge("오류가 발생했습니다. 다시 시도해주세요."),he("error")}finally{Fe(!1)}},Ye=(Ue=>{const ct=Ue.length>=6,de=/[a-zA-Z]/.test(Ue),Oe=/\d/.test(Ue),Xe=/[!@#$%^&*(),.?":{}|<>]/.test(Ue);return{minLength:ct,hasLetter:de,hasNumber:Oe,hasSpecial:Xe}})(L);return l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[l.jsx("button",{onClick:()=>h("/faculty-attendance"),className:"p-2 hover:bg-gray-100 rounded-lg flex-shrink-0",children:l.jsx(Ua,{size:20,className:"text-gray-600"})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-800 truncate",children:"출퇴근 시간 설정"}),l.jsx("p",{className:"text-sm text-gray-600 break-words leading-relaxed",children:"학생들의 출퇴근 시간 기준을 설정하세요"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[l.jsx(Ma,{className:"w-6 h-6 text-blue-600"}),l.jsxs("div",{className:"text-sm hidden sm:block",children:[l.jsx("div",{className:"font-medium text-gray-800 whitespace-nowrap",children:o.name}),l.jsx("div",{className:"text-gray-500",children:"교직원"})]})]})]})}),l.jsxs("div",{className:"p-4 max-w-2xl mx-auto",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6 mb-6",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(yn,{className:"w-6 h-6 text-blue-600 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"text-blue-800 flex-1",children:[l.jsx("h3",{className:"font-semibold mb-3",children:"출퇴근 시간 설정 안내"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{className:"leading-relaxed",children:["출근 마감 시간 전까지는 ",l.jsx("strong",{children:"'출근'"}),"으로 처리됩니다"]})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{className:"leading-relaxed",children:["출근 마감 시간 이후는 ",l.jsx("strong",{children:"'지각'"}),"으로 처리됩니다"]})]}),l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-1.5 flex-shrink-0"}),l.jsxs("span",{className:"leading-relaxed",children:["퇴근 시작 시간 이후로는 ",l.jsx("strong",{children:"'퇴근'"}),"으로 처리됩니다"]})]})]})]})]})}),S&&l.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 p-4 rounded-2xl",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Sn,{size:20}),l.jsx("span",{className:"font-medium",children:S})]})}),m.length>0&&l.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 p-4 rounded-2xl",children:[l.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[l.jsx(yn,{size:20,className:"mt-0.5 flex-shrink-0"}),l.jsx("span",{className:"font-semibold",children:"설정 오류"})]}),l.jsx("ul",{className:"text-sm space-y-2 ml-8",children:m.map((Ue,ct)=>l.jsxs("li",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full mt-2 flex-shrink-0"}),l.jsx("span",{className:"leading-relaxed break-words",children:Ue})]},ct))})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx(hi,{className:"w-6 h-6 mr-3 text-blue-600"}),"근무 시간 설정"]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"출근 마감 시간"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[l.jsx("select",{value:f.checkin_deadline_hour,onChange:Ue=>je("checkin_deadline_hour",Ue.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-medium w-full sm:w-auto",children:Array.from({length:24},(Ue,ct)=>l.jsx("option",{value:ct,children:te(ct)},ct))}),l.jsx("div",{className:"flex-1 bg-green-50 px-4 py-3 rounded-xl min-w-0",children:l.jsxs("span",{className:"text-green-700 font-medium text-sm sm:text-base leading-relaxed break-words",children:[te(f.checkin_deadline_hour)," 전까지는 정상 출근으로 처리됩니다"]})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"퇴근 시작 시간"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[l.jsx("select",{value:f.checkout_start_hour,onChange:Ue=>je("checkout_start_hour",Ue.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-medium w-full sm:w-auto",children:Array.from({length:24},(Ue,ct)=>l.jsx("option",{value:ct,children:te(ct)},ct))}),l.jsx("div",{className:"flex-1 bg-blue-50 px-4 py-3 rounded-xl min-w-0",children:l.jsxs("span",{className:"text-blue-700 font-medium text-sm sm:text-base leading-relaxed break-words",children:[te(f.checkout_start_hour)," 이후로는 퇴근으로 처리됩니다"]})})]})]}),l.jsx("button",{onClick:B,disabled:b,className:"w-full bg-blue-600 text-white py-4 rounded-xl font-medium text-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3",children:b?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"저장 중..."]}):l.jsxs(l.Fragment,{children:[l.jsx(L1,{size:20}),"설정 저장"]})})]})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 mt-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx(m2,{className:"w-6 h-6 mr-3 text-purple-600"}),"사유 입력 UI 테스트"]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("button",{onClick:()=>fe("late"),className:"bg-orange-500 text-white py-4 px-6 rounded-xl font-medium hover:bg-orange-600 focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-all flex items-center justify-center gap-3",children:[l.jsx(yn,{size:20}),"지각 사유 입력 테스트"]}),l.jsxs("button",{onClick:()=>fe("early"),className:"bg-blue-500 text-white py-4 px-6 rounded-xl font-medium hover:bg-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all flex items-center justify-center gap-3",children:[l.jsx(hi,{size:20}),"조기퇴근 사유 입력 테스트"]})]}),l.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-xl",children:l.jsx("p",{className:"text-sm text-gray-600",children:"위 버튼을 클릭하면 QR 스캔 시 나타나는 사유 입력 팝업과 동일한 UI를 테스트해볼 수 있습니다."})})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 mt-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx(Bo,{className:"w-6 h-6 mr-3 text-green-600"}),"비밀번호 변경"]}),X&&l.jsxs("div",{className:`mb-6 p-4 rounded-xl flex items-center space-x-2 ${Ce==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[Ce==="success"?l.jsx(Sn,{className:"w-4 h-4"}):l.jsx(yn,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:X})]}),l.jsxs("form",{onSubmit:Ae,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"현재 비밀번호"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:q?"text":"password",value:ie,onChange:Ue=>re(Ue.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"현재 비밀번호를 입력하세요",disabled:Ve}),l.jsx("button",{type:"button",onClick:()=>Ne(!q),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:Ve,children:q?l.jsx(Vi,{size:20}):l.jsx(di,{size:20})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"새 비밀번호"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:Z?"text":"password",value:L,onChange:Ue=>Y(Ue.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"새 비밀번호를 입력하세요",disabled:Ve}),l.jsx("button",{type:"button",onClick:()=>Ke(!Z),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:Ve,children:Z?l.jsx(Vi,{size:20}):l.jsx(di,{size:20})})]}),L&&l.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"비밀번호 강도"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Ye.minLength?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${Ye.minLength?"text-green-600":"text-gray-500"}`,children:"최소 6자 이상"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Ye.hasLetter?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${Ye.hasLetter?"text-green-600":"text-gray-500"}`,children:"영문 포함"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Ye.hasNumber?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${Ye.hasNumber?"text-green-600":"text-gray-500"}`,children:"숫자 포함"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Ye.hasSpecial?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${Ye.hasSpecial?"text-green-600":"text-gray-500"}`,children:"특수문자 포함"})]})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"새 비밀번호 확인"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:ge?"text":"password",value:ne,onChange:Ue=>ce(Ue.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"새 비밀번호를 다시 입력하세요",disabled:Ve}),l.jsx("button",{type:"button",onClick:()=>xe(!ge),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:Ve,children:ge?l.jsx(Vi,{size:20}):l.jsx(di,{size:20})})]}),ne&&l.jsx("div",{className:"mt-2 flex items-center space-x-2",children:L===ne?l.jsxs(l.Fragment,{children:[l.jsx(Sn,{className:"w-4 h-4 text-green-500"}),l.jsx("span",{className:"text-xs text-green-600",children:"비밀번호가 일치합니다"})]}):l.jsxs(l.Fragment,{children:[l.jsx(yn,{className:"w-4 h-4 text-red-500"}),l.jsx("span",{className:"text-xs text-red-600",children:"비밀번호가 일치하지 않습니다"})]})})]}),l.jsx("button",{type:"submit",disabled:Ve||!ie||!L||!ne||L!==ne,className:"w-full bg-green-600 text-white py-4 rounded-xl font-medium text-lg hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3",children:Ve?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"변경 중..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Bo,{size:20}),"비밀번호 변경"]})})]}),l.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"보안 팁"}),l.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[l.jsx("li",{children:"• 다른 사이트에서 사용하지 않는 고유한 비밀번호를 사용하세요"}),l.jsx("li",{children:"• 개인정보나 생년월일을 포함하지 마세요"}),l.jsx("li",{children:"• 정기적으로 비밀번호를 변경하세요"})]})]})]})]}),A&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:D==="late"?"지각 사유 입력":"조기퇴근 사유 입력"}),l.jsx("p",{className:"text-sm text-gray-600",children:D==="late"?"지각 사유를 입력해주세요":"조기퇴근 사유를 입력해주세요"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"사유"}),l.jsx("textarea",{value:F,onChange:Ue=>U(Ue.target.value),placeholder:D==="late"?"예: 교통체증, 알람을 못들어서...":"예: 개인사정, 병원진료...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:nt,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"취소"}),l.jsx("button",{onClick:Be,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"저장"})]})]})]})})]})}function uy(){const h=ms(),{user:i}=ps(),[o,f]=V.useState(""),[x,m]=V.useState(""),[w,S]=V.useState(""),[N,b]=V.useState(!1),[E,A]=V.useState(!1),[O,D]=V.useState(!1),[z,F]=V.useState(!1),[U,ie]=V.useState(""),[re,L]=V.useState(""),Y=async q=>{q.preventDefault(),F(!0),ie("");try{if(!o||!x||!w){ie("모든 필드를 입력해주세요."),L("error");return}if(x!==w){ie("새 비밀번호가 일치하지 않습니다."),L("error");return}if(x.length<6){ie("새 비밀번호는 최소 6자 이상이어야 합니다."),L("error");return}if(o===x){ie("새 비밀번호는 현재 비밀번호와 달라야 합니다."),L("error");return}let Ne=null;try{const{data:{user:Z}}=await He.auth.getUser();Ne=Z}catch(Z){console.error("Auth 사용자 정보 가져오기 실패:",Z);const Ke=localStorage.getItem("auth_user");Ke&&(Ne={email:JSON.parse(Ke).user_id+"@temp.com"})}if(!Ne?.email){ie("사용자 정보를 가져올 수 없습니다. 네트워크 연결을 확인해주세요."),L("error");return}try{const{error:Z}=await He.auth.signInWithPassword({email:Ne.email,password:o});if(Z){ie("현재 비밀번호가 올바르지 않습니다."),L("error");return}}catch(Z){console.error("비밀번호 확인 중 오류:",Z),ie("네트워크 연결을 확인해주세요."),L("error");return}try{const{error:Z}=await He.auth.updateUser({password:x});if(Z){ie("비밀번호 변경에 실패했습니다. 다시 시도해주세요."),L("error");return}}catch(Z){console.error("비밀번호 변경 중 오류:",Z),ie("네트워크 연결을 확인해주세요."),L("error");return}ie("비밀번호가 성공적으로 변경되었습니다."),L("success"),f(""),m(""),S(""),setTimeout(()=>{h(-1)},3e3)}catch{ie("오류가 발생했습니다. 다시 시도해주세요."),L("error")}finally{F(!1)}},ce=(q=>{const Ne=q.length>=6,Z=/[a-zA-Z]/.test(q),Ke=/\d/.test(q),ge=/[!@#$%^&*(),.?":{}|<>]/.test(q);return{minLength:Ne,hasLetter:Z,hasNumber:Ke,hasSpecial:ge}})(x);return i?l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm px-4 py-3",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("button",{onClick:()=>h(-1),className:"p-2 text-gray-600 hover:text-gray-800 rounded-lg hover:bg-gray-100",children:l.jsx(Ua,{size:20})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"비밀번호 변경"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[i.name," • ",i.department]})]})]})})}),l.jsx("div",{className:"p-4",children:l.jsx("div",{className:"max-w-md mx-auto",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Bo,{className:"w-8 h-8 text-blue-600"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"비밀번호 변경"}),l.jsx("p",{className:"text-sm text-gray-600",children:"안전한 비밀번호로 변경하세요"})]}),U&&l.jsxs("div",{className:`mb-4 p-3 rounded-lg flex items-center space-x-2 ${re==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[re==="success"?l.jsx(Sn,{className:"w-4 h-4"}):l.jsx(yn,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:U})]}),l.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"현재 비밀번호"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:N?"text":"password",value:o,onChange:q=>f(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"현재 비밀번호를 입력하세요",disabled:z}),l.jsx("button",{type:"button",onClick:()=>b(!N),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:z,children:N?l.jsx(Vi,{size:20}):l.jsx(di,{size:20})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"새 비밀번호"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:E?"text":"password",value:x,onChange:q=>m(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"새 비밀번호를 입력하세요",disabled:z}),l.jsx("button",{type:"button",onClick:()=>A(!E),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:z,children:E?l.jsx(Vi,{size:20}):l.jsx(di,{size:20})})]}),x&&l.jsxs("div",{className:"mt-2 space-y-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${ce.minLength?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${ce.minLength?"text-green-600":"text-gray-500"}`,children:"최소 6자 이상"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${ce.hasLetter?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${ce.hasLetter?"text-green-600":"text-gray-500"}`,children:"영문 포함"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${ce.hasNumber?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${ce.hasNumber?"text-green-600":"text-gray-500"}`,children:"숫자 포함"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${ce.hasSpecial?"bg-green-500":"bg-gray-300"}`}),l.jsx("span",{className:`text-xs ${ce.hasSpecial?"text-green-600":"text-gray-500"}`,children:"특수문자 포함"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"새 비밀번호 확인"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:O?"text":"password",value:w,onChange:q=>S(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"새 비밀번호를 다시 입력하세요",disabled:z}),l.jsx("button",{type:"button",onClick:()=>D(!O),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:z,children:O?l.jsx(Vi,{size:20}):l.jsx(di,{size:20})})]}),w&&l.jsx("div",{className:"mt-2 flex items-center space-x-2",children:x===w?l.jsxs(l.Fragment,{children:[l.jsx(Sn,{className:"w-4 h-4 text-green-500"}),l.jsx("span",{className:"text-xs text-green-600",children:"비밀번호가 일치합니다"})]}):l.jsxs(l.Fragment,{children:[l.jsx(yn,{className:"w-4 h-4 text-red-500"}),l.jsx("span",{className:"text-xs text-red-600",children:"비밀번호가 일치하지 않습니다"})]})})]}),l.jsx("button",{type:"submit",disabled:z||!o||!x||!w||x!==w,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:z?l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"변경 중..."})]}):"비밀번호 변경"})]}),l.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"보안 팁"}),l.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[l.jsx("li",{children:"• 다른 사이트에서 사용하지 않는 고유한 비밀번호를 사용하세요"}),l.jsx("li",{children:"• 개인정보나 생년월일을 포함하지 마세요"}),l.jsx("li",{children:"• 정기적으로 비밀번호를 변경하세요"})]})]})]})})})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"로그인 중..."})]})})}function dy(){return l.jsx(a2,{children:l.jsx(Qx,{children:l.jsx("div",{className:"min-h-screen bg-gray-100",children:l.jsxs(Kx,{children:[l.jsx(pn,{path:"/",element:l.jsx(xf,{})}),l.jsx(pn,{path:"/login",element:l.jsx(xf,{})}),l.jsx(pn,{path:"/student-attendance",element:l.jsx(q2,{})}),l.jsx(pn,{path:"/faculty-attendance",element:l.jsx(K2,{})}),l.jsx(pn,{path:"/project-management",element:l.jsx(Af,{})}),l.jsx(pn,{path:"/group-management",element:l.jsx(Af,{})}),l.jsx(pn,{path:"/project-attendance/:groupId",element:l.jsx(kf,{})}),l.jsx(pn,{path:"/group-attendance/:groupId",element:l.jsx(kf,{})}),l.jsx(pn,{path:"/qr-generator",element:l.jsx(Tf,{})}),l.jsx(pn,{path:"/qr_generator",element:l.jsx(Tf,{})}),l.jsx(pn,{path:"/vacation",element:l.jsx(oy,{})}),l.jsx(pn,{path:"/faculty-vacation-approval",element:l.jsx(ly,{})}),l.jsx(pn,{path:"/work-time-settings",element:l.jsx(cy,{})}),l.jsx(pn,{path:"/password-change",element:l.jsx(uy,{})})]})})})})}rx.createRoot(document.getElementById("root")).render(l.jsx(vr.StrictMode,{children:l.jsx(dy,{})}));
